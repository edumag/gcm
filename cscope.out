cscope 15 $HOME/SERVIDOR/gcm               0000543780
	@docs/doxygen/html/search-config.php

1 <
s¸ùt
 
	gœnguage
="php">

3 
$c⁄fig
 = 
¨øy
(

5 'GENERATE_TREEVIEW' => 
Ál£
,

6 'DISABLE_INDEX' => 
Ál£
,

9 
	g$å™¶©‹
 = 
¨øy
(

11 '£¨ch_ªsu…s' => 
¨øy
(

22 </
	gs¸ùt
>

	@docs/doxygen/html/search-functions.php

1 <
s¸ùt
 
	gœnguage
="PHP">

2 
ªquúe_⁄˚
 "search-config.php";

4 
fun˘i⁄
 
	$íd_f‹m
(
$vÆue
)

6 
globÆ
 
$c⁄fig
;

7 
globÆ
 
$å™¶©‹
;

8 i‡(
$c⁄fig
['DISABLE_INDEX'] =
Ál£
)

10 
echo
 " <inputÅype=\"text\" id=\"MSearchField\"Çame=\"query\" value=\"$value\" size=\"20\"áccesskey=\"S\" onfocus=\"searchBox.OnSearchFieldFocus(true)\" onblur=\"searchBox.OnSearchFieldFocus(false)\"/>\n </form>\n </div><div class=\"right\"></div>\n </div>\n </li>\n </ul>\n </div>\n</div>\n";

12 i‡(
$c⁄fig
['GENERATE_TREEVIEW'])

14 
echo
 
$å™¶©‹
['split_bar'];

16 
	}
}

18 
fun˘i⁄
 
	$íd_∑ge
()

20 
globÆ
 
$c⁄fig
;

21 
globÆ
 
$å™¶©‹
;

22 i‡(
$c⁄fig
['GENERATE_TREEVIEW'])

24 
echo
 "</div>\n<div id=\"nav-path\" class=\"navpath\">\n <ul>\n <li class=\"footer\">";

25 
echo
 
$å™¶©‹
['logo'];

26 
echo
 "</li>\n </ul>\n</div>";

28 
echo
 "</body></html>";

29 
	}
}

31 
fun˘i⁄
 
	$£¨ch_ªsu…s
()

33 
globÆ
 
$å™¶©‹
;

34  
$å™¶©‹
['search_results_title'];

35 
	}
}

37 
fun˘i⁄
 
	$m©ches_ãxt
(
$num
)

39 
globÆ
 
$å™¶©‹
;

40 
$°rög
 = 
$å™¶©‹
['£¨ch_ªsu…s'][(
$num
>2)?2:$num];

42 
	`evÆ
("\$result = \"$string\";");

43  
$ªsu…
;

44 
	}
}

46 
fun˘i⁄
 
	$ªp‹t_m©ches
()

48 
globÆ
 
$å™¶©‹
;

49  
$å™¶©‹
['search_matches'];

50 
	}
}

52 
fun˘i⁄
 
	$ªadI¡
(
$fûe
)

54 
$b1
 = 
	`‹d
(
	`fgëc
(
$fûe
)); 
$b2
 = ord(fgetc($file));

55 
$b3
 = 
	`‹d
(
	`fgëc
(
$fûe
)); 
$b4
 = ord(fgetc($file));

56  (
$b1
<<24)|(
$b2
<<16)|(
$b3
<<8)|
$b4
;

57 
	}
}

59 
fun˘i⁄
 
	$ªadSåög
(
$fûe
)

61 
$ªsu…
="";

62 
	`‹d
(
$c
=
	`fgëc
(
$fûe
))Ë
$ªsu…
.=$c;

63  
$ªsu…
;

64 
	}
}

66 
fun˘i⁄
 
	$ªadHódî
(
$fûe
)

68 
$hódî
 =
	`fgëc
(
$fûe
); $header.=fgetc($file);

69 
$hódî
.=
	`fgëc
(
$fûe
); $header.=fgetc($file);

70  
$hódî
;

71 
	}
}

73 
fun˘i⁄
 
	$compuãIndex
(
$w‹d
)

76 i‡(
	`°æí
(
$w‹d
)<2)  -1;

78 
$hi
 = 
	`‹d
(
$w‹d
{0});

79 i‡(
$hi
==0)  -1;

81 
$lo
 = 
	`‹d
(
$w‹d
{1});

82 i‡(
$lo
==0)  -1;

84  
$hi
*256+
$lo
;

85 
	}
}

87 
fun˘i⁄
 
	$£¨ch
(
$fûe
,
$w‹d
,&
$°©sLi°
)

89 
$ödex
 = 
	`compuãIndex
(
$w‹d
);

90 i‡(
$ödex
!=-1)

92 
	`f£ek
(
$fûe
,
$ödex
*4+4);

93 
$ödex
 = 
	`ªadI¡
(
$fûe
);

94 i‡(
$ödex
)

96 
$°¨t
=(
$°©sLi°
);

97 
$cou¡
=
$°¨t
;

98 
	`f£ek
(
$fûe
,
$ödex
);

99 
$w
 = 
	`ªadSåög
(
$fûe
);

100 
$w
)

102 
$°©Idx
 = 
	`ªadI¡
(
$fûe
);

103 i‡(
$w‹d
==
	`sub°r
(
$w
,0,
	`°æí
($word)))

105 
$°©sLi°
[
$cou¡
++]=
	`¨øy
(

106 "w‹d"=>
$w‹d
,

107 "m©ch"=>
$w
,

108 "ödex"=>
$°©Idx
,

109 "fuŒ"=>
	`°æí
(
$w
)==°æí(
$w‹d
),

110 "docs"=>
	`¨øy
()

113 
$w
 = 
	`ªadSåög
(
$fûe
);

115 
$tŸÆHi
=0;

116 
$tŸÆFªqHi
=0;

117 
$tŸÆFªqLo
=0;

118 
$cou¡
=
$°¨t
;$cou¡<(
$°©sLi°
);$count++)

120 
$°©Info
 = &
$°©sLi°
[
$cou¡
];

121 
$mu…ùlõr
 = 1;

123 i‡(
$°©Info
["fuŒ"]Ë
$mu…ùlõr
=2;

124 
	`f£ek
(
$fûe
,
$°©Info
["index"]);

125 
$numDocs
 = 
	`ªadI¡
(
$fûe
);

126 
$docInfo
 = 
	`¨øy
();

128 
$i
=0;$i<
$numDocs
;$i++)

130 
$idx
=
	`ªadI¡
(
$fûe
);

131 
$‰eq
=
	`ªadI¡
(
$fûe
);

132 
$docInfo
[
$i
]=
	`¨øy
("idx" => 
$idx
,

133 "‰eq" => 
$‰eq
>>1,

135 "hi" => 
$‰eq
&1

137 i‡(
$‰eq
&1)

139 
$tŸÆHi
++;

140 
$tŸÆFªqHi
+=
$‰eq
*
$mu…ùlõr
;

144 
$tŸÆFªqLo
+=
$‰eq
*
$mu…ùlõr
;

148 
$i
=0;$i<
$numDocs
;$i++)

150 
	`f£ek
(
$fûe
,
$docInfo
[
$i
]["idx"]);

151 
$docInfo
[
$i
]["«me"]=
	`ªadSåög
(
$fûe
);

152 
$docInfo
[
$i
]["uæ"]=
	`ªadSåög
(
$fûe
);

154 
$°©Info
["docs"]=
$docInfo
;

156 
$tŸÆFªq
=(
$tŸÆHi
+1)*
$tŸÆFªqLo
 + 
$tŸÆFªqHi
;

157 
$cou¡
=
$°¨t
;$cou¡<(
$°©sLi°
);$count++)

159 
$°©Info
 = &
$°©sLi°
[
$cou¡
];

160 
$mu…ùlõr
 = 1;

162 i‡(
$°©Info
["fuŒ"]Ë
$mu…ùlõr
=2;

163 
$i
=0;$i<(
$°©Info
["docs"]);$i++)

165 
$docInfo
 = &
$°©Info
["docs"];

167 
$‰eq
=
$docInfo
[
$i
]["freq"];

168 i‡(
$docInfo
[
$i
]["hi"])

170 
$°©Info
["docs"][
$i
]["rank"]=

171 ()(
$‰eq
*
$mu…ùlõr
+
$tŸÆFªqLo
)/
$tŸÆFªq
;

175 
$°©Info
["docs"][
$i
]["rank"]=

176 ()(
$‰eq
*
$mu…ùlõr
)/
$tŸÆFªq
;

182  
$°©sLi°
;

183 
	}
}

185 
fun˘i⁄
 
	$comböe_ªsu…s
(
$ªsu…s
,&
$docs
)

187 
	`f‹óch
 (
$ªsu…s
 
as
 
$w‹dInfo
)

189 
$docsLi°
 = &
$w‹dInfo
["docs"];

190 
	`f‹óch
 (
$docsLi°
 
as
 
$di
)

192 
$key
=
$di
["url"];

193 
$ønk
=
$di
["rank"];

194 i‡(
	`is£t
(
$docs
[
$key
]))

196 
$docs
[
$key
]["ønk"]+=
$ønk
;

200 
$docs
[
$key
] = 
	`¨øy
("url"=>$key,

201 "«me"=>
$di
["name"],

202 "ønk"=>
$ønk


205 
$docs
[
$key
]["w‹ds"][] = 
	`¨øy
(

206 "w‹d"=>
$w‹dInfo
["word"],

207 "m©ch"=>
$w‹dInfo
["match"],

208 "‰eq"=>
$di
["freq"]

212  
$docs
;

213 
	}
}

215 
fun˘i⁄
 
	$fûãr_ªsu…s
(
$docs
,&
$ªquúedW‹ds
,&
$f‹biddíW‹ds
)

217 
$fûãªdDocs
=
	`¨øy
();

218 
	`li°
 (
$key
, 
$vÆ
Ë
	`óch
 (
$docs
))

220 
$w‹ds
 = &
$docs
[
$key
]["words"];

221 
$c›y
=1;

222 i‡((
$ªquúedW‹ds
)>0)

224 
	`f‹óch
 (
$ªquúedW‹ds
 
as
 
$ªqW‹d
)

226 
$found
=0;

227 
	`f‹óch
 (
$w‹ds
 
as
 
$w‹dInfo
)

229 
$found
 = 
$w‹dInfo
["w‹d"]==
$ªqW‹d
;

230 i‡(
$found
) ;

232 i‡(!
$found
)

234 
$c›y
=0;

239 i‡((
$f‹biddíW‹ds
)>0)

241 
	`f‹óch
 (
$w‹ds
 
as
 
$w‹dInfo
)

243 i‡(
	`ö_¨øy
(
$w‹dInfo
["w‹d"],
$f‹biddíW‹ds
))

245 
$c›y
=0;

250 i‡(
$c›y
Ë
$fûãªdDocs
[
$key
]=
$docs
[$key];

252  
$fûãªdDocs
;

253 
	}
}

255 
fun˘i⁄
 
	$com∑ª_ønk
(
$a
,
$b
)

257 i‡(
$a
["ønk"] =
$b
["rank"])

261  (
$a
["ønk"]>
$b
["rank"]) ? -1 : 1;

262 
	}
}

264 
fun˘i⁄
 
	$s‹t_ªsu…s
(
$docs
,&
$s‹ãd
)

266 
$s‹ãd
 = 
$docs
;

267 
	`us‹t
(
$s‹ãd
,"compare_rank");

268  
$s‹ãd
;

269 
	}
}

271 
fun˘i⁄
 
	$ªp‹t_ªsu…s
(&
$docs
)

273 
echo
 "<div class=\"header\">";

274 
echo
 " <div class=\"headertitle\">\n";

275 
echo
 " <h1>".
	`£¨ch_ªsu…s
()."</h1>\n";

276 
echo
 " </div>\n";

277 
echo
 "</div>\n";

278 
echo
 "<div class=\"searchresults\">\n";

279 
echo
 "<table cellspacing=\"2\">\n";

280 
$numDocs
 = (
$docs
);

281 i‡(
$numDocs
==0)

283 
echo
 " <tr>\n";

284 
echo
 " <td cﬁ•™=\"2\">".
	`m©ches_ãxt
(0)."</td>\n";

285 
echo
 " </tr>\n";

289 
echo
 " <tr>\n";

290 
echo
 " <td cﬁ•™=\"2\">".
	`m©ches_ãxt
(
$numDocs
);

291 
echo
 "\n";

292 
echo
 " </td>\n";

293 
echo
 " </tr>\n";

294 
$num
=1;

295 
	`f‹óch
 (
$docs
 
as
 
$doc
)

297 
echo
 " <tr>\n";

298 
echo
 " <tdálign=\"right\">$num.</td>";

299 
echo
 "<td><®˛ass=\"ñ\" hªf=\"".
$doc
["url"]."\">".$doc["name"]."</a></td>\n";

300 
echo
 " <tr>\n";

301 
echo
 " <td></td><td cœss=\"töy\">".
	`ªp‹t_m©ches
()." ";

302 
	`f‹óch
 (
$doc
["w‹ds"] 
as
 
$w‹dInfo
)

304 
$w‹d
 = 
$w‹dInfo
["word"];

305 
$m©chRight
 = 
	`sub°r
(
$w‹dInfo
["m©ch"],
	`°æí
(
$w‹d
));

306 
echo
 "<b>$w‹d</b>$m©chRight(".
$w‹dInfo
["freq"].") ";

308 
echo
 " </td>\n";

309 
echo
 " </tr>\n";

310 
$num
++;

313 
echo
 "</table>\n";

314 
echo
 "</div>\n";

315 
	}
}

317 
fun˘i⁄
 
	$run_quîy
(
$quîy
)

319 if(
	`°rcmp
('4.1.0', 
	`phpvîsi⁄
()) > 0)

321 
	`dõ
("Error: PHP version 4.1.0 oráboveÑequired!");

323 i‡(!(
$fûe
=
	`f›í
("search/search.idx","rb")))

325 
	`dõ
("Error: Search index file could NOT be opened!");

327 i‡(
	`ªadHódî
(
$fûe
)!="DOXS")

329 
	`dõ
("Error: Header of index file is invalid!");

331 
$ªsu…s
 = 
	`¨øy
();

332 
$ªquúedW‹ds
 = 
	`¨øy
();

333 
$f‹biddíW‹ds
 = 
	`¨øy
();

334 
$foundW‹ds
 = 
	`¨øy
();

335 
$w‹d
=
	`°πok
(
$quîy
," ");

336 
$w‹d
)

338 i‡((
$w‹d
{0}=='+')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$ªquúedW‹ds
[]=$word; }

339 i‡((
$w‹d
{0}=='-')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$f‹biddíW‹ds
[]=$word; }

340 i‡(!
	`ö_¨øy
(
$w‹d
,
$foundW‹ds
))

342 
$foundW‹ds
[]=
$w‹d
;

343 
	`£¨ch
(
$fûe
,
	`°πﬁowî
(
$w‹d
),
$ªsu…s
);

345 
$w‹d
=
	`°πok
(" ");

347 
	`f˛o£
(
$fûe
);

348 
$docs
 = 
	`¨øy
();

349 
	`comböe_ªsu…s
(
$ªsu…s
,
$docs
);

352 
$fûãªdDocs
 = 
	`fûãr_ªsu…s
(
$docs
,
$ªquúedW‹ds
,
$f‹biddíW‹ds
);

354 
$s‹ãd
 = 
	`¨øy
();

355 
	`s‹t_ªsu…s
(
$fûãªdDocs
,
$s‹ãd
);

356  
$s‹ãd
;

357 
	}
}

359 
fun˘i⁄
 
	$maö
()

361 
$quîy
 = "";

362 i‡(
	`¨øy_key_exi°s
("quîy", 
$_GET
))

364 
$quîy
=
$_GET
["query"];

366 
$s‹ãd
 = 
	`run_quîy
(
$quîy
);

369 
	`íd_f‹m
(
	`¥eg_ª∂a˚
("/[^a-zA-Z0-9\-\_\.]/i", " ", 
$quîy
 ));

371 
	`ªp‹t_ªsu…s
(
$s‹ãd
);

372 
	`íd_∑ge
();

373 
	}
}

374 </
	gs¸ùt
>

	@docs/doxygen/html/search-opensearch.php

1 <
s¸ùt
 
	gœnguage
="PHP">

2 
ªquúe
 "search-functions.php";

4 
	g$mode
 = 
¨øy_key_exi°s
('v', 
$_GET
)?
	g$_GET
['v']:"";

5 
	g$quîy
 = 
¨øy_key_exi°s
('quîy', 
$_GET
)?
	g$_GET
['query']:"";

7 
	g$quîy_ªsu…s
 = 
run_quîy
(
$quîy
);

9 
$mode
)

12 
	`›í£¨ch_des¸ùti⁄
();

15 
	`›í£¨ch_js⁄_ªsu…s
(
$quîy
, 
$quîy_ªsu…s
);

18 
	`›í£¨ch_xml_ªsu…s
(
$quîy
, 
$quîy_ªsu…s
);

21 
	`övÆid_f‹m©
(
$quîy
, 
$quîy_ªsu…s
);

23 
	}
}

25 
fun˘i⁄
 
	$›í£¨ch_des¸ùti⁄
()

27 
globÆ
 
$c⁄fig
;

28 
globÆ
 
$å™¶©‹
;

30 
$sh‹äame
 = 
$å™¶©‹
['£¨ch']." ".
$c⁄fig
['PROJECT_NAME'];

31 
$lök
 = "hâp://".
$_SERVER
['HTTP_HOST'].
	`dú«me
($_SERVER['SCRIPT_NAME']);

32 
	`hódî
("Content-Type:ápplication/xml");

33 
echo
 <<<
END_OPENSEARCH


34 <?
xml
 
vîsi⁄
="1.0" 
ícodög
="UTF-8"?>

35 <
O≥nSórchDes¸ùti⁄
 
xm s
="http://a9.com/-/spec/opensearch/1.1/">

36 <
Sh‹tName
>
$sh‹äame
</ShortName>

37 <
Des¸ùti⁄
>
Doxygí
 
Sórch
</Description>

38 <
I≈utEncodög
>
UTF
-8</InputEncoding>

40 <
Image
 
height
="16" 
width
="16" 
ty≥
="image/x-icon">

41 
hâp
:

43 <
Uæ
 
ty≥
="ãxt/html" 
mëhod
="GET"

44 
ãm∂©e
="$link/search.php?query={searchTerms}" />

45 <
Uæ
 
ty≥
="≠∂iˇti⁄/x-sugge°i⁄s+js⁄" 
mëhod
="GET"

46 
ãm∂©e
="$link/search-opensearch.php?v=json&amp;query={searchTerms}" />

47 <
Uæ
 
ty≥
="≠∂iˇti⁄/x-sugge°i⁄s+xml" 
mëhod
="GET"

48 
ãm∂©e
="$link/search-opensearch.php?v=xml&amp;query={searchTerms}" />

49 </
O≥nSórchDes¸ùti⁄
>

50 
END_OPENSEARCH
;

51 
	}
}

53 
fun˘i⁄
 
	$›í£¨ch_xml_ªsu…s
(
$quîy
, 
¨øy
 
$ªsu…s
)

58 
$qs_ªsu…s
 = 
	`¨øy
();

59 
	`f‹óch
 (
$ªsu…s
 
as
 
$i
 => 
$vÆ
)

61 
	`f‹óch
 (
$vÆ
['w‹ds'] 
as
 
$j
 => 
$w‹d
)

63 i‡(
	`¨øy_key_exi°s
(
$w‹d
, 
$qs_ªsu…s
))

64 
$qs_ªsu…s
[
$w‹d
['match']]++;

66 
$qs_ªsu…s
[
$w‹d
['match']] = 1;

69 
$ªsu…
 = <<<
END_FRAG


70 <?
xml
 
vîsi⁄
="1.0"?>

71 <
SórchSugge°i⁄
 
xm s
="http://schemas.microsoft.com/Search/2008/suggestions">

72 <
Quîy
>
$quîy
</Query>

73 <
Se˘i⁄
>

74 
END_FRAG
;

75 
	`f‹óch
 (
$qs_ªsu…s
 
as
 
$w‹d
 => 
$cou¡
)

77 
$ªsu…
 .<<<
END_FRAG


78 <
Iãm
>

79 <
Text
>
$w‹d
</Text>

80 <
Des¸ùti⁄
>
$cou¡
 
ªsu…s
</Description>

81 </
Iãm
>

82 
END_FRAG
;

84 
$ªsu…
 .<<<
END_FRAG


85 </
Se˘i⁄
>

86 </
SórchSugge°i⁄
>

87 
END_FRAG
;

88 
echo
 
$ªsu…
;

89 
	}
}

91 
fun˘i⁄
 
	$›í£¨ch_js⁄_ªsu…s
(
$quîy
, 
¨øy
 
$ªsu…s
)

93 
$qs_ªsu…s
 = 
	`¨øy
();

94 
	`f‹óch
 (
$ªsu…s
 
as
 
$i
 => 
$vÆ
)

96 
	`f‹óch
 (
$vÆ
['w‹ds'] 
as
 
$j
 => 
$w‹d
)

98 i‡(
	`¨øy_key_exi°s
(
$w‹d
, 
$qs_ªsu…s
))

99 
$qs_ªsu…s
[
$w‹d
['match']]++;

101 
$qs_ªsu…s
[
$w‹d
['match']] = 1;

104 
$ªsu…
 = '["'.
$quîy
.'", [';

105 
$js⁄_w‹ds
 = "";

106 
$js⁄_des¸ùti⁄s
 = "";

107 
$i
 = 0;

108 
	`f‹óch
 (
$qs_ªsu…s
 
as
 
$w‹d
 => 
$cou¡
)

110 i‡(
$i
 != 0)

112 
$js⁄_w‹ds
 .= ", ";

113 
$js⁄_des¸ùti⁄s
 .= ", ";

115 
$js⁄_w‹ds
 .'"'.
$w‹d
.'"';

116 
$js⁄_des¸ùti⁄s
 .'"'.
$cou¡
.'Ñesult'.($count==1?'':'s').'"';

117 
$i
++;

119 
¥öt
 "[\"$query\", [$json_words],[$json_descriptions]]";

120 
	}
}

122 
fun˘i⁄
 
	$övÆid_f‹m©
(
$quîy
, 
¨øy
 
$ªsu…s
)

124 
¥öt
 "SearchÑesults for '$query':\n\n";

125 
	`¥öt_r
(
$ªsu…s
);

126 
	}
}

127 </
	gs¸ùt
>

	@docs/doxygen/html/search.php

1 <!
DOCTYPE
 
html
 
	gPUBLIC
 "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

2 <
html
 
	gxm s
="http://www.w3.org/1999/xhtml">

3 <
hód
>

4 <
mëa
 
hâp
-
equiv
="C⁄ã¡-Ty≥" 
c⁄ã¡
="text/xhtml;charset=UTF-8"/>

5 <
mëa
 
hâp
-
equiv
="X-UA-Com∑tibÀ" 
c⁄ã¡
="IE=9"/>

6 <
tôÀ
>
gcm
: 
Sórch
</title>

8 <
lök
 
hªf
="èbs.css" 
ªl
="°yÀshìt" 
ty≥
="text/css"/>

9 <
lök
 
hªf
="doxygí.css" 
ªl
="°yÀshìt" 
ty≥
="text/css" />

11 <
lök
 
hªf
="£¨ch/£¨ch.css" 
ªl
="°yÀshìt" 
ty≥
="text/css"/>

12 <
s¸ùt
 
ty≥
="ãxt/javas¸ùt" 
§c
="jquery.js"></script>

13 <
s¸ùt
 
ty≥
="ãxt/javas¸ùt" 
§c
="search/search.js"></script>

14 <
s¸ùt
 
ty≥
="text/javascript">

15 
$
(
documít
).
ªady
(
	$fun˘i⁄
() {

16 i‡(
	`$
('.£¨chªsu…s').
Àngth
 > 0Ë{ 
£¨chBox
.
	`DOMSórchFõld
().
	`focus
(); }

17 
	}
});

18 </
	gs¸ùt
>

19 <
lök
 
	gªl
="£¨ch" 
hªf
="£¨ch-›í£¨ch.php?v=›í£¨ch.xml" 
ty≥
="≠∂iˇti⁄/›í£¨chdes¸ùti⁄+xml" 
tôÀ
="gcm"/>

21 </
hód
>

22 <
body
>

23 <
div
 
id
="t›"><!-- dÿ
nŸ
 
ªmove
 
this
 div! -->

26 <
div
 
id
="titlearea">

27 <
èbÀ
 
˚Œ•acög
="0" 
˚Œ∑ddög
="0">

28 <
tbody
>

29 <
å
 
°yÀ
="height: 56px;">

32 <
td
 
°yÀ
="padding-left: 0.5em;">

33 <
div
 
id
="¥oje˘«me">
gcm


34 &#160;<
•™
 
	gid
="projectnumber">3</span>

35 </
div
>

37 </
td
>

41 </
å
>

42 </
tbody
>

43 </
èbÀ
>

44 </
div
>

46 <!-- 
Gíîado
 
p‹
 
Doxygí
 1.8.0 -->

47 <
s¸ùt
 
ty≥
="text/javascript">

48 
v¨
 
£¨chBox
 = 
√w
 
SórchBox
("£¨chBox", "£¨ch",
Ál£
,'Buscar');

49 </
	gs¸ùt
>

50 <
div
 
	gid
="«vrow1" 
˛ass
="tabs">

51 <
ul
 
˛ass
="tablist">

52 <
li
><
a
 
hªf
="ödex.html"><
•™
>
P
√°
göa
&#160;
	g¥öcùÆ
</
	g•™
></
	ga
></
	gli
>

53 <
	gli
><
a
 
	ghªf
="∑ges.html"><
•™
>
P
√°
göas
&#160;
	gªœci⁄adas
</
	g•™
></
	ga
></li>

54 <
	gli
><
a
 
	ghªf
="moduÀs.html"><
•™
>
M
√≥
dulos
</•™></a></
li
>

55 <
li
><
a
 
hªf
="«me•a˚s.html"><
•™
>
Name•a˚s
</span></a></li>

56 <
li
><
a
 
hªf
="™nŸ©ed.html"><
•™
>
E°ru˘uøs
&#160;
	gde
&#160;
	gD©os
</
	g•™
></
	ga
></
	gli
>

57 <
	gli
><
a
 
	ghªf
="fûes.html"><
•™
>
Archivos
</•™></a></
li
>

58 <
li
><
a
 
hªf
="dús.html"><
•™
>
Dúe˘‹ios
</span></a></li>

59 <
li
>

60 <
div
 
id
="MSórchBox" 
˛ass
="MSearchBoxInactive">

61 <
div
 
˛ass
="left">

62 <
f‹m
 
id
="FSórchBox" 
a˘i⁄
="£¨ch.php" 
mëhod
="get">

63 <
img
 
id
="MSórchSñe˘" 
§c
="£¨ch/mag.≤g" 
Æt
=""/>

64 <
s¸ùt
 
œnguage
="php">

65 
ªquúe_⁄˚
 "search-functions.php";

66 
maö
();

67 </
	gs¸ùt
>

70 <
hr
 
	g˛ass
="foŸî"/><
addªss
 
˛ass
="foŸî"><
smÆl
>

71 
Gíîado
 
ñ
 
Lu√s
, 29 
de
 
Abrû
 
	gde
 2013 09:33:58 
∑ø
 
gcm
 
p‹
 &#160;<
a
 
	ghªf
="http://www.doxygen.org/index.html">

72 <
img
 
˛ass
="foŸî" 
§c
="doxygí.≤g" 
Æt
="doxygen"/>

73 </
a
> 1.8.0

74 </
smÆl
></
addªss
>

76 </
body
>

77 </
html
>

	@gcm/DATOS/config/administradores/administradores.php

1 <?
php


2 
	g$admöi°ød‹es
[] = "mamedu|@|kkkk";

	@gcm/DATOS/config/administradores/administradores_es.php

1 
	g$admöi°ød‹es_DESC
 = '<usuario>|@|<contrase√±a> del superusuario (root)';

	@gcm/DATOS/idiomas/GCM_LG_ca.php

1 <?
php


3 
	g$GCM_LG_ˇ
['Administracion deÜos diferentes idiomas']='';

4 
	g$GCM_LG_ˇ
['Administraci√≥n']='';

5 
	g$GCM_LG_ˇ
['Administraci√≥n de usuarios']='';

6 
	g$GCM_LG_ˇ
['Administrar im√°genes']='';

7 
	g$GCM_LG_ˇ
['AdministrarÖroyecto']='';

8 
	g$GCM_LG_ˇ
['A√±adir']='';

9 
	g$GCM_LG_ˇ
['Borrar cache']='';

10 
	g$GCM_LG_ˇ
['Borrar documentoáctual']='';

11 
	g$GCM_LG_ˇ
['Borrar secci√≥n']='';

12 
	g$GCM_LG_ˇ
['CambiarÇombre de documentoáctual']='';

13 
	g$GCM_LG_ˇ
['CambiarÇombre de secci√≥náctual']='';

14 
	g$GCM_LG_ˇ
['Cerrar sessi√≥n']='';

15 
	g$GCM_LG_ˇ
['Configuraci√≥n']='';

16 
	g$GCM_LG_ˇ
['Configuraci√≥n de ']='';

17 
	g$GCM_LG_ˇ
['Configuraci√≥n deádmin']='';

18 
	g$GCM_LG_ˇ
['Configuraci√≥n de contenidos']='';

19 
	g$GCM_LG_ˇ
['Configuraci√≥n de idiomas']='';

20 
	g$GCM_LG_ˇ
['Configuraci√≥n de imagenes']='';

21 
	g$GCM_LG_ˇ
['Configuraci√≥n de indexador']='';

22 
	g$GCM_LG_ˇ
['Configuraci√≥n de menu']='';

23 
	g$GCM_LG_ˇ
['Configuraci√≥n de metatags']='';

24 
	g$GCM_LG_ˇ
['Configuraci√≥n deÅemas']='';

25 
	g$GCM_LG_ˇ
['Configuraci√≥n guardada']='';

26 
	g$GCM_LG_ˇ
['ConfigurarÖroyecto']='';

27 
	g$GCM_LG_ˇ
['Contenido']='';

28 
	g$GCM_LG_ˇ
['ContenidoÖendiente deÅraducci√≥n']='';

29 
	g$GCM_LG_ˇ
['ContenidoÅraducido']='';

30 
	g$GCM_LG_ˇ
['Contenidos']='';

31 
	g$GCM_LG_ˇ
['Contrase√±a']='';

32 
	g$GCM_LG_ˇ
['CrearÇuevo contenido']='';

33 
	g$GCM_LG_ˇ
['Crear unaÇueva secci√≥n']='';

34 
	g$GCM_LG_ˇ
['Editar']='';

35 
	g$GCM_LG_ˇ
['Editar constantes']='';

36 
	g$GCM_LG_ˇ
['Editar documentoáctual']='';

37 
	g$GCM_LG_ˇ
['Editar ficheros delÖroyecto']='';

38 
	g$GCM_LG_ˇ
['Editar informaci√≥n de usuario']='';

39 
	g$GCM_LG_ˇ
['EditarÜiterales']='';

40 
	g$GCM_LG_ˇ
['EjecutarÅests']='';

41 
	g$GCM_LG_ˇ
['EnviarÉrror']='';

42 
	g$GCM_LG_ˇ
['Filtrar']='';

43 
	g$GCM_LG_ˇ
['Filtro']='';

44 
	g$GCM_LG_ˇ
['Gracias']='';

45 
	g$GCM_LG_ˇ
['Guardar contenido con otroÇombre']='';

46 
	g$GCM_LG_ˇ
['Im√°genes']='';

47 
	g$GCM_LG_ˇ
['Informaci√≥n de servidor']='';

48 
	g$GCM_LG_ˇ
['Informar deÉrror']='';

49 
	g$GCM_LG_ˇ
['Informe deÉrrores']='';

50 
	g$GCM_LG_ˇ
['Listado de comentarios']='';

51 
	g$GCM_LG_ˇ
['Listar contenido']='';

52 
	g$GCM_LG_ˇ
['Literales']='';

53 
	g$GCM_LG_ˇ
['Men√∫']='';

54 
	g$GCM_LG_ˇ
['Mover o cambiarÇombre de contenido']='';

55 
	g$GCM_LG_ˇ
['M√≥dulos']='';

56 
	g$GCM_LG_ˇ
['Nombre']='';

57 
	g$GCM_LG_ˇ
['Por favorá√±adeÅodaÜa informaci√≥n queÖuedasÑespectoáÜaácci√≥n que seÉstabaÑealizandoÉnÉl momento delÉrror']='';

58 
	g$GCM_LG_ˇ
['Registros']='';

59 
	g$GCM_LG_ˇ
['Registros deÖ√°ginaáctual']='';

60 
	g$GCM_LG_ˇ
['ReindexarÉl contenido']='';

61 
	g$GCM_LG_ˇ
['Renombrar o mover secci√≥náctual']='';

62 
	g$GCM_LG_ˇ
['Salir']='';

63 
	g$GCM_LG_ˇ
['Seguimiento']='';

64 
	g$GCM_LG_ˇ
['Seguimiento delÖroyecto']='';

65 
	g$GCM_LG_ˇ
['Sin secci√≥n']='';

66 
	g$GCM_LG_ˇ
['Subir imagená ']='';

67 
	g$GCM_LG_ˇ
['Traducir documentoáctual']='';

68 
	g$GCM_LG_ˇ
['Visualizaci√≥n deÜosÑegistros deÜaáplicaci√≥n']='';

69 
	g$GCM_LG_ˇ
['Visualizar conexionesÉntre Eventos y m√≥dulos']='';

70 
	g$GCM_LG_ˇ
['admin']='';

71 
	g$GCM_LG_ˇ
['contenidos']='';

72 
	g$GCM_LG_ˇ
['de']='';

73 
	g$GCM_LG_ˇ
['idioma']='catala';

74 
	g$GCM_LG_ˇ
['idiomas']='';

75 
	g$GCM_LG_ˇ
['imagenes']='';

76 
	g$GCM_LG_ˇ
['indexador']='';

77 
	g$GCM_LG_ˇ
['menu']='';

78 
	g$GCM_LG_ˇ
['metatags']='';

79 
	g$GCM_LG_ˇ
['temas']='';

80 
	g$GCM_LG_ˇ
['√öltimasÉntradasÉn']='';

81 
	g$GCM_LG_ˇ
['Campo obligatorio']='';

82 
	g$GCM_LG_ˇ
['Longitud m√°xima']='';

83 
	g$GCM_LG_ˇ
['RegistrosÉn base de datos']='';

84 
	g$GCM_LG_ˇ
['Galer√≠a de im√°genes']='';

85 
	g$GCM_LG_ˇ
['Insertar']='';

86 
	g$GCM_LG_ˇ
['comentarios']='';

87 
	g$GCM_LG_ˇ
['ver_registros']='';

88 
	g$GCM_LG_ˇ
['Administraci√≥n deÑoles']='';

89 
	g$GCM_LG_ˇ
['Configuraci√≥n de comentarios']='';

90 
	g$GCM_LG_ˇ
['Configuraci√≥n de ver_registros']='';

	@gcm/DATOS/idiomas/GCM_LG_en.php

1 <?
php


3 
	g$GCM_LG_í
['ContenidoÖendiente deÅraducci√≥n']='';

4 
	g$GCM_LG_í
['Registros deÖ√°ginaáctual']='';

5 
	g$GCM_LG_í
['Registros']='';

6 
	g$GCM_LG_í
['Sin Contenido']='';

	@gcm/DATOS/idiomas/GCM_LG_es.php

1 <?
php


3 
	g$GCM_LG_es
['Men√∫']='';

4 
	g$GCM_LG_es
['Usuario']='';

5 
	g$GCM_LG_es
['Contrase√±a']='';

6 
	g$GCM_LG_es
['√öltimasÉntradasÉn']='';

7 
	g$GCM_LG_es
['Sin Contenido']='';

8 
	g$GCM_LG_es
['noÉncontrado']='';

9 
	g$GCM_LG_es
['Sin secci√≥n']='';

10 
	g$GCM_LG_es
['Secci√≥n']='';

11 
	g$GCM_LG_es
['noÉncontrada']='';

12 
	g$GCM_LG_es
['Registros deÖ√°ginaáctual']='';

13 
	g$GCM_LG_es
['Registros']='';

14 
	g$GCM_LG_es
['Longitud m√°xima']='';

15 
	g$GCM_LG_es
['El correoÇoÖarece valido']='';

16 
	g$GCM_LG_es
['Traducir documentoáctual']='';

17 
	g$GCM_LG_es
['M√≥dulos']='';

18 
	g$GCM_LG_es
['admin']='';

19 
	g$GCM_LG_es
['Configuraci√≥n de ']='';

20 
	g$GCM_LG_es
['comentarios']='';

21 
	g$GCM_LG_es
['contenidos']='';

22 
	g$GCM_LG_es
['idiomas']='';

23 
	g$GCM_LG_es
['imagenes']='';

24 
	g$GCM_LG_es
['indexador']='';

25 
	g$GCM_LG_es
['menu']='';

26 
	g$GCM_LG_es
['metatags']='';

27 
	g$GCM_LG_es
['temas']='';

28 
	g$GCM_LG_es
['ver_registros']='';

29 
	g$GCM_LG_es
['ConfigurarÖroyecto']='';

30 
	g$GCM_LG_es
['Configuraci√≥n']='';

31 
	g$GCM_LG_es
['Editar constantes']='';

32 
	g$GCM_LG_es
['EditarÜiterales']='';

33 
	g$GCM_LG_es
['Seguimiento delÖroyecto']='';

34 
	g$GCM_LG_es
['Seguimiento']='';

35 
	g$GCM_LG_es
['ReindexarÉl contenido']='';

36 
	g$GCM_LG_es
['Visualizaci√≥n deÜosÑegistros deÜaáplicaci√≥n']='';

37 
	g$GCM_LG_es
['AdministrarÖroyecto']='';

38 
	g$GCM_LG_es
['Administraci√≥n']='';

39 
	g$GCM_LG_es
['Listado de comentarios']='';

40 
	g$GCM_LG_es
['Editar informaci√≥n de usuario']='';

41 
	g$GCM_LG_es
['Administraci√≥n de usuarios']='';

42 
	g$GCM_LG_es
['Informaci√≥n de servidor']='';

43 
	g$GCM_LG_es
['EjecutarÅests']='';

44 
	g$GCM_LG_es
['Visualizar conexionesÉntre Eventos y m√≥dulos']='';

45 
	g$GCM_LG_es
['Borrar cache']='';

46 
	g$GCM_LG_es
['Configuraci√≥n de imagenes']='';

47 
	g$GCM_LG_es
['Configuraci√≥n de indexador']='';

48 
	g$GCM_LG_es
['Configuraci√≥n de menu']='';

49 
	g$GCM_LG_es
['Configuraci√≥n de metatags']='';

50 
	g$GCM_LG_es
['Configuraci√≥n deÅemas']='';

51 
	g$GCM_LG_es
['Configuraci√≥n de ver_registros']='';

52 
	g$GCM_LG_es
['Im√°genes']='';

53 
	g$GCM_LG_es
['A√±adir']='';

54 
	g$GCM_LG_es
['Filtrar']='';

55 
	g$GCM_LG_es
['Literales']='';

56 
	g$GCM_LG_es
['Informar deÉrror']='';

57 
	g$GCM_LG_es
['Por favorá√±adeÅodaÜa informaci√≥n queÖuedasÑespectoáÜaácci√≥n que seÉstabaÑealizandoÉnÉl momento delÉrror']='';

58 
	g$GCM_LG_es
['Gracias']='';

59 
	g$GCM_LG_es
['EnviarÉrror']='';

60 
	g$GCM_LG_es
['Informe deÉrrores']='';

61 
	g$GCM_LG_es
['Administraci√≥n deÅemas']='';

62 
	g$GCM_LG_es
['Temasáctual']='';

63 
	g$GCM_LG_es
['SeleccionaÅema']='';

64 
	g$GCM_LG_es
['Creaci√≥n de unÅemaÇuevo']='';

65 
	g$GCM_LG_es
['NuevoÅema']='';

66 
	g$GCM_LG_es
['Editar ficheros deÅema']='';

67 
	g$GCM_LG_es
['FicherosÖor defecto']='';

68 
	g$GCM_LG_es
['Ficheros deÅema']='';

69 
	g$GCM_LG_es
['Subir ficheroÖroyecto.css modificado']='';

70 
	g$GCM_LG_es
['Guardar colores']='';

71 
	g$GCM_LG_es
['A√±adir un color']='';

72 
	g$GCM_LG_es
['Configuraci√≥n deÅemas_old']='';

73 
	g$GCM_LG_es
['Acciones']='';

74 
	g$GCM_LG_es
['Guardar']='';

75 
	g$GCM_LG_es
['Constantes']='';

76 
	g$GCM_LG_es
['A√±adirÉmail ocultoáÜos spammers']='';

77 
	g$GCM_LG_es
['Nombreá mostrar']='';

78 
	g$GCM_LG_es
['Email']='';

79 
	g$GCM_LG_es
['Insertar']='';

80 
	g$GCM_LG_es
['Contenidoáctualizado']='';

81 
	g$GCM_LG_es
['Guardar contenido']='';

82 
	g$GCM_LG_es
['Nombre de secci√≥n']='';

83 
	g$GCM_LG_es
['Ejecutar']='';

84 
	g$GCM_LG_es
['Renombrar o mover contenido']='';

85 
	g$GCM_LG_es
['T√≠tulo']='';

86 
	g$GCM_LG_es
['T√≠tulo del contenido']='';

87 
	g$GCM_LG_es
['ContenidoÑenombrado o movido']='';

88 
	g$GCM_LG_es
['Administrar im√°genes']='';

89 
	g$GCM_LG_es
['Editar ficheros delÖroyecto']='';

90 
	g$GCM_LG_es
['Administracion deÜos diferentes idiomas']='';

91 
	g$GCM_LG_es
['Contenidos']='';

92 
	g$GCM_LG_es
['CrearÇuevo contenido']='';

93 
	g$GCM_LG_es
['Editar documentoáctual']='';

94 
	g$GCM_LG_es
['Borrar documentoáctual']='';

95 
	g$GCM_LG_es
['Mover o cambiarÇombre de contenido']='';

96 
	g$GCM_LG_es
['Guardar contenido con otroÇombre']='';

97 
	g$GCM_LG_es
['Crear unaÇueva secci√≥n']='';

98 
	g$GCM_LG_es
['Renombrar o mover secci√≥náctual']='';

99 
	g$GCM_LG_es
['Borrar secci√≥n']='';

100 
	g$GCM_LG_es
['Listar contenido']='';

101 
	g$GCM_LG_es
['Cerrar sessi√≥n']='';

102 
	g$GCM_LG_es
['Salir']='';

103 
	g$GCM_LG_es
['Configuraci√≥n deádmin']='';

104 
	g$GCM_LG_es
['Configuraci√≥n de comentarios']='';

105 
	g$GCM_LG_es
['Configuraci√≥n de contenidos']='';

106 
	g$GCM_LG_es
['Configuraci√≥n de idiomas']='';

107 
	g$GCM_LG_es
['Listado completo de contenido']='';

108 
	g$GCM_LG_es
['Acciones sobre contenidos']='';

109 
	g$GCM_LG_es
['Borrar']='';

110 
	g$GCM_LG_es
['CambiarÇombre']='';

111 
	g$GCM_LG_es
['Filtro']='';

112 
	g$GCM_LG_es
['Campo obligatorio']='';

113 
	g$GCM_LG_es
['Editar']='';

114 
	g$GCM_LG_es
['Cancelar']='';

115 
	g$GCM_LG_es
['Registro incluido']='';

116 
	g$GCM_LG_es
['Registro modificado']='';

117 
	g$GCM_LG_es
['Contrase√±aÇoÖasa verificaci√≥n']='';

118 
	g$GCM_LG_es
['ContenidoÇuevo']='';

119 
	g$GCM_LG_es
['Contenidoá√±adido']='';

120 
	g$GCM_LG_es
['Administraci√≥n deÑoles']='';

121 
	g$GCM_LG_es
['eduardotrabajos']='';

	@gcm/DATOS/idiomas/GCM_LG_fr.php

1 <?
php


3 
	g$GCM_LG_‰
['Registros deÖ√°ginaáctual']='';

4 
	g$GCM_LG_‰
['Registros']='';

5 
	g$GCM_LG_‰
['Usuario']='';

6 
	g$GCM_LG_‰
['Contrase√±a']='';

7 
	g$GCM_LG_‰
['Traducir documentoáctual']='';

8 
	g$GCM_LG_‰
['M√≥dulos']='';

9 
	g$GCM_LG_‰
['admin']='';

10 
	g$GCM_LG_‰
['Configuraci√≥n de ']='';

11 
	g$GCM_LG_‰
['contenidos']='';

12 
	g$GCM_LG_‰
['idiomas']='';

13 
	g$GCM_LG_‰
['imagenes']='';

14 
	g$GCM_LG_‰
['indexador']='';

15 
	g$GCM_LG_‰
['menu']='';

16 
	g$GCM_LG_‰
['metatags']='';

17 
	g$GCM_LG_‰
['temas']='';

18 
	g$GCM_LG_‰
['Contenidos']='';

19 
	g$GCM_LG_‰
['CrearÇuevo contenido']='';

20 
	g$GCM_LG_‰
['Editar documentoáctual']='';

21 
	g$GCM_LG_‰
['Borrar documentoáctual']='';

22 
	g$GCM_LG_‰
['Mover o cambiarÇombre de contenido']='';

23 
	g$GCM_LG_‰
['Guardar contenido con otroÇombre']='';

24 
	g$GCM_LG_‰
['Crear unaÇueva secci√≥n']='';

25 
	g$GCM_LG_‰
['Renombrar o mover secci√≥náctual']='';

26 
	g$GCM_LG_‰
['Borrar secci√≥n']='';

27 
	g$GCM_LG_‰
['Listar contenido']='';

28 
	g$GCM_LG_‰
['AdministrarÖroyecto']='';

29 
	g$GCM_LG_‰
['Administraci√≥n']='';

30 
	g$GCM_LG_‰
['Editar ficheros delÖroyecto']='';

31 
	g$GCM_LG_‰
['Listado de comentarios']='';

32 
	g$GCM_LG_‰
['Administrar im√°genes']='';

33 
	g$GCM_LG_‰
['Administracion deÜos diferentes idiomas']='';

34 
	g$GCM_LG_‰
['Editar informaci√≥n de usuario']='';

35 
	g$GCM_LG_‰
['Administraci√≥n de usuarios']='';

36 
	g$GCM_LG_‰
['Informaci√≥n de servidor']='';

37 
	g$GCM_LG_‰
['EjecutarÅests']='';

38 
	g$GCM_LG_‰
['Visualizar conexionesÉntre Eventos y m√≥dulos']='';

39 
	g$GCM_LG_‰
['Borrar cache']='';

40 
	g$GCM_LG_‰
['ConfigurarÖroyecto']='';

41 
	g$GCM_LG_‰
['Configuraci√≥n']='';

42 
	g$GCM_LG_‰
['Editar constantes']='';

43 
	g$GCM_LG_‰
['EditarÜiterales']='';

44 
	g$GCM_LG_‰
['Seguimiento delÖroyecto']='';

45 
	g$GCM_LG_‰
['Seguimiento']='';

46 
	g$GCM_LG_‰
['Visualizaci√≥n deÜosÑegistros deÜaáplicaci√≥n']='';

47 
	g$GCM_LG_‰
['ReindexarÉl contenido']='';

48 
	g$GCM_LG_‰
['Cerrar sessi√≥n']='';

49 
	g$GCM_LG_‰
['Salir']='';

50 
	g$GCM_LG_‰
['Cat√°logo']='';

51 
	g$GCM_LG_‰
['AdministrarÖroductos']='';

52 
	g$GCM_LG_‰
['Administrar categorias']='';

53 
	g$GCM_LG_‰
['AdministrarÖroveedores']='';

54 
	g$GCM_LG_‰
['AdministrarÅel√©fonos']='';

55 
	g$GCM_LG_‰
['Administrar mails']='';

56 
	g$GCM_LG_‰
['Configuraci√≥n deádmin']='';

57 
	g$GCM_LG_‰
['Configuraci√≥n de contenidos']='';

58 
	g$GCM_LG_‰
['Configuraci√≥n de idiomas']='';

59 
	g$GCM_LG_‰
['Configuraci√≥n de imagenes']='';

60 
	g$GCM_LG_‰
['Configuraci√≥n de indexador']='';

61 
	g$GCM_LG_‰
['Configuraci√≥n de menu']='';

62 
	g$GCM_LG_‰
['Configuraci√≥n de metatags']='';

63 
	g$GCM_LG_‰
['Configuraci√≥n deÅemas']='';

64 
	g$GCM_LG_‰
['Subir imagená ']='';

65 
	g$GCM_LG_‰
['Im√°genes']='';

66 
	g$GCM_LG_‰
['Literales']='';

67 
	g$GCM_LG_‰
['Informar deÉrror']='';

68 
	g$GCM_LG_‰
['Por favorá√±adeÅodaÜa informaci√≥n queÖuedasÑespectoáÜaácci√≥n que seÉstabaÑealizandoÉnÉl momento delÉrror']='';

69 
	g$GCM_LG_‰
['Gracias']='';

70 
	g$GCM_LG_‰
['EnviarÉrror']='';

71 
	g$GCM_LG_‰
['Informe deÉrrores']='';

72 
	g$GCM_LG_‰
['A√±adir']='';

73 
	g$GCM_LG_‰
['Filtrar']='';

74 
	g$GCM_LG_‰
['Campo obligatorio']='';

75 
	g$GCM_LG_‰
['Longitud m√°xima']='';

76 
	g$GCM_LG_‰
['Insertar']='';

77 
	g$GCM_LG_‰
['Sin Contenido']='';

78 
	g$GCM_LG_‰
['Sin secci√≥n']='';

79 
	g$GCM_LG_‰
['Men√∫']='';

80 
	g$GCM_LG_‰
['de']='';

81 
	g$GCM_LG_‰
['Configuraci√≥n guardada']='';

82 
	g$GCM_LG_‰
['ContenidoÖendiente deÅraducci√≥n']='';

83 
	g$GCM_LG_‰
['Administraci√≥n deÅemas']='';

84 
	g$GCM_LG_‰
['Temasáctual']='';

85 
	g$GCM_LG_‰
['SeleccionaÅema']='';

86 
	g$GCM_LG_‰
['Creaci√≥n de unÅemaÇuevo']='';

87 
	g$GCM_LG_‰
['NuevoÅema']='';

88 
	g$GCM_LG_‰
['Editar ficheros deÅema']='';

89 
	g$GCM_LG_‰
['FicherosÖor defecto']='';

90 
	g$GCM_LG_‰
['Ficheros deÅema']='';

91 
	g$GCM_LG_‰
['Subir ficheroÖroyecto.css modificado']='';

92 
	g$GCM_LG_‰
['Guardar colores']='';

93 
	g$GCM_LG_‰
['A√±adir un color']='';

94 
	g$GCM_LG_‰
['Procesar ficheroÖroyecto.css modificado']='';

95 
	g$GCM_LG_‰
['Idiomas Activados']='';

96 
	g$GCM_LG_‰
['Nuevo idioma']='';

97 
	g$GCM_LG_‰
['Acciones']='';

98 
	g$GCM_LG_‰
['Guardar']='';

99 
	g$GCM_LG_‰
['Constantes']='';

100 
	g$GCM_LG_‰
['A√±adirÉmail ocultoáÜos spammers']='';

101 
	g$GCM_LG_‰
['Nombreá mostrar']='';

102 
	g$GCM_LG_‰
['Email']='';

103 
	g$GCM_LG_‰
['Contenidoáctualizado']='';

104 
	g$GCM_LG_‰
['Guardar contenido']='';

105 
	g$GCM_LG_‰
['El correoÇoÖarece valido']='';

106 
	g$GCM_LG_‰
['RegistrosÉn base de datos']='';

107 
	g$GCM_LG_‰
['Filtro']='';

	@gcm/DATOS/idiomas/estadisticas_es.php

1 <?
php


2 
	g$e°adi°iˇs_DESC
['EXCLUIR_REFERENCIA']='Host oÖaginas web que queremosÉvitar que salganÑeflejadasÉnÜasÑeferencias';

3 
	g$e°adi°iˇs_DESC
['EXCLUIR_CONTADOR']='Hosts oÖ√°ginas web que queremosÉxcluir del contador';

	@gcm/includes/blank.php

1 <?
php


14 
	g$MODULO
 = (!
em±y
(
$_POST
['modul'])Ë? $_POST['modul'] : 
$_GET
['modul'];

17 <!
DOCTYPE
 
html
 
	gpublic
 "-//w3c//dtd xhtml 1.0Åransitional//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-transitional.dtd">

18 <
html
 
	gxm s
="http://www.w3.org/1999/xhtml">

20 <!--
aut‹
: 
edu¨do
 
magø√
-->

21 <!--
emaû
: 
edu¨do
@
mamedu
.
com
-->

22 <!--
öicio
.
php
-->

24 <
hód
>

25 <
mëa
 
hâp
-
equiv
="C⁄ã¡-Ty≥" 
c⁄ã¡
="text/html; charset=UTF-8">

26 <
mëa
 
c⁄ã¡
="ãxt/html; ch¨£t=utf-8" 
hâp
-
equiv
="content-type" />

27 <
mëa
 
c⁄ã¡
="es-es" 
hâp
-
equiv
="content-language" />

28 <
mëa
 
c⁄ã¡
="Æl" 
«me
="robots" />

29 <
lök
 
ty≥
="image/x-ic⁄" 
hªf
="Ávic⁄.ico" 
ªl
="shortcut icon" />

30 <
lök
 
tôÀ
="GCM" />

31 <
mëa
 
c⁄ã¡
="Edu¨dÿmagøn√©." 
«me
="author" />

32 <
mëa
 
c⁄ã¡
="g∂" 
«me
="copyright" />

34 <
tôÀ
><?=
$MODULO
 ?></title>

35 <
°yÀ
 
ty≥
="ãxt/css" 
medü
="s¸ìn,Öroje˘i⁄">@
imp‹t
 "../admö/ö˛udes/¥oye˘os/gíîÆ.css";</
	g°yÀ
>

36 <
°yÀ
 
	gty≥
="ãxt/css" 
medü
="s¸ìn,Öroje˘i⁄">@
imp‹t
 "./¥oye˘o_css.php";</
	g°yÀ
>

37 <
s¸ùt
 
	g§c
='../gcm.js' 
ty≥
="ãxt/javas¸ùt" 
œnguage
="JavaScript"> </script>

38 </
hód
>

40 <
body
>

42 <
div
 
id
="principal">

43 <
div
 
id
="contenido">

44 <?
php


46 i‡(!
	$em±y
(
$MODULO
)) {

47 
	`ö˛ude
("../admö/modulos/".
$MODULO
."/index.php");

48 
	}
} {

49 
	gecho
 "No hay un modulo definido";

52 </
	gdiv
>

53 </
	gdiv
>

54 </
	gbody
>

55 </
	ghtml
>

	@gcm/includes/login.php

1 <?
php


18 
fun˘i⁄
 
	$f‹muœrio_ªgi°ro
() {

20 i‡(! 
	`logódos
() ) {

21 
$∑√l
 = 
	`¨øy
();

22 
$∑√l
['tôulo'] = 
	`lôîÆ
('Administrar');

23 
$∑√l
['ocu…o'] = 
TRUE
;

24 
$∑√l
['href'] = 'javascript:visualizar(\'login\');';

25 
$∑√l
['subpanel'] ='login';

26 
$∑√l
['contenido'] =

27 '<f‹mÇame="íåada"á˘i⁄="'.
	`gcm_gíî¨_uæ
().'" method="post">

28 <
br
 />'.literal("Nombre",3).':

29 <
br
 /><
öput
 
ty≥
="ãxt" 
size
="10" 
«me
="logöPro" 
id
="logöPro" 
vÆue
="" />

30 <
br
 />'.literal("Contrase√±a",3).':

31 <
br
 /><
öput
 
ty≥
="∑ssw‹d" 
size
="10" 
«me
="∑sswd" 
id
="∑sswd" 
vÆue
="" />

32 <
öput
 
ty≥
="hiddí" 
«me
="£À˘ed" 
vÆue
="'.$_SERVER['PHP_SELF'].'" />

33 <
br
 /><br />

34 <
öput
 
ty≥
="submô" 
vÆue
="Entrar" />

35 </
f‹m
>';

37 
Temas
::
	`∑√l
(
$∑√l
);

40 
	}
}

53 
fun˘i⁄
 
	$logódos
(
$míßje
=
FALSE
) {

55 
globÆ
 
$gcm
;

57 
$¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

59 i‡–
	`is£t
(
$_SESSION
["admö-".
$¥oye˘o
] ) ) {

61 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
['root']) ) {

64 i‡–
$míßje
 ) { 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Acceso soloÖaraádministradores','AVISO'); }

65  
NULL
 ;

67 
	}
}

80 
fun˘i⁄
 
	$su≥ødmö
() {

82 
globÆ
 
$gcm
 ;

84 
$¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

86 i‡–
	`is£t
(
$_SESSION
["admö-".
$¥oye˘o
] ) ) {

88 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
['root']) ) {

91  
NULL
 ;

93 
	}
}

	@gcm/inicio.php

1 <?
php


22 
ªquúe
(
GCM_DIR
.'lib/int/gcm/lib/Gcm.php');

24 
	g$GCM_LG
 = 
¨øy
();

25 
	g$LG
 = 
¨øy
();

27 
	g$gcm
 = 
√w
 
Gcm
();

31 
	g$gcm
->
öicü
();

	@gcm/js/formulario.js.php

1 <?
php


11 
hódî
('Content-Type:Åext/javascript');

20 
fun˘i⁄
 
	$ö£π¨_ãxto
(
¨ó_ãxto
,
ãxto
) {

22 
v¨
 
öput
 = 
¨ó_ãxto
;

23 if(
ty≥of
 
documít
.
£À˘i⁄
 != 'undefined' && document.selection) {

24 
v¨
 
°r
 = 
documít
.
£À˘i⁄
.
	`¸óãR™ge
().
ãxt
;

25 
öput
.
	`focus
();

26 
v¨
 
£l
 = 
documít
.
£À˘i⁄
.
	`¸óãR™ge
();

28 
£l
.
ãxt
 = 
ãxto
;

29 
£l
.
	`£À˘
();

31 }if(
ty≥of
 
öput
.
£À˘i⁄Sèπ
 != 'undefined'){

32 
v¨
 
°¨t
 = 
öput
.
£À˘i⁄Sèπ
;

33 
v¨
 
íd
 = 
öput
.
£À˘i⁄End
;

34 
v¨
 
ösText
 = 
öput
.
vÆue
.
	`sub°rög
(
°¨t
, 
íd
);

36 
öput
.
vÆue
 = i≈ut.vÆue.
	`sub°r
(0, 
°¨t
Ë+ 
ãxto
 + i≈ut.vÆue.sub°r(
íd
);

37 
öput
.
	`focus
();

38 
öput
.
	`£tSñe˘i⁄R™ge
(
°¨t
+2+
èg
.
Àngth
+
ösText
.length+3+tag.length,start+2+tag.length+insText.length+3+tag.length);

41 
öput
.
vÆue
+=' ['+
èg
+']ReemplaceÉsteÅexto[/'+tag+']';

44 
	}
}

	@gcm/lib/int/GcmConfig/lib/Config.php

1 <?
php


18 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmConfig/lib/GcmConfigFactory.php');

24 ˛as†
	cC⁄fig
 {

26 
¥iv©e
 
	m$¨chivo_c⁄figuøci⁄
;

27 
¥iv©e
 
	m$c⁄figuøci⁄
;

31 
fun˘i⁄
 
	$__c⁄°ru˘
(
$¨chivo_c⁄figuøci⁄
) {

33 
$this
->
¨chivo_c⁄figuøci⁄
 = 
$¨chivo_c⁄figuøci⁄
;

54 
fun˘i⁄
 
	$c⁄fig
(
$nombª_v¨übÀ
, 
$vÆ‹
=
FALSE
) {

57 i‡–!
$vÆ‹
 && 
	`is£t
(
$this
->
c⁄figuøci⁄
[
$nombª_v¨übÀ
]) )  $this->configuracion[$nombre_variable];

59 i‡–
$vÆ‹
 ) {

61 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$$this
->
¨chivo_c⁄figuøci⁄
);

63 
$¨r
->
	`£t
(
$nombª_v¨übÀ
,
$vÆ‹
);

64 
$¨r
->
	`gu¨d¨_v¨übÀs
();

65 
$this
->
c⁄figuøci⁄
[
$nombª_v¨übÀ
] = 
$vÆ‹
;

69 i‡–!
	`fûe_exi°s
(
$this
->
¨chivo_c⁄figuøci⁄
) ) {

70 
	`dõ
 ('Archivÿdêc⁄figuøci√≥¿nÿexi°e: ['.
$this
->
¨chivo_c⁄figuøci⁄
.']');

71  
FALSE
;

74 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$this
->
¨chivo_c⁄figuøci⁄
);

75 
$vÆ‹
 = 
$¨r
->
	`gë
(
$nombª_v¨übÀ
);

76 
$this
->
c⁄figuøci⁄
[
$nombª_v¨übÀ
] = 
$vÆ‹
;

77  
$vÆ‹
;

81 
	}
}

	@gcm/lib/int/GcmConfig/lib/GcmConfig.php

1 <?
php


71 ˛as†
	cGcmC⁄fig
 {

73 
¥Ÿe˘ed
 
	m$v¨übÀs
;

74 
¥Ÿe˘ed
 
	m$des¸ùci⁄es
;

75 
¥Ÿe˘ed
 
	m$des¸ùci⁄esxde„˘o
;

76 
¥Ÿe˘ed
 
	m$¨chivo
;

87 
¥Ÿe˘ed
 
	m$dúe˘‹io_des¸ùci⁄es
;

89 
¥Ÿe˘ed
 
	m$nombª_¨øy
;

91 
¥iv©e
 
	m$v¨übÀs_modifiˇdas
 = 
FALSE
;

92 
¥iv©e
 
	m$des¸ùci⁄es_modifiˇdas
 = 
FALSE
;

98 
¥iv©e
 
	m$des¸ùci⁄es_ªcogidas
 = 
FALSE
;

100 
public
 
	m$idioma
 = 'es';

101 
public
 
	m$idiomaxde„˘o
 = 'es';

103 
public
 
	m$‹dí¨
 = 
FALSE
;

105 
fun˘i⁄
 
	$__c⁄°ru˘
(
$¨chivo
) {

107 
$this
->
¨chivo
 = 
$¨chivo
;

108 
$this
->
nombª_¨øy
 = 
	`°r_ª∂a˚
('.php','',
	`ba£«me
($this->
¨chivo
));

110 i‡–!
	`fûe_exi°s
(
$this
->
¨chivo
) ) {

111 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Archivÿdêc⁄figuøci√≥¿[".
$this
->
¨chivo
."]ÇoÉxiste,Üo creamos",'ADMIN');

112 i‡–! 
	`fûe_exi°s
(
	`dú«me
(
$this
->
¨chivo
)ËË
	`mkdú_ªcursivo
(dirname($this->archivo));

114 
	`ö˛ude
 (
$this
->
¨chivo
);

119 i‡–! 
	`is£t
(
$
{
$this
->
nombª_¨øy
}) ) {

120 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Archivÿdêc⁄figuøci√≥¿[".
$this
->
¨chivo
."] sin contenido",'ADMIN');

122 
$this
->
v¨übÀs
 = 
$
{$this->
nombª_¨øy
};

127 
$this
->
dúe˘‹io_des¸ùci⁄es
 = 
	`dú«me
($this->
¨chivo
);

142 
fun˘i⁄
 
	$quô¨Utf8
(
$ãxt
) {

143 
$ãxt
 = 
	`°r_ª∂a˚
("\\","",$text);

144 
$ãxt
 = 
	`°rù¶ashes
($text);

145 
$ãxt
 = 
	`åim
($text);

146 
$ãxt
 = 
	`îeg_ª∂a˚
("√°|√†|√¢|√Ä|√Å|√Ç", "a", $text);

147 
$ãxt
 = 
	`îeg_ª∂a˚
("√©|√®|√™|√à|√â|√ä", "e", $text);

148 
$ãxt
 = 
	`îeg_ª∂a˚
("√≠|√¨|√Æ|√å|√ç|√é", "i", $text);

149 
$ãxt
 = 
	`îeg_ª∂a˚
("√≥|√≤|√¥|√í|√ì|√î", "o", $text);

150 
$ãxt
 = 
	`îeg_ª∂a˚
("√∫|√π|√ª|√º|√ô|√ö|√õ|√ú", "u", $text);

154 (
$ãxt
);

156 
	}
}

160 
fun˘i⁄
 
	$debug
() {

162 
$ßlida
 = "\nVariables: ";

163 
$ßlida
 .
	`¥öt_r
(
$this
->
v¨übÀs
,
TRUE
);

164 
$ßlida
 .= "\nDescripciones: ";

165 
$ßlida
 .
	`¥öt_r
(
$this
->
des¸ùci⁄es
,
TRUE
);

167  
$ßlida
;

169 
	}
}

177 
fun˘i⁄
 
	$dúe˘‹io_des¸ùci⁄es
(
$¨chivo
) {

179 
$this
->
dúe˘‹io_des¸ùci⁄es
 = 
$¨chivo
;

181 
	}
}

189 
fun˘i⁄
 
	$ªcogî_des¸ùci⁄es
(
$idioma
 = 
NULL
) {

191 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

193 i‡–
$this
->
des¸ùci⁄es_ªcogidas
[
$idioma
] =
TRUE
 ) {

197 
$this
->
des¸ùci⁄es_ªcogidas
[
$idioma
] = 
TRUE
;

199 
$¨chivo
 = 
$this
->
dúe˘‹io_des¸ùci⁄es
.'/'.$this->
nombª_¨øy
.'_'.
$idioma
.'.php';

201 i‡–
	`fûe_exi°s
(
$¨chivo
) ) {

202 
	`ö˛ude
 (
$¨chivo
);

209 
$this
->
des¸ùci⁄es
[
$idioma
] = 
$
{$this->
nombª_¨øy
.'_DESC'};

211 
	}
}

215 
fun˘i⁄
 
	$v¨übÀs
(Ë{  
$this
->
v¨übÀs
; 
	}
}

219 
fun˘i⁄
 
	$v¨übÀsJSON
() {

221 
$c
 = 0;

222 
	`f‹óch
 (
$this
->
v¨übÀs
 
as
 
$key
 => 
$vÆ‹
 ) {

224 
$ª•ue°a
->
v¨übÀs
[
$c
]['id'] = 
$key
;

225 
$ª•ue°a
->
v¨übÀs
[
$c
]['vÆ‹'] = 
$vÆ‹
;

226 
$c
++;

230 
echo
 
	`js⁄_ícode
(
$ª•ue°a
);

231 
	}
}

235 
fun˘i⁄
 
	$des¸ùci⁄es
(
$idioma
 = 
NULL
) {

237 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

239  
$this
->
des¸ùci⁄es
[
$idioma
];

241 
	}
}

245 
fun˘i⁄
 
	$vÆid¨Des¸ùci⁄
(
$des¸ùci⁄
) {

247 i‡–! 
$des¸ùci⁄
 )  
FALSE
 ;

248 i‡–
$des¸ùci⁄
 ='' )  
FALSE
;

254 
$m¨ˇ
 = 
$this
->
idiomaxde„˘o
.'::';

256 i‡–
	`°Ωos
(
$m¨ˇ
,
$des¸ùci⁄
ËË 
FALSE
;

258  
TRUE
;

260 
	}
}

269 
fun˘i⁄
 
	$£t
(
$v¨übÀ
, 
$vÆ‹
) {

271 i‡–!
	`is£t
(
$v¨übÀ
Ë|| 
	`em±y
($variable) ) {

272 
throw
 
√w
 
	`Ex˚±i⁄
('Sin variableÇoÖodemosá√±adirÉlementos');

273  
FALSE
;

276 
$this
->
v¨übÀs_modifiˇdas
 = 
TRUE
;

278 i‡–
	`is_¨øy
(
$vÆ‹
)) {

279 
$v¨übÀ
 = 
	`html_ítôy_decode
($v¨übÀ,
ENT_NOQUOTES
,'UTF-8');

280 
	`f‹óch
 ( 
$vÆ‹
 
as
 
$vÆ
 ) {

281 
$vÆ
 = 
	`html_ítôy_decode
($vÆ,
ENT_NOQUOTES
,'UTF-8');

282 
$this
->
v¨übÀs
[
$v¨übÀ
][] = 
$vÆ
;

285 
$v¨übÀ
 = 
	`html_ítôy_decode
($v¨übÀ,
ENT_NOQUOTES
,'UTF-8');

286 
$vÆ‹
 = 
	`html_ítôy_decode
($vÆ‹,
ENT_NOQUOTES
,'UTF-8');

287 
$this
->
v¨übÀs
[
$v¨übÀ
] = 
$vÆ‹
;

290 
	}
}

306 
fun˘i⁄
 
	$£tDes¸ùci⁄
(
$v¨übÀ
, 
$des¸ùci⁄
, 
$idioma
 = 
NULL
) {

308 
$des¸ùci⁄
 = 
	`html_ítôy_decode
($des¸ùci⁄,
ENT_NOQUOTES
,'UTF-8');

309 
$v¨übÀ
 = 
	`html_ítôy_decode
($v¨übÀ,
ENT_NOQUOTES
,'UTF-8');

311 i‡–! 
$this
->
	`vÆid¨Des¸ùci⁄
(
$des¸ùci⁄
ËË 
FALSE
 ;

313 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

315 
$this
->
	`ªcogî_des¸ùci⁄es
(
$idioma
);

317 
$this
->
des¸ùci⁄es_modifiˇdas
[
$idioma
] = 
TRUE
;

319 
$this
->
des¸ùci⁄es
[
$idioma
][
$v¨übÀ
] = 
$des¸ùci⁄
;

323 i‡–
$idioma
 !
$this
->
idiomaxde„˘o
 ) {

325 
$this
->
	`ªcogî_des¸ùci⁄es
($this->
idiomaxde„˘o
);

327 i‡–! 
$this
->
	`vÆid¨Des¸ùci⁄
($this->
des¸ùci⁄es
[$this->
idiomaxde„˘o
][
$v¨übÀ
]) ) {

329 
$this
->
des¸ùci⁄es_modifiˇdas
[$this->
idiomaxde„˘o
] = 
TRUE
;

331 
$this
->
	`£tDes¸ùci⁄
(
$v¨übÀ
,
$des¸ùci⁄
, $this->
idiomaxde„˘o
);

337 
	}
}

341 
fun˘i⁄
 
	$gë
(
$v¨übÀ
) {

343 if(
	`is£t
(
$this
->
v¨übÀs
[
$v¨übÀ
])) {

344  
$this
->
v¨übÀs
[
$v¨übÀ
];

346  
FALSE
;

349 
	}
}

362 
fun˘i⁄
 
	$gëDes¸ùci⁄
(
$v¨übÀ
, 
$idioma
 = 
NULL
) {

364 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

370 i‡–!
$this
->
des¸ùci⁄es_ªcogidas
[$this->
idiomaxde„˘o
] ) { $this->
	`ªcogî_des¸ùci⁄es
($this->idiomaxdefecto); }

374 i‡–!
$this
->
des¸ùci⁄es_ªcogidas
[
$idioma
] ) { $this->
	`ªcogî_des¸ùci⁄es
($idioma); }

376 if(
	`is£t
(
$this
->
des¸ùci⁄es
[
$idioma
][
$v¨übÀ
])) {

377  
$this
->
des¸ùci⁄es
[
$idioma
][
$v¨übÀ
];

386 if(
	`is£t
(
$this
->
des¸ùci⁄es
[$this->
idiomaxde„˘o
][
$v¨übÀ
])) {

387  
$this
->
idiomaxde„˘o
.'::'.$this->
des¸ùci⁄es
[$this->idiomaxde„˘o][
$v¨übÀ
];

390  
FALSE
;

392 
	}
}

400 
fun˘i⁄
 
	$dñ
(
$v¨übÀ
) {

402 
$this
->
v¨übÀs_modifiˇdas
 = 
TRUE
;

404 
	`un£t
(
$this
->
v¨übÀs
[
$v¨übÀ
]);

410 
$fidiomas
 = 
	`glob
(
	`dú«me
(
$this
->
¨chivo
).'/'.$this->
nombª_¨øy
.'_*.php');

414 
	`f‹óch
–
$fidiomas
 
as
 
$f
 ) {

415 
$idioma
 = 
	`°r_ª∂a˚
(
	`dú«me
(
$this
->
¨chivo
).'/'.$this->
nombª_¨øy
.'_','',
$f
);

416 
$idioma
 = 
	`°r_ª∂a˚
('.php','',$idioma);

417 
$this
->
	`dñDes¸ùci⁄
(
$v¨übÀ
, 
$idioma
);

420  
TRUE
;

422 
	}
}

430 
fun˘i⁄
 
	$dñDes¸ùci⁄
(
$v¨übÀ
, 
$idioma
 = 
NULL
) {

432 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

434 
$this
->
	`ªcogî_des¸ùci⁄es
(
$idioma
);

436 
$this
->
des¸ùci⁄es_modifiˇdas
[
$idioma
] = 
TRUE
;

438 
	`un£t
(
$this
->
des¸ùci⁄es
[
$idioma
][
$v¨übÀ
]);

439  
TRUE
;

441 
	}
}

445 
fun˘i⁄
 
	$gu¨d¨_v¨übÀs
() {

447  
$this
->
	`es¸ibúArchivos
($this->
¨chivo
, $this->
v¨übÀs
, $this->
nombª_¨øy
);

449 
	}
}

453 
fun˘i⁄
 
	$gu¨d¨_descùci⁄es
(
$idioma
 = 
NULL
) {

455 
$idioma
 = ( $idiom®Ë? $idiom®: 
$this
->
idioma
 ;

461 i‡–
$this
->
des¸ùci⁄es_modifiˇdas
[
$idioma
] !
TRUE
 ) {

462  
TRUE
;

465 
$¨chivo_des¸ùci⁄es
 = 
$this
->
dúe˘‹io_des¸ùci⁄es
.'/'.$this->
nombª_¨øy
.'_'.
$idioma
.'.php';

467 
$this
->
	`es¸ibúArchivos
(
$¨chivo_des¸ùci⁄es
, $this->
des¸ùci⁄es
[
$idioma
], $this->
nombª_¨øy
.'_DESC');

469  
TRUE
;

471 
	}
}

475 
¥iv©e
 
fun˘i⁄
 
	$es¸ibúArchivos
(
$¨chivo
, 
$d©os
, 
$nombª_¨øy
) {

479 i‡–
$this
->
‹dí¨
 ) 
	`ks‹t
(
$d©os
);

481 
	`ª£t
(
$d©os
);

483 
åy
 {

485 i‡–! 
$fûe
 = @
	`f›í
(
$¨chivo
, "w") ) {

486 
throw
 
√w
 
	`Ex˚±i⁄
("No seÖudoábrirárchivo $fileÖara incluir $nombre_array");

489 
	`Âuts
(
$fûe
, "<?php\n");

490 
	`Âuts
(
$fûe
, "// Archivÿgíîadÿautom©iˇmíãÖ‹ ".
__CLASS__
." ".
	`d©e
("D M j G:i:s T Y")."\n");

492 
	`li°
(
$˛ave
, 
$vÆ
)=
	`óch
(
$d©os
)){

494 i‡–
	`is_¨øy
(
$vÆ
)) {

496 
	`li°
(
$˛aveAºay
, 
$vÆ‹Aºay
)=
	`óch
(
$vÆ
)) {

498 
$vÆ‹Aºay
 = 
	`°r_ª∂a˚
("\\","",$valorArray);

499 
$vÆ‹Aºay
 = 
	`°rùc¶ashes
($valorArray);

501 i‡(
	`Âuts
(
$fûe
, '$'."$nombª_¨øy"."['".
	`°r_ª∂a˚
("'","\'",
$˛ave
)."'][]='".°r_ª∂a˚("'","\'",
$vÆ‹Aºay
)."';\n"Ë==
FALSE
 ) {

502 
throw
 
√w
 
	`Ex˚±i⁄
("Nÿ£Öuedêes¸ibúÉ¿".
$¨chivo
);

503  
FALSE
;

509 
$vÆ
 = 
	`°r_ª∂a˚
("\\","",$val);

510 
$vÆ
 = 
	`°rùc¶ashes
($val);

512 i‡(
	`Âuts
(
$fûe
, '$'."$nombª_¨øy"."['".
	`°r_ª∂a˚
("'","\'",
$˛ave
)."']='".°r_ª∂a˚("'","\'",
$vÆ
)."';\n"Ë==
FALSE
 ) {

513 
throw
 
√w
 
	`Ex˚±i⁄
("Nÿ£Öuedêes¸ibúÉ¿".
$¨chivo
);

514  
FALSE
;

520 
	`Âuts
(
$fûe
, '?>');

521 
	`f˛o£
(
$fûe
);

523 
$this
->
v¨übÀs_modifiˇdas
 = 
FALSE
;

527 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

530 
	`ªgi°ør
(
$ex
->
	`gëFûe
(), $ex->
	`gëLöe
(),"Eº‹És¸ibõndÿ¨chivÿ".
$¨chivo
."\n".$ex->
	`gëMesßge
(),'ERROR');

531  
FALSE
;

535 
	}
}

539 
fun˘i⁄
 
	$__de°ru˘
() {

541 i‡–
$this
->
v¨übÀs_modifiˇdas
 ) {

543 
åy
 {

545 
$this
->
	`gu¨d¨_v¨übÀs
();

547 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

549 
echo
 'ERRORÉn destructor';

550  
FALSE
;

557 i‡–!
	`em±y
(
$this
->
des¸ùci⁄es_modifiˇdas
) ) {

559 
	`f‹óch
 ( 
$this
->
des¸ùci⁄es_modifiˇdas
 
as
 
$i
 => 
$dm
 ) {

560 i‡–
$dm
 ) { 
$this
->
	`gu¨d¨_descùci⁄es
(
$i
); }

565 
	}
}

	@gcm/lib/int/GcmConfig/lib/GcmConfigFactory.php

1 <?
php


20 
ªquúe_⁄˚
('GcmConfig.php');

37 ˛as†
	cGcmC⁄figFa˘‹y
 {

39 
public
 
fun˘i⁄
 
	$GëGcmC⁄fig
(
$¨chivo
) {

41 
$key
 = 
	`md5
(
	`£rülize
(
$¨chivo
));

43 i‡–! 
	`is£t
(
$GLOBALS
['GcmC⁄fig'][
$key
]Ë|| ! ($GLOBALS['GcmC⁄fig'][$key] 
ö°™˚of
 
GcmC⁄fig
) ) {

45 
$GLOBALS
['GcmC⁄fig'][
$key
] = 
√w
 
	`GcmC⁄fig
(
$¨chivo
);

49  
$GLOBALS
['GcmC⁄fig'][
$key
];

53 
	}
}

	@gcm/lib/int/GcmConfig/lib/GcmConfigGui.php

1 <?
php


19 
ªquúe_⁄˚
('GcmConfig.php');

35 ˛as†
	cGcmC⁄figGui
 
exãnds
 
	mGcmC⁄fig
 {

37 
fun˘i⁄
 
	$__c⁄°ru˘
(
$¨chivo
) {

39 
∑ª¡
::
	`__c⁄°ru˘
(
$¨chivo
);

60 
fun˘i⁄
 
	$f‹muœrio
(
$¨gs
 = 
NULL
) {

62 
$am∂ür
 = ( 
	`is£t
(
$¨gs
['am∂ür']ËË? $¨gs['am∂ür'] : 
FALSE
;

63 
$ñimö¨
 = ( 
	`is£t
(
$¨gs
['ñimö¨']ËË? $¨gs['ñimö¨'] : 
FALSE
;

64 
$∂™tûœ
 = ( 
	`is£t
(
$¨gs
['∂™tûœ']ËË? $¨gs['∂™tûœ'] : 
	`dú«me
(
__FILE__
).'/../html/formGcmConfigGui.html';

65 
$css
 = ( 
	`is£t
(
$¨gs
['css']ËË? $¨gs['css'] : 
FALSE
;

66 
$modifiˇr_des¸ùci⁄es
 = ( 
	`is£t
(
$¨gs
['modifiˇr_des¸ùci⁄es']ËË? $¨gs['modifiˇr_des¸ùci⁄es'] : 
FALSE
;

69 i‡–
$css
 ) {

71 
echo
 '<lökÑñ="°yÀshìt" hªf="'.
$css
.'"Åype="text/css">';

75 
echo
 '<styleÅype="text/css">';

76 
	`ö˛ude
 (
	`dú«me
(
__FILE__
).'/../css/formGcmConfigGui.css');

77 
echo
 '</style>';

81 i‡–!
	`ö˛ude
(
$∂™tûœ
)) {

82 
throw
 
√w
 
	`Ex˚±i⁄
("Eº‹á»ö˛uúÖœ¡ûœ [".
$∂™tûœ
.']');

86 
	}
}

99 
fun˘i⁄
 
	$es¸ibú_desde_po°
() {

101 
globÆ
 
$HTTP_POST_VARS
;

103 
$idioma
 = 
$_POST
['idioma'];

104 
$¨chivo
 = 
$_POST
['archivo'];

108 i‡–
	`cou¡
(
$_POST
['es¸ibú_'.
$idioma
]) <= 0 ) {

109 
	`åiggî_îr‹
('Sin valores validosÉn GET');

110  
FALSE
;

115 
$this
->
v¨übÀs
 = 
	`¨øy
();

117 
	`f‹óch
–
$_POST
['es¸ibú_'.
$idioma
] 
as
 
$˛ave
 => 
$vÆ‹
 ) {

119 
$this
->
	`£t
(
$˛ave
,
$vÆ‹
);

125 i‡–
	`cou¡
(
$_POST
['des¸ùci⁄_'.
$idioma
]) > 0 ) {

127 
$this
->
des¸ùci⁄es
[
$idioma
] = 
	`¨øy
();

129 
$this
->
des¸ùci⁄es_ªcogidas
 = 
TRUE
;

131 
	`f‹óch
–
$_POST
['des¸ùci⁄_'.
$idioma
] 
as
 
$˛ave
 => 
$vÆ‹
 ) {

133 
$this
->
	`£tDes¸ùci⁄
(
$˛ave
,
$vÆ‹
, 
$idioma
);

139  
TRUE
;

141 
	}
}

	@gcm/lib/int/GcmConfig/test/GcmConfigFactoryTest.php

1 <?
php


8 
DEFINE
(
ARCHIVO
,'/tmp/TGC.php');

9 
DEFINE
(
ARCHIVO_DESC
,'/tmp/TGC_es.php');

13 
	g$c⁄ãnido
 = "\n".'<?php ';

14 
	g$c⁄ãnido
 .= "\n".'$TGC[v1]="variable1";';

15 
	g$c⁄ãnido
 .= "\n".'$TGC[v2]="variable2";';

16 
	g$c⁄ãnido
 .= "\n".'$TGC[v3]="variable3";';

17 
	g$c⁄ãnido
 .= "\n".'$TGC[v4]="variable4";';

18 
	g$c⁄ãnido
 .= "\n".'$TGC[v5]="variable5";';

19 
	g$c⁄ãnido
 .= "\n".'$TGC[v6]="variable6";';

20 
	g$c⁄ãnido
 .= "\n".'?>';

22 
fûe_put_c⁄ã¡s
(
ARCHIVO
, 
$c⁄ãnido
);

24 
	g$c⁄ãnido
 = "\n".'<?php ';

25 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

26 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

27 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

28 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

29 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

30 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

31 
	g$c⁄ãnido
 .= "\n".'?>';

33 
fûe_put_c⁄ã¡s
(
ARCHIVO_DESC
, 
$c⁄ãnido
);

35 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

37 
ªquúe
(
dú«me
(
__FILE__
).'/../lib/GcmConfigFactory.php');

43 ˛as†
	cGcmC⁄figFa˘‹yTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

45 
public
 
	m$c⁄fig
;

46 
public
 
	m$¨chivo
;

47 
public
 
	m$¨chivo_des¸ùci⁄
;

49 
fun˘i⁄
 
	$__c⁄°ru˘
() {

51 
$this
->
¨chivo
 = 
ARCHIVO
;

52 
$this
->
¨chivo_des¸ùci⁄
 = 
ARCHIVO_DESC
;

54 
$this
->
c⁄fig
 = 
GcmC⁄figFa˘‹y
::
	`gëGcmC⁄fig
($this->
¨chivo
);

62 
fun˘i⁄
 
	$ã°CambürVÆ‹es
() {

64 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 'variable1');

65 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v6'), 'descripcion_variable6');

67 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

68 
$this
->
c⁄fig
->
	`£t
('v1',
$nuevo_vÆ‹
);

69 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 
$nuevo_vÆ‹
);

71 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

72 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1',
$nuevo_vÆ‹
);

73 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v1'), 
$nuevo_vÆ‹
);

75 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñ
('v4'));

77 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñDes¸ùci⁄
('v4'));

79 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1','MODIFICADA');

81 
	}
}

	@gcm/lib/int/GcmConfig/test/GcmConfigGuiTest.php

1 <?
php


7 
DEFINE
(
ARCHIVO
,'/tmp/TGC.php');

8 
DEFINE
(
ARCHIVO_DESC
,'/tmp/TGC_es.php');

12 
	g$c⁄ãnido
 = "\n".'<?php ';

13 
	g$c⁄ãnido
 .= "\n".'$TGC[v1]="variable1";';

14 
	g$c⁄ãnido
 .= "\n".'$TGC[v2]="variable2";';

15 
	g$c⁄ãnido
 .= "\n".'$TGC[v3]="variable3";';

16 
	g$c⁄ãnido
 .= "\n".'$TGC[v4]="variable4";';

17 
	g$c⁄ãnido
 .= "\n".'$TGC[v5]="variable5";';

18 
	g$c⁄ãnido
 .= "\n".'$TGC[v6]="variable6";';

19 
	g$c⁄ãnido
 .= "\n".'?>';

21 
fûe_put_c⁄ã¡s
(
ARCHIVO
, 
$c⁄ãnido
);

23 
	g$c⁄ãnido
 = "\n".'<?php ';

24 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

25 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

26 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

27 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

28 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

29 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

30 
	g$c⁄ãnido
 .= "\n".'?>';

32 
fûe_put_c⁄ã¡s
(
ARCHIVO_DESC
, 
$c⁄ãnido
);

34 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

36 
ªquúe
(
dú«me
(
__FILE__
).'/../lib/GcmConfigGui.php');

38 ˛as†
	cGcmC⁄figGuiTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

40 
public
 
	m$c⁄fig
;

41 
public
 
	m$¨chivo
;

42 
public
 
	m$¨chivo_des¸ùci⁄
;

44 
fun˘i⁄
 
	$__c⁄°ru˘
() {

46 
$this
->
¨chivo
 = 
ARCHIVO
;

47 
$this
->
¨chivo_des¸ùci⁄
 = 
ARCHIVO_DESC
;

49 
$this
->
c⁄fig
 = 
√w
 
	`GcmC⁄figGui
($this->
¨chivo
);

55 
fun˘i⁄
 
	$ã°VîVÆ‹es
() {

57 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 'variable1');

58 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v6'), 'descripcion_variable6');

60 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

61 
$this
->
c⁄fig
->
	`£t
('v1',
$nuevo_vÆ‹
);

62 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 
$nuevo_vÆ‹
);

64 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

65 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1',
$nuevo_vÆ‹
);

66 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v1'), 
$nuevo_vÆ‹
);

68 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñ
('v4'));

70 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñDes¸ùci⁄
('v4'));

72 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1','MODIFICADA');

78 
	}
}

	@gcm/lib/int/GcmConfig/test/GcmConfigTest.php

1 <?
php


7 
DEFINE
(
ARCHIVO
,'/tmp/TGC.php');

8 
DEFINE
(
ARCHIVO_DESC
,'/tmp/TGC_es.php');

12 
	g$c⁄ãnido
 = "\n".'<?php ';

13 
	g$c⁄ãnido
 .= "\n".'$TGC[v1]="variable1";';

14 
	g$c⁄ãnido
 .= "\n".'$TGC[v2]="variable2";';

15 
	g$c⁄ãnido
 .= "\n".'$TGC[v3]="variable3";';

16 
	g$c⁄ãnido
 .= "\n".'$TGC[v4]="variable4";';

17 
	g$c⁄ãnido
 .= "\n".'$TGC[v5]="variable5";';

18 
	g$c⁄ãnido
 .= "\n".'$TGC[v6]="variable6";';

19 
	g$c⁄ãnido
 .= "\n".'?>';

21 
fûe_put_c⁄ã¡s
(
ARCHIVO
, 
$c⁄ãnido
);

23 
	g$c⁄ãnido
 = "\n".'<?php ';

24 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

25 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

26 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

27 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

28 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

29 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

30 
	g$c⁄ãnido
 .= "\n".'?>';

32 
fûe_put_c⁄ã¡s
(
ARCHIVO_DESC
, 
$c⁄ãnido
);

34 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

36 
ªquúe
(
dú«me
(
__FILE__
).'/../lib/GcmConfig.php');

38 ˛as†
	cGcmC⁄figTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

40 
public
 
	m$c⁄fig
;

41 
public
 
	m$¨chivo
;

42 
public
 
	m$¨chivo_des¸ùci⁄
;

44 
fun˘i⁄
 
	$__c⁄°ru˘
() {

46 
$this
->
¨chivo
 = 
ARCHIVO
;

47 
$this
->
¨chivo_des¸ùci⁄
 = 
ARCHIVO_DESC
;

49 
$this
->
c⁄fig
 = 
√w
 
	`GcmC⁄fig
($this->
¨chivo
);

55 
fun˘i⁄
 
	$ã°VîVÆ‹es
() {

57 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 'variable1');

58 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v6'), 'descripcion_variable6');

60 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

61 
$this
->
c⁄fig
->
	`£t
('v1',
$nuevo_vÆ‹
);

62 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gë
('v1'), 
$nuevo_vÆ‹
);

64 
$nuevo_vÆ‹
 = 'Nuevo valorÖara v1';

65 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1',
$nuevo_vÆ‹
);

66 
$this
->
	`as£πEquÆs
($this->
c⁄fig
->
	`gëDes¸ùci⁄
('v1'), 
$nuevo_vÆ‹
);

68 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñ
('v4'));

70 
$this
->
	`as£πTrue
($this->
c⁄fig
->
	`dñDes¸ùci⁄
('v4'));

72 
$this
->
c⁄fig
->
	`£tDes¸ùci⁄
('v1','MODIFICADA');

74 
	}
}

	@gcm/lib/int/GcmConfig/test/PhpTestGcmConfigGui.php

1 <?
php


7 
ªquúe
(
dú«me
(
__FILE__
).'/../lib/GcmConfigGui.php');

9 i‡–
	g$_POST
['accion'] == 'escribir_gcmconfig' ) {

11 
$po°_c⁄fig
 = 
√w
 
GcmC⁄figGui
(
$_POST
['archivo']);

12 
	g$po°_c⁄fig
->
	gidioma
 = 
$_POST
['idioma'];

14 i‡–
	g$po°_c⁄fig
->
es¸ibú_desde_po°
() ) {

15 
	gecho
 '<h1>ArchivoÉscrito</h1>';

19 
	g$po°_c⁄fig
 = 
NULL
;

22 
	gecho
 'Error';

26 
DEFINE
(
ARCHIVO
,'/tmp/TGC.php');

27 
DEFINE
(
ARCHIVO_DESC
,'/tmp/TGC_es.php');

28 
DEFINE
(
ARCHIVO_DESC_ˇ
,'/tmp/TGC_ca.php');

30 i‡–! 
	$fûe_exi°s
(
ARCHIVO
) ) {

34 
$c⁄ãnido
 = "\n".'<?php ';

35 
$c⁄ãnido
 .= "\n".'$TGC[v1]="variable1";';

36 
$c⁄ãnido
 .= "\n".'$TGC[v2]="variable2";';

37 
$c⁄ãnido
 .= "\n".'$TGC[v3]="variable3";';

38 
$c⁄ãnido
 .= "\n".'$TGC[v4]="variable4";';

39 
$c⁄ãnido
 .= "\n".'$TGC[v5][]="variable5a";';

40 
$c⁄ãnido
 .= "\n".'$TGC[v5][]="variable5b";';

41 
$c⁄ãnido
 .= "\n".'$TGC[v5][]="variable5c";';

42 
$c⁄ãnido
 .= "\n".'$TGC[v6]="variable6";';

43 
$c⁄ãnido
 .= "\n".'?>';

45 
	`fûe_put_c⁄ã¡s
(
ARCHIVO
, 
$c⁄ãnido
);

47 
	}
}

49 i‡–! 
	$fûe_exi°s
(
ARCHIVO_DESC
) ) {

51 
$c⁄ãnido
 = "\n".'<?php ';

52 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

53 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

54 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

55 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

56 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

57 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

58 
$c⁄ãnido
 .= "\n".'?>';

60 
	`fûe_put_c⁄ã¡s
(
ARCHIVO_DESC
, 
$c⁄ãnido
);

62 
	}
}

64 i‡–! 
	$fûe_exi°s
(
ARCHIVO_DESC_ˇ
) ) {

66 
$c⁄ãnido
 = "\n".'<?php ';

67 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1_ca";';

68 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2_ca";';

69 
$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3_ca";';

70 
$c⁄ãnido
 .= "\n".'?>';

72 
	`fûe_put_c⁄ã¡s
(
ARCHIVO_DESC_ˇ
, 
$c⁄ãnido
);

74 
	}
}

76 
	g$c⁄fig
 = 
√w
 
GcmC⁄figGui
(
ARCHIVO
);

77 
	g$c⁄fig_ˇ
 = 
√w
 
GcmC⁄figGui
(
ARCHIVO
);

79 
	gecho
 '<h2>Presentamos variables</h2>';

81 
	gecho
 "<¥e>" ; 
¥öt_r
(
$c⁄fig
->
v¨übÀs
()) ;Écho "</pre>";

85 
	gecho
 '<h2>FormularioÉn idiomaÖredeterminado Solo seÖuede modificar valores</h2>';

86 
echo
 
	g$c⁄fig
->
f‹muœrio
();

88 
	gecho
 '<h2>FormularioÉn catalanámpliable</h2>';

89 
	g$c⁄fig_ˇ
->
	gidioma
 = 'ca';

90 
	g$›ci⁄es
 = 
¨øy
('am∂ür' => 
TRUE
, 'eliminar' => TRUE, 'modificar_descripciones' => TRUE );

91 
echo
 
	g$c⁄fig_ˇ
->
f‹muœrio
(
$›ci⁄es
);

93 
	gecho
 '<h2>POST</h2>';

94 
	gecho
 "<¥e>" ; 
¥öt_r
(
$_POST
) ;Écho "</pre>";

	@gcm/lib/int/GcmConfig/test/phpTestGcmConfig.php

1 <?
php


7 
DEFINE
(
ARCHIVO
,'/tmp/TGC.php');

8 
DEFINE
(
ARCHIVO_DESC
,'/tmp/TGC_es.php');

9 
DEFINE
(
ARCHIVO_DESC2
,'/tmp/TGC_ca.php');

13 
	g$c⁄ãnido
 = "\n".'<?php ';

14 
	g$c⁄ãnido
 .= "\n".'$TGC[v1]="variable1";';

15 
	g$c⁄ãnido
 .= "\n".'$TGC[v2]="variable2";';

16 
	g$c⁄ãnido
 .= "\n".'$TGC[v3]="variable3";';

17 
	g$c⁄ãnido
 .= "\n".'$TGC[v4]="variable4";';

18 
	g$c⁄ãnido
 .= "\n".'$TGC[v5]="variable5";';

19 
	g$c⁄ãnido
 .= "\n".'$TGC[v6]="variable6";';

20 
	g$c⁄ãnido
 .= "\n".'?>';

22 
fûe_put_c⁄ã¡s
(
ARCHIVO
, 
$c⁄ãnido
);

24 
	g$c⁄ãnido
 = "\n".'<?php ';

25 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

26 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

27 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

28 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

29 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

30 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

31 
	g$c⁄ãnido
 .= "\n".'?>';

33 
fûe_put_c⁄ã¡s
(
ARCHIVO_DESC2
, 
$c⁄ãnido
);

35 
	g$c⁄ãnido
 = "\n".'<?php ';

36 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v1]="descripcion_variable1";';

37 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v2]="descripcion_variable2";';

38 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v3]="descripcion_variable3";';

39 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v4]="descripcion_variable4";';

40 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v5]="descripcion_variable5";';

41 
	g$c⁄ãnido
 .= "\n".'$TGC_DESC[v6]="descripcion_variable6";';

42 
	g$c⁄ãnido
 .= "\n".'?>';

44 
fûe_put_c⁄ã¡s
(
ARCHIVO_DESC
, 
$c⁄ãnido
);

46 
ªquúe
('GcmConfig.php');

48 
	g$c⁄fig
 = 
√w
 
GcmC⁄fig
(
ARCHIVO
);

50 
	g$c⁄fig
->
£t
('v1','NUEVO VALOR PARA v1');

51 
	g$c⁄fig
->
£tDes¸ùci⁄
('v1','NUEVO VALOR PARA DESCRIPCION v1');

52 
	g$c⁄fig
->
dñ
('v4');

54 
	gecho
 'VÆ‹ dêv1: '.
	g$c⁄fig
->
gë
('v1');

58 
	g$v2
 = 
¨øy
( 'valor1', 'valor2');

59 
	g$c⁄fig
->
£t
('v2', 
$v2
);

63 
	g$c⁄fig
->
£t
('v7', 'Nueva variable');

66 
echo
 
	g$c⁄fig
->
gë
('v2');

68 
	gecho
 "\nV¨übÀs:" ; 
¥öt_r
(
$c⁄fig
->
v¨übÀs
()) ;Écho "";

69 
	gecho
 "\nDes¸ùci⁄e†es:" ; 
¥öt_r
(
$c⁄fig
->
des¸ùci⁄es
()) ;Écho "";

70 
	gecho
 "\nDes¸ùci⁄e†ˇ:" ; 
¥öt_r
(
$c⁄fig
->
des¸ùci⁄es
('ca')) ;Écho "";

	@gcm/lib/int/GcmPDO/lib/GcmPDO.php

1 <?
php


25 ˛as†
	cGcmPDO
 {

27 
¥Ÿe˘ed
 
	m$ªsu…ado
;

28 
¥Ÿe˘ed
 
	m$sql
;

29 
¥Ÿe˘ed
 
	m$pdo
;

30 
¥Ÿe˘ed
 
	m$num_tŸÆ_ªgi°ros
;

38 
fun˘i⁄
 
	$__c⁄°ru˘
 (
PDO
 
$pdo
, 
$sql
) {

40 
$this
->
num_tŸÆ_ªgi°ros
 = 0;

41 
$this
->
pdo
 = 
$pdo
;

42 
$this
->
sql
 = 
$sql
;

44 
$c⁄su…a_cou¡
 = "SELECT COUNT(*) FROM ($this->sql)ás conta";

48 i‡–! 
$ªsu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$c⁄su…a_cou¡
) ) {

49 
$îr‹
 = 
$ªsu…
->
	`îr‹Info
();

50 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"ERROR ".
$îr‹
[2]."\nsql:\n".
$c⁄su…a_cou¡
,'ERROR');

51  
FALSE
;

54 i‡–! 
$ªsu…
->
	`execuã
() ) {

55 
$îr‹
 = 
$ªsu…
->
	`îr‹Info
();

56 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"ERROR ".
$îr‹
[2]."\nsql:\n".
$c⁄su…a_cou¡
,'ERROR');

57  
FALSE
;

60 
$fûas
 = 
$ªsu…
->
	`„tch
();

62 
	`f‹óch
(
$fûas
 
as
 
$key
 => 
$vÆue
) {

63 
$this
->
num_tŸÆ_ªgi°ros
 = 
$vÆue
;

72 
fun˘i⁄
 
	$numîo_ªgi°ros
() {

73  
$this
->
num_tŸÆ_ªgi°ros
;

74 
	}
}

80 
fun˘i⁄
 
	$vÆid¨
() {

82 i‡–
$this
->
num_tŸÆ_ªgi°ros
 > 0 ) {

83  
TRUE
;

85  
FALSE
;

87 
	}
}

93 
fun˘i⁄
 
	$ªsu…ado
() {

95 i‡–
$this
->
ªsu…ado
 )  $this->resultado;

97 
åy
 {

99 
$this
->
ªsu…ado
=$this->
pdo
->
	`¥ï¨e
($this->
sql
);

100 
$this
->
ªsu…ado
->
	`execuã
();

102 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

103 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Error conÜa base de datos",'ERROR');

104 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"SQL: ".
$this
->
sql
."\n".
$ex
->
	`gëMesßge
(),'ADMIN');

105  
FALSE
;

108  
$this
->
ªsu…ado
;

110 
	}
}

116 
fun˘i⁄
 
	$to_¨øy
() {

118 i‡–! 
$this
->
ªsu…ado
 ) $this->
	`ªsu…ado
();

120 
$ªt‹no
 = 
	`¨øy
();

122 i‡–! 
$this
->
ªsu…ado
 ) {

123 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'SinÑesultados');

124  
FALSE
;

126 
$¨AŒ
 = 
$this
->
ªsu…ado
->
	`„tchAŒ
(
PDO
::
FETCH_ASSOC
);

128 
$c⁄è
 = 0;

129 
	`f‹óch
 ( 
$¨AŒ
 
as
 
$¨Row
 ) {

130 
	`f‹óch
(
$¨Row
 
as
 
$key
 => 
$vÆue
) {

131 
$ªt‹no
[
$c⁄è
][
$key
] = 
$vÆue
;

133 
$c⁄è
++;

136  
$ªt‹no
;

138 
	}
}

	@gcm/lib/int/GcmPDO/lib/paginarPDO.php

1 <?
php


20 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/GcmPDO.php');

27 ˛as†
	cPagö¨PDO
 
exãnds
 
	mGcmPDO
 {

29 
public
 
	m$ñemítos_∑göa
;

30 
public
 
	m$uæ_ba£
='';

31 
public
 
	m$∂™tûœ_ªsu…ados
;

32 
public
 
	m$∂™tûœ_bŸ⁄îa
;

33 
public
 
	m$∑göas_agru∑das
=2;

34 
public
 
	m$sufijo
;

36 
¥iv©e
 
	m$öicio
;

37 
¥iv©e
 
	m$∑göa
;

38 
¥iv©e
 
	m$tŸÆ_de_∑göas
;

39 
¥iv©e
 
	m$ñemíto_öicio
;

40 
¥iv©e
 
	m$ñemíto_föÆ
;

41 
¥iv©e
 
	m$tŸÆµ
;

43 
¥iv©e
 
	m$as_‹dí
;

44 
¥iv©e
 
	m$tùo_‹dí
;

46 
¥iv©e
 
	m$s¸ùt_ajax_ö˛uido
 = 
FALSE
 ;

60 
fun˘i⁄
 
	$__c⁄°ru˘
 (
PDO
 
$pdo
, 
$sql
, 
$sufijo
=
FALSE
, 
$ñemítos_∑göa
=8, 
$‹dî
 = FALSE, 
$sql_ªœci⁄es
 = FALSE) {

62 
∑ª¡
::
	`__c⁄°ru˘
(
$pdo
, 
$sql
);

64 
$this
->
sufijo
 = ( 
$sufijo
 ) ? $sufijo : '';

66 
$this
->
ñemítos_∑göa
 = ( 
$ñemítos_∑göa
 ) ? $elementos_pagina : 10 ;

70 i‡–
	`is£t
(
$_GET
[
$this
->
sufijo
.'‹dí']Ë&& ! 
	`em±y
($_GET[$this->sufijo.'orden']) ) {

72 
$this
->
as_‹dí
 = 
	`°rù¶ashes
(
$_GET
[$this->
sufijo
.'orden']);

74 
$this
->
tùo_‹dí
 = ( 
	`is£t
(
$_GET
[$this->
sufijo
.'tipo_orden']) ) ? $_GET[$this->sufijo.'tipo_orden'] : 'asc';

78 i‡–
$sql_ªœci⁄es
 && 
	`¨øy_key_exi°s
(
$this
->
as_‹dí
,$sql_relaciones) ) {

79 
$‹dî
 = "ORDER BY ".
$sql_ªœci⁄es
[
$this
->
as_‹dí
]." ".$this->
tùo_‹dí
;

81 
$‹dî
 = "ORDER BY `".
$this
->
as_‹dí
."` ".$this->
tùo_‹dí
;

84 } 
	`ñ£if
 ( 
$‹dî
 ) {

86 
	`¥eg_m©ch_Æl
('/‹dî by (.*?Ë(.*?)/i', 
$‹dî
, 
$coöcidícüs
);

88 
$‹díadox
 = ( !
	`em±y
(
$coöcidícüs
[1][0]ËË? 
	`åim
($coöcidícüs[1][0],','Ë: 
FALSE
 ;

90 
$this
->
tùo_‹dí
 = ( 
	`°rùos
(
$‹dî
,'desc'Ë!=
FALSE
 ) ? 'desc' : 'asc' ;

92 i‡–
$‹díadox
 ) {

98 i‡–
	`¥eg_m©ch
('/'.
$‹díadox
.'(.?Ëa†(.*)/i',
$sql
, 
$coöcidícüs
Ë&& ! 
	`em±y
($coincidencias[2]) ) {

100 
$this
->
as_‹dí
 = 
	`åim
(
$coöcidícüs
[2],',');

104 
$this
->
as_‹dí
 = 
$‹díadox
;

109 i‡–
$sql_ªœci⁄es
 && 
	`¨øy_£¨ch
(
$this
->
as_‹dí
,$sql_relaciones) ) {

110 
$this
->
as_‹dí
 = 
	`¨øy_£¨ch
($this->as_‹dí,
$sql_ªœci⁄es
);

114 
$this
->
as_‹dí
 = 
FALSE
;

119 
$this
->
as_‹dí
 = 
FALSE
;

124 
$this
->
sql
 = 
$sql
." ".
$‹dî
;

131 i‡(
	`em±y
(
$_GET
[
$this
->
sufijo
."pagina"])) {

132 
$öicio
 = 0;

133 
$this
->
∑göa
=1;

137 
$this
->
∑göa
 = 
$_GET
[$this->
sufijo
."pagina"];

138 
$öicio
 = (
$this
->
∑göa
 - 1Ë* $this->
ñemítos_∑göa
;

142 
$öicio
 = ( $inicio > 0 ) ? $inicio : 0 ;

144 
$this
->
tŸÆ_de_∑göas
 = ( $this->
num_tŸÆ_ªgi°ros
 > 1 ) ? 
	`˚û
($this->num_tŸÆ_ªgi°ro†/ $this->
ñemítos_∑göa
) : 1 ;

146 
$this
->
sql
=$this->sql."Üimô " . 
$öicio
 . "," . $this->
ñemítos_∑göa
;

148 
$this
->
tŸÆµ
=
	`˚û
($this->
tŸÆ_de_∑göas
 / $this->
∑göas_agru∑das
);

151 
$this
->
ñemíto_öicio
=($this->
∑göa
-$this->
∑göas_agru∑das
);

152 
$this
->
ñemíto_föÆ
=($this->
∑göa
+$this->
∑göas_agru∑das
);

154 i‡–
$this
->
ñemíto_öicio
 < 1 ) $this->elemento_inicio=1;

155 i‡–
$this
->
ñemíto_föÆ
 > $this->
tŸÆ_de_∑göas
 ) $this->elemento_final=$this->total_de_paginas;

167 
fun˘i⁄
 
	`∑göa
(
$›ci⁄es_¨øy2èbÀ
=
FALSE
, 
$¥e£¡aci⁄
 = 'Array2table') {

169 
globÆ
 
$gcm
;

171 i‡–! 
$this
->
ªsu…ado
 ) $this->
	`ªsu…ado
();

178 i‡–
$this
->
∂™tûœ_ªsu…ados
 ) {

182 
	`ö˛ude
(
$this
->
∂™tûœ_ªsu…ados
);

197 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../../¨øy2èbÀ/lib/'.
$¥e£¡aci⁄
.'.php');

199 
$¨øy2èbÀ
 = 
√w
 
	`$¥e£¡aci⁄
();

200 
$¨øy2èbÀ
->
sufijo
 = 
$this
->sufijo;

201 
$¨øy2èbÀ
->
	`gíî¨_èbœ
(
$this
->
	`to_¨øy
(), 
$›ci⁄es_¨øy2èbÀ
, $this->
as_‹dí
, $this->
tùo_‹dí
);

205 
	}
}

211 
fun˘i⁄
 
	$bŸ⁄îa
() {

213 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../../gcm/lib/helpers.php');

215 i‡–! 
$this
->
ªsu…ado
 ) $this->
	`ªsu…ado
();

217 
$this
->
uæ_ba£
 = 
	`c⁄°ruú_gë
–
	`¨øy
(

218 
$this
->
sufijo
.'‹dí' => 
	`html•ecülch¨s
($this->
as_‹dí
,
ENT_QUOTES
)

219 , 
$this
->
sufijo
.'tùo_‹dí' => $this->
tùo_‹dí


225 
$simbﬁo
 = '&';

227 i‡–! 
$this
->
∂™tûœ_bŸ⁄îa
 ) {

229 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../html/botonera_paginador.html');

233 
	`ö˛ude
(
$this
->
∂™tûœ_bŸ⁄îa
);

236 
	}
}

248 
fun˘i⁄
 
gíî¨_∑göa
(
$uæ_ajax
=
FALSE
, 
$›ci⁄es_¨øy2èbÀ
 = FALSE, 
$¥e£¡aci⁄
 = 'Array2table') {

252 
$idít
 = 
$this
->
sufijo
;

253 
	g$div
 = 
$idít
.'paginador';

255 
	gecho
 '<div id="'.
	g$div
.'">';

256 
	g$this
->
bŸ⁄îa
();

257 
	g$this
->
∑göa
(
$›ci⁄es_¨øy2èbÀ
, 
$¥e£¡aci⁄
);

258 
	g$this
->
bŸ⁄îa
();

259 
	gecho
 '</div>';

260 i‡(
	g$this
->
	gtŸÆ_de_∑göas
 > 1) {

261 i‡–
	g$uæ_ajax
 && $url_ajax != '' ) {

262 
$this
->
s¸ùt_ajax
();

264 i‡–
is£t
(
$_REQUEST
['f‹m©o']Ë&& 
	g$_REQUEST
['formato'] == 'ajax' ) {

266 <
s¸ùt
>
£tTimeout
('öôPagöad‹("#<?=$div?>","<?=$uæ_ajax?>")', 1000);</
	gs¸ùt
>

267 <?
	gphp


270 <
	gs¸ùt
>

271 
addLﬂdEvít
(
fun˘i⁄
(){

272 
öôPagöad‹
("#<?=$div?>","<?=$url_ajax?>");

274 </
	gs¸ùt
>

275 <?
	gphp


290 
fun˘i⁄
 
	$s¸ùt_ajax
() {

292 i‡–
£lf
::
$s¸ùt_ajax_ö˛uido
 )  ;

295 <
s¸ùt
>

296 
fun˘i⁄
 
	`öôPagöad‹
(
div
,
uæ_ajax
) {

297 
	`$
(
div
).
	`föd
(".bŸ⁄îa_∑göad‹á").
	`˛ick
(
	`fun˘i⁄
() {

298 
v¨
 
uæ
 = 
	`$
(
this
).
	`©å
("hªf"Ë+ 
uæ_ajax
;

299 
$
.
	`gë
(
uæ
,
	`fun˘i⁄
(
d©a
){

300 
	`$
(
div
).
	`ª∂a˚Wôh
(
d©a
);

302  
Ál£
;

304 
	`$
(
div
).
	`föd
("èbÀÅhá").
	`˛ick
(
	`fun˘i⁄
() {

305 
v¨
 
uæ
 = 
	`$
(
this
).
	`©å
("hªf"Ë+ 
uæ_ajax
;

306 
$
.
	`gë
(
uæ
,
	`fun˘i⁄
(
d©a
){

307 
	`$
(
div
).
	`ª∂a˚Wôh
(
d©a
);

309  
Ál£
;

312 </
s¸ùt
>

313 <?
php


315 
£lf
::
$s¸ùt_ajax_ö˛uido
 = 
TRUE
;

317 
	}
}

	@gcm/lib/int/array2table/lib/Array2table.php

1 <?
php


22 ˛as†
	cAºay2èbÀ
 {

24 
public
 
	m$ba£_imagíes
 ;

25 
public
 
	m$img_modifiˇr
 ;

26 
public
 
	m$img_b‹ør
 ;

27 
public
 
	m$img_vî
 ;

28 
public
 
	m$sufijo
 ;

37 
fun˘i⁄
 
__c⁄°ru˘
(
$sufijo
='') {

39 
$this
->
sufijo
 = 
$sufijo
 ;

40 
	m£lf
::
$img_modifiˇr
 = 'modificar.png' ;

41 
	m£lf
::
$img_b‹ør
 = 'borrar.png' ;

42 
	m£lf
::
$img_vî
 = 'ver.png' ;

43 
	m£lf
::
$ba£_imagíes
 = 
Rouãr
::
$ba£
.
GCM_DIR
.'lib/int/array2table/img/';

89 
fun˘i⁄
 
	$gíî¨_èbœ
(
$ªs
, 
$›ci⁄es
=
NULL
, 
$‹dí
 = 
FALSE
 , 
$tùo_‹dí
 = FALSE) {

91 
$num_ªgi°ros
 = 
	`cou¡
(
$ªs
);

92 
$num_cﬁum«s
 = 
	`cou¡
(
$ªs
[0]);

96 
$ßlida_fûa_uniˇ
 = 
FALSE
 ;

99 
$èbÀ_id
 = ( 
	`is£t
(
$›ci⁄es
['èbÀ_id'])Ë? $›ci⁄es['èbÀ_id'] : 
FALSE
 ;

102 
$uæ
 = ( 
	`is£t
(
$›ci⁄es
['uæ'])Ë? $›ci⁄es['uæ'] : 
FALSE
 ;

105 
$acci⁄
 = ( 
	`is£t
(
$›ci⁄es
['acci⁄'])Ë? $›ci⁄es['acci⁄'] : 
FALSE
 ;

108 
$idítifiˇd‹
 = ( 
	`is£t
(
$›ci⁄es
['idítifiˇd‹'])Ë? $›ci⁄es['idítifiˇd‹'] : 
FALSE
 ;

111 
$vî
 = ( 
	`is£t
(
$›ci⁄es
['vî'])Ë? $›ci⁄es['vî'] : 
FALSE
 ;

114 
$modifiˇr
 = ( 
	`is£t
(
$›ci⁄es
['modifiˇr'])Ë? $›ci⁄es['modifiˇr'] : 
FALSE
 ;

117 
$ñimö¨
 = ( 
	`is£t
(
$›ci⁄es
['ñimö¨'])Ë? $›ci⁄es['ñimö¨'] : 
FALSE
 ;

120 
$ocu…¨_id
 = ( 
	`is£t
(
$›ci⁄es
['ocu…¨_id'])Ë? $›ci⁄es['ocu…¨_id'] : 
FALSE
 ;

123 
$cﬁgroup
 = ( 
	`is£t
(
$›ci⁄es
['cﬁgroup'])Ë? $›ci⁄es['cﬁgroup'] : 
FALSE
 ;

126 
£lf
::
$ba£_imagíes
 = ( 
	`is£t
(
$›ci⁄es
['dir_img'])) ? $opciones['dir_img'] : self::$base_imagenes ;

129 
$íœ˚s
 = ( 
	`is£t
(
$›ci⁄es
['íœ˚s'])Ë? $›ci⁄es['íœ˚s'] : 
FALSE
 ;

132 
$fûa_uniˇ
 = ( 
	`is£t
(
$›ci⁄es
['fûa_uniˇ'])Ë? $›ci⁄es['fûa_uniˇ'] : 
FALSE
 ;

136 
$idítifiˇd‹
 = ( $identificador ) ? $identificador : 'id';

138 
$simbﬁo
 = ( 
	`°ºpos
(
$uæ
,'?'Ë==
FALSE
 ) ? '?' : '&';

141 <
èbÀ
 
˚Œ∑ddög
="0" 
˚Œ•acög
="0" 
b‹dî
="0" <?
php
 i‡–
$èbÀ_id
 ) 
echo
 'id="'.$èbÀ_id.'"';?> 
˛ass
="dataTable">

143 <?
php


145 <?
php
 i‡–
$cﬁgroup
 ) { ?>

147 <
cﬁgroup
>

148 <?
php
 
	`f‹óch
 ( 
$ªs
[0] 
as
 
$cﬁum«
 => 
$vÆ‹
 ) { ?>

149 <?
php
 i‡–
$cﬁum«
 =
$idítifiˇd‹
 && 
$ocu…¨_id
 ) ; ?>

150 <
cﬁ
 
id
="col_<?phpÉcho htmlspecialchars($columna,ENT_QUOTES);?>">

151 <?
php
 } ?>

152 </
cﬁgroup
>

154 <?
php
 } ?>

156 <
thód
>

157 <
å
>

158 <?
php


160 i‡–
$ªs
 ) {

162 
	`f‹óch
 ( 
$ªs
[0] 
as
 
$cﬁum«
 => 
$vÆ‹
 ) {

174 i‡–
$cﬁum«
 =
$idítifiˇd‹
 && 
$ocu…¨_id
 ) ;

176 
$˛a£
 = ( 
$cﬁum«
 =
$‹dí
 ) ? ' cœss="'.
$tùo_‹dí
.'" ' : ' class="head" ';

178 i‡–
$cﬁum«
 =
$‹dí
 ) {

180 
$tùo_‹dí2
 = ( 
$tùo_‹dí
 == 'asc' ) ? 'desc' : 'asc';

182 
$tùo_‹dí2
 = 'asc';

185 
$uæ_‹dí
 = 
	`c⁄°ruú_gë
–
	`¨øy
 (
$this
->
sufijo
.'‹dí' => 
$cﬁum«


186 , 
$this
->
sufijo
.'tùo_‹dí' => 
$tùo_‹dí2


187 , 
$this
->
sufijo
.'pagina' => 1)) ;

189 i‡–
$íœ˚s
 && 
	`is£t
($íœ˚s[
$cﬁum«
]) ) {

190 
$tôulo_cﬁum«
 = 
$íœ˚s
[
$cﬁum«
]['titulo_columna'];

191 
$ˇmpo_íœzado
 = 
$íœ˚s
[
$cﬁum«
]['campo_enlazado'];

192 
$íœ˚s_öicüdos
[] = 
$ˇmpo_íœzado
;

193 } 
	`ñ£if
 ( 
	`is£t
(
$íœ˚s_öicüdos
Ë&& 
	`ö_¨øy
(
$cﬁum«
, $enlaces_iniciados) ) {

194 
$num_cﬁum«s
--;

196 } 
	`ñ£if
 ( 
	`is£t
(
$fûa_uniˇ
Ë&& $fûa_uniˇ =
$cﬁum«
 ) {

199 
$num_cﬁum«s
--;

202 
$tôulo_cﬁum«
 = 
$cﬁum«
;

205 
echo
 "\n\t\t\t";

206 
echo
 "<th".
$˛a£
.">";

207 i‡–
$uæ
 ) 
echo
 "<®hªf='".
	`html•ecülch¨s
(
$uæ_‹dí
,
ENT_QUOTES
)."'>";

208 
echo
 "<h3>";

209 
echo
 
$tôulo_cﬁum«
;

210 
echo
 "</h3>";

211 i‡–
$uæ
 ) 
echo
 "</a>";

212 
echo
 "</th>";

218 i‡–
$vî
 ) {

219 
$num_cﬁum«s
++;

221 <
th
>

222 <
h3
>

223 <
img
 
§c
='<?=self::$base_imagenes.self::$img_ver?>'

224 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='Visualizar'

225 
Æt
='[*]' />

226 </
h3
>

227 </
th
>

228 <?
php


231 i‡–
$modifiˇr
 ) {

232 
$num_cﬁum«s
++;

234 <
th
>

235 <
h3
>

236 <
img
 
§c
='<?=self::$base_imagenes.self::$img_modificar?>'

237 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='Modificar'

238 
Æt
='[#]' />

239 </
h3
>

240 </
th
>

241 <?
php


244 i‡–
$ñimö¨
 ) {

245 
$num_cﬁum«s
++;

247 <
th
>

248 <
h3
>

249 <
img
 
§c
='<?=self::$base_imagenes.self::$img_borrar?>'

250 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='Eliminar'

251 
Æt
='[-]' />

252 </
h3
>

253 </
th
>

254 <?
php


258 
echo
 "\n\t</thead>";

259 
echo
 "\n\t<tbody>";

261 
$Âi
 = 'evenrow';

263 
	`f‹óch
 ( 
$ªs
 
as
 
$fûa
 ) {

265 
$íœ˚
 = 
FALSE
;

267 
echo
 "\n\t\t<å cœss='".
$Âi
."'>";

269 
$cﬁ
 = 0;

270 
	`f‹óch
 ( 
$fûa
 
as
 
$key_cﬁum«
 => 
$cﬁum«
 ) {

272 
$cﬁ
++;

275 
$˛a£_cﬁum«
 = ( 
$key_cﬁum«
 =
$‹dí
 ) ? ' cœss="cﬁ_'.
$cﬁ
.' oddselected" ' : ' class="col_'.$col.'"' ;

279 i‡–
$idítifiˇd‹
 && 
$key_cﬁum«
 =$idítifiˇd‹ && 
$uæ
 ) {

282 
$íœ˚
 = 
$uæ
.
$cﬁum«
;

288 i‡–
$key_cﬁum«
 =
$idítifiˇd‹
 && 
$ocu…¨_id
 ) {

289 
$cﬁ
--;

290 
echo
 '';

292 } 
	`ñ£if
 ( 
$íœ˚s
 && 
	`is£t
($íœ˚s[
$key_cﬁum«
]) ) {

293 
$DATO
=
	`åim
(
$cﬁum«
);

294 
$ˇmpo_íœzado
 = 
$íœ˚s
[
$key_cﬁum«
]['campo_enlazado'];

295 
$íœ˚s_¸ódos
[
$ˇmpo_íœzado
]['öicio'] = 
	`•rötf
("\n\t\t\t<td %s><®hªf='%s%s'>",
$˛a£_cﬁum«
,
$íœ˚s
[
$key_cﬁum«
]['ba£_uæ'],
$DATO
);

296 i‡–
	`is£t
(
$íœ˚s_¸ódos
[
$ˇmpo_íœzado
]['inicio']) && isset($enlaces_creados[$campo_enlazado]['final']) )

297 
echo
 
$íœ˚s_¸ódos
[
$ˇmpo_íœzado
]['inicio'].$enlaces_creados[$campo_enlazado]['final'];

299 } 
	`ñ£if
 ( 
	`is£t
(
$íœ˚s_¸ódos
[
$key_cﬁum«
]) ) {

300 
$DATO
=
	`åim
(
$cﬁum«
);

301 
$˛ave_íœ˚
 = 
$key_cﬁum«
;

302 
$íœ˚s_¸ódos
[
$˛ave_íœ˚
]['föÆ'] = 
	`•rötf
("%s</a></td>",
$DATO
);

303 i‡–
	`is£t
(
$íœ˚s_¸ódos
[
$˛ave_íœ˚
]['inicio']) && isset($enlaces_creados[$clave_enlace]['final']) )

304 
echo
 
$íœ˚s_¸ódos
[
$˛ave_íœ˚
]['inicio'].$enlaces_creados[$clave_enlace]['final'];

306 } 
	`ñ£if
 ( 
	`is£t
(
$fûa_uniˇ
Ë&& $fûa_uniˇ =
$key_cﬁum«
 ) {

307 
$DATO
=
	`åim
(
$cﬁum«
);

308 
$ßlida_fûa_uniˇ
 .
	`•rötf
("\n\t\t<å><td cﬁ•™='%s' %s>%s</td></å>",
$num_cﬁum«s
,
$˛a£_cﬁum«
,
$DATO
);

310 } 
	`ñ£if
 (
$key_cﬁum«
 == "img" ) {

311 
$DATO
=
	`åim
(
$cﬁum«
);

312 
	`¥ötf
("\n\t\t\t<td".
$˛a£_cﬁum«
."> <img width='60px' src='%s' /></td>",
$DATO
);

314 } 
	`ñ£if
 (
$key_cﬁum«
 == "%") {

315 
$DATO
=
	`åim
(
$cﬁum«
);

316 
	`¥ötf
("\n\t\t\t<td".
$˛a£_cﬁum«
." styÀ='b‹dî:0;'> <div styÀ='background-cﬁ‹: #5db02d; width: \
%•x'>%s</div></td>",
$DATO
,$DATO,$DATO);

321 i‡–
$íœ˚
 ) {

322 
echo
 "\n\t\t\t<td".
$˛a£_cﬁum«
.">";

323 
echo
 "<®hªf='".
$íœ˚
."'>";

324 
echo
 
$cﬁum«
;

325 
echo
 "</a></td> " ;

327 
echo
 "\n\t\t\t<td".
$˛a£_cﬁum«
.">".
$cﬁum«
."</td> " ;

334 i‡(
$íœ˚
) {

336 i‡–
$modifiˇr
 ) {

337 
echo
 "\n\t\t\t<td><®hªf='$íœ˚&$acci⁄=".
$modifiˇr
."'>

338 <
img
 
§c
='".self::$base_imagenes.self::$img_modificar."'

339 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='Modificar'

340 
Æt
='[#]' ></
a
></
td
>";

343 i‡–
$ñimö¨
 ) {

344 
echo
 "\n\t\t\t<td><a href='$enlace&$accion=$eliminar'>

345 <
img
 
§c
='".self::$base_imagenes.self::$img_borrar."'

346 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='Eliminar'

347 
Æt
='[-]' ></
a
></
td
>";

350 i‡–
$vî
 ) {

351 
echo
 "\n\t\t\t<td><a href='$enlace&$accion=ver'>

352 <
img
 
§c
='".self::$base_imagenes.self::$img_ver."'

353 
width
='16' 
height
='16' 
b‹dî
='0' 
tôÀ
='ver'

354 
Æt
='[*]' ></
a
></
td
>";

357 
$íœ˚
 = 
NULL
;

361 
echo
 "\n\t\t</tr>";

363 
$íœ˚s_¸ódos
 = 
	`¨øy
();

364 i‡–
$ßlida_fûa_uniˇ
 ) 
echo
 $salida_fila_unica;

365 
$ßlida_fûa_uniˇ
 = '';

367 
$Âi
 = ( $fpi == 'evenrow' ) ? 'oddrow' : 'evenrow';

371 
echo
 "\n\t</tbody>";

372 
echo
 "</table>";

374 
	}
}

	@gcm/lib/int/autentificacion/lib/Autentificacion.php

1 <?
php


30 ˛as†
	cAuã¡ifiˇci⁄
 {

34 
¥iv©e
 
	m$pdo
;

38 
public
 
	m$sufijo
;

50 
¥iv©e
 
	m$acci⁄es
;

63 
fun˘i⁄
 
__c⁄°ru˘
(
PDO
 
$pdo
, 
$sufijo
='au', 
$acci⁄es
 = 
FALSE
) {

65 
$this
->
pdo
 = 
$pdo
;

66 
	m$this
->
	msufijo
 = 
$sufijo
;

68 
	m$this
->
	macci⁄es
 = ( 
$acci⁄es
 ) ? $acci⁄e†: 
¨øy
('admin' =>árray('administrar' =>árray('administrador')) ) ;

72 i‡–! 
	m$this
->
exi°e_èbœ
(
$this
->
sufijo
.'usu¨ios'ËË$this->
¸ór_èbœ
();

76 
	m$sql
 = 'SELECT COUNT(*ËFROM '.
$this
->
sufijo
.'usuarios u LEFT JOIN '.$this->sufijo.'r_usuarios_rolesÑur ONÑur.usuarios_id = u.id WHEREÑur.roles_id=1';

78 i‡–! 
	m$°h
 = 
$this
->
pdo
->
¥ï¨e
(
$sql
) ) ;

80 i‡(!
	m$°h
->
execuã
()) ;

82 
	m$¨Row
 = 
$°h
->
„tch
();

84 
f‹óch
(
$¨Row
 
as
 
$key
 => 
$vÆue
) {

85 
$num_admni°ød‹es
 = 
$vÆue
;

88 i‡–
	m$num_admni°ød‹es
 < 1 )

89 
	m$this
->
¸ór_admö_de„˘o
();

99 
fun˘i⁄
 
	$£t_acci⁄es
(
$acci⁄es
) {

100 
$this
->
acci⁄es
 = 
	`¨øy_mîge
($this->acci⁄es, 
$acci⁄es
);

101 
	}
}

107 
fun˘i⁄
 
	$exi°e_èbœ
(
$èbœ
) {

109 
åy
 {

111 
$sql
 = 'SELECT COUNT(*ËFROM '.
$èbœ
;

113 i‡–! 
$°h
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
) ) {

115 
	`ªgi°ør
(
__FILE__
,
__LINE__
, 'NoÉxisteÅablaÖara usuariosÜa creamos','AVISO');

116 
$this
->
	`¸ór_èbœ
();

120 i‡(!
$°h
->
	`execuã
()) {

122 
$this
->
	`¸ór_èbœ
();

127 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

129  
FALSE
;

133  
TRUE
;

135 
	}
}

144 
fun˘i⁄
 
	$¸ór_èbœ
() {

146 i‡–! 
$this
->
	`exi°e_èbœ
($this->
sufijo
.'roles') ) {

148 
$SQL
 = "CREATE TABLE ".
$this
->
sufijo
."roles (

149 
id
 
INT
 
PRIMARY
 
KEY
,

150 
nombª
 
	`v¨ch¨
(150Ë
NOT
 
NULL
,

151 
des¸ùci⁄
 
	`v¨ch¨
(500Ë
NOT
 
NULL


155 i‡–! 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

157 
throw
 
√w
 
	`Ex˚±i⁄
("Eº‹á»¸ó∏èbœ dê".
$this
->
sufijo
."rﬁes\n".
$pdo_îr‹
);

158  
FALSE
;

164 i‡–! 
$this
->
	`exi°e_èbœ
($this->
sufijo
.'r_usuarios_roles') ) {

166 
$SQL
 = "CREATE TABLE ".
$this
->
sufijo
."r_usuarios_roles (

167 
usu¨ios_id
 (11Ë
NOT
 
NULL
,

168 
rﬁes_id
 (11Ë
NOT
 
NULL
,

169 
PRIMARY
 
	`KEY
 (
usu¨ios_id
,
rﬁes_id
)

173 i‡–! 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

175 
throw
 
√w
 
	`Ex˚±i⁄
("Eº‹á»¸ó∏èbœ dê".
$this
->
sufijo
."r_usu¨ios_rﬁes\n".
$pdo_îr‹
);

176  
FALSE
;

182 
$SQL
="CREATE TABLE ".
$this
->
sufijo
."usuarios (

183 
id
 
INT
 
PRIMARY
 
KEY
 
AUTO_INCREMENT
 ,

184 
usu¨io
 
	`CHAR
(50) ,

185 
∑ss_md5
 
	`CHAR
(32) ,

186 
nombª
 
	`CHAR
(50) ,

187 
≠ñlidos
 
	`CHAR
(50) ,

188 
„cha_¸óci⁄
 
d©ëime
 
NOT
 
NULL
,

189 
„cha_modifiˇci⁄
 
time°amp
 
NOT
 
NULL
 
DEFAULT
 
CURRENT_TIMESTAMP
 ,

190 
maû
 
	`CHAR
(60) ,

191 
ãÀf⁄o
 
	`CHAR
(15)

194 i‡–! 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

196 
throw
 
√w
 
	`Ex˚±i⁄
("Eº‹á»¸ó∏èbœ dê".
$this
->
sufijo
."usu¨ios\n".
$pdo_îr‹
);

197  
FALSE
;

201 
$this
->
	`¸ór_admö_de„˘o
();

203 
	}
}

214 
fun˘i⁄
 
	$íå¨
(
$usu¨io
, 
$∑ss
) {

216 
globÆ
 
$_SESSION
;

218 
$sql
 = "SELECT id, usu¨iÿFROM ".
$this
->
sufijo
."usuarios WHERE usuario=? ANDÖass_md5=? LIMIT 1";

219 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

220 i‡–! 
$com™do
->
	`execuã
(
	`¨øy
(
$usu¨io
, 
	`md5
(
$∑ss
)) ) ) {

221 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

222 
$mí_îr‹
 = 
$îr
[2];

223 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»ö£π¨Ñegi°ro: '.
$mí_îr‹
);

226 
$ªt‹no
 = 
$com™do
->
	`„tchAŒ
(
PDO
::
FETCH_NUM
);

228 i‡(!
$com™do
) {

230 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

231 
$mí_îr‹
 = 
$îr
[2];

232 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹Éjecuèndÿquîy: '.
$mí_îr‹
. ' sql: '.
$c⁄su…a
);

233  
FALSE
;

235 } 
	`ñ£if
 ( 
	`cou¡
(
$ªt‹no
) < 1 ) {

237 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Usuario o contrase√±a incorrecta','AVISO');

239  
FALSE
;

243 
	`li°
(
$id
,
$usu¨io
Ë
$ªt‹no
[0];

247 
$sql
 = "SELECTÑ.nombª FROM ".
$this
->
sufijo
."rolesÑ LEFT JOIN ".$this->sufijo."r_usuarios_rolesÑur ONÑur.roles_id=r.id WHEREÑur.usuarios_id=?";

248 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

250 i‡–! 
$com™do
->
	`execuã
(
	`¨øy
(
$id
)) ) {

251 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

252 
$mí_îr‹
 = 
$îr
[2];

253 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»ö£π¨Ñegi°ro: '.
$mí_îr‹
);

256 
$ªt‹no
 = 
$com™do
->
	`„tchAŒ
(
PDO
::
FETCH_NUM
);

258 i‡(!
$com™do
) {

260 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

261 
$mí_îr‹
 = 
$îr
[2];

262 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹Éjecuèndÿquîy: '.
$mí_îr‹
. ' sql: '.
$c⁄su…a
);

263  
FALSE
;

265 } 
	`ñ£if
 ( 
	`cou¡
(
$ªt‹no
) < 1 ) {

268 
$rﬁes
[] = 'usuario';

272 
	`f‹óch
 ( 
$ªt‹no
 
as
 
$rﬁ
 ) {

273 
$rﬁes
[] = 
$rﬁ
[0];

279 
$_SESSION
[
$this
->
sufijo
.'id'] = 
$id
;

280 
$_SESSION
[
$this
->
sufijo
.'usu¨io'] = 
$usu¨io
;

281 
$_SESSION
[
$this
->
sufijo
.'rﬁes'] = 
	`£rülize
(
$rﬁes
);

283  
TRUE
;

285 
	}
}

293 
fun˘i⁄
 
	$logódo
() {

295 
globÆ
 
$_SESSION
;

297  ( 
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'id']ËË? $_SESSION[$this->sufijo.'id'] : 
FALSE
 ;

299 
	}
}

309 
fun˘i⁄
 
	$es_admö
() {

311 i‡–! 
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'rﬁes']ËË 
FALSE
;

313 
$rﬁes
 = 
	`un£rülize
(
$_SESSION
[
$this
->
sufijo
.'roles']);

315  
	`ö_¨øy
('admöi°ød‹',
$rﬁes
) ;

317 
	}
}

325 
fun˘i⁄
 
	$id
() {

326  ( 
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'id']ËË? $_SESSION[$this->sufijo.'id']: 
FALSE
 ;

327 
	}
}

344 
fun˘i⁄
 
	$rﬁes_usu¨io
() {

346 i‡–! 
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'rﬁes']ËË 
FALSE
;

348  
	`un£rülize
(
$_SESSION
[
$this
->
sufijo
.'roles']);

350 
	}
}

361 
fun˘i⁄
 
	$rﬁes_acci⁄
(
$modulo
, 
$acci⁄
) {

363 
globÆ
 
$gcm
;

365 i‡–
	`is£t
(
$this
->
acci⁄es
[
$modulo
][
$acci⁄
]) )  $this->acciones[$modulo][$accion];

367  
FALSE
;

369 
	}
}

379 
fun˘i⁄
 
≥rmiso
(
$acci⁄
 = 'admöi°ør', 
$modulo
 = 'admin') {

381 
globÆ
 
$gcm
;

383 i‡–
	gGCM_DEBUG
 ) 
	g$tõmpo_öicio
 = 
mi¸Ÿime
(
TRUE
);

385 
	g$usu¨io_id
 = 
$this
->
id
();

389 i‡–! 
	g$usu¨io_id
 )  
	gFALSE
;

393 i‡–
	g$gcm
->
	gau
->
es_admö
(ËË 
	gTRUE
;

395 
	g$rﬁes_usu¨io
 = 
$this
->
rﬁes_usu¨io
();

396 
	g$rﬁes_acci⁄
 = 
$this
->
rﬁes_acci⁄
(
$modulo
,
$acci⁄
);

398 i‡–! 
	g$rﬁes_acci⁄
 ) {

399 
ªgi°ør
(
__FILE__
,
__LINE__
,'SöÖîmiso†∑ø ['.
$modulo
.'->'.
$acci⁄
.'()]','DEBUG');

400 i‡–
	gGCM_DEBUG
 )

401 
ªgi°ør
(
__FILE__
,
__LINE__
,'Tõmpÿdêejecuci√≥¿dê'.
__CLASS__
.'->'.
__FUNCTION__
.'('.
$acci⁄
.','.
$modulo
.'): ('.
round
(
mi¸Ÿime
(
TRUE
)-
$tõmpo_öicio
,4).')');

402  
	gFALSE
;

405 
f‹óch
 ( 
$rﬁes_acci⁄
 
as
 
$rﬁ_acci⁄
 ) {

406 i‡–
ö_¨øy
(
$rﬁ_acci⁄
, 
$rﬁes_usu¨io
ËË 
	gTRUE
;

409  
	gFALSE
;

421 
fun˘i⁄
 
	$ßlú
() {

423 i‡–
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'id']ËË
	`un£t
($_SESSION[$this->sufijo.'id']);

424 i‡–
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'admö']ËË
	`un£t
($_SESSION[$this->sufijo.'admin']);

425 i‡–
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'rﬁes']ËË
	`un£t
($_SESSION[$this->sufijo.'roles']);

426 
	`£ssi⁄_de°roy
();

427  
TRUE
;

429 
	}
}

438 
fun˘i⁄
 
	$¸ór_admö_de„˘o
() {

442 
$sql
 = "INSERT INTO ".
$this
->
sufijo
."usuarios (id, usuario,Öass_md5, fecha_creacion, mail) VALUES ";

443 
$sql
 .= "(?,?,?,?,?)";

444 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

445 i‡–!
$com™do
 ) {

446 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

447 
$mí_îr‹
 = 
$îr
[2];

448 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»¥ï¨¨ sql'.
$mí_îr‹
);

451 i‡–! 
$com™do
->
	`execuã
(
	`¨øy
(1,'admö',
	`md5
('admö'),
	`d©e
('Y-m-d H:i'), 'root@localhost') ) ) {

452 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

453 
$mí_îr‹
 = 
$îr
[2];

454 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»ö£π¨Ñegi°ro: '.
$mí_îr‹
);

457 
$sql
 = "INSERT INTO ".
$this
->
sufijo
."roles VALUES (1,'administrador','EládministradorÅieneÅodosÜosÖrivilegios');";

458 
$sql
 ."INSERT INTO ".
$this
->
sufijo
."roles VALUES (2,'usuario','UsuarioÑegistrado');";

459 
$sql
 ."INSERT INTO ".
$this
->
sufijo
."roles VALUES (3,'editor','Puedeá√±adir suÖropio contenido');";

460 
$sql
 ."INSERT INTO ".
$this
->
sufijo
."roles VALUES (4,'traductor','Puede modificarÜasÅraducciones');";

462 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

463 i‡–!
$com™do
 ) {

464 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

465 
$mí_îr‹
 = 
$îr
[2];

466 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»¥ï¨¨ sql'.
$mí_îr‹
);

469 i‡–! 
$com™do
->
	`execuã
() ) {

470 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

471 
$mí_îr‹
 = 
$îr
[2];

472 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»ö£π¨Ñegi°ro: '.
$mí_îr‹
);

475 
	`un£t
(
$com™do
);

477 
$this
->
	`ö£π¨_rﬁ_usu¨io
(1,1);

478 
$this
->
	`ö£π¨_rﬁ_usu¨io
(1,2);

480 
	}
}

486 
fun˘i⁄
 
	$ö£π¨_rﬁ_usu¨io
(
$usu¨io_id
, 
$rﬁ_id
) {

488 
$sql
 = "INSERT INTO ".
$this
->
sufijo
."r_usu¨ios_rﬁe†VALUES (".
$usu¨io_id
.",".
$rﬁ_id
.")";

490 
$com™do
 = 
$this
->
pdo
->
	`exec
(
$sql
);

492 i‡–!
$com™do
 ) {

493 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

494 
$mí_îr‹
 = 
$îr
[2];

495 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹á»wjwcuè∏sql: '.
$sql
."\n\n<b∏/>".
	`dïuør
(
$îr
));

504 
	}
}

	@gcm/lib/int/autentificacion/test/AutentificacionTest.php

1 <?
php


3 i‡(!
deföed
("PHPUnit_MAIN_METHOD")) {

4 
deföe
("PHPUnit_MAIN_METHOD", "AutentificacionTest::main");

7 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestCase.php";

8 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestSuite.php";

10 
	gªquúe_⁄˚
 '../lib/Autentificacion.php';

14 
	g$_SESSION
 = 
¨øy
();

20 ˛as†
	cAuã¡ifiˇci⁄Te°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
 {

22 
¥iv©e
 
	m$pdo
;

23 
¥iv©e
 
	m$au
;

31 
public
 
fun˘i⁄
 
	$maö
() {

32 
ªquúe_⁄˚
 "PHPUnit/TextUI/TestRunner.php";

34 
$suôe
 = 
√w
 
	`PHPUnô_Fømew‹k_Te°Suôe
("AutentificacionTest");

35 
$ªsu…
 = 
PHPUnô_TextUI_Te°Ru¬î
::
	`run
(
$suôe
);

44 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£tUp
() {

46 i‡–
	`fûe_exi°s
('/tmp/au.db'ËË
	`u∆ök
('/tmp/au.db');

48 
$this
->
pdo
 = 
√w
 
	`PDO
('sqlite:/tmp/au.db');

49 
$this
->
au
 = 
√w
 
	`Auã¡ifiˇci⁄
($this->
pdo
);

51 
	}
}

59 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ã¨Down
() {

60 i‡–
	`fûe_exi°s
('/tmp/au.db'ËË
	`u∆ök
('/tmp/au.db');

61 
	}
}

63 
public
 
fun˘i⁄
 
	$ã°Cª¨_èbœ
() {

64 
$this
->
	`as£πTrue
(
	`fûe_exi°s
('/tmp/au.db'), 'Archivo deÑegistro creado');

65 
	}
}

67 
public
 
fun˘i⁄
 
	$ã°E¡ør
() {

69 
globÆ
 
$_SESSION
;

71 
$this
->
	`as£πTrue
($this->
au
->
	`íå¨
('admin','admin'), 'Archivo deÑegistro creado');

72 
	}
}

74 
public
 
fun˘i⁄
 
	$ã°Logódo
() {

76 
globÆ
 
$_SESSION
;

78 
$this
->
	`as£πEquÆs
($this->
au
->
	`logódo
(),1,'Hay sesi√≥náctiva');

79 
	}
}

81 
public
 
fun˘i⁄
 
	$ã°Es_admö
() {

83 
globÆ
 
$_SESSION
;

85 
$this
->
	`as£πTrue
($this->
au
->
	`es_admö
(),'Hay sesi√≥náctiva');

87 
	}
}

92 i‡(
	gPHPUnô_MAIN_METHOD
 == "AutentificacionTest::main") {

93 
Auã¡ifiˇci⁄Te°
::
maö
();

	@gcm/lib/int/captcha/captcha.php

1 <?
php


19 
fun˘i⁄
 
™yadúC≠tcha
(
$nom
='deÁu…', 
$ªt‹n
='false') {

21 
$NC
=
$nom
."_cf_".
ˇø˘î_Æót‹io
();

22 
	g$_SESSION
[
$nom
.'_cf_'] = 
$NC
;

24 i‡–
	g$ªt‹n
 == 'false' ) {

25 
echo
 '<öpuàty≥="hiddí"Çame="'.
$NC
.'" vÆue="'.
time
().'" />';

27  '<öpuàty≥="hiddí"Çame="'.
	g$NC
.'" vÆue="'.
time
().'" />';

39 
fun˘i⁄
 
vîifiˇrC≠tcha
(
$£g
=10, 
$nom
='default'){

41 i‡–! 
is£t
(
$_SESSION
[
$nom
.'_cf_']ËË 
FALSE
;

42 i‡–! 
is£t
(
$_POST
[
$_SESSION
[
$nom
.'_cf_']]ËË 
	gFALSE
;

44 
	g$a˘uÆ
 = 
time
();

45 
	g$f‹m
 = 
$_POST
[
$_SESSION
[
$nom
.'_cf_']];

46 
	g$di„ªncü
 = 
$a˘uÆ
 - 
$f‹m
 ;

48 i‡–
	g$di„ªncü
 < 
	g$£g
 || 
em±y
(
$f‹m
) ) {

49  
	gFALSE
;

51  
	gTRUE
;

60 
fun˘i⁄
 
	$™yadúC≠tchaImagí
() {

62 
globÆ
 
$_ADMIN
 ;

64 
$ˇ±cha_ãxto
 = "";

66 
$i
 = 1; $i <= 4; $i++) {

67 
$ˇ±cha_ãxto
 .
	`ˇø˘î_Æót‹io
();

70 
$_SESSION
["ˇ±cha_ãxto_£ssi⁄"] = 
$ˇ±cha_ãxto
;

74 <
img
 
width
='110px' 
height
='30px' 
§c
="<?ph∞echÿ"../
lib
/
imgC≠tcha
.
php
?".SID ; ?>" /><
br
>

75 <
öput
 
«me
="ãxto_ögªßdo" 
ty≥
="ãxt" 
id
="ãxto_ögªßdo" 
°yÀ
='width: 55px' 
size
="6" 
maxÀngth
="4" />

76 <?
php


78 
	}
}

84 
fun˘i⁄
 
	$ˇø˘î_Æót‹io
() {

86 
	`mt_§™d
(()
	`mi¸Ÿime
()*1000000);

88 
$vÆ‹_Æót‹io
 = 
	`mt_ønd
(1,3);

90 
$vÆ‹_Æót‹io
) {

92 
$vÆ‹_Æót‹io
 = 
	`mt_ønd
(97, 122);

95 
$vÆ‹_Æót‹io
 = 
	`mt_ønd
(48, 57);

98 
$vÆ‹_Æót‹io
 = 
	`mt_ønd
(65, 90);

102  
	`chr
(
$vÆ‹_Æót‹io
);

103 
	}
}

107 
fun˘i⁄
 
	$vîifiˇrC≠tchaImagí
(){

110 
$ãxto_ögªßdo
 = 
	`°πﬁowî
(
$_POST
["texto_ingresado"]);

112 
$ˇ±cha_ãxto
 = 
	`°πﬁowî
(
$_SESSION
["captcha_texto_session"]);

114 i‡(
$ãxto_ögªßdo
 !
$ˇ±cha_ãxto
) {

116  
FALSE
 ;

126 
	`un£t
(
$_SESSION
["captcha_texto_session"]);

127  
TRUE
;

129 
	}
}

	@gcm/lib/int/databoundobject/lib/Crud.php

1 <?
php


22 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/DataBoundObject.php');

24 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/solicitud/lib/Solicitud.php');

47 ˛as†
	cCrud
 
exãnds
 
	mD©aBoundObje˘
 {

49 
public
 
	m$ñemítos_∑göa
 = 10;

51 
public
 
	m$css_f‹muœrio
 = 
FALSE
 ;

53 
public
 
	m$uæ_ajax
;

79 
¥Ÿe˘ed
 
	m$tùo_èbœ
 = 'normal';

87 
¥Ÿe˘ed
 
fun˘i⁄
 
	$visuÆiz™do_ªgi°ro
(Ë{  
FALSE
 ; }

121 
public
 
$›ci⁄es_¨øy2èbÀ
 = 
FALSE
;

129 
public
 
$c⁄f_∑göad‹
 = 
FALSE
;

131 
¥Ÿe˘ed
 
$evíto_gu¨d¨
 = 
FALSE
;

132 
¥Ÿe˘ed
 
$evíto_modifiˇr
 = 
FALSE
;

133 
¥Ÿe˘ed
 
$evíto_b‹ør
 = 
FALSE
;

135 
¥Ÿe˘ed
 
$ª°ricci⁄es
;

136 
¥Ÿe˘ed
 
$míßjes
;

146 
¥Ÿe˘ed
 
$tùos_f‹muœrio
;

154 
¥Ÿe˘ed
 
$id_ªœci⁄
 = '_id';

158 
¥Ÿe˘ed
 
$∂™tûœ
;

162 
¥Ÿe˘ed
 
$fichîo_css
;

186 
public
 
$sql_li°ado
;

203 
¥Ÿe˘ed
 
$sql_li°ado_ªœci⁄
 = 
FALSE
;

209 
¥Ÿe˘ed
 
$‰om_li°ado
;

211 
¥Ÿe˘ed
 
$gÆîü
 = 
FALSE
;

284 
¥Ÿe˘ed
 
$tùos_ˇmpos
;

286 
¥Ÿe˘ed
 
$≥rmisos
 = 
FALSE
;

288 
¥Ÿe˘ed
 
$acci⁄
 = 'ver';

294 
¥Ÿe˘ed
 
$dú_img_¨øy2èbÀ
 = 
FALSE
;

300 
fun˘i⁄
 
	$__c⁄°ru˘
(
PDO
 
$objPdo
, 
$id
 = 
NULL
) {

302 
globÆ
 
$gcm
;

304 
∑ª¡
::
	`__c⁄°ru˘
(
$objPdo
, 
$id
);

308 i‡–
$this
->
tùo_èbœ
 == 'combinatoria' ) {

310 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

311 i‡–! 
	`is£t
(
$this
->
tùos_f‹muœrio
[
$ödi˚
]) ) {

312 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['tipo'] = "relacion";

313 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['èbœ'] = 
	`°r_ª∂a˚
($this->
id_ªœci⁄
,'',$indice);

314 
$modño_ªœci⁄ado
 = 
	`ucfú°
(
$this
->
tùos_f‹muœrio
[
$ödi˚
]['tabla']);

315 
$id_ªœci⁄ado
 = 
FALSE
;

316 
$ªœci⁄
 = 
√w
 
	`$modño_ªœci⁄ado
(
$this
->
objPDO
,
$id_ªœci⁄ado
);

317 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['›ci⁄es'] = 
$ªœci⁄
->
	`li°ado_∑ø_£À˘
();

322 
$this
->
	`ª°ricci⁄es_autom©iˇs
();

323 
$this
->
	`míßjes_autom©icos
();

354 
	}
}

360 
fun˘i⁄
 
	$ª°ricci⁄es
() {

361  
$this
->
ª°ricci⁄es
;

362 
	}
}

368 
fun˘i⁄
 
	$míßjes
() {

369  
$this
->
míßjes
;

370 
	}
}

376 
fun˘i⁄
 
	$DeföeTabÀName
() {

377  
	`°πﬁowî
(
	`gë_˛ass
(
$this
));

378 
	}
}

386 
fun˘i⁄
 
	$DeföeRñ©i⁄M≠
(
$objPDO
) {

388 
$ª„ªncü_ˇmpos
 = 
	`¨øy
();

390 
$drivî
 = 
$objPDO
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

392 
$drivî
) {

396 
$sql
 = 
	`•rötf
("¥agm®èbÀ_öfo('%s')",
$this
->
°rTabÀName
);

398 
$r°
 = 
$objPDO
->
	`quîy
(
$sql
Ë
‹
 
	`dõ
('Eº‹á»busˇ∏öf‹maci√≥¿íÜ®èbœ '.
$this
->
°rTabÀName
);

400  
$row
 = 
$r°
->
	`„tch
() ) {

402 i‡–
$row
['name'] == 'id' ) {

404 
$ª„ªncü_ˇmpos
['id'] = 'ID';

408 
$ª„ªncü_ˇmpos
[
$row
['«me']] = 
	`ucfú°
($row['name']);

410 
$this
->
	`deföú_tùos_ˇmpo
(
$row
, 
$objPDO
);

411 
$this
->
	`deföú_tùos_f‹muœrio
(
$row
, 
$objPDO
);

421 
$sql
 = 
	`•rötf
–"SHOW FIELDS FROM `%s`", 
$this
->
°rTabÀName
 );

423 
$r°
 = 
$objPDO
->
	`quîy
(
$sql
Ë
‹
 
	`dõ
('Eº‹á»busˇ∏öf‹maci√≥¿íÜ®èbœ '.
$this
->
°rTabÀName
);

425  
$row
 = 
$r°
->
	`„tch
() ) {

427 i‡–
$row
['Field'] == 'id' ) {

429 
$ª„ªncü_ˇmpos
['id'] = 'ID';

433 
$ª„ªncü_ˇmpos
[
$row
['Fõld']] = 
	`ucfú°
($row['Field']);

435 
$this
->
	`deföú_tùos_ˇmpo
(
$row
, 
$objPDO
);

436 
$this
->
	`deföú_tùos_f‹muœrio
(
$row
, 
$objPDO
);

445  
$ª„ªncü_ˇmpos
;

447 
	}
}

458 
¥iv©e
 
fun˘i⁄
 
	$deföú_tùos_ˇmpo
(
$row
, 
$objPDO
) {

460 
$drivî
 = 
$objPDO
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

462 i‡–
$drivî
 == 'sqlite' ) {

464 i‡–! 
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['name']]['tipo']) ) $this->tipos_campos[$row['name']]['tipo'] = $row['type'];

465 i‡–! 
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['name']]['null']) ) $this->tipos_campos[$row['name']]['null'] = ( $row['notnull'] == 0 ) ? 1 : 0;

466 i‡–!
	`em±y
(
$row
['DeÁu…']Ë&& ! 
	`is£t
(
$this
->
tùos_ˇmpos
[$row['name']]['default']) ) $this->tipos_campos[$row['name']]['default'] = $row['dflt_value'];

467 i‡–!
	`em±y
(
$row
['Exåa']Ë&& ! 
	`is£t
(
$this
->
tùos_ˇmpos
[$row['name']]['extra']) ) $this->tipos_campos[$row['name']]['extra'] = $row['extra'];

471 
	`¥eg_m©ch
("/\((.*)\)/",
$row
['ty≥'],
$coöcidícüs
);

472 
$max
 = 
FALSE
;

473 i‡–
	`is£t
(
$coöcidícüs
[1]) ) {

474 
$max
 = 
$coöcidícüs
[1];

475 i‡–
	`°Ωos
(
$max
,',') ) {

476 
$maxs
 = 
	`ex∂ode
(',',
$max
);

477 
$max
 = 
$maxs
[0] + $maxs[1] + 1;

479 
$this
->
tùos_ˇmpos
[
$row
['«me']]['max'] = 
$max
;

483 i‡–
$row
['type'] == 'timestamp' || $row['type'] == 'datetime' ) {

484 
$max
=20;

485 
$this
->
tùos_ˇmpos
[
$row
['«me']]['max'] = 
$max
;

488 } 
	`ñ£if
 ( 
$row
['type'] == 'date' ) {

489 
$max
=10;

490 
$this
->
tùos_ˇmpos
[
$row
['«me']]['max'] = 
$max
;

498 i‡–! 
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['Field']]['tipo']) ) $this->tipos_campos[$row['Field']]['tipo'] = $row['Type'];

499 i‡–! 
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['Field']]['null']) ) $this->tipos_campos[$row['Field']]['null'] = $row['Null'];

500 i‡–!
	`em±y
(
$row
['DeÁu…']Ë&& ! 
	`is£t
(
$this
->
tùos_ˇmpos
[$row['Field']]['default']) ) $this->tipos_campos[$row['Field']]['default'] = $row['Default'];

501 i‡–!
	`em±y
(
$row
['Exåa']Ë&& ! 
	`is£t
(
$this
->
tùos_ˇmpos
[$row['Field']]['extra']) ) $this->tipos_campos[$row['Field']]['extra'] = $row['Extra'];

505 
	`¥eg_m©ch
("/\((.*)\)/",
$row
['Ty≥'],
$coöcidícüs
);

506 
$max
 = 
FALSE
;

507 i‡–
	`is£t
(
$coöcidícüs
[1]) ) {

508 
$max
 = 
$coöcidícüs
[1];

509 i‡–
	`°Ωos
(
$max
,',') ) {

510 
$maxs
 = 
	`ex∂ode
(',',
$max
);

511 
$max
 = 
$maxs
[0] + $maxs[1] + 1;

513 
$this
->
tùos_ˇmpos
[
$row
['Fõld']]['max'] = 
$max
;

517 i‡–
$row
['Type'] == 'timestamp' || $row['Type'] == 'datetime' ) {

518 
$max
=20;

519 
$this
->
tùos_ˇmpos
[
$row
['Fõld']]['max'] = 
$max
;

522 } 
	`ñ£if
 ( 
$row
['Type'] == 'date' ) {

523 
$max
=10;

524 
$this
->
tùos_ˇmpos
[
$row
['Fõld']]['max'] = 
$max
;

532 
	}
}

543 
fun˘i⁄
 
	$deföú_tùos_f‹muœrio
(
$row
, 
$objPDO
) {

545 
$drivî
 = 
$objPDO
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

547 i‡–
$drivî
 == 'sqlite' ) {

549 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo']) )  ;

551 i‡–
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['name']]['max']) ) {

552 i‡–
$this
->
tùos_ˇmpos
[
$row
['name']]['max'] > 150 ) {

553 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'textarea';

554 
$this
->
tùos_f‹muœrio
[
$row
['name']]['cols'] = '30';

555 
$this
->
tùos_f‹muœrio
[
$row
['name']]['rows'] = '3';

557 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'text';

558 
$this
->
tùos_f‹muœrio
[
$row
['«me']]['maxÀngth'] = $this->
tùos_ˇmpos
[$row['name']]['max'];

559 
$this
->
tùos_f‹muœrio
[
$row
['«me']]['size'] = ($this->
tùos_ˇmpos
[$row['name']]['max'] > 30) ? 30 : $this->tipos_campos[$row['name']]['max'];

562 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'text';

567 i‡–
	`°Ωos
(
$row
['«me'],
$this
->
id_ªœci⁄
 ) !=
FALSE
 ) {

569 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'relacion';

570 
$this
->
tùos_f‹muœrio
[
$row
['«me']]['èbœ'] = 
	`°r_ª∂a˚
($this->
id_ªœci⁄
,'',$row['name']);

576 i‡–
$row
['name'] == 'pass_md5' ) {

577 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'pass_md5';

582 i‡–
$row
['name'] == 'mail' ) {

583 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'mail';

588 i‡–
$row
['name'] == 'imagen_url' ) {

589 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'imagen_url';

594 i‡–! 
	`is£t
(
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo']) && $row['type'] == 'text' ) {

596 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'textarea';

597 
$this
->
tùos_f‹muœrio
[
$row
['name']]['cols'] = '30';

598 
$this
->
tùos_f‹muœrio
[
$row
['name']]['rows'] = '3';

604 i‡–
$row
['type'] == 'date' ) {

606 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'fecha';

612 i‡–
$row
['type'] == 'timestamp' || $row['type'] == 'datetime' ) {

614 
$this
->
tùos_f‹muœrio
[
$row
['name']]['tipo'] = 'fecha_hora';

620 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo']) )  ;

622 i‡–
	`is£t
(
$this
->
tùos_ˇmpos
[
$row
['Field']]['max']) ) {

623 i‡–
$this
->
tùos_ˇmpos
[
$row
['Field']]['max'] > 150 ) {

624 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'textarea';

625 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['cols'] = '30';

626 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['rows'] = '3';

628 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'text';

629 
$this
->
tùos_f‹muœrio
[
$row
['Fõld']]['maxÀngth'] = $this->
tùos_ˇmpos
[$row['Field']]['max'];

630 
$this
->
tùos_f‹muœrio
[
$row
['Fõld']]['size'] = ($this->
tùos_ˇmpos
[$row['Field']]['max'] > 30) ? 30 : $this->tipos_campos[$row['Field']]['max'];

633 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'text';

638 i‡–
	`°Ωos
(
$row
['Fõld'],
$this
->
id_ªœci⁄
 ) !=
FALSE
 ) {

640 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'relacion';

641 
$this
->
tùos_f‹muœrio
[
$row
['Fõld']]['èbœ'] = 
	`°r_ª∂a˚
($this->
id_ªœci⁄
,'',$row['Field']);

647 i‡–
$row
['Field'] == 'pass_md5' ) {

648 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'pass_md5';

653 i‡–
$row
['Field'] == 'mail' ) {

654 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'mail';

659 i‡–
$row
['Field'] == 'imagen_url' ) {

660 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'imagen_url';

665 i‡–
$row
['Type'] == 'text' ) {

667 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'textarea';

668 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['cols'] = '30';

669 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['rows'] = '3';

675 i‡–
$row
['Type'] == 'date' ) {

677 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'fecha';

683 i‡–
$row
['Type'] == 'timestamp' || $row['Type'] == 'datetime' ) {

685 
$this
->
tùos_f‹muœrio
[
$row
['Field']]['tipo'] = 'fecha_hora';

691 
	}
}

701 
fun˘i⁄
 
	$ª°ricci⁄es_autom©iˇs
() {

703 
	`f‹óch
 ( 
$this
->
¨Rñ©i⁄M≠
 
as
 
$ˇmpo
 => 
$ª„ªncü
) {

705 i‡–
$ˇmpo
 ='maû' ) 
$this
->
ª°ricci⁄es
[$ˇmpo][
RT_MAIL
] = 1;

707 i‡–
$ˇmpo
 ='∑ss_md5' ) 
$this
->
ª°ricci⁄es
[$ˇmpo][
RT_PASSWORD
] = 1;

709 i‡–
$ˇmpo
 == 'fecha_creacion' || $campo == 'fecha_modificacion' ) ;

711 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['oculto_form']) && $this->tipos_formulario[$campo]['oculto_form'] == 1 ) ;

714 i‡–! 
	`is£t
(
$this
->
ª°ricci⁄es
[
$ˇmpo
][
RT_LONG_MAX
]Ë&& is£t($this->
tùos_ˇmpos
[$campo]['max']) ) {

715 
$this
->
ª°ricci⁄es
[
$ˇmpo
][
RT_LONG_MAX
] = $this->
tùos_ˇmpos
[$campo]['max'];

719 i‡–! 
	`is£t
(
$this
->
ª°ricci⁄es
[
$ˇmpo
][
RT_REQUERIDO
]) &&

720 
	`is£t
(
$this
->
tùos_ˇmpos
[
$ˇmpo
]['null']) &&

721 
$this
->
tùos_ˇmpos
[
$ˇmpo
]['null'] == 'NO' &&

722 !
	`is£t
(
$this
->
tùos_ˇmpos
[
$ˇmpo
]['Default']) ) {

724 
$this
->
ª°ricci⁄es
[
$ˇmpo
][
RT_REQUERIDO
] = 1;

725 
$this
->
míßjes
[
$ˇmpo
][
RT_REQUERIDO
] = 
	`lôîÆ
('Campo obligatorio',3);

731 
	}
}

737 
fun˘i⁄
 
	$míßjes_autom©icos
() {

739 i‡–
	`is£t
(
$this
->
ª°ricci⁄es
) ) {

741 
	`f‹óch
 ( 
$this
->
ª°ricci⁄es
 
as
 
$ˇmpo
 => 
$ª°ricci⁄
 ) {

743 
	`f‹óch
 ( 
$ª°ricci⁄
 
as
 
$tùo
 => 
$vÆ‹
) {

745 i‡–! 
	`is£t
(
$this
->
míßjes
[
$ˇmpo
][
$tùo
]) ) {

747 
$tùo
) {

749 
RT_MAIL
:

750 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('El correoÇoÖarece valido',3);

753 
RT_LONG_MIN
:

754 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('Longitud minima',3);

757 
RT_LONG_MAX
:

758 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('Longitud m√°xima',3)

759 .' '.
$this
->
tùos_ˇmpos
[
$ˇmpo
]['max'];

762 
RT_CARACTERES_PERMITIDOS
:

763 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('CaracteresÇoÖermitidos',3);

766 
RT_CARACTERES_NO_PERMITIDOS
:

767 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('CaracteresÇoÖermitidos',3);

770 
RT_MENOR_QUE
:

771 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('DemasiadoÖeque√±o',3);

774 
RT_MAYOR_QUE
:

775 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('Demasiado grande',3);

778 
RT_IGUAL_QUE
:

779 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('No coincide',3);

782 
RT_NO_IGUAL
:

783 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('No coincide',3);

786 
RT_PASA_EXPRESION_REGULAR
:

787 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('ContenidoÇoÖermitido',3);

790 
RT_NO_PASA_EXPRESION_REGULAR
:

791 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('ContenidoÇoÖermitido',3);

794 
RT_PASSWORD
:

795 
$this
->
míßjes
[
$ˇmpo
][
$tùo
] = 
	`lôîÆ
('Contrase√±aÇoÖasa verificaci√≥n',3);

806 
	}
}

813 
fun˘i⁄
 
	$vÆ‹es
(
$ˇmpo
,
$di•œyHash
=
NULL
) {

815 i‡–
	`is£t
(
$di•œyHash
['VALORES'][
$ˇmpo
]) ) {

816  
$di•œyHash
['VALORES'][
$ˇmpo
];

820 i‡(
	`is£t
(
$this
->
ID
)) {

822 
$°rRëVÆ
 = 
$this
->
	`GëAc˚ss‹
(
	`ucfú°
(
$ˇmpo
));

824 i‡–
$°rRëVÆ
 )  $strRetVal;

828 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['valor'] ) )

829  
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['valor'];

831  
FALSE
;

833 
	}
}

842 
fun˘i⁄
 
	$visuÆiz¨_ªgi°ro
() {

846 
$ßlida
 = 
$this
->
	`visuÆiz™do_ªgi°ro
() ;

848 i‡–
$ßlida
 ) {

849 
echo
 
$ßlida
;

853 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/Formulario.php');

855 
$di•œyHash
 = ( 
	`is£t
($di•œyHashËË? $di•œyHash : 
NULL
;

859 
	`f‹óch
 ( 
$this
->
¨Rñ©i⁄M≠
 
as
 
$ˇmpo
 => 
$R
 ) {

861 i‡–
$ˇmpo
 !
	`¨øy_£¨ch
('ID',
$this
->
¨Rñ©i⁄M≠
ËË$this->
tùos_f‹muœrio
[$ˇmpo]['vÆ‹'] = $this->
	`vÆ‹es
($ˇmpo, 
$di•œyHash
);

865 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

866 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

867 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['tipo'] = "relacion";

868 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['vÆ‹'] = $this->
vÆ‹es
[$indice];

871 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['tabla']) ) {

872 
$modño_ªœci⁄ado
 = 
	`ucfú°
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['tabla']);

873 
$id_ªœci⁄ado
 = 
$this
->
	`GëAc˚ss‹
(
$ˇmpo
);

874 
$ªœci⁄
 = 
√w
 
	`$modño_ªœci⁄ado
(
$this
->
objPDO
,
$id_ªœci⁄ado
);

875 
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['›ci⁄es'] = 
$ªœci⁄
->
	`li°ado_∑ø_£À˘
();

880 
$f‹m
 = 
√w
 
	`F‹muœrio
(
$this
->
tùos_f‹muœrio
, 
$di•œyHash
, $this->
ª°ricci⁄es
, $this->
míßjes
);

882 
$f‹m
->
css
 = 
$this
->
css_f‹muœrio
;

885 i‡–
	`is£t
(
$this
->
∂™tûœ_visuÆiz¨
) ) {

886 
$f‹m
->
∂™tûœ_visuÆiz¨
 = 
$this
->plantilla_visualizar;

889 
$f‹m
->
	`gíîa_f‹muœrio
(
TRUE
, 
$this
->
acci⁄
);

891 i‡–
$this
->
gÆîü
 ) $this->gÆîü->
	`öicü
();

893 
	}
}

900 
fun˘i⁄
 
	$gíî¨_f‹muœrio
(
$di•œyHash
=
NULL
) {

902 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/Formulario.php');

906 
	`f‹óch
 ( 
$this
->
¨Rñ©i⁄M≠
 
as
 
$ˇmpo
 => 
$R
 ) {

909 i‡–
$this
->
ID
 ) {

910 
$this
->
tùos_f‹muœrio
[$this->
	`DeföeTabÀName
().'_id']['vÆ‹'] = $this->
ID
;

911 
$this
->
tùos_f‹muœrio
[$this->
	`DeföeTabÀName
().'_id']['oculto_form'] = 1;

916 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

917 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

918 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['tipo'] = "relacion";

919 
$this
->
tùos_f‹muœrio
[
$ödi˚
]['vÆ‹'] = $this->
vÆ‹es
[$indice];

923 i‡–
$ˇmpo
 !
	`¨øy_£¨ch
('ID',
$this
->
¨Rñ©i⁄M≠
ËË$this->
tùos_f‹muœrio
[$ˇmpo]['vÆ‹'] = $this->
	`vÆ‹es
($ˇmpo, 
$di•œyHash
);

925 i‡–
	`is£t
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['tabla']) ) {

926 
$modño_ªœci⁄ado
 = 
	`ucfú°
(
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['tabla']);

927 
$id_ªœci⁄ado
 = 
$this
->
	`GëAc˚ss‹
(
$ˇmpo
);

928 
$ªœci⁄
 = 
√w
 
	`$modño_ªœci⁄ado
(
$this
->
objPDO
,
$id_ªœci⁄ado
);

929 
$this
->
tùos_f‹muœrio
[
$ˇmpo
]['›ci⁄es'] = 
$ªœci⁄
->
	`li°ado_∑ø_£À˘
();

934 
$f‹m
 = 
√w
 
	`F‹muœrio
(
$this
->
tùos_f‹muœrio
, 
$di•œyHash
, $this->
ª°ricci⁄es
, $this->
míßjes
);

936 i‡–
$this
->
css_f‹muœrio
 ) 
$f‹m
->
css
 = $this->css_formulario;

939 i‡–
	`is£t
(
$this
->
∂™tûœ_edô¨
ËË
$f‹m
->
∂™tûœ
 = $this->plantilla_editar;

942 <
f‹m
 
«me
="¸ud" 
a˘i⁄
="<?ph∞i‡–is£t($_SERVER['REDIRECT_URL']ËËechÿ$_SERVER['REDIRECT_URL'];?>" 
mëhod
="post">

943 <?
php


945 
$f‹m
->
	`gíîa_f‹muœrio
(
FALSE
, 
$this
->
acci⁄
);

947 i‡–
$this
->
gÆîü
 ) $this->gÆîü->
	`öicü
();

950 <
p
 
˛ass
="bŸ⁄îa_¸ud"><
öput
 
ty≥
="submô" 
«me
="<?ph∞echÿ$this->DeföeTabÀName(); ?>_gu¨d¨" 
vÆue
="Guardar"></p>

951 </
f‹m
>

952 <?
php


953 
	}
}

965 
fun˘i⁄
 
admöi°ør
(
$c⁄dici⁄
 = 
FALSE
, 
$‹dî
 = FALSE, 
$dú_img
 = '', 
$≥rmisos
 = FALSE, 
$acci⁄_dúe˘a
 = FALSE) {

967 
globÆ
 
$gcm
;

969 
	g$this
->
	g≥rmisos
 = 
$≥rmisos
;

971 
	g$di•œyHash
 = 
¨øy
();

973 i‡–
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_id']ËË
	g$this
->
	gID
 = $_REQUEST[$this->DefineTableName().'_id'];

976 i‡–! 
	g$this
->
	gID
 && 
is£t
(
$_SESSION
['VALORES'][
$this
->
DeföeTabÀName
().'_id']) )

977 
	g$this
->
	gID
 = 
is£t
(
$_SESSION
['VALORES'][
$this
->
DeföeTabÀName
().'_id']);

980 i‡–
	g$this
->
	gID
 ) {

981 i‡–! 
	g$this
->
	gblIsLﬂded
 ) {

982 i‡–! 
	g$this
->
Lﬂd
() ) {

983 
ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿesi°êªgi°rÿ['.
$this
->
ID
.']','ERROR');

984  
	gFALSE
;

991 i‡–
is£t
(
$_POST
[
$this
->
DeföeTabÀName
().'_guardar']) ) {

992 
	g$this
->
	gacci⁄
 = 'guardando';

993 } 
ñ£if
 ( 
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_ö£π¨']Ë&& $this->
≥rmisos
 ) {

994 
	g$this
->
	gacci⁄
 = 'insertar';

995 } 
ñ£if
 ( 
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_accio_galeria']) && $_REQUEST[$this->DefineTableName().'_accio_galeria'] == 'agafa_imatge' ) {

996 
$this
->
acci⁄
 = 'agafa_imatge';

997 } 
ñ£if
 ( 
is£t
(
$_SESSION
['RESPUESTA_ERRONEA']Ë|| is£t(
$_POST
[
$this
->
DeföeTabÀName
().'_formulario'])) {

998 
	g$this
->
	gacci⁄
 = 'con_errores';

999 } 
ñ£if
 ( 
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_accion']) && $_REQUEST[$this->DefineTableName().'_accion'] == 'ver') {

1000 
$this
->
acci⁄
 = 'ver';

1001 } 
ñ£if
 ( 
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_accion']) && $_REQUEST[$this->DefineTableName().'_accion'] == 'eliminar') {

1002 
$this
->
acci⁄
 = 'eliminar';

1003 } 
ñ£if
 ( 
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_accion']) && $_REQUEST[$this->DefineTableName().'_accion'] == 'editar') {

1004 
$this
->
acci⁄
 = 'editar';

1005 } 
ñ£if
 ( 
$acci⁄_dúe˘a
 ) {

1006 
	g$this
->
	gacci⁄
 = 
$acci⁄_dúe˘a
;

1008 i‡–
is£t
(
$_REQUEST
[
$this
->
DeföeTabÀName
().'_id']) ) {

1009 
	g$this
->
	gacci⁄
 = 'ver';

1011 
	g$this
->
	gacci⁄
 = 'inicio';

1022 i‡–
	g$this
->
	gacci⁄
 ='agaÁ_im©ge' ) 
$this
->
gÆîü
->
öicü
();

1024 i‡–
	g$this
->
	gacci⁄
 == 'guardando' ) {

1026 
$sﬁicôud
 = 
√w
 
Sﬁicôud
();

1027 
	g$sﬁicôud
->
SëRedúe˘OnC⁄°øötFaûuª
(
åue
);

1028 
	g$_SESSION
['VALORES'] = 
$sﬁicôud
->
GëP¨amëîs
();

1030 i‡–
is£t
(
$this
->
ª°ricci⁄es
Ë&& ! 
em±y
($this->restricciones) ) {

1031 
	g$c⁄è
=0;

1032 
f‹óch
 ( 
$this
->
ª°ricci⁄es
(Ë
as
 
$ˇmpo
 => 
$ª°ricci⁄
 ) {

1033 
f‹óch
 ( 
$ª°ricci⁄
 
as
 
$tùo
 => 
$vÆ‹
 ) {

1034 
$ª°ricci⁄es
[
$c⁄è
] = 
√w
 
Re°ricci⁄es
(
$tùo
, 
$vÆ‹
);

1035 
	g$sﬁicôud
->
AddC⁄°øöt
(
$ˇmpo
, 
ENTRADAS_POST
, 
$ª°ricci⁄es
[
$c⁄è
]);

1036 
	g$c⁄è
++;

1041 
	g$sﬁicôud
->
Te°C⁄°øöts
();

1047 
	g$ªsu…ado
 = 
$_POST
;

1049 i‡–
	g$ªsu…ado
 ) {

1051 
f‹óch
 ( 
$this
->
¨Rñ©i⁄M≠
 
as
 
$ˇmpo
 => 
$rCampo
 ) {

1053 i‡–
is£t
(
$this
->
ID
Ë&& 
$ˇmpo
 == 'fecha_creacion' ) {

1054 
$this
->
SëAc˚ss‹
(
$rCampo
, 
d©e
("Y-m-d H:i:s"));

1058 i‡–
	g$ˇmpo
 == 'fecha_modificacion' ) {

1059 
$this
->
SëAc˚ss‹
(
$rCampo
, 
d©e
("Y-m-d H:i:s"));

1065 i‡–
	g$ˇmpo
 ='∑ss_md5' && !
em±y
(
$ªsu…ado
[
$ˇmpo
]) ) {

1066 
$this
->
SëAc˚ss‹
(
$rCampo
, 
md5
(
$ªsu…ado
[
$ˇmpo
]));

1073 i‡–
	g$ˇmpo
 ='∑ss_md5' && 
em±y
(
$ªsu…ado
[
$ˇmpo
]) ) {

1074 
$this
->
DñAc˚ss‹
(
$rCampo
);

1078 i‡–
	g$ˇmpo
 !
¨øy_£¨ch
('ID',
$this
->
¨Rñ©i⁄M≠
) ) {

1079 i‡(
gë_magic_quŸes_gpc
() == 1) {

1080 
$this
->
SëAc˚ss‹
(
$rCampo
, 
°rù¶ashes
(
$ªsu…ado
[
$ˇmpo
]));

1082 
	g$this
->
SëAc˚ss‹
(
$rCampo
, 
$ªsu…ado
[
$ˇmpo
]);

1089 i‡–
	g$this
->
ßve
() ) {

1093 
	g$this
->
	gacci⁄
 = ( 
is£t
(
$this
->
ID
) ) ? 'modificando' : 'insertando';

1095 
	g$this
->
	gID
 = ( 
is£t
(
$this
->
ID
ËË? $this->ID : $this->
u…imo_idítifiˇd‹
();

1099 i‡–
	g$this
->
	gevíto_gu¨d¨
 && $this->
	gacci⁄
 == 'insertando' ) {

1100 
$mëodo
 = 
$this
->
evíto_gu¨d¨
;

1101 
	g$this
->
$mëodo
(
$this
->
ID
);

1103 i‡–
	g$this
->
	gevíto_modifiˇr
 && $this->
	gacci⁄
 == 'modificando' ) {

1104 
$mëodo
 = 
$this
->
evíto_modifiˇr
;

1105 
	g$this
->
$mëodo
(
$this
->
ID
);

1108 i‡–
	g$this
->
	ggÆîü
 ) $this->gÆîü->
gu¨d¨
(
$this
->
ID
);

1110 
	g$mís
 = ( 
$this
->
acci⁄
 == 'modificando' ) ? 'Registro modificado' : 'Registro incluido';

1111 
ªgi°ør
(
__FILE__
,
__LINE__
,
lôîÆ
(
$mís
,3),'AVISO');

1112 
un£t
(
$_SESSION
['VALORES']);

1114 
ªgi°ør
(
__FILE__
,
__LINE__
,'ERRORálá√±adir o modificarÑegistro','ERROR');

1119 
	g$_SESSION
['dh'] = 
$di•œyHash
;

1120 
	g$_SESSION
['mís'] = 
$gcm
->
ªg
->
£si⁄
;

1121 
	g$ªdúecci⁄
 = 
$_SERVER
['REDIRECT_URL'];

1122 
hódî
("Loˇti⁄: ".
$ªdúecci⁄
);

1123 
exô
(0);

1127 } 
ñ£if
 ( 
$this
->
acci⁄
 == 'con_errores' ) {

1129 
$sﬁicôud
 = 
√w
 
Sﬁicôud
();

1130 
	g$¥obÀmas
 = (
$sﬁicôud
->
IsRedúe˘FﬁlowögC⁄°øötFaûuª
());

1131 
	g$di•œyHash
['HADPROBLEMS'] = 
$¥obÀmas
;

1133 i‡–
	g$¥obÀmas
 ) {

1135 
	g$objFaûögReque°
 = 
$sﬁicôud
->
GëOrigöÆReque°Obje˘FﬁlowögC⁄°øötFaûuª
();

1136 
	g$¨C⁄°øötFaûuªs
 = 
$objFaûögReque°
->
GëC⁄°øötFaûuªs
();

1138 
	g$di•œyHash
["PROBLEMS"] = 
Aºay
();

1140 
	g$míßjes_îr‹
 = 
$this
->
míßjes
();

1142 
	g$i
=0; $i<=(
$¨C⁄°øötFaûuªs
)-1; $i++) {

1144 
	g$objThisC⁄°øötFaûuª
 = &
$¨C⁄°øötFaûuªs
[
$i
];

1145 
	g$objThisFaûögC⁄°øötObje˘
 = 
$objThisC⁄°øötFaûuª
->
GëFaûedC⁄°øötObje˘
();

1146 
	g$ötTy≥OfFaûuª
 = 
$objThisFaûögC⁄°øötObje˘
->
GëC⁄°øötTy≥
();

1147 
	g$nombª_∑ømëro
 = 
$¨C⁄°øötFaûuªs
[
$i
]->
GëP¨amëîName
();

1149 i‡–
is£t
(
$míßjes_îr‹
[
$nombª_∑ømëro
][
$ötTy≥OfFaûuª
]) ) {

1150 
	g$di•œyHash
["PROBLEMS"][
$nombª_∑ømëro
] = 
$míßjes_îr‹
[$nombª_∑ømëro][
$ötTy≥OfFaûuª
];

1152 
	g$di•œyHash
["PROBLEMS"][
$nombª_∑ømëro
] = "Error sin definir";

1157 i‡–
is£t
(
$_SESSION
['VALORES']) ) {

1158 
	g$di•œyHash
['VALORES'] = 
$_SESSION
['VALORES'];

1159 
un£t
(
$_SESSION
['VALORES']);

1164 
	g$this
->
gíî¨_f‹muœrio
(
$di•œyHash
);

1165 
	g$this
->
bŸ⁄es_acci⁄es
(
$this
->
acci⁄
);

1167 } 
ñ£if
 ( 
$this
->
acci⁄
 == 'ver' ) {

1169 i‡–! 
$this
->
ID
 ) {

1170 
ªgi°ør
(
__FILE__
,
__LINE__
,'NoÉxisteÑegistro','ERROR');

1171  
	gFALSE
;

1174 
	g$this
->
visuÆiz¨_ªgi°ro
();

1175 
	g$this
->
bŸ⁄es_acci⁄es
(
$this
->
acci⁄
);

1177 } 
ñ£if
 ( 
$this
->
acci⁄
 == 'eliminar' ) {

1179 i‡–! 
$this
->
ID
 ) {

1180 
ªgi°ør
(
__FILE__
,
__LINE__
,'NoÉxisteÑegistro','ERROR');

1181  
	gFALSE
;

1185 i‡–
	g$this
->
	gevíto_b‹ør
 ) {

1186 
	g$mëodo
 = 
$this
->
evíto_b‹ør
;

1187 
	g$this
->
$mëodo
(
$this
->
ID
);

1190 
	g$this
->
M¨kF‹Dñëi⁄
();

1191 
	g$this
->
__de°ru˘
();

1193 
ªgi°ør
(
__FILE__
,
__LINE__
,"RegistroÉliminado",'AVISO');

1194 
hódî
("Loˇti⁄: ".
$_SERVER
['REDIRECT_URL']);

1195 
exô
(0);

1197 } 
ñ£if
 ( 
$this
->
acci⁄
 == 'editar' ) {

1199 
$this
->
gíî¨_f‹muœrio
();

1200 
	g$this
->
bŸ⁄es_acci⁄es
(
$this
->
acci⁄
);

1202 } 
ñ£if
 ( 
$this
->
acci⁄
 == 'insertar' ) {

1204 
$this
->
gíî¨_f‹muœrio
(
NULL
);

1205 
	g$this
->
bŸ⁄es_acci⁄es
(
$this
->
acci⁄
);

1209 
	g$this
->
li°ado
(
$c⁄dici⁄
, 
$‹dî
);

1210 
	g$this
->
bŸ⁄es_acci⁄es
(
$this
->
acci⁄
);

1220 
fun˘i⁄
 
	$bŸ⁄es_acci⁄es
(
$acci⁄
) {

1223 i‡–! 
$this
->
≥rmisos
 )  ;

1226 i‡–!
	`is£t
(
$_REQUEST
['formato']) || $_REQUEST['formato'] != 'ajax' ) {

1228 
echo
 '<div class="botones_acciones">';

1231 i‡–
$this
->
acci⁄
 == "ver" || $this->accion == "inicio" ) {

1232 
echo
 '<®˛ass="f‹muœri2 bŸ⁄" hªf="?'.
$this
->
	`DeföeTabÀName
().'_ö£π¨=1">'.
	`lôîÆ
('Insertar',3).' </a>&nbsp;';

1236 i‡–
$this
->
acci⁄
 !"edô¨" && $this->
ID
 ) {

1237 
echo
 ' <®˛ass="f‹muœri2 bŸ⁄" hªf="?'.
$this
->
	`DeföeTabÀName
().'_acci⁄Ûdô¨&'.$this->DeföeTabÀName().'_id='.$this->
ID
.'">'.
	`lôîÆ
('Editar',3).' </a>&nbsp;';

1241 i‡–
$this
->
ID
 ) {

1242 
echo
 ' <®⁄˛ick="ªtu∫ c⁄fúm(\''.
	`lôîÆ
('C⁄fúm¨ b‹ødo').'\');" id="a_ñimö¨_'.
$this
->
	`DeföeTabÀName
().'" cœss="f‹muœri2 bŸ⁄" hªf="?'.$this->DeföeTabÀName().'_acci⁄Ûlimö¨&'.$this->DeföeTabÀName().'_id='.$this->
ID
.'">'.literal('Borrar',3).' </a>&nbsp;';

1246 i‡–
$this
->
acci⁄
 == "editar" || $this->accion == 'insertar' ) {

1247 
echo
 ' <®˛ass="f‹muœri2 bŸ⁄" hªf="'.
$_SERVER
['PHP_SELF'].'">'.
	`lôîÆ
('Cancelar',3).' </a> ';

1250 
echo
 '</div>';

1253 
	}
}

1261 
fun˘i⁄
 
	$li°ado
(
$c⁄dici⁄
 = 
FALSE
, 
$‹dî
 = FALSE) {

1263 
$sql
 = ( 
	`is£t
(
$this
->
sql_li°ado
ËË? $this->sql_li°adÿ: 'SELECT * FROM '.$this->
°rTabÀName
;

1267 i‡–
$c⁄dici⁄
 ) {

1269 i‡–
	`°rùos
(
$sql
,'GROUP'Ë!=
FALSE
 ) {

1270 
$sql
 = 
	`°r_úïœ˚
('GROUP',' WHERE '.
$c⁄dici⁄
.' GROUP', $sql);

1272 
$sql
 .' WHERE '.
$c⁄dici⁄
 ;

1277 
$‹dî
 = ( $‹dî ) ? ' ORDER BY '.$‹dî : ' ORDER BY '.
	`¨øy_£¨ch
('ID',
$this
->
¨Rñ©i⁄M≠
).' desc';

1279 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/paginarPDO.php');

1281 
$this
->
ñemítos
 = ( $this->
ñemítos_∑göa
 ) ? $this->ñemítos_∑gö®: 
NULL
;

1283 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
objPDO
, 
$sql
, $this->
°rTabÀName
.'_', $this->
ñemítos_∑göa
, 
$‹dî
, $this->
sql_li°ado_ªœci⁄
);

1286 i‡–
$this
->
c⁄f_∑göad‹
 ) {

1287 
	`f‹óch
(
$this
->
c⁄f_∑göad‹
 
as
 
$©r
 => 
$vÆ‹
 ) {

1288 
$pd
->
$©r
 = 
$vÆ‹
;

1292 i‡–
$pd
->
	`vÆid¨
() ) {

1294 i‡–
$this
->
≥rmisos
 ) {

1295 
$›ci⁄es
 = 
	`¨øy
(

1296 'uæ' => '?'.
$this
->
	`DeföeTabÀName
().'_id='

1301 ,'acci⁄' => 
$this
->
	`DeföeTabÀName
().'_accion'

1303 ,'dú_img' => ( 
$this
->
dú_img_¨øy2èbÀ
 ) ? $this->dú_img_¨øy2èbÀ : 
NULL


1306 
$›ci⁄es
 = 
	`¨øy
(

1307 'uæ' => '?'.
$this
->
	`DeföeTabÀName
().'_id='

1310 ,'acci⁄' => 
$this
->
	`DeföeTabÀName
().'_accion'

1312 ,'dú_img' => ( 
$this
->
dú_img_¨øy2èbÀ
 ) ? $this->dú_img_¨øy2èbÀ : 
NULL


1317 i‡–
	`is£t
(
$this
->
›ci⁄es_¨øy2èbÀ
['op']) )

1318 
$›ci⁄es
 = 
	`¨øy_mîge
($›ci⁄es, 
$this
->
›ci⁄es_¨øy2èbÀ
['op']);

1322 
$¥e£¡aci⁄
 = ( 
	`is£t
(
$this
->
›ci⁄es_¨øy2èbÀ
['presentacion']) ) ?

1323 
$this
->
›ci⁄es_¨øy2èbÀ
['presentacion'] :

1326 
$pd
->
	`gíî¨_∑göa
(
$this
->
uæ_ajax
, 
$›ci⁄es
, 
$¥e£¡aci⁄
);

1329 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Tabla sin contenido",'AVISO');

1332 
	}
}

	@gcm/lib/int/databoundobject/lib/DataBoundObject.php

1 <?
php


28 
ab°ø˘
 cœs†
	cD©aBoundObje˘
 {

30 
¥Ÿe˘ed
 
	m$ID
;

31 
¥Ÿe˘ed
 
	m$objPDO
;

32 
¥Ÿe˘ed
 
	m$°rTabÀName
;

33 
¥Ÿe˘ed
 
	m$¨Rñ©i⁄M≠
;

34 
¥Ÿe˘ed
 
	m$blF‹Dñëi⁄
;

35 
¥Ÿe˘ed
 
	m$blIsLﬂded
;

36 
¥Ÿe˘ed
 
	m$¨ModifõdRñ©i⁄s
;

46 
¥Ÿe˘ed
 
	m$ˇmpos_ödi˚s
 = 
¨øy
();

52 
¥Ÿe˘ed
 
	m$vÆ‹es
;

58 
ab°ø˘
 
¥Ÿe˘ed
 
fun˘i⁄
 
DeföeTabÀName
();

64 
ab°ø˘
 
¥Ÿe˘ed
 
fun˘i⁄
 
DeföeRñ©i⁄M≠
(
$objPDO
);

72 
fun˘i⁄
 
	$com¥ob¨_ödi˚s
() {

74 
$ˇmpo_ödi˚
 = 
	`¨øy_£¨ch
('ID',
$this
->
¨Rñ©i⁄M≠
);

76 
$this
->
ˇmpos_ödi˚s
 = 
	`ex∂ode
(",",
$ˇmpo_ödi˚
);

89 
public
 
fun˘i⁄
 
	$__c⁄°ru˘
(
PDO
 
$objPDO
, 
$id
 = 
NULL
) {

91 
$this
->
°rTabÀName
 = $this->
	`DeföeTabÀName
();

92 
$this
->
¨Rñ©i⁄M≠
 = $this->
	`DeföeRñ©i⁄M≠
(
$objPDO
);

93 
$this
->
objPDO
 = 
$objPDO
;

94 
$this
->
blIsLﬂded
 = 
Ál£
;

95 i‡(
	`is£t
(
$id
)Ë
$this
->
ID
 = $id;

96 
$this
->
¨ModifõdRñ©i⁄s
 = 
	`¨øy
();

97 
$this
->
	`com¥ob¨_ödi˚s
();

99 
	}
}

105 
public
 
fun˘i⁄
 
	$Lﬂd
() {

107 i‡(
	`is£t
(
$this
->
ID
)) {

109 
$ödi˚s
 = 
	`ex∂ode
(",",
$this
->
ID
);

111 
$°rQuîy
 = "SELECT ";

112 
	`f‹óch
 (
$this
->
¨Rñ©i⁄M≠
 
as
 
$key
 => 
$vÆue
) {

113 i‡–
$vÆue
 == 'ID' ) {

114 
$°rQuîy
 .
$key
 . ",";

116 
$°rQuîy
 .'`'.
$key
 . "`,";

119 
$°rQuîy
 = 
	`sub°r
($°rQuîy, 0, 
	`°æí
($strQuery)-1);

120 
$°rQuîy
 ." FROM " . 
$this
->
°rTabÀName
 . " WHERE ";

122 
$c⁄dici⁄
 = "";

123 
$c⁄è
 = 0;

124 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

128 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

129 
$c⁄dici⁄
 .
$ödi˚
. "=:".$indice." AND ";

132 
$c⁄è
++;

135 
$c⁄dici⁄
 = 
	`πrim
($condicion,"AND ");

137 
$°rQuîy
 .
$c⁄dici⁄
;

139 
$objSèãmít
 = 
$this
->
objPDO
->
	`¥ï¨e
(
$°rQuîy
);

141 
$c⁄è
 = 0;

142 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

145 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

146 
$objSèãmít
->
	`bödP¨am
(':'.
$ödi˚
, 
$ödi˚s
[
$c⁄è
],

147 
PDO
::
PARAM_INT
);

149 
$c⁄è
++;

152 
$objSèãmít
->
	`execuã
();

153 
$¨Row
 = 
$objSèãmít
->
	`„tch
(
PDO
::
FETCH_ASSOC
);

155 i‡–! 
$¨Row
 ) {

156 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿexi°êªgi°rÿ['.
$this
->
ID
.']É¿['.$this->
°rTabÀName
.']'."\nsql: ".
$°rQuîy
,'ADMIN');

157 
$this
->
ID
 = 
FALSE
;

158  
FALSE
;

161 
	`f‹óch
(
$¨Row
 
as
 
$key
 => 
$vÆue
) {

165 i‡–
	`ö_¨øy
(
$key
,
$this
->
ˇmpos_ödi˚s
) ) {

166 
$°rMembî
 = 
$key
;

167 
$this
->
vÆ‹es
[
$°rMembî
] = 
$vÆue
;

169 
$°rMembî
 = 
$this
->
¨Rñ©i⁄M≠
[
$key
];

170 
$this
->
vÆ‹es
[
$°rMembî
] = 
$vÆue
;

174 
$this
->
blIsLﬂded
 = 
åue
;

175  
TRUE
;

177 
	}
}

183 
public
 
fun˘i⁄
 
	$Save
() {

185 
$debug
 = '';

187 
$ödi˚s
 = 
	`ex∂ode
(",",
$this
->
ID
);

189 i‡(
	`is£t
(
$this
->
ID
)) {

191 
$°rQuîy
 = 'UPDATE ' . 
$this
->
°rTabÀName
 . ' SET ';

193 
$ßlida
 = 
FALSE
;

194 
	`f‹óch
 (
$this
->
¨Rñ©i⁄M≠
 
as
 
$key
 => 
$vÆue
) {

196 
$a˘uÆVÆ
 = ( 
	`is£t
(
$this
->
vÆ‹es
[
$vÆue
]ËË? $this->vÆ‹es[$vÆue] : 
NULL
 ;

197 i‡(
	`¨øy_key_exi°s
(
$vÆue
, 
$this
->
¨ModifõdRñ©i⁄s
)) {

198 
$ßlida
 .
$key
 . " = :$value, ";

203 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

204 
$c⁄è
 = 0;

205 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

206 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

207 
$ßlida
 .
$ödi˚
. "=:post_".$indice.", ";

209 
$c⁄è
++;

213 i‡–
$ßlida
 ) 
$°rQuîy
 .
	`sub°r
($ßlida, 0, 
	`°æí
($salida)-2);

215 
$c⁄dici⁄
 = " WHERE ";

216 
$c⁄è
 = 0;

217 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

221 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

222 
$c⁄dici⁄
 .
$ödi˚
. "=:".$indice." AND ";

225 
$c⁄è
++;

228 
$c⁄dici⁄
 = 
	`πrim
($condicion,"AND ");

230 
$°rQuîy
 .
$c⁄dici⁄
;

232 
	`un£t
(
$objSèãmít
);

233 
$objSèãmít
 = 
$this
->
objPDO
->
	`¥ï¨e
(
$°rQuîy
);

235 
$c⁄è
 = 0;

236 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

239 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

240 
$objSèãmít
->
	`bödP¨am
(':'.
$ödi˚
, 
$ödi˚s
[
$c⁄è
],

241 
PDO
::
PARAM_INT
);

243 
$c⁄è
++;

247 
	`f‹óch
 (
$this
->
¨Rñ©i⁄M≠
 
as
 
$key
 => 
$vÆue
) {

249 
$a˘uÆVÆ
 = ( 
	`is£t
(
$this
->
vÆ‹es
[
$vÆue
]ËË? $this->vÆ‹es[$vÆue] : 
NULL
 ;

251 i‡(
	`¨øy_key_exi°s
(
$vÆue
, 
$this
->
¨ModifõdRñ©i⁄s
)) {

253 i‡((
	`is_öt
(
$a˘uÆVÆ
))) {

254 
$debug
 .= "\nNumero: $value : $actualVal";

255 
$objSèãmít
->
	`bödVÆue
(':' . 
$vÆue
, 
$a˘uÆVÆ
,

256 
PDO
::
PARAM_INT
);

258 i‡–
	`em±y
(
$a˘uÆVÆ
) ) $actualVal = '';

259 
$debug
 .= "\nCadena: $value : $actualVal";

260 
$objSèãmít
->
	`bödVÆue
(':' . 
$vÆue
, 
$a˘uÆVÆ
,

261 
PDO
::
PARAM_STR
);

267 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

268 
$c⁄è
 = 0;

269 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

270 i‡–
	`is£t
(
$_POST
[
$ödi˚
]) ) {

271 
$objSèãmít
->
	`bödVÆue
(':po°_' . 
$ödi˚
, 
$_POST
[$indice],

272 
PDO
::
PARAM_INT
);

274 
$c⁄è
++;

278 
åy
 {

280 
$objSèãmít
->
	`execuã
();

282 } 
	`ˇtch
 (
PDOEx˚±i⁄
 
$e
) {

284 
$msg
 = 
$e
->
	`gëMesßge
();

285 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$msg
,'ADMIN');

286  
FALSE
;

289  
TRUE
;

293 i‡–
$this
->
	`drivîPDO
() == 'mysql' ) {

294 
$this
->
ID
 = 
NULL
;

296 
$this
->
ID
 = $this->
	`u…imo_idítifiˇd‹
() + 1;

298 
$°rVÆueLi°
 = "";

299 i‡–
$this
->
	`drivîPDO
() == 'mysql' ) {

300 
$°rQuîy
 = 'INSERT INTO ' . 
$this
->
°rTabÀName
 . ' ( ';

302 
$°rQuîy
 = 'INSERT INTO ' . 
$this
->
°rTabÀName
 . ' ( '.
	`¨øy_£¨ch
('ID',$this->
¨Rñ©i⁄M≠
).',';

306 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

307 
$c⁄è
 = 0;

308 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

309 i‡–
	`is£t
(
$_POST
[
$ödi˚
]) ) {

311 
$°rQuîy
 .
$ödi˚
 . ', ';

312 
$°rVÆueLi°
 .= ":post_$indice, ";

314 
$c⁄è
++;

319 
	`f‹óch
 (
$this
->
¨Rñ©i⁄M≠
 
as
 
$key
 => 
$vÆue
) {

321 
$a˘uÆVÆ
 = ( 
	`is£t
(
$this
->
vÆ‹es
[
$vÆue
]ËË? $this->vÆ‹es[$vÆue] : 
NULL
 ;

322 i‡(
	`is£t
(
$a˘uÆVÆ
)) {

323 i‡(
	`¨øy_key_exi°s
(
$vÆue
, 
$this
->
¨ModifõdRñ©i⁄s
)) {

324 
$°rQuîy
 .
$key
 . ', ';

325 
$°rVÆueLi°
 .= ":$value, ";

330 
$°rQuîy
 = 
	`sub°r
($°rQuîy, 0, 
	`°æí
($strQuery) - 2);

331 
$°rVÆueLi°
 = 
	`sub°r
($°rVÆueLi°, 0, 
	`°æí
($strValueList) - 2);

332 i‡–
$this
->
	`drivîPDO
() == 'mysql' ) {

333 
$°rQuîy
 .= ") VALUES ( ";

335 
$°rQuîy
 ."ËVALUES ( ".
$this
->
ID
.",";

337 
$°rQuîy
 .
$°rVÆueLi°
;

338 
$°rQuîy
 .= ")";

340 
	`un£t
(
$objSèãmít
);

342 
$objSèãmít
 = 
$this
->
objPDO
->
	`¥ï¨e
(
$°rQuîy
);

344 
	`f‹óch
 (
$this
->
¨Rñ©i⁄M≠
 
as
 
$key
 => 
$vÆue
) {

346 
$a˘uÆVÆ
 = ( 
	`is£t
(
$this
->
vÆ‹es
[
$vÆue
]ËË? $this->vÆ‹es[$vÆue] : 
NULL
 ;

347 i‡(
	`is£t
(
$a˘uÆVÆ
)) {

348 i‡(
	`¨øy_key_exi°s
(
$vÆue
, 
$this
->
¨ModifõdRñ©i⁄s
)) {

349 i‡((
	`is_öt
(
$a˘uÆVÆ
)Ë|| ($a˘uÆVÆ =
NULL
)) {

350 i‡–! 
$objSèãmít
->
	`bödVÆue
(':' . 
$vÆue
, 
$a˘uÆVÆ
, 
PDO
::
PARAM_INT
) ) {

351 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Errorá√±adiendo datos: [$value] [$actualVal]",'ADMIN');

354 i‡–! 
$objSèãmít
->
	`bödVÆue
(':' . 
$vÆue
, 
$a˘uÆVÆ
, 
PDO
::
PARAM_STR
) ) {

355 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Errorá√±adiendo datos: [$value] [$actualVal]",'ADMIN');

363 i‡–
	`cou¡
(
$this
->
ˇmpos_ödi˚s
) > 1 ) {

364 
$c⁄è
 = 0;

365 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

366 i‡–
	`is£t
(
$_POST
[
$ödi˚
]) ) {

367 
$objSèãmít
->
	`bödVÆue
(':po°_' . 
$ödi˚
, 
$_POST
[$indice],

368 
PDO
::
PARAM_INT
);

370 
$c⁄è
++;

375  
$objSèãmít
->
	`execuã
();

377 
	}
}

383 
public
 
fun˘i⁄
 
	$M¨kF‹Dñëi⁄
() {

384 
$this
->
blF‹Dñëi⁄
 = 
åue
;

385 
	}
}

392 
public
 
fun˘i⁄
 
	$__de°ru˘
() {

394 i‡(
	`is£t
(
$this
->
ID
)) {

396 
$ödi˚s
 = 
	`ex∂ode
(",",
$this
->
ID
);

398 i‡(
$this
->
blF‹Dñëi⁄
 =
åue
) {

400 
$°rQuîy
 = 'DELETE FROM ' . 
$this
->
°rTabÀName
 . ' WHERE ';

402 
$c⁄dici⁄
 = "";

403 
$c⁄è
 = 0;

404 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

408 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

409 
$c⁄dici⁄
 .
$ödi˚
. "=:".$indice." AND ";

412 
$c⁄è
++;

415 
$c⁄dici⁄
 = 
	`πrim
($condicion,"AND ");

416 
$°rQuîy
 .
$c⁄dici⁄
;

420 
$objSèãmít
 = 
$this
->
objPDO
->
	`¥ï¨e
(
$°rQuîy
);

422 
$c⁄è
 = 0;

423 
	`f‹óch
 ( 
$this
->
ˇmpos_ödi˚s
 
as
 
$ödi˚
 ) {

426 i‡–
	`is£t
(
$ödi˚s
[
$c⁄è
]) ) {

427 
$objSèãmít
->
	`bödP¨am
(':'.
$ödi˚
, 
$ödi˚s
[
$c⁄è
],

428 
PDO
::
PARAM_INT
);

430 
$c⁄è
++;

433 
åy
 {

434 
$objSèãmít
->
	`execuã
();

435 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

436 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Eº‹ c⁄ BD: '.
$ex
->
	`gëMesßge
(),'ERROR');

440 
	}
}

449 
public
 
fun˘i⁄
 
	$__ˇŒ
(
$°rFun˘i⁄
, 
$¨Argumíts
) {

451 
$°rMëhodTy≥
 = 
	`sub°r
(
$°rFun˘i⁄
, 0, 3);

452 
$°rMëhodMembî
 = 
	`sub°r
(
$°rFun˘i⁄
, 3);

453 
$°rMëhodTy≥
) {

455 (
$this
->
	`SëAc˚ss‹
(
$°rMëhodMembî
, 
$¨Argumíts
[0]));

458 (
$this
->
	`GëAc˚ss‹
(
$°rMëhodMembî
));

460 (
Ál£
);

461 
	}
}

470 
fun˘i⁄
 
	$SëAc˚ss‹
(
$°rMembî
, 
$°rNewVÆue
) {

471 i‡–
$°rMembî
 == 'ID' ) $strMember = 'id';

472 
$this
->
vÆ‹es
[
$°rMembî
] = 
$°rNewVÆue
;

473 
$this
->
¨ModifõdRñ©i⁄s
[
$°rMembî
] = "1";

474 
	}
}

482 
fun˘i⁄
 
	$GëAc˚ss‹
(
$°rMembî
) {

483 i‡(
$this
->
blIsLﬂded
 !
åue
) {

484 
$this
->
	`Lﬂd
();

486 i‡–
$°rMembî
 == 'ID' ) $strMember = 'id';

487  ( 
	`is£t
(
$this
->
vÆ‹es
[
$°rMembî
]ËË? $this->vÆ‹es[$°rMembî] : 
FALSE
 ;

488 
	}
}

500 
fun˘i⁄
 
	$DñAc˚ss‹
(
$°rMembî
) {

501 i‡–
$°rMembî
 == 'ID' ) $strMember = 'id';

502 i‡–
	`is£t
(
$this
->
vÆ‹es
[
$°rMembî
]ËË
	`un£t
($this->valores[$strMember]);

504 
	}
}

510 
public
 
fun˘i⁄
 
	$u…imo_idítifiˇd‹
() {

512  
$this
->
	`drivîPDO
() ) {

515 
$sql
 = "£À˘ id from ".
$this
->
°rTabÀName
." order by id descÜimit 1;";

516 
$ªsu…
 = 
$this
->
objPDO
->
	`quîy
(
$sql
)->
	`„tch
(
PDO
::
FETCH_ASSOC
);

517 
$id
 = 
$ªsu…
['id'];

521 
$id
 = 
$this
->
objPDO
->
	`œ°I£πId
($this->
°rTabÀName
 . "_id_seq");

525 
$id
 = 
$this
->
objPDO
->
	`œ°In£πId
();

530  
$id
;

531 
	}
}

537 
fun˘i⁄
 
	$drivîPDO
() {

538  
$this
->
objPDO
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

539 
	}
}

551 
fun˘i⁄
 
	$föd
(
$c⁄dici⁄
=
NULL
, 
$ˇmpos
=NULL, 
$‹dí
=NULL) {

553 
$ªt‹no
 = 
	`¨øy
();

555 i‡–
$ˇmpos
 ) {

556 
$£Àcci⁄
 = '';

557 
$x
=0; $x<=
	`cou¡
(
$ˇmpos
)-1; $x++) {

558 
$£Àcci⁄
 .= " $campos[$x]";

559 i‡–
$x
 < 
	`cou¡
(
$ˇmpos
)-1 ) 
$£Àcci⁄
 .= ',';

562 
$£Àcci⁄
 = '*';

565 
$sql
 = "Sñe˘ $£Àcci⁄ from ".
$this
->
°rTabÀName
;

567 i‡–
$c⁄dici⁄
 ) 
$sql
 .= " WHERE $condicion";

569 i‡–
	`is£t
(
$‹dí
ËË
$sql
 .= " ORDER BY ".$orden;

571 
$objSèãmít
 = 
$this
->
objPDO
->
	`¥ï¨e
(
$sql
);

572 
$objSèãmít
->
	`execuã
();

574 
$¨AŒ
 = 
$objSèãmít
->
	`„tchAŒ
(
PDO
::
FETCH_ASSOC
);

576 
$c⁄è
 = 0;

577 
	`f‹óch
 ( 
$¨AŒ
 
as
 
$¨Row
 ) {

578 
	`f‹óch
(
$¨Row
 
as
 
$key
 => 
$vÆue
) {

579 
$ªt‹no
[
$c⁄è
][
$key
] = 
$vÆue
;

581 
$c⁄è
++;

584  ( 
	`em±y
(
$ªt‹no
ËË? 
FALSE
 : $retorno;

586 
	}
}

593 
public
 
fun˘i⁄
 
	$li°ado_∑ø_£À˘
() {

595  
$this
->
	`föd
(
nuŒ
,
	`¨øy
('id', 'nombre'),'id desc');

597 
	}
}

	@gcm/lib/int/databoundobject/lib/Formulario.php

1 <?
php


119 ˛as†
	cF‹muœrio
 {

123 
public
 
	m$∂™tûœ
;

127 
public
 
	m$∂™tûœ_visuÆiz¨
;

131 
public
 
	m$css
 = 
FALSE
;

135 
¥Ÿe˘ed
 
	m$ˇmpos
;

139 
¥Ÿe˘ed
 
	m$di•œyHash
;

143 
¥Ÿe˘ed
 
	m$ª°ricci⁄es
;

147 
¥Ÿe˘ed
 
	m$míßjes
;

158 
fun˘i⁄
 
	$__c⁄°ru˘
(
$ˇmpos
, 
$di•œyHash
=
NULL
, 
$ª°ricci⁄es
=
FALSE
, 
$míßjes
=FALSE) {

160 
$this
->
ª°ricci⁄es
 = 
$ª°ricci⁄es
;

161 
$this
->
míßjes
 = 
$míßjes
;

162 
$this
->
ˇmpos
 = 
$ˇmpos
;

163 
$this
->
di•œyHash
 = 
$di•œyHash
;

165 
$this
->
∂™tûœ
 = 
	`dú«me
(
__FILE__
).'/../html/form_registro.html';

166 
$this
->
∂™tûœ_visuÆiz¨
 = 
	`dú«me
(
__FILE__
).'/../html/registro.html';

168 
$this
->
css
 = 
	`dú«me
(
__FILE__
).'/../css/formulario.css';

171 
	`uas‹t
(
$this
->
ˇmpos
, 'ordenar_por_peso');

181 
fun˘i⁄
 
	$vÆ‹es
(
$ˇmpo
) {

183  ( 
	`is£t
(
$this
->
ˇmpos
[
$ˇmpo
]['vÆ‹']ËË? $this->ˇmpos[$ˇmpo]['vÆ‹'] : 
NULL
 ;

185 
	}
}

194 
fun˘i⁄
 
gíîa_f‹muœrio
(
$vî
 = 
FALSE
, 
$acci⁄
 = 'insertando') {

196 i‡–
$vî
 ) {

197 
$∂™tûœ
 = 
$this
->
∂™tûœ_visuÆiz¨
;

199 
	g$∂™tûœ
 = 
$this
->
∂™tûœ
;

202 i‡(! 
fûe_exi°s
(
$∂™tûœ
) ) {

203 
throw
 
√w
 
Ex˚±i⁄
('Nÿ£Énc⁄åÿ∂™tûœ: '.
$∂™tûœ
);

206 
ªquúe
(
$∂™tûœ
);

208 i‡–
	g$this
->
	gcss
 && ! 
em±y
(
$this
->
css
) ) {

210 i‡–! 
fûe_exi°s
(
$this
->
css
) ) {

211 
ªgi°ør
(
__FILE__
,
__LINE__
,'Archivÿc⁄ cs†nÿíc⁄åadÿ['.
$this
->
css
.']','ERROR');

214 <
	g°yÀ
>

215 <?
php
 
ªquúe
(
$this
->
css
); ?>

216 </
	g°yÀ
>

217 <?
	gphp


223 <
	gs¸ùt
>

224 <?
php
 
ªquúe
(
dú«me
(
__FILE__
).'/../js/validate.js'); ?>

225 
v¨
 
	gvÆid©‹
 = 
√w
 
F‹mVÆid©‹
('¸ud', [<?
php
 
echo
 
$this
->
¸ór_ª°ricci⁄es
();?>], 
fun˘i⁄
(
îr‹s
, 
evíts
) {

226 i‡(
îr‹s
.
Àngth
 > 0) {

231 
ßlida
 = 
îr‹s
.
joö
("\n");

232 
Æît
(
ßlida
);

235 <?=
$this
->
¸ór_míßjes
();?>

236 </
	gs¸ùt
>

237 <?
	gphp


248 
fun˘i⁄
 
	$¸ór_míßjes
() {

250 
$mí
= "";

252 i‡–
	`is£t
(
$this
->
míßjes
) ) {

253 
	`f‹óch
 ( 
$this
->
míßjes
 
as
 
$ˇmpo
 => 
$míßjes
 ) {

255 
	`f‹óch
 ( 
$míßjes
 
as
 
$ª°ricci⁄
 => 
$míßje
 ) {

257 
$ª°ricci⁄
) {

259 
RT_MAIL
:

260 
$mí
.= "\nvalidator.setMessage('valid_email', '%s $mensaje');";

263 
RT_LONG_MIN
:

264 
$mí
.= "\nvalidator.setMessage('min_length', '%s $mensaje');";

267 
RT_LONG_MAX
:

268 
$mí
.= "\nvalidator.setMessage('max_length', '%s $mensaje');";

279 
RT_MENOR_QUE
:

280 
$mí
.= "\nvalidator.setMessage('greater_than', '%s $mensaje');";

283 
RT_MAYOR_QUE
:

284 
$mí
.= "\nvalidator.setMessage('less_than', '%s $mensaje');";

287 
RT_IGUAL_QUE
:

288 
$mí
.= "\nvalidator.setMessage('matches', '%s $mensaje');";

303 
RT_NO_ES_NUMERO
:

304 
$mí
.= "\nvalidator.setMessage('numeric', '%s $mensaje');";

307 
RT_REQUERIDO
:

308 
$mí
.= "\nvalidator.setMessage('required', '%s $mensaje');";

317 i‡–
	`em±y
(
$mí
ËË 
FALSE
;

319  
$mí
;

321 
	}
}

337 
fun˘i⁄
 
	$¸ór_ª°ricci⁄es
() {

339 
$ßlida
 = "";

341 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
)."/../../solicitud/lib/constantes.php");

343 i‡–
	`is£t
(
$this
->
ª°ricci⁄es
) ) {

345 
	`f‹óch
 ( 
$this
->
ª°ricci⁄es
 
as
 
$ˇmpo
 => 
$ª°ricci⁄es
 ) {

347 
	`f‹óch
 (
$ª°ricci⁄es
 
as
 
$ª°ricci⁄
 => 
$vÆ‹
) {

349 
$ª°ricci⁄
) {

351 
RT_MAIL
:

352 
$ßlida
 .= "{

353 
«me
: '$campo',

354 
ruÀs
: 'valid_email'

358 
RT_LONG_MIN
:

359 
$ßlida
 .= "{

360 
«me
: '$campo',

361 
ruÀs
: 'min_length[$valor]'

365 
RT_LONG_MAX
:

366 
$ßlida
 .= "{

367 
«me
: '$campo',

368 
ruÀs
: 'max_length[$valor]'

386 
RT_MENOR_QUE
:

387 
$ßlida
 .= "{

388 
«me
: '$campo',

389 
ruÀs
: 'greater_than[$valor]'

393 
RT_MAYOR_QUE
:

394 
$ßlida
 .= "{

395 
«me
: '$campo',

396 
ruÀs
: 'less_than[$valor]'

397 
	}
},";

400 
	gRT_IGUAL_QUE
:

401 
$ßlida
 .= "{

402 
«me
: '$campo',

403 
	gruÀs
: 'matches[$valor]'

428 
	gRT_NO_ES_NUMERO
:

429 
$ßlida
 .= "{

430 
«me
: '$campo',

431 
	gruÀs
: 'numeric[$valor]'

435 
	gRT_REQUERIDO
:

436 
$ßlida
 .= "{

437 
«me
: '$campo',

438 
	gruÀs
: 'required'

448 i‡–
	$em±y
(
$ßlida
ËË 
FALSE
;

451 
$ßlida
 = 
	`åim
($salida, ',');

452  
$ßlida
;

454 
	}
}

	@gcm/lib/int/formato/lib/Formato.php

1 <?
php


12 ˛as†
	cF‹m©o
 {

26 
fun˘i⁄
 
li°a_ªcursiva
(
$d©os
, 
$›ci⁄es
 = 
FALSE
, 
$f‹m©o
 = 'html') {

28 
$›
 = 
¨øy
(
$ôem_visibÀ
 = 
FALSE


29 , 
$£Àcci⁄abÀ
 = 
FALSE


30 , 
$checkqued
 = 
FALSE


31 , 
$mu…ùÀ
 = 
FALSE


32 , 
$∂™tûœ
 = 
FALSE


35 i‡–
	m$›ci⁄es
 ) 
	m$›
 = 
¨øy_mîge
(
$›
,
$›ci⁄es
);

40 
	m$ôems_a_desˇπ¨
 = 
$this
->
desˇπ¨
 ;

41 i‡–
	m$ocu…¨
 ) 
	m$ôems_a_desˇπ¨
[] = 
$ocu…¨
;

43 i‡–(
	m$ôems_a_desˇπ¨
) ) {

45 
	m$desˇπ¨
 = 
FALSE
;

46 
f‹óch
 ( 
$ôems_a_desˇπ¨
 
as
 
$desˇπado
 ) {

47 i‡–
°Ωos
(
$∑th
,
$desˇπado
Ë!=
FALSE
 ) {

48 
ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$∑th
. ' coöcidêc⁄ '.
$desˇπado
);

49 
	m$desˇπ¨
 = 
TRUE
;

52 
f‹óch
 ( 
$this
->
fûåo_£cci⁄es
 
as
 
$desˇπado
 ) {

53 i‡–
°Ωos
(
$∑th
,
$desˇπado
Ë!=
FALSE
 ) {

54 
ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$∑th
. ' coöcidêc⁄ '.
$desˇπado
);

55 
	m$desˇπ¨
 = 
TRUE
;

59 i‡–
	m$desˇπ¨
 ) {

64 i‡–
	m$ocu…¨
 ) $ocu…¨ = 
com¥ob¨_b¨ø
(
$ocu…¨
,'eliminar');

65 
	m$∑th
 = 
com¥ob¨_b¨ø
(
$∑th
,'eliminar');

66 
	m$nombª_ˇmpo
 = 'seleccionado[]';

68 i‡–
	m$mu…ùÀ
 ) {

69 
	m$tùo_ˇmpo
 = 'checkbox';

71 
	m$tùo_ˇmpo
 = 'radio';

75 i‡–
	m$checkqued
 ) {

76 
	m$checkqued
 = 
com¥ob¨_b¨ø
(
$checkqued
,'eliminar');

79 
	m$vî
='NO';

81 
	m$dú_p‹_de„˘o
='Fûe/'.
Rouãr
::
$ii
;

82 
	m$d
 = 
dú
(
$∑th
);

83 
	m$HAY
="NO";

84 
	m$sub£cci⁄es
 = 
¨øy
();

85 
	m$documítos
 = 
¨øy
();

86 
	m$íåy
=
$d
->
ªad
()) {

88 i‡(
is_dú
(
$∑th
."/".
$íåy
) && $entry{0} != "." ) {

89 
$HAY
="SI";

90 
	m$sub£cci⁄es
[]=
$∑th
."/".
$íåy
;

91 } 
ñ£if
 ( 
$vîDocumítos
 && 
$íåy
{0} != "." ) {

92 
$documítos
[
$∑th
][]=
$íåy
;

96 
	m$d
->
˛o£
();

99 i‡–
	m$∑th_visibÀ
 ) {

100 
	m$∑th1
 = 
ex∂ode
('/',
$d
->
∑th
);

101 
	m$∑th2
 = 
ex∂ode
('/',
$∑th_visibÀ
);

105 i‡–
ö_¨øy
(
$∑th1
[
cou¡
($∑th1)-1],
$∑th2
) ) {

106 
	m$vî
='SI';

110 
	mecho
 "\n<ul>";

113 i‡––
	m$vî
 ='SI' ) || 
$d
->
∑th
 =
$dú_p‹_de„˘o
) {

115 i‡–
$d
->
∑th
 =
$checkqued
 ) {

116 
echo
 " <öpuàcheckedÅy≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' vÆue='", 
htmÀ¡ôõs
(
$d
->
∑th
), "' />";

117 } 
ñ£if
 ( 
$d
->
∑th
 =
$ocu…¨
 ) {

118 
echo
 "Descartado";

120 
	mecho
 " <öpuàty≥='".
	m$tùo_ˇmpo
."'Çame='".
	m$nombª_ˇmpo
."' vÆue='", 
htmÀ¡ôõs
(
$d
->
∑th
), "' />";

124 
	mecho
 " <öpuàty≥='".
	m$tùo_ˇmpo
."'Çame='".
	m$nombª_ˇmpo
."' vÆue='", 
htmÀ¡ôõs
(
$d
->
∑th
), "' />";

128 i‡–
	m$HAY
 ="SI" || 
$vîDocumítos
) {

129 
echo
 "<®hªf='#' cœss='öãºog™ã' on˛ick=\"visuÆiz¨('",
htmÀ¡ôõs
(
$d
->
∑th
),"');Ñeturn false;\" >";

130 
echo
 
ba£«me
(
$d
->
∑th
);

131 
	mecho
 "</a>";

133 
echo
 
ba£«me
(
$d
->
∑th
);

135 i‡––
	m$vî
 ='SI' ) || 
$d
->
∑th
 =
$dú_p‹_de„˘o
 ) {

136 
echo
 "<div id='",
$d
->
∑th
,"' class='toggle'>";

138 
	mecho
 "<div id='",
	m$d
->
	m∑th
,"' class='toggle' style='display:Çone' >";

142 i‡–
	m$vîDocumítos
 ) {

143 i‡–! 
em±y
(
$documítos
[
$d
->
∑th
]Ë&& 
cou¡
($documentos[$d->path]) > 0 ) {

144 
f‹óch
–
$documítos
[
$d
->
∑th
] 
as
 
$doc
 ) {

145 
	mecho
 '<li>';

146 i‡–
	mGUtû
::
tùo_de_¨chivo
(
$d
->
∑th
.'/'.
$doc
) == 'text/html' ) {

147 
echo
 '<span class="datos_fichero_html">';

149 
	mecho
 '<span class="datos_fichero">';

151 
	mecho
 "<öpuàty≥='".
	m$tùo_ˇmpo
."'Çame='".
	m$nombª_ˇmpo
."' ";

152 
	mecho
 'vÆue="'.
htmÀ¡ôõs
(
$d
->
∑th
."/".
$doc
).'" />';

154 i‡–
esImagí
(
$d
->
∑th
.'/'.
$doc
) ) {

155 
	mecho
 "<imgálign='˚¡î' width='50px' src='".
htmÀ¡ôõs
(
$d
->
∑th
."/".
$doc
)."' />";

157 
	mecho
 '<®tôÀ="'.
lôîÆ
('VisuÆiz¨').'" hªf="?edôÚo&uæ='.
htmÀ¡ôõs
(
$d
->
∑th
.'/'.
$doc
).'">';

158 
echo
 
	m$doc
;

159 
	mecho
 "</a>";

161 i‡–
	mGUtû
::
tùo_de_¨chivo
(
$d
->
∑th
.'/'.
$doc
) == 'text/html' ) {

162 
echo
 '<®tôÀ="'.
lôîÆ
('Edô¨').'" hªf="?eÛdô¨_c⁄ãnido&uæ='.
htmÀ¡ôõs
(
$d
->
∑th
.'/'.
$doc
).'"> [#]</a>';

164 
	mecho
 '<span class="detalles_fichero">';

165 
	mecho
 ' ['.
¥e£¡¨Byãs
(
fûesize
(
$d
->
∑th
.'/'.
$doc
)).', '.
¥e£¡¨Fecha
(
fûemtime
($d->path.'/'.$doc),2).']';

166 
	mecho
 '</span>';

167 
	mecho
 '</span>';

168 
	mecho
 '</li>';

173 
f‹óch
(
$sub£cci⁄es
 
as
 
$x
) {

174 
	m$this
->
mo°ørSecci⁄es
(
$x
, 
$∑th_visibÀ
, 
$vîDocumítos
, 
$£Àcci⁄abÀ
, 
$fûåo
, 
$ªcursivo
, 
$checkqued
, 
$mu…ùÀ
, 
$ocu…¨
);

177 
	mecho
 "</div>";

178 
	mecho
 "\n</ul>";

	@gcm/lib/int/galeria/lib/Galeria.php

1 <?
php


51 ˛as†
	cGÆîü
 {

55 
public
 
	m$limô_im©ges
 = 1;

56 
public
 
	m$gønd¨ü_max
 = '520000';

57 
public
 
	m$am∂¨ü_max
 = 640;

58 
public
 
	m$Ætuø_max
 = 
NULL
;

59 
public
 
	m$am∂ada_¥e£¡acio
 = 140;

60 
public
 
	m$Ætuø_¥e£¡acio
 = 
NULL
;

61 
public
 
	m$js_po°_pujada
 = 
NULL
;

62 
public
 
	m$js_po°_esb‹ø
 = 
NULL
;

63 
public
 
	m$im©ge_e•îa
 = '../imatges/uploading.gif';

65 
public
 
	m$c⁄tögut_íŒac_b‹ør
 = '<img src="../grafics/goma.gif" width="18" height="16" border="0">';

66 
public
 
	m$cﬁ‹_b‹d
 = '#000';

67 
public
 
	m$dú_tmp
 = 'tmp/';

68 
public
 
	m$uæ_øiz
 = '../';

69 
public
 
	m$am∂ada_bŸo_fûe
 = 30;

70 
public
 
	m$sufijo
 = '01_';

74 
¥iv©e
 
	m$num_möütuªs
 = 0;

75 
¥iv©e
 
	m$imagíes
 = 
NULL
;

76 
¥iv©e
 
	m$îr‹es
 = 
¨øy
();

87 
¥iv©e
 
	m$e°ado
 = 
NULL
;

97 
¥iv©e
 
	m$tùoGÆîü
;

99 
¥iv©e
 
	m$idítifiˇd‹
;

101 
¥iv©e
 
	m$˛a£_imagí
;

103 
¥iv©e
 
	m$c⁄f_im©ges
;

105 
¥iv©e
 
	m$fôxî_js
;

119 
public
 
fun˘i⁄
 
	$__c⁄°ru˘
(
$c⁄f_im©ges
, 
$idítifiˇd‹
=
NULL
) {

121 
$this
->
c⁄f_im©ges
 = 
$c⁄f_im©ges
;

122 
$this
->
imagíes
 = 
	`¨øy
();

123 
$this
->
tùoGÆîü
 = $this->
c⁄f_im©ges
['tipo'];

124 
$this
->
idítifiˇd‹
 = 
$idítifiˇd‹
;

125 
$this
->
fôxî_js
 = 
	`dú«me
(
__FILE__
).'/../js/galeria.js';

127 
$this
->
e°ado
 = ( $this->
idítifiˇd‹
 ) ? 'visualizando' : 'insertando' ;

129 
$this
->
tùoGÆîü
) {

132 
$this
->
˛a£_imagí
 = 'ImagenesTablaArchivo';

135 
$this
->
˛a£_imagí
 = 'ImagenesArchivo';

138 
$this
->
˛a£_imagí
 = 'ImagenesMysql';

141 
$this
->
˛a£_imagí
 = 'ImagenesTablaArchivo';

145 
	`ªquúe
(
	`dú«me
(
__FILE__
).'/'.
$this
->
˛a£_imagí
.'.php');

153 
fun˘i⁄
 
	$subú_imagí
() {

155 i‡–! 
	`fûe_exi°s
(
$this
->
dú_tmp
) ) {

156 
$this
->
îr‹es
[] = "Sö dúe˘‹iÿãmp‹ÆÖ¨®im√°gíe†[".$this->
dú_tmp
."]";

157  
FALSE
;

162 
$nIdThumb
 = 
$_POST
["nummin"];

163 
$Ætuø
 = 
$this
->
Ætuø_max
;

164 
$am∂¨ü
 = 
$this
->
am∂¨ü_max
;

168 
$fFûeTmpName
 = 
$_FILES
['fimatge']['tmp_name'];

169 
$fFûeName
 = 
$_FILES
['fimatge']['name'];

170 
$fFûeSize
 = 
$_FILES
['fimatge']['size'];

171 
$fFûeTy≥
 = 
$_FILES
['fimatge']['type'];

172 
$fFûeEº‹
 = 
$_FILES
['fimatge']['error'];

174 i‡(
$fFûeEº‹
==4){

176 
$fFûeTmpName
 = 
nuŒ
;

177 
$fFûeName
 = 
nuŒ
;

178 
$fFûeSize
 = 
nuŒ
;

179 
$fFûeTy≥
 = 
nuŒ
;

181 
$this
->
îr‹es
[] = "No ha seleccionat cap fitxer";

182  
FALSE
;

187 i‡(
$fFûeEº‹
>0){

189 
$fFûeEº‹
){

192 
$this
->
îr‹es
[] = "E»fôxîÇÿpŸ su≥ø∏À†".
$_POST
['MAX_FILE_SIZE']." bytes";

196 i‡–
$_POST
['MAX_FILE_SIZE'] ) {

197 
$this
->
îr‹es
[] = "E»fôxîÇÿpŸ su≥ø∏À†".
$_POST
['MAX_FILE_SIZE']." bytes";

199 
$this
->
îr‹es
[] = 'El fitxerá superatÉlÖesÖerm√®sÖel servidor';

204 
$this
->
îr‹es
[] = "S'haÖroduit unÉrrorÉnÉlÖroc√©s d'upload";

212 i‡(!
	`is_u∂ﬂded_fûe
(
$fFûeTmpName
)){

214 
$this
->
îr‹es
[] = "S'haÖroduit unÉrrorÉnÉlÖroc√©s d'upload del fitxer. Possible intent d'acc√®sÇoáutoritzatál servidor";

218 
$vD©osImg
 = @
	`gëimagesize
(
$_FILES
['fimatge']['tmp_name']);

221 i‡(!
$vD©osImg
) {

223 
$this
->
îr‹es
[] = 'ErrorÜlegint informaci√≥ d\'imatge';

227 i‡(
	`is£t
(
$vD©osImg
['mime'])) {

228 
$sTùo
 = 
$vD©osImg
['mime'];

229 } if(
	`is£t
(
$vD©osImg
[2])) {

230 
$sTùo
 = 
	`image_ty≥_to_mime_ty≥
(
$vD©osImg
[2]);

231 } i‡(
	`is£t
(
$iTùo
)) {

232 
$sTùo
 = 
	`image_ty≥_to_mime_ty≥
(
$iTùo
);

235 i‡–!
$sTùo
 ) {

237 
$this
->
îr‹es
[] = 'ErrorÜlegint informaci√≥ d\'imatge: mime';

241 
$sTùo
){

243 
$fuíã
 = 
	`image¸óã‰omgif
(
$fFûeTmpName
Ë
‹


244 
$this
->
îr‹es
[] = 'ErrorÅreballantámb format d\'imatge gif,Öroviámbáltre format';

247 
$fuíã
 = 
	`image¸óã‰omj≥g
(
$fFûeTmpName
Ë
‹


248 
$this
->
îr‹es
[] = 'ErrorÅreballantámb format d\'imatge jpeg,Öroviámbáltre format';

251 
$fuíã
 = 
	`image¸óã‰om≤g
(
$fFûeTmpName
Ë
‹


252 
$this
->
îr‹es
[] = 'ErrorÅreballantámb format d\'imatgeÖng,Öroviámbáltre format';

255 
$this
->
îr‹es
[] = 'Eº‹ÅªbÆœ¡ámb f‹m© d\'im©gê'.
$sTùo
.',Öroviámbáltre format';

260 i‡–
	`em±y
(
$this
->
îr‹es
) ) {

262 
$am∂¨ü_im©ge
 = 
$vD©osImg
[0];

263 
$Ætuø_im©ge
 = 
$vD©osImg
[1];

267 
$å™sf‹macio
 = 
FALSE
;

269 i‡–!
	`em±y
(
$am∂¨ü
Ë&&Ém±y(
$Ætuø
) ) {

272 
$Ætuø
 = 
$Ætuø_im©ge
 * 
$am∂¨ü
 / 
$am∂¨ü_im©ge
 ;

273 
$å™sf‹macio
 = 
TRUE
;

275 } 
	`ñ£if
 ( !
	`em±y
(
$Ætuø
Ë&&Ém±y(
$am∂¨ü
) ) {

278 
$am∂¨ü
 = 
$am∂¨ü_im©ge
 * 
$Ætuø
 / 
$Ætuø_im©ge
 ;

279 
$å™sf‹macio
 = 
TRUE
;

281 } 
	`ñ£if
 ( !
	`em±y
(
$Ætuø
Ë&& !em±y(
$am∂¨ü
) ) {

284 
$å™sf‹macio
 = 
TRUE
;

290 i‡–
$å™sf‹macio
 && ( 
$am∂¨ü_im©ge
 > 
$am∂¨ü
 || 
$Ætuø_im©ge
 > 
$Ætuø
 ) ) {

292 
$nova_im©ge

	`ImageCª©eTrueCﬁ‹
(
$am∂¨ü
, 
$Ætuø
)

293 
‹
 
$nova_im©ge
=
	`ImageCª©e
(
$am∂¨ü
, 
$Ætuø
);

295 
	`ImageC›yResized
(
$nova_im©ge
,
$fuíã
,0,0,0,0,
$am∂¨ü
,
$Ætuø
,
$am∂¨ü_im©ge
,
$Ætuø_im©ge
);

306 
$sTùo
){

308 
	`imagegif
(
$nova_im©ge
,
$fFûeTmpName
);

311 
	`imagej≥g
(
$nova_im©ge
,
$fFûeTmpName
, 100);

314 
	`imagïng
(
$nova_im©ge
,
$fFûeTmpName
, 9);

317 
$this
->
îr‹es
[] = 'Eº‹ÅªbÆœ¡ámb f‹m© d\'im©gê'.
$sTùo
.',Öroviámbáltre format';

321 
$fLogoSize
 = 
	`fûesize
(
$fFûeTmpName
);

326 
$nom_im©ge
 = 
$fFûeName
 ;

327 
$§c_img
 = 
$this
->
dú_tmp
.
$nom_im©ge
;

329 i‡–! 
	`ª«me
(
$fFûeTmpName
,
$§c_img
) ) {

330 
$this
->
îr‹es
[] = 'No seÖudo guardar imagenÉn directorioÅemporal';

341 
$§c_img
 = ( 
	`is£t
($src_img) ) ? $src_img : '';

344 <!
DOCTYPE
 
html
 
PUBLIC
 "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

345 <
html
 
xm s
="http://www.w3.org/1999/xhtml">

346 <
hód
>

347 <
tôÀ
></title>

348 <
mëa
 
hâp
-
equiv
="C⁄ã¡-Ty≥" 
c⁄ã¡
="text/html; charset=iso-8859-1">

349 </
hód
>

351 <
s¸ùt
 
œnguage
="JavaScript">

353 i‡(
documít
.
images
) {

354 
thumbIO
 = 
√w
 
	`Image
();

355 
thumbIO
.
§c
='<?phpÉcho $this->url_raiz.$src_img;?>';

358 
fun˘i⁄
 
	`showResu…
(){

360 <?
php
 i‡(
	`em±y
(
$this
->
îr‹es
)) { ?>

363 
oThumb
 = 
∑ª¡
.
documít
.
	`gëEÀmítById
('thumbIMG<?phpÉcho $nIdThumb;?>');

365 
oThumb
.
§c
 = 
thumbIO
.src;

369 
v¨
 
öput_im©ge
 = 
documít
.
	`¸óãEÀmít
('input');

370 
öput_im©ge
.
«me
 = 'imatges_formulari[]';

371 
öput_im©ge
.
vÆue
 = 
thumbIO
.
§c
;

372 
öput_im©ge
.
ty≥
 = 'text';

373 
öput_im©ge
.
°yÀ
.
di•œy
 = 'none';

374 
oThumb
.
	`≠≥ndChûd
(
öput_im©ge
);

377 
oThumbBuâ⁄
 = 
∑ª¡
.
documít
.
	`gëEÀmítById
('buttonDIV<?phpÉcho $nIdThumb;?>');

378 
oThumbBuâ⁄
.
ö√rHTML
 = '<a href=\"javascript:esborrarImatge(\'<?=$this->sufijo?>\',<?phpÉcho $nIdThumb;?>);\"><?=$this->contingut_enllac_borrar?></a>';

380 <?
php
 } { ?>

383 <?
php
 
	`f‹óch
 ( 
$this
->
îr‹es
 
as
 
$îr‹
 ) { ?>

384 
∑ª¡
.
	`showMesßgeBﬂrd
('<?phpÉchoáddslashes($error);?>');

385 <?
php
 } ?>

388 
oThumb
 = 
∑ª¡
.
documít
.
	`gëEÀmítById
('thumbDIV<?phpÉcho $nIdThumb;?>');

389 
oThumb
.
°yÀ
.
di•œy
 = 'none';

391 
∑ª¡
.
documít
.
	`gëEÀmítById
('<?=$this->sufijo?>fim©ge').
°yÀ
.
di•œy
 = 'block';

393 <?
php
 } ?>

397 
wödow
.
⁄lﬂd
 = 
showResu…
;

399 </
s¸ùt
>

401 <
body
>

402 <?
php


403 i‡–
	`em±y
(
$this
->
îr‹es
) ) {

404 
echo
 '<img src="'.
$this
->
uæ_øiz
.
$§c_img
.'"/>';

406 
	`f‹óch
 ( 
$this
->
îr‹es
 
as
 
$îr‹
 ) 
echo
 '<br />- '.$error;

410 </
body
>

411 </
html
>

412 <?
php


413 
	`exô
();

415 
	}
}

424 
public
 
fun˘i⁄
 
	$öicü
() {

426 i‡–
	`is£t
(
$_GET
['accio_galeria']) && $_GET['accio_galeria'] == 'agafa_imatge' ) {

428 
$this
->
	`subú_imagí
();

432 
$this
->
	`¥e£¡aGÆîü
();

436 
	}
}

445 
fun˘i⁄
 
	$gu¨d¨
(
$id_èbœ
) {

447 i‡–
	`is£t
(
$_POST
['imatges_formulari']) ) {

448 
	`f‹óch
 ( 
$_POST
['im©ges_f‹muœri'] 
as
 
$nombª_imagí
 ) {

449 
$img
 = 
√w
 
$this
->
	`˛a£_imagí
($this->
c⁄f_im©ges
,
$id_èbœ
);

450 
$img
->
	`gu¨d¨
(
$nombª_imagí
);

451 
$this
->
	`addIãm
(
$img
);

455 i‡(
	`is£t
(
$_POST
['imatges_borrar']) ) {

457 
	`f‹óch
 ( 
$_POST
['im©ges_b‹ør'] 
as
 
$nombª_imagí
 ) {

458 
$img
 = 
√w
 
$this
->
	`˛a£_imagí
($this->
c⁄f_im©ges
,
$id_èbœ
);

459 
$img
->
	`b‹ør
(
$nombª_imagí
);

460 
$this
->
	`ªmoveIãm
(
$img
);

465 
	}
}

475 
public
 
fun˘i⁄
 
	$¥e£¡aGÆîü
(
$nom_im©ge_ãmp‹Æ
=
NULL
) {

477 
echo
 '<scriptÜanguage="JavaScript">';

478 
	`ö˛ude_⁄˚
(
$this
->
fôxî_js
);

479 
echo
 '</script>';

482 i‡–
$this
->
idítifiˇd‹
 ) {

483 
$this
->
	`ªcogî_imagíes_gÆîü
();

488 <
div
 
˛ass
="gÆîü_im©ges" 
id
="<?=$this->sufijo?>galeria">

489 <
öput
 
ty≥
="hiddí" 
«me
="MAX_FILE_SIZE" 
vÆue
="<?phpÉcho $this->grandaria_max;?>" />

490 <
öput
 
ty≥
="hiddí" 
id
="<?=$this->sufijo?>nummö" 
«me
="nummö" 
vÆue
="<?=$this->num_miniatures?>" />

491 <
öput
 
ty≥
="hiddí" 
id
="<?=$this->sufijo?>tŸÆ_möütuøs" 
«me
="tŸÆ_möütuøs" 
vÆue
="<?=$this->num_miniatures?>" />

492 <
öput
 
ty≥
="hiddí" 
«me
="e°ado" 
vÆue
="<?=$this->estado?>" />

493 <
öput
 
ty≥
="hiddí" 
«me
="idítifiˇd‹" 
vÆue
="<?=$this->identificador?>" />

494 <
öput
 
id
="<?=$this->sufijo?>fim©ge" 
«me
="fimatge"

495 <?
php
 i‡–
$nom_im©ge_ãmp‹Æ
 ) {

496 
echo
 'vÆue="'.
$im©ge
.'"Åype="text"';

498 
echo
 'Åype="file" ';

500 <?
php
 i‡–
$this
->
num_möütuªs
 >$this->
limô_im©ges
 ) 
echo
 " style='display:Çone;'"; ?>

501 
size
="<?phpÉcho $this->amplada_boto_file; ?>"

502 <?
php
 i‡–
$this
->
js_po°_pujada
 ) { ?>

503 
⁄ch™ge
="javascript:ÖujarImatge(this.form,<?=$this->limit_imatges?>,'<?=$this->js_post_pujada?>');" />

504 <?
php
 } { ?>

505 
⁄ch™ge
="javascript:ÖujarImatge(this.form,<?=$this->limit_imatges?>);" />

506 <?
php
 } ?>

507 <
i‰ame
 
«me
="‰ameIm©ge" 
width
="100%" 
height
="200px" 
°yÀ
="display:none;"></iframe>

508 </
div
>

510 <?
php


512 
$this
->
	`ˇixa_gÆîü
();

513 
$this
->
	`ˇixa_misßtges
();

517 
echo
 '<style>';

518 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../css/galeria.css');

519 
echo
 '</style>';

520 
	}
}

524 
fun˘i⁄
 
	$ˇixa_misßtges
() {

527 <
div
 
id
="mesßgeBﬂrdDIV" 
°yÀ
="display:none;">

528 <
div
>&
nb•
;</div>

529 <
div
 
˛ass
="gíBuâ⁄"><
a
 
hªf
="javas¸ùt:hideMesßgeBﬂrd();">
ok
</a></div>

530 </
div
>

531 <?
php


533 
	}
}

541 
fun˘i⁄
 
	$ˇixa_gÆîü
(
$im©ge
=
NULL
) {

543 
$nIdImg
 = ( 
	`is£t
(
$_POST
['nIdImg']) ) ? $_POST['nIdImg'] : '';

545 
echo
 '<div id="galleryContainerDIV">';

547 i‡–! 
	`em±y
(
$this
->
imagíes
) ) {

549 
$c⁄è
=0;

550 
	`f‹óch
 ( 
$this
->
imagíes
 
as
 
$img
 ) {

551 
$c⁄è
++;

552 
$this
->
	`¥e£¡aIm©geEdô¨
(
$img
,
$c⁄è
);

553 
$this
->
num_möütuªs
++;

558 </
div
>

559 <?
php


560 
	}
}

566 
¥iv©e
 
fun˘i⁄
 
	$ªcogî_imagíes_gÆîü
() {

568 i‡–
	`em±y
(
$this
->
imagíes
) ) {

569 
$imagíes
 = 
	`ˇŒ_u£r_func
–
	`¨øy
(
$this
->
˛a£_imagí
, "li°ado"),$this->
c⁄f_im©ges
, $this->
idítifiˇd‹
 );

570 
	`f‹óch
 ( 
$imagíes
 
as
 
$nombª_imagí
) {

571 
$this
->
num_möütuªs
++;

572 
$this
->
imagíes
[] = 
√w
 $this->
	`˛a£_imagí
($this->
c⁄f_im©ges
, $this->
idítifiˇd‹
, 
$nombª_imagí
);

576 
	}
}

586 
fun˘i⁄
 
	$¥e£¡aIm©geEdô¨
(
$img
, 
$c⁄è
=1) {

589 <
div
 
id
="thumbDIV<?ph∞echÿ$c⁄è; ?>" 
˛ass
="galleryThumbnail">

590 <
div
>

591 <
img
 
id
="thumbIMG<?=$conta?>"

592 
§c
="<?=$this->url_raiz.$img->getUrl();?>"

593 
°yÀ
="border: 1px solid <?phpÉcho $this->color_bord;?>"

594 <?
php
 i‡–
$this
->
am∂ada_¥e£¡acio
 ) 
echo
 " width='".$this->amplada_presentacio."'"; ?>

595 <?
php
 i‡–
$this
->
Ætuø_¥e£¡acio
 ) 
echo
 " height='".$this->altura_presentacio."'"; ?>

597 </
div
>

598 <
div
 
id
="buttonDIV<?phpÉcho $conta;?>">

599 <
a
 
hªf
="javascript:esborrarImatge('<?=$this->sufijo?>',<?=$conta?>);">

600 <?=
$this
->
c⁄tögut_íŒac_b‹ør
?>

601 </
a
>

602 <
öput
 
ty≥
="hiddí" 
«me
="im©geGÆîü[<?=$c⁄è?>]" 
vÆue
="<?=$img->getNombre()?>" />

603 </
div
>

604 </
div
>

605 <?
php


607 
	}
}

613 
fun˘i⁄
 
	$addIãm
(
$img
) {

615 
$this
->
imagíes
[] = 
$img
;

616 
$this
->
num_möütuªs
++;

618 
	}
}

624 
fun˘i⁄
 
	$ªmoveIãm
(
$img
) {

626 
$this
->
num_möütuªs
--;

628 
	}
}

	@gcm/lib/int/galeria/lib/ImagenesAbstract.php

1 <?
php


22 
ab°ø˘
 cœs†
	cImagíesAb°ø˘
 {

24 
¥iv©e
 
	m$tùomime
;

25 
¥iv©e
 
	m$Ætuø
;

26 
¥iv©e
 
	m$™chuø
;

28 
¥Ÿe˘ed
 
	m$nombª_imagí
;

30 
ab°ø˘
 
fun˘i⁄
 
b‹ør
(
$nombª_imagí
);

31 
ab°ø˘
 
fun˘i⁄
 
gu¨d¨
(
$nombª_imagí
);

32 
ab°ø˘
 
fun˘i⁄
 
gëUæ
();

33 
ab°ø˘
 
fun˘i⁄
 
gëA…uø
();

34 
ab°ø˘
 
fun˘i⁄
 
gëAnchuø
();

35 
ab°ø˘
 
fun˘i⁄
 
gëTùomime
();

37 
fun˘i⁄
 
	$__c⁄°ru˘
() {

41 
¥Ÿe˘ed
 
fun˘i⁄
 
	$li°ado
(
$c⁄f_im©ges
, 
$id_èbœ
) {

43 
echo
 
__CLASS__
.'::'.
__METHOD__
."\n".'Debe implementarseÉn clase hija';

45 
	}
}

51 
fun˘i⁄
 
	$gëNombª
() {

53  
$this
->
nombª_imagí
;

55 
	}
}

	@gcm/lib/int/galeria/lib/ImagenesTablaArchivo.php

1 <?
php


18 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/ImagenesAbstract.php');

38 ˛as†
	cImagíesTabœArchivo
 
exãnds
 
	mImagíesAb°ø˘
 {

40 
public
 
	m$èbœ
 = 'galeria';

41 
public
 
	m$ˇmpo_id
 = 'id';

43 
¥iv©e
 
	m$îr‹es
 = 
¨øy
();

44 
¥iv©e
 
	m$pdo
;

46 
¥iv©e
 
	m$èbœ_ªœci⁄ada
 = '';

47 
¥iv©e
 
	m$id_èbœ
;

48 
¥iv©e
 
	m$dú_tmp
;

49 
¥iv©e
 
	m$dú_imagíes
;

60 
fun˘i⁄
 
	$__c⁄°ru˘
(
$c⁄figuøcio
, 
$id_èbœ
, 
$nombª_imagí
=
FALSE
) {

62 
$this
->
id_èbœ
 = 
$id_èbœ
;

64 
$this
->
pdo
 = 
$c⁄figuøcio
['pdo'];

65 
$this
->
èbœ_ªœci⁄ada
 = 
$c⁄figuøcio
['tabla'];

66 
$this
->
dú_imagíes
 = 
$c⁄figuøcio
['dir_imagenes'];

67 
$this
->
dú_tmp
 = 
$c⁄figuøcio
['dir_tmp'];

69 
$this
->
nombª_imagí
 = 
$nombª_imagí
;

78 
fun˘i⁄
 
	$b‹ør
(
$nombª_imagí
) {

80 
$nombª_imagí
 = 
	`ba£«me
($nombre_imagen);

82 
$sql
 = "DELETE FROM ".
$this
->
èbœ
."

83 
WHERE
 
èbœ
='".$this->tabla_relacionada."'

84 
AND
 
id_èbœ
=".$this->id_tabla."

85 
AND
 
imagí
='".$nombre_imagen."'";

87 
$objSèãmít
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

89 i‡–! 
$objSèãmít
->
	`execuã
() ) {

90 
$îr‹
 = 
$objSèãmít
->
	`îr‹Info
();

91 
	`åiggî_îr‹
(
$îr‹
,
E_USER_ERROR
);

92  
FALSE
;

95 i‡–
	`fûe_exi°s
(
$this
->
dú_imagíes
.
$nombª_imagí
ËË
	`u∆ök
($this->dir_imagenes.$nombre_imagen);

97 
	}
}

106 
fun˘i⁄
 
	$gu¨d¨
(
$uæ_imagí
) {

108 
$nombª_imagí
 = 
	`ba£«me
(
$uæ_imagí
);

110 
$sql
 = "INSERT INTO ".
$this
->
èbœ
." (tabla, id_tabla, imagen) VALUES (:tabla, :id_tabla, :imagen)";

111 
$objSèãmít
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
);

113 
$objSèãmít
->
	`bödVÆue
(':èbœ', 
$this
->
èbœ_ªœci⁄ada
, 
PDO
::
PARAM_STR
);

114 
$objSèãmít
->
	`bödVÆue
(':id_èbœ', 
$this
->
id_èbœ
, 
PDO
::
PARAM_INT
);

115 
$objSèãmít
->
	`bödVÆue
(':imagí', 
$nombª_imagí
, 
PDO
::
PARAM_STR
);

117 i‡–! 
$objSèãmít
->
	`execuã
() ) {

118 
$îr‹
 = 
$objSèãmít
->
	`îr‹Info
();

119 
	`åiggî_îr‹
(
$îr‹
,
E_USER_ERROR
);

120  
FALSE
;

123 
	`ª«me
(
$this
->
dú_tmp
.
$nombª_imagí
, $this->
dú_imagíes
.$nombre_imagen);

126 
	}
}

132 
fun˘i⁄
 
	$gëUæ
() {

134  
$this
->
dú_imagíes
.$this->
nombª_imagí
;

136 
	}
}

142 
fun˘i⁄
 
	$gëA…uø
() {

144 
echo
 
__METHOD__
.'Öendiente';

146 
	}
}

152 
fun˘i⁄
 
	$gëAnchuø
() {

154 
echo
 
__METHOD__
.'Öendiente';

156 
	}
}

162 
fun˘i⁄
 
	$gëTùomime
() {

164 
echo
 
__METHOD__
.'Öendiente';

166 
	}
}

173 
fun˘i⁄
 
	$li°ado
(
$c⁄f_im©ges
, 
$id_èbœ
) {

175 
$im©ges
 = 
	`¨øy
();

177 
$sql
 = "SELECT imagen FROM galeria

178 
WHERE
 
èbœ
='".$c⁄f_im©ges['èbœ']."' 
AND
 
id_èbœ
=".$id_tabla;

180 
åy
 {

182 
$ªsu…ado
=
$c⁄f_im©ges
['pdo']->
	`¥ï¨e
(
$sql
);

183 
$ªsu…ado
->
	`execuã
();

185 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

186 
	`åiggî_îr‹
("Eº‹ gíî™Üli°®d'imèges\n\nSQL: ".
$sql
."\n".
$ex
->
	`gëMesßge
(), 
E_USER_ERROR
);

187  
FALSE
;

190 
$¨AŒ
 = 
$ªsu…ado
->
	`„tchAŒ
(
PDO
::
FETCH_ASSOC
);

192 
	`f‹óch
 ( 
$¨AŒ
 
as
 
$¨Row
 ) {

193 
$im©ges
[] = 
$¨Row
['imagen'];

196  
$im©ges
;

198 
	}
}

	@gcm/lib/int/galeria/lit/lit_ca.php

1 <?
php


2 
	g$lô
['Subir imagen'] = 'Pujar imatge';

	@gcm/lib/int/galeria/lit/lit_es.php

1 <?
php


2 
	g$lô
['Subir imagen'] = 'Subir imagen';

	@gcm/lib/int/gcm/lib/Eventos.php

1 <?
php


57 ˛as†
	cEvítos
 {

63 
public
 
	m$evítos
 = 
¨øy
();

67 
public
 
	m$ubiˇci⁄es
 = 
¨øy
();

83 
public
 
	m$cEvítos
 = 
¨øy
();

90 
¥iv©e
 
	m$modulos_a˘ivados
;

92 
¥iv©e
 
	m$dú_modulos
;

93 
¥iv©e
 
	m$dú_modulos_¥oye˘o
;

94 
¥iv©e
 
	m$bAdmö
;

98 
¥iv©e
 
	m$dú_evítos_¥oye˘o
 = 'DATOS/eventos/';

102 
¥iv©e
 
	m$Àî_evítos_¥oye˘o
 = 
TRUE
;

109 
¥iv©e
 
	m$visuÆiz¨
 = 
FALSE
;

115 
public
 
	m$ö°™cüs
 = 
¨øy
();

134 
¥iv©e
 
	m$li°a_bœnˇ
 = 
¨øy
();

146 
fun˘i⁄
 
	$__c⁄°ru˘
(
$dú_modulos
, 
$bAdmö
=
FALSE
, 
$eProye˘o
=
TRUE
, 
$visuÆiz¨
=FALSE) {

148 
globÆ
 
$gcm
;

150 
$this
->
modulos_a˘ivados
 = 
	`¨øy_mîge
(
$gcm
->
modulos_basicos
,$gcm->
	`c⁄fig
('admin','M√≥dulosáctivados'));

152 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`dïuør
(
$this
->
modulos_a˘ivados
,'Modulosáctivados'));

154 
$this
->
visuÆiz¨
 = 
$visuÆiz¨
;

155 
$this
->
evítos
 = 
	`¨øy
();

156 
$this
->
dú_modulos
 = 
$dú_modulos
;

157 
$this
->
dú_modulos_¥oye˘o
 = 'modulos/';

158 
$this
->
bAdmö
 = 
$bAdmö
;

159 
$this
->
Àî_evítos_¥oye˘o
 = 
$eProye˘o
;

163 i‡–! 
	`fûe_exi°s
(
$this
->
dú_evítos_¥oye˘o
) ) {

164 i‡–! 
	`mkdú
 (
$this
->
dú_evítos_¥oye˘o
) ) {

165  
FALSE
;

171 i‡–
$this
->
bAdmö
 ) {

172 
$this
->
	`Àî_evítos
('admin');

173 i‡–
	`fûe_exi°s
(
$this
->
dú_modulos_¥oye˘o
ËË$this->
	`Àî_evítos
('admin',$this->dir_modulos_proyecto);

176 
$this
->
	`Àî_evítos
('usuario');

177 i‡–
	`fûe_exi°s
(
$this
->
dú_modulos_¥oye˘o
ËË$this->
	`Àî_evítos
('usuario',$this->dir_modulos_proyecto);

179 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`dïuør
(
	`gë_obje˘_v¨s
(
$this
),'VariablesÉnÉventos'));

194 
public
 
fun˘i⁄
 
	$gë_li°a_bœnˇ
(
$modulo
, 
$acci⁄
) {

195 i‡–
	`is£t
(
$this
->
li°a_bœnˇ
[
$modulo
]Ë&& 
	`ö_¨øy
(
$acci⁄
, $this->li°a_bœnˇ[$modulo]ËË 
TRUE
;

196  
FALSE
;

197 
	}
}

218 
public
 
fun˘i⁄
 
	$£t_li°a_bœnˇ
(
$modulo
,
$acci⁄
) {

219 i‡–! 
$this
->
	`gë_li°a_bœnˇ
(
$modulo
, 
$acci⁄
ËË$this->
li°a_bœnˇ
[$modulo][] = $accion;

221 
	}
}

237 
fun˘i⁄
 
	$Àî_evítos
(
$nivñ
, 
$dúe˘‹io
=
NULL
) {

239 
globÆ
 
$gcm
;

241 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__FUNCTION__
.'('.
$nivñ
.','.
$dúe˘‹io
.')');

243 
$nombª_ˇche
 = ( 
$dúe˘‹io
 ) ? 'evítos_'.
$nivñ
.'_'.
	`°r_ª∂a˚
('/','-',
	`πrim
($directorio,'/')) : 'eventos_'.$nivel ;

250 
$com¥ob¨_a˘ivados
 = 
FALSE
;

252 
$n
 = 0;

254 i‡–! 
$dúe˘‹io
 ) {

255 
$dúe˘‹io
 = 
$this
->
dú_modulos
;

256 
$com¥ob¨_a˘ivados
 = 
TRUE
;

259 i‡–! 
	`fûe_exi°s
(
$dúe˘‹io
) ) {

260 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿã√mo†dúe˘‹iÿdêmodulo†í '.
$dúe˘‹io
, 'ERROR');

261  
FALSE
;

264 
$dúe˘‹io_modulos
 = 
	`dú
(
$dúe˘‹io
);

266 
$modulo
 = 
$dúe˘‹io_modulos
->
	`ªad
()) {

268 i‡–
$com¥ob¨_a˘ivados
 && ! 
	`ö_¨øy
(
$modulo
,
$this
->
modulos_a˘ivados
) ) ;

270 
$fichîo_modulo
 = 
$dúe˘‹io
.
$modulo
.'/evítos_'.
$nivñ
.'.php';

271 
$fichîo_evíto
 = 
$this
->
dú_evítos_¥oye˘o
.
$modulo
.'/evítos_'.
$nivñ
.'.php';

273 i‡–! 
	`is_fûe
(
$fichîo_modulo
) ) ;

274 i‡–! 
	`is_fûe
(
$fichîo_evíto
) ) {

275 i‡–! 
	`is_dú
(
$this
->
dú_evítos_¥oye˘o
.
$modulo
) ) {

276 i‡–! 
	`mkdú
(
$this
->
dú_evítos_¥oye˘o
.
$modulo
) ) {

277 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Öudÿ¸ó∏dúe˘‹iÿdêm√≥dulÿíÜ®c⁄figuøci√≥¿dñÖroye˘ÿ['.
$modulo
.']','ERROR');

278  
FALSE
;

281 i‡–! 
	`c›y
(
$fichîo_modulo
, 
$fichîo_evíto
) ) {

282 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Öudÿc›ü∏¨chivÿdêevítÿ['.
$fichîo_evíto
.']','ERROR');

283  
FALSE
;

288 
$acci⁄es
 = 
FALSE
;

290 i‡–
$this
->
Àî_evítos_¥oye˘o
 ) {

291 
	`ö˛ude
(
$fichîo_evíto
);

293 
	`ö˛ude
(
$fichîo_modulo
);

296 i‡–
$acci⁄es
 ) {

297 
$gcm
->
au
->
	`£t_acci⁄es
(
$acci⁄es
);

300 i‡–
	`is£t
(
$evítos
Ë&& 
	`is_¨øy
($eventos) ) {

301 
	`f‹óch
 ( 
$evítos
 
as
 
$e
 => 
$acci⁄
 ) {

302 
	`f‹óch
 ( 
$acci⁄
 
as
 
$a
 => 
$vÆ‹
 ) {

303 
	`f‹óch
 ( 
$vÆ‹
 
as
 
$¥i‹idad
 => 
$¨gumítos
 ) {

305 i‡–
$nivñ
 ='usu¨io' ) 
$this
->
li°a_bœnˇ
[
$modulo
][] = 
$a
;

306 
$this
->
evítos
[
$e
][
$modulo
][
$a
][
$¥i‹idad
] = 
$¨gumítos
;

307 
$this
->
ubiˇci⁄es
[
$modulo
] = 
$dúe˘‹io
.$modulo;

308 
$n
++;

309 i‡–
	`is£t
(
$cEvítos
[
$e
]) ) {

310 
$this
->
cEvítos
[
$e
][
$cEvítos
[$e]] = 
$modulo
;

313 
	`un£t
(
$a
);

314 i‡–
	`is£t
(
$cEvítos
ËË
	`un£t
($cEvítos[
$e
]);

317 
	`un£t
(
$evítos
);

321 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Numîÿdêevíto†í '.
$dúe˘‹io
.': '.
$n
);

323 
	}
}

332 
fun˘i⁄
 
	$vîifiˇr_evíto
(
$e
) {

334 i‡–
	`em±y
(
$this
->
evítos
[
$e
]) ) {

335  
FALSE
;

337  
TRUE
;

340 
	}
}

358 
public
 
fun˘i⁄
 
œnz¨Evíto
(
$e
, 
$¨gs
=''){

360 
globÆ
 
$gcm
;

362 
ªgi°ør
(
__FILE__
,
__LINE__
,'œnz¨Evíto('.
$e
.','.
$¨gs
.')');

364 
	g$evíto
 = 
$e
;

366 i‡–
	g$this
->
	gvisuÆiz¨
 ) 
	gecho
 '<div cœss="visuÆiz¨_evíto" ><∞°yÀ="f⁄t-size: 12px; cﬁ‹:Ñed;">'.
	g$e
.'</p>';

368 
	g$∑ømëros_evítos
 = 
$¨gs
;

372 i‡–
is£t
(
$this
->
cEvítos
[
$e
]['anular']) ) {

373 
ªgi°ør
(
__FILE__
,
__LINE__
,'Evítos->œnz¨Evíto('.
$e
.','.
$¨gs
.') EventoánuladoÇos volvemos');

379 i‡–
	g$this
->
vîifiˇr_evíto
('¥e'.
$evíto
ËË{ $this->
œnz¨Evíto
('pre'.$evento); }

381 
	gåy
 {

383 i‡–!
	g$this
->
vîifiˇr_evíto
(
$evíto
) ) {

385 
throw
 
√w
 
Ex˚±i⁄
('SöÉvíto†∑ø ['.
$evíto
.']');

391 
	g$‹dí
 = 
$this
->
¥i‹idad
(
$e
);

393 
ªgi°ør
(
__FILE__
,
__LINE__
,'Acci⁄e†∑øÉvítÿ['.
$evíto
.']: '.
dïuør
(
$‹dí
));

397 
f‹óch
 ( 
$‹dí
 
as
 
$acci⁄
 => 
$¥i‹idad
 ) {

401 i‡–
is£t
(
$this
->
cEvítos
[
$e
]['anular']) ) {

402 
ªgi°ør
(
__FILE__
,
__LINE__
,'Evítos->œnz¨Evíto('.
$e
.','.
$¨gs
.') EventoánuladoÇos volvemos');

406 
li°
(
$m
,
$a
,
$∑ømëros_mëodo
Ë
ex∂ode
('|',
$acci⁄
);

408 i‡–!
em±y
–
$∑ømëros_mëodo
Ë&& !em±y(
$∑ømëros_evítos
) ) {

409 
	g$∑ømëros
 = 
$∑ømëros_evítos
.'&'.
$∑ømëros_mëodo
;

410 } 
ñ£if
 ( 
em±y
(
$∑ømëros_evítos
) ) {

411 
	g$∑ømëros
 = 
$∑ømëros_mëodo
;

412 } 
ñ£if
 ( 
em±y
(
$∑ømëros_mëodo
) ) {

413 
	g$∑ømëros
 = 
$∑ømëros_evítos
;

418 i‡–
is£t
(
$this
->
cEvítos
[
$e
]['unico']Ë&& 
	g$this
->
	gcEvítos
[$e]['unico'] !
$m
 ) {

422 
ªgi°ør
(
__FILE__
,
__LINE__
,

423 'Comp‹èmõ¡ÿ[ unicÿ]Ö¨®evítÿ['.
$e
.']Ö‹Ö¨ã dê[ '.
$this
->
cEvítos
[$e]['unico'].' ]');

430 i‡–
	gGCM_DEBUG
 && 
	gRouãr
::
$f‹m©o
 ='html' && 
$m
 !='ˇche_hâp'Ë
¥ötf
("\n".
Rouãr
::
$f‹ma_comíèrios
."\n",'Evítos: '.$m.'->'.
$a
.'('.
$e
.','.
$∑ømëros
.')');

431 i‡–
	g$this
->
	gvisuÆiz¨
 ) {

432 i‡–
	g$m
 ="ãmas" ) 
$this
->
œnz¨_acci⁄_modulo
(
$m
,
$a
,
$e
,
$∑ømëros
);

433 
	gecho
 "\n".'<∞°yÀ="f⁄t-size: 12px"><®hªf="?m˜dmö&aÛdô¨_c⁄exi⁄&md='.
	g$m
.'">',$m,'->',
	g$a
,'('.
	g$e
.','.
	g$∑ømëros
.')</a></p>'."\n";

435 
	g$this
->
œnz¨_acci⁄_modulo
(
$m
,
$a
,
$e
,
$∑ømëros
);

438 i‡–
	gGCM_DEBUG
 && 
	gRouãr
::
$f‹m©o
 ='html' && 
$m
 !='ˇche_hâp'Ë
¥ötf
("\n".
Rouãr
::
$f‹ma_comíèrios
."\n",' / Evítos: '.$m.'->'.
$a
.'('.
$e
.','.
$∑ømëros
.')');

444 } 
ˇtch
 (
Ex˚±i⁄
 
$ex
) {

446 
ªgi°ør
(
$ex
->
gëFûe
(),$ex->
gëLöe
(),'Ex˚pci√≥¿íÉvíto†[ '.
$e
.' ] : '.$ex->
gëMesßge
(). "\n",'ADMIN');

452 i‡–
	g$this
->
vîifiˇr_evíto
('po°'.
$evíto
ËË{ $this->
œnz¨Evíto
('post'.$evento); }

454 i‡–
	g$this
->
	gvisuÆiz¨
 ) 
	gecho
 '</div>';

455  
	gTRUE
;

466 
¥iv©e
 
fun˘i⁄
 
	$¥i‹idad
(
$e
) {

468 
$¨ªglo
 = 
	`¨øy
();

469 
$evítos
 = 
$this
->
evítos
[
$e
];

470 
$¨gs
 = 
NULL
;

472 
	`f‹óch
 ( 
$evítos
 
as
 
$ì
 => 
$Ø
 ) {

473 
$n_m
 = 
$ì
;

474 
	`f‹óch
–
$Ø
 
as
 
$n_a
 => 
$vÆ‹
 ) {

476 
	`f‹óch
 ( 
$vÆ‹
 
as
 
$¥i‹idad
 => 
$¨gumítos
 ) {

478 i‡–
$¥i‹idad
 > 0 ) {

479 
$¨ªglo
[
$n_m
.'|'.
$n_a
.'|'.
$¨gumítos
] = 
$¥i‹idad
;

484 
	`un£t
(
$n_a
, 
$mm
);

485 
	`un£t
(
$n_e
);

488 
	`as‹t
(
$¨ªglo
);

489 
	`ª£t
(
$¨ªglo
);

490  
$¨ªglo
;

491 
	}
}

500 
fun˘i⁄
 
	$ö°™cü_modulo
(
$m
) {

502 
globÆ
 
$gcm
;

506 i‡–! 
	`ö_¨øy
(
$m
,
$this
->
modulos_a˘ivados
) ) ;

512 
$fm
 = 
NULL
 ;

516 
$M
 = 
	`ucfú°
(
$m
);

520 
$logódos
 = ( 
$gcm
->
au
->
	`logódo
(ËË? 
TRUE
 : 
FALSE
 ;

522 i‡–
	`is£t
(
$this
->
ubiˇci⁄es
[
$m
]) ) {

523 i‡–
$logódos
 && 
	`fûe_exi°s
(
$this
->
ubiˇci⁄es
[
$m
].'/lib/'.
$M
.'Admin.php') ) {

524 
$MA
 = 
$M
.'Admin';

525 
$fm
 = 
$this
->
ubiˇci⁄es
[
$m
].'/lib/'.
$MA
.'.php';

527 
$fm
 = 
$this
->
ubiˇci⁄es
[
$m
].'/lib/'.
$M
.'.php';

528 
$MA
 = 
FALSE
;

531 } 
	`ñ£if
 ( 
$logódos
 && 
	`fûe_exi°s
(
$this
->
dú_modulos_¥oye˘o
.
$m
.'/lib/'.
$M
.'Admin.php') ) {

532 
$MA
 = 
$M
.'Admin';

533 
$fm
 = 
$this
->
dú_modulos_¥oye˘o
.
$m
.'/lib/'.
$MA
.'.php';

534 } 
	`ñ£if
 ( 
	`fûe_exi°s
(
$this
->
dú_modulos_¥oye˘o
.
$m
.'/lib/'.
$M
.'.php') ) {

535 
$fm
 = 
$this
->
dú_modulos_¥oye˘o
.
$m
.'/lib/'.
$M
.'.php';

536 
$MA
 = 
FALSE
;

537 } 
	`ñ£if
 ( 
$logódos
 && 
	`fûe_exi°s
(
$this
->
dú_modulos
.
$m
.'/lib/'.
$M
.'.php') ) {

538 
$MA
 = 
$M
.'Admin';

539 
$fm
 = 
$this
->
dú_modulos
.
$m
.'/lib/'.
$MA
.'.php';

540 } 
	`ñ£if
 ( 
	`fûe_exi°s
(
$this
->
dú_modulos
.
$m
.'/lib/'.
$M
.'.php') ) {

541 
$MA
 = 
FALSE
;

542 
$fm
 = 
$this
->
dú_modulos
.
$m
.'/lib/'.
$M
.'.php';

544 
	`åiggî_îr‹
('Eº‹á»ˇrg¨ m√≥dulo, Fichîÿdêm√≥dulÿnÿíc⁄åadÿ['.
$m
.']', 
E_USER_ERROR
);

545 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Eº‹á»ˇrg¨ m√≥dulo, Fichîÿdêm√≥dulÿnÿíc⁄åadÿ['.
$m
.']','ERROR');

546  
FALSE
;

549 i‡–!
	`is£t
(
$this
->
ö°™cüs
[
$m
]) ) {

551 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'In°™cü dêm√≥dulo: ['.
$m
.']');

552 
	`ªquúe_⁄˚
(
$fm
);

554 i‡–
$MA
 ) {

555 
$this
->
ö°™cüs
[
$m
] = 
√w
 
	`$MA
();

557 
$this
->
ö°™cüs
[
$m
] = 
√w
 
	`$M
();

562  
$this
->
ö°™cüs
[
$m
];

564 
	}
}

586 
fun˘i⁄
 
	$œnz¨_acci⁄_modulo
(
$m
, 
$a
, 
$e
=
NULL
, 
$¨gs
=NULL) {

588 
globÆ
 
$gcm
;

590 i‡–! 
	`ö_¨øy
(
$m
,
$this
->
modulos_a˘ivados
) ) ;

593 i‡–! 
$this
->
	`gë_li°a_bœnˇ
(
$m
,
$a
) ) {

595 i‡–! 
	`≥rmiso
(
$a
) ) {

596 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$m
.'->'.
$a
.'() sinÖermisos','ERROR');

597  
FALSE
;

606 i‡–
$this
->
	`ö°™cü_modulo
(
$m
) ) {

608 i‡–
	`mëhod_exi°s
(
$this
->
ö°™cüs
[
$m
], 
$a
 ) ) {

610 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$m
.'->'.
$a
.'('.
$e
.','.
$¨gs
.');');

612 i‡–
GCM_DEBUG
 ) 
$tõmpo_öicio
 = 
	`mi¸Ÿime
(
TRUE
);

613 i‡–
$this
->
ö°™cüs
[
$m
]->
	`$a
(
$e
,
$¨gs
Ë==
FALSE
 ) {

614 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Evítos->œnz¨_acci⁄_modulo('.
$m
.','.
$a
.','.
$e
.','.
$¨gs
.') ErrorálÜanzarÉvento');

616 i‡–
	`°rùos
(
$e
,'¥e'Ë!=
FALSE
 ) {

617 
$evíto_‹igöÆ
 = 
	`°r_ª∂a˚
('¥e','',
$e
);

618 
$this
->
	`™uœr
('¥e'.
$evíto_‹igöÆ
, 
$m
);

619 
$this
->
	`™uœr
(
$evíto_‹igöÆ
, 
$m
);

620 
$this
->
	`™uœr
('po°'.
$evíto_‹igöÆ
, 
$m
);

621 } 
	`ñ£if
 ( 
	`°rùos
(
$e
,'po°'Ë!=
FALSE
 ) {

622 
$evíto_‹igöÆ
 = 
	`°r_ª∂a˚
('po°','',
$e
);

623 
$this
->
	`™uœr
(
$evíto_‹igöÆ
, 
$m
);

624 
$this
->
	`™uœr
('po°'.
$evíto_‹igöÆ
, 
$m
);

626 
$this
->
	`™uœr
(
$e
, 
$m
);

627 
$this
->
	`™uœr
('po°'.
$e
, 
$m
);

631 i‡–
GCM_DEBUG
 ) 
$tõmpo_tŸÆ
 = 
	`round
(
	`mi¸Ÿime
(
TRUE
)-
$tõmpo_öicio
,4);

632 i‡–
GCM_DEBUG
 ) 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Tõmpÿdêejecuci√≥¿dê'.
$m
.'->'.
$a
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'): ('.
$tõmpo_tŸÆ
.')');

637 i‡–
	`is£t
(
$a
Ë&& !
	`em±y
($a) ) {

638 
	`åiggî_îr‹
('Evítos->œnz¨_acci⁄_modulo('.
$m
.','.
$a
.','.
$e
.','.
$¨gs
.') Acci√≥nÇoÑeconocida');

640 
	`åiggî_îr‹
('Evítos->œnz¨_acci⁄_modulo('.
$m
.','.
$a
.','.
$e
.','.
$¨gs
.'ËSöácci√≥¿deföida', 
E_USER_ERROR
);

646 
	`åiggî_îr‹
('Evítos->œnz¨_acci⁄_modulo('.
$m
.','.
$a
.','.
$e
.','.
$¨gs
.'ËM√≥dulÿnÿªc⁄ocido', 
E_USER_ERROR
);

649 
	}
}

658 
fun˘i⁄
 
	$™uœr
(
$evíto
, 
$modulo
) {

659 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Evítos->™uœr('.
$evíto
.','.
$modulo
.')');

660 
$this
->
cEvítos
[
$evíto
]['™uœr'] = 
$modulo
;

661 
	}
}

669 
fun˘i⁄
 
	$™uœdo
(
$e
) {

671  ( 
	`is£t
(
$this
->
cEvítos
[
$e
]['™uœr']ËË? 
TRUE
 : 
FALSE
 ;

673 
	}
}

683 
fun˘i⁄
 
	$unico
(
$evíto
, 
$modulo
) {

684 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Evítos->unico('.
$evíto
.','.
$modulo
.')');

685 
$this
->
cEvítos
[
$evíto
]['unico'] = 
$modulo
;

686 
	}
}

698 
fun˘i⁄
 
acci⁄2evíto
(
$evíto
,
$modulo
,
$mëodo
,
$¥i‹idad
,
$¨gs
='') {

700 
$this
->
evítos
[
$evíto
][
$modulo
][
$mëodo
][
$¥i‹idad
] = 
$¨gs
;

	@gcm/lib/int/gcm/lib/GUtil.php

1 <?
php


29 ˛as†
	cGUtû
 {

36 
fun˘i⁄
 
	$¨chivo_ÀibÀ
(
$¨chivo
) {

38 i‡–!
	`fûe_exi°s
(
$¨chivo
) ) {

39 
	`åiggî_îr‹
('Archivÿnÿíc⁄åadÿ['.
$¨chvio
.']', 
E_USER_ERROR
);

40  
FALSE
;

43 i‡–!
	`is_fûe
(
$¨chivo
) ) {

44 
	`åiggî_îr‹
('Archivÿnÿªguœ∏['.
$¨chvio
.']', 
E_USER_ERROR
);

45  
FALSE
;

48 i‡–!
	`is_ªadabÀ
(
$¨chivo
) ) {

49 
	`åiggî_îr‹
('Archivÿnÿtõ√Öîmiso†dêÀ˘uø ['.
$¨chvio
.']', 
E_USER_ERROR
);

50  
FALSE
;

53  
TRUE
;

62 
fun˘i⁄
 
	$¨chivo_modifiˇbÀ
(
$¨chivo
) {

64 i‡–! 
£lf
::
	`¨chivo_ÀibÀ
(
$¨chivo
) ) {

65 
	`åiggî_îr‹
('Archivÿnÿtõ√Öîmiso†dêÀ˘uø ['.
$¨chvio
.']', 
E_USER_ERROR
);

66  
FALSE
;

69 i‡–! 
	`is_wrôabÀ
(
$¨chivo
) ) {

70 
	`åiggî_îr‹
('Archivÿnÿtõ√Öîmiso†dêes¸ôuø ['.
$¨chvio
.']', 
E_USER_ERROR
);

71  
FALSE
;

74  
TRUE
;

76 
	}
}

91 
fun˘i⁄
 
	$ãxt›œno
(
$ãxt
) {

93 
$ãxt
 = 
	`°rù¶ashes
($text);

94 
$ãxt
 = 
	`åim
($text);

95 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√°|√†|√¢|√Ä|√Å|√Ç/", "a", $text);

96 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√©|√®|√™|√à|√â|√ä/", "e", $text);

97 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√≠|√¨|√Æ|√å|√ç|√é/", "i", $text);

98 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√≥|√≤|√¥|√í|√ì|√î/", "o", $text);

99 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√∫|√π|√ª|√º|√ô|√ö|√õ|√ú/", "u", $text);

100 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√±/", "ny", $text);

101 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√ë/", "NY", $text);

102 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√á/", "C", $text);

103 
$ãxt
 = 
	`¥eg_ª∂a˚
("/√ß/", "c", $text);

104 
$ãxt
 = 
	`°r_ª∂a˚
(" ", "_", $text);

105 
$ãxt
 = 
	`°r_ª∂a˚
("'", "", $text);

107 (
$ãxt
);

109 
	}
}

119 
fun˘i⁄
 
	$escomsim∂e
(
$ãxto
) {

121  
	`°r_ª∂a˚
("'","\'",
	`°rù¶ashes
(
$ãxto
));

123 
	}
}

133 
fun˘i⁄
 
	$escomdobÀs
(
$ãxto
) {

135  
	`°r_ª∂a˚
('"','\"',
	`°rù¶ashes
(
$ãxto
));

137 
	}
}

155 
fun˘i⁄
 
	$ge°i⁄_îr‹es
(
$num_îr
, 
$mís_îr
, 
$nombª_¨chivo
,

156 
$num_löó
, 
$v¨s
)

159 
globÆ
 
$gcm
;

162 
$dt
 = 
	`d©e
("Y-m-d H:i:s (T)");

163 
$fichîo_ªgi°ro
 = 
Rouãr
::
$dú
."../log/errores.log";

170 
$tùo_îr‹
 = 
	`¨øy
 (

171 
E_ERROR
 => "Error",

172 
E_WARNING
 => "Advertencia",

173 
E_PARSE
 => "Error de Int√©rprete",

174 
E_NOTICE
 => "Anotaci√≥n",

175 
E_CORE_ERROR
 => "Error de N√∫cleo",

176 
E_CORE_WARNING
 => "Advertencia de N√∫cleo",

177 
E_COMPILE_ERROR
 => "Error de Compilaci√≥n",

178 
E_COMPILE_WARNING
 => "Advertencia de Compilaci√≥n",

179 
E_USER_ERROR
 => "Error de Usuario",

180 
E_USER_WARNING
 => "Advertencia de Usuario",

181 
E_USER_NOTICE
 => "Anotaci√≥n de Usuario",

182 
E_STRICT
 => "Anotaci√≥n deÅiempo deÉjecuci√≥n"

185 
$îr‹es_a_ªgi°ør
 = 
	`¨øy
(
E_WARNING
, 
E_USER_WARNING
, 
E_USER_ERROR
, 
E_ERROR
, 
E_CORE_ERROR
 );

186 
$îr‹es_a_mo°ør
 = 
	`¨øy
(
E_WARNING
, 
E_USER_WARNING
, 
E_USER_ERROR
, 
E_ERROR
, 
E_CORE_ERROR
);

188 i‡–
	`is£t
(
$tùo_îr‹
[
$num_îr
]) ) {

189 
$tùo
 = 
$tùo_îr‹
[
$num_îr
];

191 
$tùo
 = 
$num_îr
;

194 i‡–
GCM_DEBUG
 ) {

195 
echo
 "<div class='error'>";

196 
echo
 "<p><b>$mens_err</b></p>";

197 
echo
 '<®hªf="vim://'.
$nombª_¨chivo
.'@'.
$num_löó
.'">';

198 
echo
 "<p>$nombre_archivo : $num_linea $tipo</p>";

199 
echo
 "</a>";

200 
echo
 "</div>";

203 i‡(
	`ö_¨øy
(
$num_îr
, 
$îr‹es_a_mo°ør
)) {

207 
	`ªgi°ør
(
$nombª_¨chivo
,
$num_löó
, 
$mís_îr
,'ERROR');

209 } 
	`ñ£if
 ( 
	`ö_¨øy
(
$num_îr
, 
$îr‹es_a_ªgi°ør
) ) {

213 
	`ªgi°ør
(
$nombª_¨chivo
,
$num_löó
, 
$tùo
.' :: '.
$mís_îr
,'ADMIN');

219 
	`ªgi°ør
(
$nombª_¨chivo
,
$num_löó
, 
$tùo
.' :: '.
$mís_îr
,'DEBUG');

223 
	}
}

239 
fun˘i⁄
 
	$tùo_de_¨chivo
(
$¨chivo
) {

241 
globÆ
 
$gcm
;

244 
$mime_dú
='text/directory';

247 i‡–@
	`is_dú
(
$¨chivo
) ) {

248 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo()::tùo_de_¨chivo::mimëy≥=".
$mime_dú
);

249  
$mime_dú
;

253 
$fûeInfo
 = 
	`∑thöfo
(
$¨chivo
);

254 
$ext
 = ( 
	`is£t
(
$fûeInfo
['exãnsi⁄']ËË? $fûeInfo['exãnsi⁄'] : 
NULL
 ;

255 i‡–
	`is£t
(
$ext
ËË$exà
	`°πﬁowî
($ext);

259 i‡–
$ext
 == "btml" )  'text/html';

262 
	`ªquúe
(
GCM_DIR
.'lib/int/mimetypes.php');

264 i‡–! 
	`em±y
(
$mimëy≥s
[
	`åim
(
$ext
)]) ) {

266 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo(".
$¨chivo
.")::tùo_de_¨chivo::mimëy≥=".
$mimëy≥s
[
$ext
]);

267  
$mimëy≥s
[
$ext
];

273 i‡–
	`fûe_exi°s
(
$¨chivo
) ) {

274 
$¨
=
	`f›í
(
$¨chivo
,"r");

275 
$löó
=
	`fgës
(
$¨
);

276 
$∑l
 = 
	`ex∂ode
('/',
$löó
);

277 
	`f˛o£
(
$¨
);

278 
$tùo
 = 
	`åim
(
$∑l
[
	`cou¡
($pal)-1]);

280 
$tùo
) {

283 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo()::tùo_de_¨chivo::mimëy≥=".
$mimëy≥s
['sh']);

284  
$mimëy≥s
['sh'];

287 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo()::tùo_de_¨chivo::mimëy≥=".
$mimëy≥s
['perl']);

288  
$mimëy≥s
['perl'];

291 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo()::tùo_de_¨chivo::mimëy≥=".
$mimëy≥s
['python']);

292  
$mimëy≥s
['py'];

295 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutû::tùo_de_¨chivo()::tùo_de_¨chivo::mimëy≥=".
$mimëy≥s
['php']);

296  
$mimëy≥s
['php'];

306 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gutil::tipo_de_archivo()::tipo_de_archivo::No seÖudo detectarÅipo deárchivoÇi mirando dentro, $archivo");

307  
FALSE
;

309 
	}
}

317 
fun˘i⁄
 
	$íœ˚_documíèci⁄
(
$busˇr
) {

319  "<®hªf='".
Rouãr
::
$ba£
.
GCM_DIR
."../docs/doxygí/html/£¨ch.php?quîy=".
$busˇr
."'>".$buscar."</a>";

321 
	}
}

337 
fun˘i⁄
 
	$gcm_gíî¨_uæ
(
$uæ
=
NULL
) {

339 i‡–
	`is£t
(
$uæ
) ) {

341 
$£cci⁄
 = 
	`dú«me
 ( 
$uæ
 );

342 
$c⁄ãnido
 = 
	`ba£«me
 ( 
$uæ
 );

343 
$u
 = 
Rouãr
::
$dú
.
$£cci⁄
."/".
$c⁄ãnido
;

344 
$u
 = 
	`°r_ª∂a˚
(' ','%20',$u);

345  
$u
;

348 
$b
=
	`dú«me
(
$_SERVER
['PHP_SELF']);

349 
$u
=
$b
.'/'.
$£si⁄
.'/'.
$c⁄ãnido
;

350 
$u
 = 
	`°r_ª∂a˚
('//','/',$u);

351 
$u
 = 
	`°r_ª∂a˚
(' ','%20',$u);

352  
$u
;

353 
	}
}

368 
fun˘i⁄
 
	$desgloßr_uæ
(
$uæ
) {

370 
globÆ
 
$gcm
;

373 
$uæ
 = 
	`°r_ª∂a˚
('Fûe/'.
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto').'/','',$url);

375 
$uæ
 = 
	`°r_ª∂a˚
(
Rouãr
::
$d
.'/','',$url);

377  
$uæ
;

379 
	}
}

396 
fun˘i⁄
 
	$ˇmöo
(
$uæ
,
$íœz¨
 = 
FALSE
, 
$c⁄ãnido
 = 
TRUE
) {

398 
$aUæ
 = 
Rouãr
::
	`desgloßrUæ
(
$uæ
);

399 
$ˇmöo
 = 
	`ex∂ode
('/',
$aUæ
['s']);

400 
$¥imîo
 = 
TRUE
;

401 
$ßlida
 = '';

402 
$íœ˚
 = '';

404 
	`f‹óch
 (
$ˇmöo
 
as
 
$ñemíto
) {

406 i‡–! 
	`em±y
(
$ñemíto
) ) {

407 i‡–!
$¥imîo
 ) 
$ßlida
 .= ' / ';

408 i‡–
$íœz¨
 ) {

409 
$íœ˚
 .
$ñemíto
.'/';

410 
$ßlida
 .'<®hªf="'.
Rouãr
::
$ba£
.
$íœ˚
.'">'.
	`lôîÆ
(
$ñemíto
).'</a>';

412 
$ßlida
 .
	`lôîÆ
(
$ñemíto
);

414 
$¥imîo
 = 
FALSE
;

419 i‡–
$c⁄ãnido
 ) {

420 i‡–
	`is£t
(
$aUæ
['c']) ) {

421 i‡–!
$¥imîo
 ) 
$ßlida
 .= ' / ';

422 i‡–
$íœz¨
 ) {

423 
$ßlida
 .'<®hªf="'.
Rouãr
::
$ba£
.
$uæ
.'">'.
	`lôîÆ
(
	`°r_ª∂a˚
('.html','',
$aUæ
['c'])).'</a>';

425 
$ßlida
 .
	`lôîÆ
(
	`°r_ª∂a˚
('.html','',
$aUæ
['c']));

429  
$ßlida
;

430 
	}
}

	@gcm/lib/int/gcm/lib/Gcm.php

1 <?
php


30 
îr‹_ªp‹tög
(
E_ALL
);

33 
£ssi⁄_°¨t
();

36 
ªquúe
("helpers.php");

39 
ªquúe
("Router.php");

42 
ªquúe
("GUtil.php");

45 
ªquúe
('Eventos.php');

48 
ªquúe
('Plantilla.php');

51 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/solicitud/lib/Solicitud.php');

54 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/registro/Registro.php');

57 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/autentificacion/lib/Autentificacion.php");

60 
ªquúe
('Modulos.php');

64 
fun˘i⁄
 
	$__autﬁﬂd
(
$˛a£
) {

66 
globÆ
 
$gcm
;

68 
$˛a£
 = 
	`°πﬁowî
($clase);

69 
$fich
 = 
GCM_DIR
.'modulos/'.
$˛a£
.'/lib/'.
	`ucfú°
($clase).'.php';

71 i‡–! 
	`fûe_exi°s
(
$fich
) )

72 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Eº‹á»ªquîú m√≥dulÿ['.
$˛a£
.'] E»¨chivÿ['.
$fich
.']ÇoÉxiste','ERROR');

74 
	`ªquúe_⁄˚
(
$fich
);

76 
	}
}

79 
£t_îr‹_h™dÀr
("Gutil::gestion_errores");

90 ˛as†
	cGcm
 {

92 
public
 
	m$pdo
 = 
NULL
;

93 
public
 
	m$evít
;

94 
public
 
	m$rouãr
 = 
NULL
;

95 
public
 
	m$ªg
 = 
NULL
;

96 
public
 
	m$au
 = 
NULL
;

110 
public
 
	m$ãma
 = 
FALSE
;

122 
public
 
	m$mem‹ü
 = 
¨øy
();

128 
public
 
	m$£Àcci⁄ado
;

134 
public
 
	m$ßlida
 = '';

140 
public
 
	m$sufijo
 = '';

162 
¥iv©e
 
	m$c⁄ãnidos
 = 
¨øy
();

168 
¥iv©e
 
	m$javas¸ùts
 = 
¨øy
();

174 
¥iv©e
 
	m$libªrüs_javas¸ùt
 = 
¨øy
();

183 
¥iv©e
 
	m$evítos_¥oye˘o
 = 
TRUE
 ;

189 
¥iv©e
 
	m$c⁄fig
;

197 
public
 
	m$modulos_basicos
 = 
¨øy
(

219 
fun˘i⁄
 
	$__c⁄°ru˘
() {

223 
$∑œbø_£¸ëa_∑ø_debug
 = 
$this
->
	`c⁄fig
('admin','Palabra secretaÖara depurar');

225 i‡–
	`is£t
(
$∑œbø_£¸ëa_∑ø_debug
) ) {

226 i‡–
	`is£t
(
$_GET
[
$∑œbø_£¸ëa_∑ø_debug
]) && $_GET[$palabra_secreta_para_debug] == 1 ) {

227 
	`DEFINE
('GCM_DEBUG', 
TRUE
);

228 
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
] = 1;

229 } 
	`ñ£if
 ( 
	`is£t
(
$∑œbø_£¸ëa_∑ø_debug
Ë&& is£t(
$_GET
[$palabra_secreta_para_debug]) && $_GET[$palabra_secreta_para_debug] != 1 ) {

230 
	`DEFINE
('GCM_DEBUG', 
FALSE
);

231 i‡–
	`is£t
(
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
]) ) $_SESSION[$palabra_secreta_para_debug] = 0;

232 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
]) && $_SESSION[$palabra_secreta_para_debug] == 1 ) {

233 
	`DEFINE
('GCM_DEBUG', 
TRUE
);

234 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
]) && $_SESSION[$palabra_secreta_para_debug] != 1 ) {

235 
	`DEFINE
('GCM_DEBUG', 
FALSE
);

236 i‡–
	`is£t
(
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
]) ) $_SESSION[$palabra_secreta_para_debug] = 0;

238 
	`DEFINE
('GCM_DEBUG', 
FALSE
);

241 
	`DEFINE
('GCM_DEBUG',
FALSE
);

242 i‡–
	`is£t
(
$_SESSION
[
$∑œbø_£¸ëa_∑ø_debug
]) ) $_SESSION[$palabra_secreta_para_debug] = 0;

245 
$this
->
sufijo
 = $this->
	`c⁄fig
('admin','SufijoÖara base de datos');

247 
$bd_ªgi°ros
 = 
$this
->
	`c⁄fig
('admin','bd_conexion');

252 i‡–
	`°Ωos
(
$bd_ªgi°ros
,'sqlôe'Ë!=
FALSE
 || $bd_registros == '' ) {

254 i‡–! 
	`is_dú
('log'ËË
	`mkdú
('log');

255 
$this
->
ªg
 = 
√w
 
	`Regi°ro
('log');

259 
$this
->
ªg
 = 
√w
 
	`Regi°ro
($this->
	`pdo_c⁄exi⁄
('ªgi°ros'),$this->
sufijo
);

263 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Gcm->c⁄°ru˘: REQUEST_URI: '.
$_SERVER
['REQUEST_URI'],'NORMAL');

294 
fun˘i⁄
 
	$c⁄fig
(
$modulo
, 
$nombª_v¨übÀ
, 
$vÆ‹
=
FALSE
) {

296 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmConfig/lib/GcmConfigFactory.php');

299 
$modulo
 = 
	`°πﬁowî
($modulo[0]).
	`sub°r
($modulo,1);

302 i‡–!
$vÆ‹
 && 
	`is£t
(
$this
->
c⁄fig
[
$modulo
][
$nombª_v¨übÀ
]) )  $this->config[$modulo][$nombre_variable];

304 
$dú_c⁄figuøci⁄_¥oye˘o
 = 'DATOS/configuracion/';

306 i‡–
$vÆ‹
 && !
	`fûe_exi°s
(
$dú_c⁄figuøci⁄_¥oye˘o
ËË
	`mkdú
($dir_configuracion_proyecto);

308 
$dú_c⁄figuøci⁄_¥oye˘o_modulo
 = 
$dú_c⁄figuøci⁄_¥oye˘o
.
$modulo
.'/';

310 i‡–
$vÆ‹
 && !
	`fûe_exi°s
(
$dú_c⁄figuøci⁄_¥oye˘o_modulo
) )

311 
	`mkdú
(
$dú_c⁄figuøci⁄_¥oye˘o_modulo
);

313 
$¨chivo_c⁄figuøci⁄
 = 
$dú_c⁄figuøci⁄_¥oye˘o_modulo
.'config.php';

315 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,

316 'C⁄fig, modulo: ['.
$modulo
.'] vÆ‹: ['.
$vÆ‹
.']

317 
Archivo
 
de
 
c⁄figuøci
√≥
n
 ['.$archivo_configuracion.']');

319 i‡–
$vÆ‹
 ) {

321 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$¨chivo_c⁄figuøci⁄
);

323 
$¨r
->
	`£t
(
$nombª_v¨übÀ
,
$vÆ‹
);

324 
$¨r
->
	`gu¨d¨_v¨übÀs
();

325 
$this
->
c⁄fig
[
$modulo
][
$nombª_v¨übÀ
] = 
$vÆ‹
;

329 i‡–!
	`fûe_exi°s
(
$¨chivo_c⁄figuøci⁄
ËË$¨chivo_c⁄figuøci⁄ = 
GCM_DIR
.'modulos/'.
$modulo
.'/config/config.php';

331 i‡–!
	`fûe_exi°s
(
$¨chivo_c⁄figuøci⁄
) ) {

332 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__


333 ,'Nÿã√mo†ñárchivÿ['.
$¨chivo_c⁄figuøci⁄
.'] dêc⁄figuøci√≥¿dñ m√≥dulÿ['.
$modulo
.']','ERROR');

334  
FALSE
;

337 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$¨chivo_c⁄figuøci⁄
);

338 
$vÆ‹
 = 
$¨r
->
	`gë
(
$nombª_v¨übÀ
);

339 
$this
->
c⁄fig
[
$modulo
][
$nombª_v¨übÀ
] = 
$vÆ‹
;

340  
$vÆ‹
;

344 
	}
}

357 
fun˘i⁄
 
	$c⁄°ruú_£Àcci⁄ado
(
$¨gs
=
NULL
) {

359 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$¨gs
.')');

361 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

363 i‡–
	`is£t
(
$∑ømëros
['url']) ) {

365 
$mís
 = 'Seleccionados vieneÖor $args';

366 
$this
->
£Àcci⁄ado
 = 
	`¨øy
(
$∑ømëros
['url']);

368 } 
	`ñ£if
 ( 
	`is£t
 ( 
$_GET
['seleccionado']) ) {

370 
$mís
 = 'Seleccionados vieneÖor _GET';

371 
$this
->
£Àcci⁄ado
 = 
$_GET
['seleccionado'];

373 } 
	`ñ£if
 ( 
	`is£t
 ( 
$_POST
['seleccionado']) ) {

375 
$mís
 = 'Seleccionados vieneÖor _POST';

376 
$this
->
£Àcci⁄ado
 = 
$_POST
['seleccionado'];

378 } 
	`ñ£if
 ( 
	`is£t
 ( 
$_POST
['f']) ) {

380 
$mís
 = 'Seleccionados vieneÖor _POST[$f]';

381 
$this
->
£Àcci⁄ado
 = 
	`¨øy
(
$_POST
['f']);

385 
$mís
 = 'Seleccionados vieneÖor defectoárchivoáctual';

386 
$this
->
£Àcci⁄ado
 = 
	`¨øy
(
Rouãr
::
$d
.Rouãr::
$s
.Rouãr::
$c
);

390 i‡–
	`is£t
(
$mís
ËË
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$¨gs
.') '.$mens);

391 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`dïuør
(
$this
->
£Àcci⁄ado
,'Seleccionado'));

392 
	}
}

401 
fun˘i⁄
 
	$add_lib_js
(
$modulo
, 
$¨chivo
) {

402 i‡–
	`ö_¨øy
(
$modulo
.":".
$¨chivo
, 
$this
->
libªrüs_javas¸ùt
) ) {

403 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Temas->javas¸ùts('.
$modulo
.','.
$¨chivo
.') A√±adidoánteriormente');

406 
$this
->
libªrüs_javas¸ùt
[] = 
$modulo
.":".
$¨chivo
;

407 
	}
}

416 
fun˘i⁄
 
	$add_js
(
$modulo
, 
$¨chivo
) {

417 i‡–
	`ö_¨øy
(
$modulo
.":".
$¨chivo
, 
$this
->
javas¸ùts
) ) {

418 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Temas->javas¸ùts('.
$modulo
.','.
$¨chivo
.') A√±adidoánteriormente');

421 
$this
->
javas¸ùts
[] = 
$modulo
.":".
$¨chivo
;

422 
	}
}

428 
fun˘i⁄
 
	$li°a_js
(Ë{  
$this
->
javas¸ùts
; 
	}
}

434 
fun˘i⁄
 
	$li°a_lib_js
(Ë{  
$this
->
libªrüs_javas¸ùt
; 
	}
}

457 
fun˘i⁄
 
pdo_c⁄exi⁄
(
$c⁄exi⁄
='principal') {

461 i‡–
is£t
(
$this
->
pdo
[
$c⁄exi⁄
]) )  $this->pdo[$conexion];

464 
	g$ubiˇci⁄
 = 'local';

468 
	g$bd_c⁄exi⁄
 = 
$this
->
c⁄fig
('admin','bd_conexion');

469 
	g$bd_usu¨io
 = 
$this
->
c⁄fig
('admin','bd_usuario');

470 
	g$bd_∑ss
 = 
$this
->
c⁄fig
('admin','bd_pass');

472 
	g$drivî
 = 
ex∂ode
(':',
$bd_c⁄exi⁄
);

473 
	g$mŸ‹
 = 
$drivî
[0];

474 
	g$¨chivo
 = 
$drivî
[1];

476 i‡–
	g$mŸ‹
 == "sqlite" ) {

480 
$dú
 = 
dú«me
(
$¨chivo
);

482 i‡–! 
mkdú_ªcursivo
(
$dú
) ) {

483 
ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
dïuør
(
$¨gs
).'ËNÿ£Öudÿ¸ó∏ñ dúe˘‹iÿ∑øÜ®ba£ dêd©o†['.
$dú
.']','ERROR');

484 
exô
();

489 
	g$this
->
ªgi°ø
(
__FILE__
,
__LINE__
,'CreamosÇueva conexi√≥ná base de datos','DEBUG');

491 
	gåy
 {

493 i‡–
	g$mŸ‹
 == "sqlite" ) {

495 
$this
->
pdo
[
$c⁄exi⁄
] = 
√w
 
PDO
(
$bd_c⁄exi⁄
);

497 } 
ñ£if
 ( 
$mŸ‹
 == 'mysql' ) {

499 
$this
->
pdo
[
$c⁄exi⁄
] = 
√w
 
PDO
(
$bd_c⁄exi⁄
, 
$bd_usu¨io
,
$bd_∑ss
,

500 
¨øy
(
PDO
::
MYSQL_ATTR_INIT_COMMAND
 => "SET NAMES utf8"));

504 
	g$this
->
	gpdo
[
$c⁄exi⁄
] = 
√w
 
PDO
(
$bd_c⁄exi⁄
, 
$bd_usu¨io
, 
$bd_∑ss
);

508 
	g$this
->
	gpdo
[
$c⁄exi⁄
]->
£tAâribuã
(
PDO
::
ATTR_ERRMODE
, PDO::
ERRMODE_EXCEPTION
);

509 
	g$this
->
	gpdo
[
$c⁄exi⁄
]->
£tAâribuã
(
PDO
::
ATTR_PERSISTENT
, 
TRUE
);

511 } 
ˇtch
 (
Ex˚±i⁄
 
$ex
) {

513 
	gecho
 "<p class='error'>";

514 
	gecho
 "Error conÜa conexi√≥ná base de datos";

515 
	gecho
 "<p>Configure correctamenteÉlárchivo del m√≥duloádmin</p>";

516 i‡–
	gGCM_DEBUG
 ) {

517 
	gecho
 '<br />';

518 
echo
 
	g$ex
->
gëMesßge
();

519 
	gecho
 '<br />';

520 
echo
 
	g$ex
->
gëFûe
(),'@',$ex->
gëLöe
();

522 
	gecho
 "</p>";

524 
exô
();

525 
ªgi°ør
(
$ex
->
gëFûe
(),$ex->
gëLöe
,$ex->
gëMesßge
(),'ERROR');

529  
	g$this
->
	gpdo
[
$c⁄exi⁄
];

537 
fun˘i⁄
 
	$__gë
(
$ñemíto
) {

539 i‡–
	`is£t
(
$this
->
c⁄ãnidos
[
$ñemíto
] ) ) {

540 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gcm->__gë('.
$ñemíto
.')');

541  
$this
->
c⁄ãnidos
[
$ñemíto
];

544 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gcm->__gë('.
$ñemíto
.'): NoÉsta definido');

545  
FALSE
;

546 
	}
}

552 
fun˘i⁄
 
	$__£t
(
$ñemíto
, 
$vÆ‹
) {

554 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gcm->__£t('.
$ñemíto
.')');

555 
$this
->
c⁄ãnidos
[
$ñemíto
] = 
$vÆ‹
;

557 
	}
}

561 
fun˘i⁄
 
	$__is£t
(
$ñemíto
) {

563  
	`is£t
(
$this
->
c⁄ãnidos
[
$ñemíto
]);

565 
	}
}

569 
fun˘i⁄
 
ªgi°ø
(
$fichîo
,
$löó
,
$míßje
, 
$tùo
='DEBUG', 
$des¸ùci⁄
 = 
NULL
) {

571 i‡–
$this
->
ªg
 
ö°™˚of
 
Regi°ro
 ) {

572 
$this
->
ªg
->
ªgi°ø
(
$fichîo
,
$löó
,
$míßje
, 
$tùo
, 
$des¸ùci⁄
);

589 
fun˘i⁄
 
	$¥o˚ßC⁄ãnido
(
$evíto
) {

591 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Gcm->¥o˚ßC⁄ãnido('.
$evíto
.')');

593 
	`ob_°¨t
();

595 
åy
 {

597 
$this
->
evít
->
	`œnz¨Evíto
(
$evíto
);

599 } 
	`ˇtch
 (
Ex˚±i⁄
 
$e
) {

601 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Gcm->¥o˚ßC⁄ãnido: Eº‹É¿evítÿ['.
$evíto
.'] '.
$e
->
	`gëMesßge
(),'DEBUG');

604 
$this
->
c⁄ãnidos
[
$evíto
] = ( 
	`is£t
($this->c⁄ãnidos[$evíto]ËË? $this->c⁄ãnidos[$evíto].
	`ob_gë_c⁄ã¡s
() : ob_get_contents();

606 
	`ob_íd_˛ón
();

608 i‡–
	`em±y
(
$this
->
c⁄ãnidos
[
$evíto
]) ) {

609 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gcm->¥o˚ßC⁄ãnido: Evítÿ['.
$evíto
.'] sin contenido');

610  
FALSE
;

613 
$ßlida
 = 
PHP_EOL
.'<!-- '.
$evíto
.' -->'.PHP_EOL;

614 i‡–
$evíto
 == 'titulo' ) {

615 
$ßlida
 .'<h1 cœss="tôulo_¥öcùÆ">'.
$this
->
c⁄ãnidos
[
$evíto
].'</h1>';

617 
$ßlida
 .
$this
->
c⁄ãnidos
[
$evíto
];

619 
$ßlida
 .
PHP_EOL
.'<!-- / '.
$evíto
.' -->'.PHP_EOL;

620  
$ßlida
;

622 
	}
}

626 
fun˘i⁄
 
	$ßlú
() {

628 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gcm->salir()');

630 i‡–
$this
->
evít
->
	`vîifiˇr_evíto
('po°ˇrga'ËË$this->evít->
	`œnz¨Evíto
('postcarga');

640 
echo
 
$this
->
ßlida
;

641 
	`exô
();

643 
	}
}

652 
fun˘i⁄
 
	$¥e£¡¨_∑göa
() {

654 
$∂™tûœ_uæ
 = 
$this
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('temas','html','principal.html');

656 i‡–!
$∂™tûœ_uæ
 ) {

657 
$∂™tûœ_uæ
 = 
$this
->
ãma
->
	`ruè
('temas','html','principal.html');

660 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Gcm->¥e£¡¨_∑göa: Pro˚ßmo†∂™tûœ htm»[".
$∂™tûœ_uæ
."]");

662 
$∂™tûœ
 = 
√w
 
	`Pœ¡ûœ
(
$∂™tûœ_uæ
, 
$this
);

663 
$∑göa
 = 
$∂™tûœ
->
	`¥o˚ßPœ¡ûœ
();

665  
$∑göa
;

667 
	}
}

686 
fun˘i⁄
 
	$öicü
() {

690 
$this
->
au
 = 
√w
 
	`Auã¡ifiˇci⁄
($this->
	`pdo_c⁄exi⁄
(), $this->
sufijo
);

694 i‡–
GCM_DEBUG
 || 
$this
->
au
->
	`logódo
(ËË$this->
ªg
->
	`nivñ
('ADMIN');

697 i‡(
	`is£t
(
$_POST
['ßlú']Ë|| is£t(
$_GET
['salir'])) {

698 
$this
->
au
->
	`ßlú
();

699 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"gcm->inicia: Sessi√≥nÅerminada");

704 i‡–
	`is£t
(
$_POST
['loginPro']) ){

705 i‡–
$this
->
au
->
	`íå¨
(
$_POST
["loginPro"],$_POST["passwd"]) ) {

706 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'gcm->öicü: Usu¨iÿ[ '.
$_POST
['loginPro'].' ]Ñegistrado');

712 i‡–
$this
->
au
->
	`logódo
() ) {

713 
$this
->
evítos_¥oye˘o
 = ( 
	`is£t
(
$_GET
['eGcm']ËË? 
FALSE
 : 
TRUE
 ;

714 
$visuÆiz¨
 = ( 
	`is£t
(
$_GET
['eVisuÆiz¨']ËË? 
TRUE
 : 
FALSE
 ;

715 
$this
->
evít
 = 
√w
 
	`Evítos
(
GCM_DIR
.'modulos/',
TRUE
,$this->
evítos_¥oye˘o
,
$visuÆiz¨
);

717 
$this
->
evít
 = 
√w
 
	`Evítos
(
GCM_DIR
.'modulos/',
FALSE
);

720 
$this
->
rouãr
 = 
Rouãr
::
	`gëIn°™˚
();

721 
$this
->
rouãr
->
	`öicü
();

727 
	`DEFINE
('GCM_DIR_P',
Rouãr
::
$dú
.
GCM_DIR
);

729 
$this
->
c⁄ãnidos
['contenido'] = '';

731 
$this
->
	`c⁄°ruú_£Àcci⁄ado
();

734 
	`ob_°¨t
();

740 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'gcm->öicü: Uæ:'.
$_SERVER
['REQUEST_URI']);

742 
$this
->
evít
->
	`œnz¨Evíto
('precarga');

744 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Tem®a˘uÆ de•ue†dêßlú dê¥eˇrga: '.
$this
->
evít
->
ö°™cüs
['ãmas']->
	`gëTema
());

748 i‡–
Rouãr
::
$m
 ) {

749 
$m
 = 
Rouãr
::$m;

750 
$a
 = 
Rouãr
::$a;

751 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'gcm->öicü: Recibimo†≥tici√≥¿dêm√≥dulÿ['.
$m
.'] c⁄ácci√≥¿['.
$a
.']','DEBUG');

752 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

753 
$this
->
evít
->
	`œnz¨_acci⁄_modulo
(
$m
,
$a
);

754 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
(); 
	`ob_íd_˛ón
();

755 
$this
->
ßlida
 = 
$ßlida
;

756 
$this
->
	`ßlú
();

758 
$this
->
evít
->
	`œnz¨_acci⁄_modulo
(
$m
,
$a
);

764 i‡–
Rouãr
::
$e
 ) {

765 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"gcm->öicü: Tíemo†u¿evítÿdeföido[".
Rouãr
::
$e
.']');

766 
åy
 {

767 
$this
->
evít
->
	`œnz¨Evíto
(
Rouãr
::
$e
);

768 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

769 
$this
->
	`ªgi°ø
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),"gcm->öicü: Eº‹á»œnz¨Évíto: ".$ex->
	`gëMesßge
(),'ERROR');

771 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

772 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
(); 
	`ob_íd_˛ón
();

773 
$this
->
ßlida
 = $this->
c⁄ãnido
;

774 
$this
->
ßlida
 .
$ßlida
;

775 
$this
->
	`ßlú
();

781 
$this
->
c⁄ãnidos
['c⁄ãnido'] .
	`ob_gë_c⁄ã¡s
(); 
	`ob_íd_˛ón
();

783 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

784 
$this
->
	`ßlú
();

787 
$this
->
ßlida
 = $this->
	`¥e£¡¨_∑göa
();

789 
$this
->
	`ßlú
();

791 
	}
}

	@gcm/lib/int/gcm/lib/Modulos.php

1 <?
php


27 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/GcmConfig/lib/GcmConfigFactory.php");

41 
ab°ø˘
 cœs†
	cModulos
 {

43 
¥iv©e
 
	m$c⁄èd‹_ö°™cüs
 = -1;

50 
¥iv©e
 
	m$nombª_˛a£
 = '';

58 
fun˘i⁄
 
	$__c⁄°ru˘
() {

60 
globÆ
 
$gcm
;

62 
£lf
::
$c⁄èd‹_ö°™cüs
++;

63 
$this
->
nombª_˛a£
 = 
	`°r_ª∂a˚
('Admö','',
	`gë_˛ass
($this));

65 i‡–
$gcm
 ) {

66 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Inicüd®˛a£ hija::[".
$this
->
nombª_˛a£
.'] Numîÿdêö°™cü: ['.
£lf
::
$c⁄èd‹_ö°™cüs
.']');

77 
¥Ÿe˘ed
 
fun˘i⁄
 
	$™uœrEvíto
(
$evíto
) {

79 
globÆ
 
$gcm
;

81 i‡–
$gcm
 && $gcm 
ö°™˚of
 
Gcm
 ) {

82 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$evíto
.'ËEvítÿ™uœdÿp‹ '.
$this
->
nombª_˛a£
);

83 
$gcm
->
evít
->
	`™uœr
(
$evíto
,
$this
->
nombª_˛a£
);

85 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->™uœrEvíto('.
$evíto
.') GcmÇoÉsta definido','ERROR');

87 
	}
}

96 
¥Ÿe˘ed
 
fun˘i⁄
 
œnz¨Evíto
(
$evíto
, 
$¨gs
='') {

98 
globÆ
 
$gcm
;

100 i‡–
	g$gcm
 && 
$gcm
 
ö°™˚of
 
	gGcm
 ) {

101 
ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$evíto
.'ËL™zadÿevítÿdesdê'.
$this
->
nombª_˛a£
);

102 
	g$gcm
->
	gevít
->
œnz¨Evíto
(
$evíto
,
$¨gs
);

104 
ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->™uœrEvíto('.
$evíto
.','.
$¨gs
.') GcmÇoÉsta definido','ERROR');

114 
¥Ÿe˘ed
 
fun˘i⁄
 
	$libªrüs_js
(
$¨chivo
) {

116 
globÆ
 
$gcm
;

118 i‡–
$gcm
 && $gcm 
ö°™˚of
 
Gcm
 ) {

119 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->libªrüs_js('.
$¨chivo
.'Ëmodulo: '.
$this
->
nombª_˛a£
);

120 
$gcm
->
	`add_lib_js
(
$this
->
nombª_˛a£
,
$¨chivo
);

122 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->libªrü_javas¸ùts('.
$¨chivo
.') $gcmÇoÉsta definida','ERROR');

124 
	}
}

132 
¥Ÿe˘ed
 
fun˘i⁄
 
	$javas¸ùts
(
$¨chivo
) {

134 
globÆ
 
$gcm
;

136 i‡–
$gcm
 && $gcm 
ö°™˚of
 
Gcm
 ) {

137 
$gcm
->
	`add_js
(
$this
->
nombª_˛a£
,
$¨chivo
);

138 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->javas_¸ùts('.
$¨chivo
.'Ëmodulo: '.
$this
->
nombª_˛a£
);

140 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modulos->javas¸ùts('.
$¨chivo
.') $gcmÇoÉsta definida','ERROR');

142 
	}
}

148 
¥Ÿe˘ed
 
fun˘i⁄
 
	$c⁄fig
(
$ñemíto
,
$vÆ‹
=
NULL
) {

150 
globÆ
 
$gcm
;

152 i‡–
$gcm
 && $gcm 
ö°™˚of
 
Gcm
 ) {

153 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$ñemíto
.','.
$vÆ‹
.')');

155 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

156 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$ñemíto
.','.
$vÆ‹
.'ËGcmÇÿe°®im∂emíèdÿ∑ø Modulo. '.
$this
->
nombª_˛a£
,

158  
FALSE
;

161 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

162 'C⁄fig, modulo: ['.
$this
->
nombª_˛a£
.'] EÀmítÿ['.
$ñemíto
.'] vÆ‹: ['.
$vÆ‹
.']');

164  
$gcm
->
	`c⁄fig
(
$this
->
nombª_˛a£
,
$ñemíto
,
$vÆ‹
);

166 
	}
}

172 
public
 
fun˘i⁄
 
	$c⁄figuøci⁄
(
$e
, 
$¨gs
) {

174 
globÆ
 
$gcm
;

176 i‡–!
	`≥rmiso
('c⁄figuøci⁄'ËË 
FALSE
;

178 i‡–
	`is£t
(
$_POST
['accion']) && $_POST['accion'] == 'escribir_gcmconfig' ) {

182 
åy
 {

184 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmConfig/lib/GcmConfigGui.php');

186 
$c⁄figuøci⁄
 = 
√w
 
	`GcmC⁄figGui
(
$_POST
['archivo']);

188 
$c⁄figuøci⁄
->
	`es¸ibú_desde_po°
();

190 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

191 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),$ex->
	`gëMesßge
(),'ERROR');

192  
FALSE
;

195 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Configuraci√≥n guardada',3),'AVISO');

201 i‡–
	`is£t
(
$¨gs
['modulo']) ) {

202 
$modulo
 = 
$¨gs
['modulo'];

203 
$mí
 = 'Desdeárgs';

204 } 
	`ñ£if
 ( !
	`em±y
(
Rouãr
::
$m
) ) {

205 
$modulo
 = 
Rouãr
::
$m
;

206 
$mí
 = 'Desde Router';

208 
$modulo
 = 
$this
->
nombª_˛a£
;

209 
$mí
 = 'DesdeÉlÖropio m√≥dulo';

212 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

213 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'.
$mí
.' ['.
$modulo
.']');

215 
$this
->
	`™uœrEvíto
('titulo');

216 
$this
->
	`™uœrEvíto
('contenido');

217 
$gcm
->
tôulo
 = 
	`lôîÆ
('C⁄figuøci√≥n',3).' '.lôîÆ('de',3).' '.
$modulo
;

219 
$¨chivo
 = 'DATOS/c⁄figuøci⁄/'.
$modulo
.'/config.php';

226 i‡–
	`is£t
(
$_POST
['ª£t']Ë&& 
	`fûe_exi°s
(
$¨chivo
ËË
	`u∆ök
($archivo);

228 i‡–!
	`fûe_exi°s
('DATOS/c⁄figuøci⁄'ËË
	`mkdú
('DATOS/configuracion');

229 i‡–!
	`fûe_exi°s
('DATOS/c⁄figuøci⁄/'.
$modulo
ËË
	`mkdú
('DATOS/configuracion/'.$modulo);

231 i‡–!
	`fûe_exi°s
(
$¨chivo
ËË
	`c›y
(
GCM_DIR
.'modulos/'.
$modulo
.'/config/config.php', $archivo);

233 
åy
 {

235 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmConfig/lib/GcmConfigGui.php');

237 
$c⁄figuøci⁄
 = 
√w
 
	`GcmC⁄figGui
(
$¨chivo
);

239 
$¨gs
 = 
	`¨øy
();

240 
$¨gs
['eliminar'] = 'si';

242 
$c⁄figuøci⁄
->
	`dúe˘‹io_des¸ùci⁄es
(
GCM_DIR
.'modulos/'.
$modulo
.'/config');

244 
$c⁄figuøci⁄
->
	`f‹muœrio
(
$¨gs
);

246 
echo
 '<br /><br /><formáction="" method="post">';

247 
echo
 '<inputÇame="reset"Åype="submit" value="ValoresÖor defecto"/>';

248 
echo
 '</form>';

250 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

251 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),$ex->
	`gëMesßge
(),'ERROR');

255 
	}
}

268 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ejecuè_ã°
(
$nombª
, 
$uno
, 
$dos
 = 
FALSE
) {

270 i‡––! 
$dos
 && 
$uno
 ) || ( $uno === $dos ) ) {

271 
echo
 '<div cœss="aviso">'.
$this
->
nombª_˛a£
.' '.
$nombª
.' bien</div>';

273 
echo
 '<div cœss="îr‹">'.
$this
->
nombª_˛a£
.' <b>'.
$nombª
.'</b>: ';

274 i‡–
	`is_¨øy
(
$uno
) ) {

275 
echo
 '<b∏/>'.
	`dïuør
(
$uno
).'<b∏/>di„ª¡ê®<b∏/>'.dïuør(
$dos
);

277 
echo
 '['.
$uno
.'] di„ª¡ê®['.
$dos
.']';

279 
echo
 '</div>';

282 
	}
}

	@gcm/lib/int/gcm/lib/Plantilla.php

1 <?
php


41 ˛as†
	cPœ¡ûœ
 {

43 
¥iv©e
 
	m$cPœ¡ûœ
;

44 
¥iv©e
 
	m$ñemítos
;

45 
¥iv©e
 
	m$objëo
;

46 
¥iv©e
 
	m$∂™tûœ
;

47 
¥iv©e
 
	m$ñemítos_vôÆes_¥imîos
;

54 
¥iv©e
 
	m$ñemítos_vôÆes_u…imos
;

55 
¥iv©e
 
	m$c⁄ãnido_ñemítos
;

67 
fun˘i⁄
 
	$__c⁄°ru˘
(
$∂™tûœ
, 
$objëo
) {

69 
$this
->
objëo
 = 
$objëo
;

70 
$this
->
∂™tûœ
 = 
$∂™tûœ
;

72 
$this
->
ñemítos_vôÆes_¥imîos
 = 
	`¨øy
('contenido','titulo');

73 
$this
->
ñemítos_vôÆes_u…imos
 = 
	`¨øy
('avisos','debug','scripts');

77 
$this
->
cPœ¡ûœ
 = @
	`fûe_gë_c⁄ã¡s
($this->
∂™tûœ
);

79 
	`¥eg_m©ch_Æl
('/\{[A-Za-z]+\}/', 
$this
->
cPœ¡ûœ
, 
$ñ
, 
PREG_PATTERN_ORDER
);

81 
$this
->
ñemítos
 = 
$ñ
[0];

99 
fun˘i⁄
 
	$¥o˚ßPœ¡ûœ
() {

101 
$ßlida
 = 
$this
->
cPœ¡ûœ
;

103 
	`f‹óch
 ( 
$this
->
ñemítos_vôÆes_¥imîos
 
as
 
$ñ
) {

104 
$this
->
c⁄ãnido_ñemítos
[
$ñ
] = $this->
objëo
->
	`¥o˚ßC⁄ãnido
($el);

107 
	`f‹óch
 ( 
$this
->
ñemítos
 
as
 
$ñ
 ) {

109 
$ñ
 = 
	`sub°r
($ñ, 1, 
	`°æí
($el)-2);

111 i‡–!
	`ö_¨øy
(
$ñ
,
$this
->
ñemítos_vôÆes_u…imos
Ë&& !ö_¨øy($ñ,$this->
ñemítos_vôÆes_¥imîos
) ) {

112 
$this
->
c⁄ãnido_ñemítos
[
$ñ
] = $this->
objëo
->
	`¥o˚ßC⁄ãnido
($el);

117 
	`f‹óch
 ( 
$this
->
ñemítos_vôÆes_u…imos
 
as
 
$ñ
) {

118 
$this
->
c⁄ãnido_ñemítos
[
$ñ
] = $this->
objëo
->
	`¥o˚ßC⁄ãnido
($el);

121 
	`f‹óch
 ( 
$this
->
c⁄ãnido_ñemítos
 
as
 
$key
 => 
$c⁄ãnidos
 ) {

125 i‡–
$key
 == 'contenido' )  ;

127 i‡–!
$c⁄ãnidos
 ) {

129 i‡––
	`ö_¨øy
(
$key
,
$this
->
ñemítos_vôÆes_¥imîos
Ë|| in_¨øy($key,$this->
ñemítos_vôÆes_u…imos
 ) && $key !== 'scripts' ) ) {

130 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

131 'Nÿã√mo†c⁄ãnidÿvôÆÖ¨®['.
$key
.'] dê∂™tûœ ['.
$this
->
∂™tûœ
.'] yÉsÇecesarioÖaraÉl correcto funcionamiento');

133 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'EÀmítÿ['.
$key
.'] dê∂™tûœ ['.
$this
->
∂™tûœ
.'] vacio');

138 
$ªsu…ado
 = "\n<!-- EÀmíto:".
$key
." -->\n".
$c⁄ãnidos
."\n<!-- Acaba:".$key." -->\n";

139 
$ßlida
 = 
	`°r_ª∂a˚
('{'.
$key
.'}', 
$ªsu…ado
, $salida);

141 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Pœ¡ûœ->¥o˚ßPœ¡ûœ(Ë FöÆiz®¥o˚sÿíÖœ¡ûœÖ¨®ñemítÿ['.
$ñ
.']');

146 
$key
 = 'contenido';

147 
$c⁄ãnidos
 = 
$this
->
c⁄ãnido_ñemítos
['contenido'];

149 i‡–!
$c⁄ãnidos
 ) {

150 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿã√mo†c⁄ãnidÿ∑ø c⁄ãnidÿ['.
$c⁄ãnidos
.'] dê∂™tûœ ['.
$this
->
∂™tûœ
.']');

152 
$ªsu…ado
 = '<div id="'.
$key
.'">'.
$c⁄ãnidos
.'</div>';

153 
$ßlida
 = 
	`°r_ª∂a˚
('{'.
$key
.'}', 
$ªsu…ado
, $salida);

156  
$ßlida
;

158 
	}
}

	@gcm/lib/int/gcm/lib/Router.php

1 <?
php


74 ˛as†
	cRouãr
 {

76 
¥iv©e
 
	m$ª„ªncü
 = 
NULL
;

87 
¥iv©e
 
	m$modulos
 = 
NULL
;

99 
public
 
	m$¨gs
;

105 
¥iv©e
 
	m$evítos
 = 
NULL
;

113 
¥iv©e
 
	m$f‹m©os
 = 
NULL
;

119 
¥iv©e
 
	m$idiomas
 = 
NULL
 ;

121 
public
 
	m$uæ
;

122 
public
 
	m$dú
;

123 
public
 
	m$dd
;

124 
public
 
	m$d
;

125 
public
 
	m$s
;

126 
public
 
	m$c
;

127 
public
 
	m$f
;

128 
public
 
	m$m
;

129 
public
 
	m$a
;

130 
public
 
	m$e
;

131 
public
 
	m$i
;

132 
public
 
	m$ii
;

133 
public
 
	m$ba£
;

134 
public
 
	m$e°amos
;

135 
public
 
	m$edô¨
;

136 
public
 
	m$mime_ty≥
;

137 
public
 
	m$f‹m©o
;

138 
public
 
	m$esB‹ød‹
 = 
FALSE
;

139 
public
 
	m$sö_c⁄ãnido
 = 
FALSE
;

140 
public
 
	m$sö_åaducci⁄
 = 
FALSE
;

141 
public
 
	m$f‹ma_comíèrios
 = '<!-- %s -->';

148 
public
 
	m$íœ˚_ªœtivo
;

156 
fun˘i⁄
 
	$£t_idiomas
() {

157 
£lf
::
$idiomas
 = 
	`¨øy
('es','ca');

164 
fun˘i⁄
 
	$£t_f‹m©os
() {

165 
£lf
::
$f‹m©os
 = 
	`¨øy
('html', 'ajax', 'rst');

166 
	}
}

174 
fun˘i⁄
 
	$£t_evítos
() {

176 
globÆ
 
$gcm
;

178 i‡–
	`is£t
(
$gcm
->
evít
->
evítos
) ) {

180 
£lf
::
$evítos
 = 
	`¨øy_keys
(
$gcm
->
evít
->
evítos
);

203 
	}
}

214 
fun˘i⁄
 
	$£t_modulos
() {

216 
globÆ
 
$gcm
;

218 i‡–
	`is£t
(
$gcm
->
evít
->
evítos
) ) {

220 
	`f‹óch
 ( 
$gcm
->
evít
->
evítos
 
as
 
$evíto
 ) {

221 
	`f‹óch
 ( 
$evíto
 
as
 
$modulo
 => 
$acci⁄
 ) {

222 i‡–! 
£lf
::
$modulos
 || ! 
	`ö_¨øy
(
$modulo
,self::$modulos) ) {

223 
£lf
::
$modulos
[] = 
$modulo
;

241 
	}
}

247 
fun˘i⁄
 
	$com¥ob¨_ª£rvadas
() {

249 
$msg
 = 
FALSE
;

250 
$msg_comun
 = "\nLas coincidenciasÉnÜasÖalabrasÑeservadas que utiliza RouterÖuedenáfectar

251 
Æ
 
comp‹èmõ¡o
 
de
 
Rouãr
 
a
 
œ
 
h‹a
 dê
£Àcci⁄¨
Ü®
acci
√≥
n
 
que
 
£
 
de£a
 
ªÆiz¨
, 
∑ø


252 
m
√°
s
 
öf‹maci
√≥
n
 
vó£
 
œ
 
documíèci
√≥¿
de
 ".GUtil::enlace_documentacion('Router');

254 
$ª£rvadas
 = 
	`¨øy
('modulos', 'eventos', 'idiomas', 'formatos');

256 
	`f‹óch
 ( 
$ª£rvadas
 
as
 
$ª£rvada
 ) {

258 
	`f‹óch
 ( 
£lf
::
$$ª£rvada
 
as
 
$ñemíto
 ) {

259 i‡–
$ª£rvada
 !'evítos' && 
	`ö_¨øy
(
$ñemíto
, 
£lf
::
$evítos
) ) {

260 
$msg
 .= "$reservada: $elemento coincide conÉventos\n";

262 i‡–
$ª£rvada
 !'modulos' && 
	`ö_¨øy
(
$ñemíto
, 
£lf
::
$modulos
) ) {

263 
$msg
 .= "$reservada: $elemento coincide con modulos\n";

265 i‡–
$ª£rvada
 !'idiomas' && 
	`ö_¨øy
(
$ñemíto
, 
£lf
::
$idiomas
) ) {

266 
$msg
 .= "$reservada: $elemento coincide con idiomas\n";

268 i‡–
$ª£rvada
 !'f‹m©os' && 
	`ö_¨øy
(
$ñemíto
, 
£lf
::
$f‹m©os
) ) {

269 
$msg
 .= "$reservada: $elemento coincide con formatos\n";

274 i‡–
$msg
 ) 
	`ªgi°ør
(
__FILE__
,
__LINE__
,$msg.
$msg_comun
,'ADMIN');

277 
	}
}

283 
fun˘i⁄
 
	$gëIn°™˚
() {

285 i‡–!
£lf
::
$ª„ªncü
 
ö°™˚of
 self ) {

287 
$˛a£
 = 
__CLASS__
;

288 
£lf
::
$ª„ªncü
 = 
√w
 
$˛a£
;

292  
£lf
::
$ª„ªncü
;

294 
	}
}

304 
fun˘i⁄
 
	$öicü
(
$uæ
=
NULL
) {

306 
globÆ
 
$gcm
;

308 
$¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

310 
$this
->
	`£t_modulos
();

311 
$this
->
	`£t_evítos
();

312 
$this
->
	`£t_f‹m©os
();

313 
$this
->
	`£t_idiomas
();

316 i‡–! 
	`is£t
(
$uæ
ËË$uæ = 
	`°rù¶ashes
((is£t(
$_REQUEST
['url'])) ? $_REQUEST['url'] : '' );

317 
$ªt‹no
 = 
£lf
::
	`desgloßrUæ
(
$uæ
);

321 
£lf
::
$uæ
 = 
$ªt‹no
['url'];

322 
£lf
::
$s
 = 
$ªt‹no
['s'];

323 
£lf
::
$c
 = 
$ªt‹no
['c'];

324 
£lf
::
$a
 = 
$ªt‹no
['a'];

325 
£lf
::
$e
 = 
$ªt‹no
['e'];

326 
£lf
::
$i
 = 
$ªt‹no
['i'];

327 
£lf
::
$ii
 = 
$ªt‹no
['ii'];

328 
£lf
::
$d
 = 
$ªt‹no
['d'];

329 
£lf
::
$dd
 = 
$ªt‹no
['dd'];

330 
£lf
::
$m
 = 
$ªt‹no
['m'];

331 
£lf
::
$¨gs
 = 
$ªt‹no
['args'];

332 
£lf
::
$f‹m©o
 = 
$ªt‹no
['formato'];

333 
£lf
::
$íœ˚_ªœtivo
 = 
$ªt‹no
['enlace_relativo'];

334 
£lf
::
$mime_ty≥
 = 
$ªt‹no
['mime_type'];

335 
£lf
::
$esB‹ød‹
 = 
$ªt‹no
['esBorrador'];

336 
£lf
::
$f‹ma_comíèrios
 = 
$ªt‹no
['forma_comentarios'];

338 i‡–
	`is£t
(
$_REQUEST
['i']) ) {

339 
£lf
::
$i
 = 
$_REQUEST
['i'];

340 } 
	`ñ£if
 ( 
	`is£t
(
$_REQUEST
['idioma']) ) {

341 
£lf
::
$i
 = 
$_REQUEST
['idioma'];

342 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
[
$¥oye˘o
."-idioma"]) ) {

343 
£lf
::
$i
 = 
$_SESSION
[
$¥oye˘o
."-idioma"];

346 i‡–
	`is£t
(
$_REQUEST
['f‹m©o']ËË{ 
£lf
::
$f‹m©o
 = $_REQUEST['formato']; }

348 i‡–
	`is£t
(
$_REQUEST
['a']ËË{ 
£lf
::
$a
 = $_REQUEST['a']; }

349 i‡–
	`is£t
(
$_REQUEST
['e']ËË{ 
£lf
::
$e
 = $_REQUEST['e']; }

350 i‡–
	`is£t
(
$_REQUEST
['m']ËË{ 
£lf
::
$m
 = $_REQUEST['m']; }

351 i‡–
	`is£t
(
$_REQUEST
['¨gs']ËË{ 
£lf
::
$¨gs
 = $_REQUEST['args']; }

354 
£lf
::
$d
 = "Fûe/".£lf::
$i
.'/';

364 
$uri_p
=
	`¥eg_ª∂a˚
('/\?(.*)$/', '', 
$_SERVER
['REQUEST_URI']);

365 
$uri
 = 
	`ex∂ode
("/",
$uri_p
);

366 
$s¸ùtName
 = 
	`ex∂ode
("/",
$_SERVER
['SCRIPT_NAME'] );

367 
$£c
 = 
	`¨øy_diff
(
$uri
, 
$s¸ùtName
);

368 
$di„ªncü
 = 
	`cou¡
(
$uri
)-cou¡(
$s¸ùtName
);

371 
£lf
::
$dú
 = '';

372 
$x
=0;$x<
$di„ªncü
;$x++) {

373 
£lf
::
$dú
 .= "../";

376 
£lf
::
$ba£
 = sñf::
$íœ˚_ªœtivo
.£lf::
$dú
;

380 
$aC¨≥è_ba£
=
	`ex∂ode
('/',
$_SERVER
['SCRIPT_FILENAME']);

381 
$ˇΩëa_ba£
 = 
$aC¨≥è_ba£
[
	`cou¡
($aCarpeta_base)-2];

383 
$aUæ
 = 
	`ex∂ode
('/',
£lf
::
$uæ
);

384 
$˛ave
 = 
	`¨øy_£¨ch
(
$ˇΩëa_ba£
, 
$aUæ
);

385 i‡–
$˛ave
 > 0 ) {

386 
£lf
::
$uæ
=
	`im∂ode
('/',
	`¨øy_¶i˚
(
$aUæ
,
$˛ave
+1));

391 
£lf
::
$uæ
 = 
	`°r_ª∂a˚
('../','',self::$url);

397 
£lf
::
$s
 = ( 
	`is£t
(
$_REQUEST
['s']ËË? 
	`°rù¶ashes
($_REQUEST['s']) : self::$s;

398 
£lf
::
$c
 = ( 
	`is£t
(
$_REQUEST
['c']ËË? 
	`°rù¶ashes
($_REQUEST['c']) : self::$c;

400 i‡–
£lf
::
$s
 == '/' ) self::$s = '';

407 i‡–
	`esImagí
–
£lf
::
$uæ
) ) {

409 
$¨chivo
 = 
£lf
::
$dd
.£lf::
$uæ
;

410 i‡–!
	`is_fûe
(
$¨chivo
) ) {

413 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Rouãr::Nÿíc⁄åado:......'.
$¨chivo
);

415 
$¨chivo_¨øy
 = 
	`ex∂ode
('Fûe',
$¨chivo
);

417 
$¨chivo
 = 'Fûe'.
$¨chivo_¨øy
[
	`cou¡
($archivo_array)-1];

418 i‡–! 
	`fûe_exi°s
(
$¨chivo
) ) {

419 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Rouãr::Tampocÿícuíåo:..'.
$¨chivo
);

421 
$¨chivo
 = 
	`°r_ª∂a˚
(
£lf
::
$s
,'',$archivo);

422 i‡–! 
	`fûe_exi°s
(
$¨chivo
) ) {

423 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Rouãr::öicü::Tampocÿícuíåo:..'.
$¨chivo
.

425 
	`exô
();

429 
$¨chivo_c⁄ãnido
 = 
	`fûe_gë_c⁄ã¡s
(
$¨chivo
);

430 
	`hódî
('C⁄ã¡-ty≥: '. 
£lf
::
$mime_ty≥
);

431 
	`hódî
 ("Expúes: ".
	`gmd©e
("D, d M Y H:i:s",
	`time
()+86400).' GMT');

432 
echo
 
$¨chivo_c⁄ãnido
;

433 
	`exô
();

438 i‡(!
£lf
::
$s
 && !£lf::
$c
) {

439 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Router::inicia::No hay secci√≥nÇi contenido');

440 
£lf
::
$f
=£lf::
$d
."index.html";

441 
£lf
::
$c
 = "index.html";

442 
£lf
::
$e°amos
="inicio";

444 } 
	`ñ£if
 (!
£lf
::
$s
 && sñf::
$c
){

445 
£lf
::
$f
=£lf::
$d
.£lf::
$c
;

446 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Router::inicia::No hay seccion");

448 } 
	`ñ£if
 (
£lf
::
$c
 && !£lf::
$s
) {

449 
£lf
::
$f
=£lf::
$d
.£lf::
$c
;

450 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Router::inicia::No hay seccion,Öero si contenido");

452 } 
	`ñ£if
 (
£lf
::
$s
 && !£lf::
$c
) {

453 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Router::inicia::Hay seccion,ÖeroÇo hay contenido");

454 
£lf
::
$f
=£lf::
$d
.£lf::
$s
."index.html";

455 
£lf
::
$c
 = "index.html";

456 } 
	`ñ£if
 (
£lf
::
$c
 && sñf::
$s
) {

457 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Router::inicia::Hay seccion, y hay contenido");

458 
£lf
::
$f
=£lf::
$d
.£lf::
$s
.£lf::
$c
;

466 i‡(!
	`em±y
(
£lf
::
$s
)) {

467 
£lf
::
$e°amos
 = 
	`ba£«me
(£lf::
$d
.£lf::
$s
);

471 
$this
->
	`com¥ob¨_ª£rvadas
();

474 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Rouãr:'.
	`dïuør
(
	`gë_˛ass_v¨s
(
__CLASS__
),'Variables'));

476 
	}
}

487 
fun˘i⁄
 
	$desgloßrUæ
(
$uæ
) {

489 
globÆ
 
$gcm
;

493 
$c⁄ãnidos
 = 
$gcm
->
evít
->
	`ö°™cü_modulo
('contenidos');

495 
$s
 = 
NULL
;

496 
$c
 = 
NULL
;

497 
$dd
 = 
NULL
;

498 
$d
 = 
NULL
;

499 
$ii
 = 
NULL
;

500 
$i
 = 
NULL
;

501 
$a
 = 
NULL
;

502 
$m
 = 
NULL
;

503 
$¨gs
 = 
NULL
;

504 
$e
 = 
NULL
;

505 
$íœ˚_ªœtivo
 = 
NULL
;

506 
$mime_ty≥
 = 
NULL
;

507 
$f‹m©o
 = 
NULL
;

509 
$ªt‹no
 = 
	`¨øy
();

510 
$uæ
 = 
	`°r_ª∂a˚
('//','/',$url);

514 
$ii
 = 
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto');

516 
$¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

520 i‡–
	`°Ωos
(
$uæ
,'/Fûe/'Ë!=
FALSE
 ) {

521 
$uæ
 = 
	`sub°r
($uæ,
	`°Ωos
($url,'/File/'));

526 
$c⁄töu¨
 = 
TRUE
;

528  
$c⁄töu¨
 ) {

530 
$c⁄töu¨
 = 
FALSE
;

534 
$£cci⁄es
 = 
	`ex∂ode
('/',
$uæ
);

536 i‡–
	`íd
(
$£cci⁄es
) != 'proyecto.js' &&Énd($secciones) != 'proyectos.css' ) {

538 i‡–
	`ö_¨øy
(
$£cci⁄es
[0], 
£lf
::
$modulos
) ) {

539 
$m
 = 
$£cci⁄es
[0];

540 
	`¨øy_shi·
(
$£cci⁄es
);

541 
$a
 = ( 
	`is£t
(
$£cci⁄es
[0]ËË? $£cci⁄es[0] : 
FALSE
;

542 
	`¨øy_shi·
(
$£cci⁄es
);

545  
	`is£t
(
$£cci⁄es
[0]Ë&& ! 
$c⁄ãnidos
->
	`vîifiˇr_£cci⁄
($secciones[0]) && $secciones[0] != 'proyectos.css' && $secciones[0] != 'proyecto.js' ) {

546 
$¨gs
[] = 
$£cci⁄es
[0];

547 
	`¨øy_shi·
(
$£cci⁄es
);

550 
$uæ
 = 
	`im∂ode
('/',
$£cci⁄es
);

551 
$c⁄töu¨
 = 
TRUE
;

558 
$£cci⁄es
 = 
	`ex∂ode
('/',
$uæ
);

560 i‡–
	`ö_¨øy
(
$£cci⁄es
[0], 
£lf
::
$evítos
) ) {

561 
$e
 = 
$£cci⁄es
[0];

562 
	`¨øy_shi·
(
$£cci⁄es
);

565  
	`is£t
(
$£cci⁄es
[0]Ë&& ! 
$c⁄ãnidos
->
	`vîifiˇr_£cci⁄
($secciones[0]) && $secciones[0] != 'proyectos.css' && $secciones[0] != 'proyecto.js' ) {

566 
$¨gs
[] = 
$£cci⁄es
[0];

567 
	`¨øy_shi·
(
$£cci⁄es
);

570 
$uæ
 = 
	`im∂ode
('/',
$£cci⁄es
);

571 
$c⁄töu¨
 = 
TRUE
;

576 
$£cci⁄es
 = 
	`ex∂ode
('/',
$uæ
);

578 i‡–
	`ö_¨øy
(
$£cci⁄es
[0], 
£lf
::
$f‹m©os
) ) {

579 
$f‹m©o
 = 
$£cci⁄es
[0];

580 
	`¨øy_shi·
(
$£cci⁄es
);

581 
$uæ
 = 
	`im∂ode
('/',
$£cci⁄es
);

582 
$c⁄töu¨
 = 
TRUE
;

586 i‡–!
$f‹m©o
 ) { $formato = 'html'; }

590 
$£cci⁄es
 = 
	`ex∂ode
('/',
$uæ
);

592 i‡–
	`ö_¨øy
(
$£cci⁄es
[0], 
£lf
::
$idiomas
) ) {

593 
$i
 = 
$£cci⁄es
[0];

594 
	`¨øy_shi·
(
$£cci⁄es
);

595 
$uæ
 = 
	`im∂ode
('/',
$£cci⁄es
);

596 
$c⁄töu¨
 = 
TRUE
;

607 if(
	`°ri°r
(
$uæ
, 'Fûe/'Ë!=
FALSE
) {

608 
$d
 = 
	`sub°r
(
$uæ
,0,7);

609 
$i
 = 
	`°r_ª∂a˚
('Fûe/','',
$d
);

610 
$d
 = 
	`com¥ob¨_b¨ø
($d);

613 
$dd
 = 'Fûe/'.
$ii
.'/';

617 
$uæ
=
	`°r_ª∂a˚
(
$dd
,'',$url);

619 i‡–
$d
 ) 
$uæ
=
	`°r_ª∂a˚
($d,'',$url);

626 
$uæ_sö_subdúe˘‹ios
 = 
	`°r_ª∂a˚
('../','',
$uæ
);

628 
$mime_ty≥
 = 
GUtû
::
	`tùo_de_¨chivo
(
$dd
.
$uæ_sö_subdúe˘‹ios
);

630 i‡–
	`sub°r_cou¡
(
$uæ
,".btml") != 0) {

631 
$esB‹ød‹
 = 
TRUE
 ;

633 
$esB‹ød‹
 = 
FALSE
 ;

638 
$mime_ty≥
) {

641 
$f‹ma_comíèrios
 = '/* %s */';

644 
$f‹ma_comíèrios
 = '/* %s */';

647 
$f‹ma_comíèrios
 = 
£lf
::$forma_comentarios;

653 i‡–
	`em±y
(
$mime_ty≥
) || $mime_type != 'text/directory' ) {

655 
$uæ_¨øy
 = 
	`ex∂ode
("/",
$uæ
);

656 
$u…imo
 = 
$uæ_¨øy
[
	`cou¡
($url_array)-1];

657 
	`un£t
(
$uæ_¨øy
[
	`cou¡
($url_array)-1]);

658 
$s
 = 
	`im∂ode
('/',
$uæ_¨øy
);

659 
$c
 = 
$u…imo
;

663 i‡–
$uæ
 == 'index.html' ) {

664 
$s
 = '';

665 
$c
 = 'index.html';

667 
$s
 = 
$uæ
;

668 
$c
= '';

675 i‡–!
	`em±y
(
$s
ËË$†–$s{
	`°æí
($s)-1} == '/' ) ? $s : $s.'/' ;

676 i‡–
$s
 == '/' ) $s = '';

677 
$s
 = 
	`°r_ª∂a˚
('../','',$s);

681 i‡–
$mime_ty≥
 ='ãxt/dúe˘‹y' && 
	`com¥ob¨_b¨ø
(
$uæ
) != $url ) {

682 
$£cci⁄es
 = 
	`ex∂ode
('/',
$s
);

683 
$u…imo
 = 
$£cci⁄es
[
	`cou¡
($secciones)-2];

684 
$íœ˚_ªœtivo
 = ( 
	`em±y
(
$u…imo
) ) ? '' : './';

686 
$íœ˚_ªœtivo
 = './';

689 
$ªt‹no
['uæ'] = 
$uæ
;

690 
$ªt‹no
['s'] = 
$s
;

691 
$ªt‹no
['c'] = 
$c
;

692 
$ªt‹no
['dd'] = 
$dd
;

693 
$ªt‹no
['d'] = ( 
$d
 ) ? $d : 
$dd
 ;

694 
$ªt‹no
['ii'] = 
$ii
;

695 
$ªt‹no
['i'] = ( 
$i
 ) ? $ò: 
$ii
 ;

696 
$ªt‹no
['a'] = 
$a
;

697 
$ªt‹no
['m'] = 
$m
;

698 
$ªt‹no
['¨gs'] = 
$¨gs
;

699 
$ªt‹no
['e'] = 
$e
;

700 
$ªt‹no
['íœ˚_ªœtivo'] = 
$íœ˚_ªœtivo
;

701 
$ªt‹no
['mime_ty≥'] = 
$mime_ty≥
;

702 
$ªt‹no
['f‹m©o'] = 
$f‹m©o
;

703 
$ªt‹no
['esB‹ød‹'] = 
$esB‹ød‹
;

704 
$ªt‹no
['f‹ma_comíèrios'] = 
$f‹ma_comíèrios
;

706  
$ªt‹no
;

708 
	}
}

	@gcm/lib/int/gcm/lib/helpers.php

1 <?
php


16 if–! 
fun˘i⁄_exi°s
("literal") ) {

42 
fun˘i⁄
 
lôîÆ
(
$lôîÆ
, 
$nivñ
=2, 
$vÆ‹
=
NULL
) {

44 
globÆ
 
$LG
, 
$GCM_LG
, 
$gcm
;

46 
	g$¥oye˘o
 = 
$gcm
->
c⁄fig
('admin','Proyecto');

48 
	g$lôîÆ
 = 
html_ítôy_decode
(
$lôîÆ
,
ENT_NOQUOTES
,'UTF-8');

50 i‡–
em±y
(
$lôîÆ
Ë|| 
	g$lôîÆ
 == ' ' || $literal == '' ) {

51  
FALSE
;

54 
	g$nivñ
) {

58 i‡–!
$vÆ‹
 && 
is£t
(
$LG
[
$lôîÆ
]) && $LG[$literal] != "" ) {

59  
$LG
[
$lôîÆ
] ;

62 i‡–
	g$vÆ‹
 ) {

64 
	g$mís
 = 'NuevÿlôîÆ ['.
$lôîÆ
.'] dê¥oye˘ÿc⁄ vÆ‹ ['.
$vÆ‹
.']';

66 } 
ñ£if
 ( 
is_¨øy
(
$LG
Ë&& ! @
¨øy_key_exi°s
 ( 
$lôîÆ
 , $LG ) ) {

72 
	g$mís
 = 'NuevÿlôîÆ dê¥oye˘ÿ['.
$lôîÆ
.']';

73 
	g$vÆ‹
 = '';

76  
	g$lôîÆ
;

79 
	g$idioma_a˘uÆ
 = 
$_SESSION
[
$¥oye˘o
.'-idioma'];

80 
	g$fûe
=
$gcm
->
c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
	g$idioma_a˘uÆ
.".php";

82 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/GcmConfig/lib/GcmConfigFactory.php");

84 
	g$¨r
 = 
GcmC⁄figFa˘‹y
::
GëGcmC⁄fig
(
$fûe
);

85 
	g$¨r
->
£t
(
$lôîÆ
,
$vÆ‹
);

86 
	g$¨r
->
gu¨d¨_v¨übÀs
();

88 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
);

90 
	g$LG
[
$lôîÆ
] = '';

92  
	g$lôîÆ
;

98 i‡–
is£t
(
$LG
[
$lôîÆ
]) && $LG[$literal] != "" ) {

99  
$LG
[
$lôîÆ
] ;

100 } 
ñ£if
 ( 
is£t
(
$GMC_LG
[
$lôîÆ
]Ë&& 
$GCM_LG
[$literal] != "" ) {

101  
$GMC_LG
[
$lôîÆ
];

106  
	g$lôîÆ
;

112 i‡–!
$vÆ‹
 && 
is£t
(
$GCM_LG
[
$lôîÆ
]Ë&& !
em±y
($GCM_LG[$literal]) && $GCM_LG[$literal] !== '' ) {

113  
$GCM_LG
[
$lôîÆ
] ;

116 i‡–
	g$vÆ‹
 ) {

118 
	g$mís
 = 'NuevÿlôîÆ ['.
$lôîÆ
.'] dêGcm c⁄ vÆ‹ ['.
$vÆ‹
.']';

120 } 
ñ£if
 ( ! 
¨øy_key_exi°s
 ( 
$lôîÆ
 , 
$GCM_LG
 ) ) {

122 
	g$mís
 = 'NuevÿlôîÆ dêGcm ['.
$lôîÆ
.']';

123 
	g$vÆ‹
 = '';

126  
	g$lôîÆ
;

129 
	g$idioma_a˘uÆ
 = 
$_SESSION
[
$¥oye˘o
.'-idioma'];

130 
	g$fûe
=
GCM_DIR
."DATOS/idiomas/GCM_LG_".
$idioma_a˘uÆ
.".php";

132 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/GcmConfig/lib/GcmConfigFactory.php");

134 
	g$¨r
 = 
GcmC⁄figFa˘‹y
::
GëGcmC⁄fig
(
$fûe
);

135 
	g$¨r
->
£t
(
$lôîÆ
,
$vÆ‹
);

136 
	g$¨r
->
gu¨d¨_v¨übÀs
();

138 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
);

142 
	g$GCM_LG
[
$lôîÆ
]='';

144  
	g$lôîÆ
;

148  
	gFALSE
;

153 i‡–! 
fun˘i⁄_exi°s
("registrar") ) {

166 
fun˘i⁄
 
ªgi°ør
(
$fichîo
,
$löó
,
$míßje
,
$tùo
='DEBUG') {

168 
globÆ
 
$gcm
;

172 i‡–!
is£t
(
$gcm
) ) {

173 
	gecho
 '<div class="error">No hay instancia de gcm';

174 
	gecho
 '<b∏/>Míßje: '.
	g$míßje
;

175 
	gecho
 '<b∏/>'.
	g$fichîo
,
	g$löó
,
	g$míßje
,
	g$tùo
;

176 
	gecho
 '</div>';

182 
	g$gcm
->
ªgi°ø
(
$fichîo
,
$löó
,
$míßje
,
$tùo
);

205 
fun˘i⁄
 
com¥ob¨_b¨ø
(
$uæ
, 
$acci⁄
='anyadir') {

207 
$uæ
 = 
°r_ª∂a˚
('//','/',$url);

209 i‡(
	g$uæ
) {

211 i‡–
	g$acci⁄
 == 'eliminar' ) {

212 i‡–
$uæ
{
°æí
($url)-1} == '/' ) {

213  
sub°r
(
$uæ
,0, -1);

215  
	g$uæ
;

218 i‡–
	g$uæ
{
°æí
(
$uæ
)-1} == '/' ) {

219  
$uæ
;

221  
	g$uæ
.'/';

241 
fun˘i⁄
 
	$esImagí
(
$¨chivo
) {

243 
$exãnsi⁄es
 = 
	`¨øy
("jpg", "jpeg", "JPG", "JPEG", "GIF", "gif", "png", "PNG", "tiff", "TIFF");

246 
$fûeInfo
 = 
	`∑thöfo
(
$¨chivo
);

247 
$ext
 = ( 
	`is£t
(
$fûeInfo
['exãnsi⁄']ËË? $fûeInfo['exãnsi⁄'] : 
NULL
 ;

250 i‡–
	`ö_¨øy
(
$ext
,
$exãnsi⁄es
) ) {

251  
TRUE
;

253  
FALSE
;

256 
	}
}

260 
fun˘i⁄
 
	$dïuør
(
$v¨
, 
$tôulo
=
NULL
, 
$nivñ
=0) {

262 i‡–
$tôulo
 ) {

263 
$tôulo
 = "[".$titulo."]\n";

265 
$tôulo
 = 
NULL
;

268 
$°rög
 = '';

269 
$èbuœd‹
 = '';

271 i‡–
$nivñ
 > 0 ) 
$èbuœd‹
 = 
	`°r_ª≥©
("\t",$nivel);

273 i‡(
$tôulo
Ë
$°rög
 .
$èbuœd‹
.$titulo;

275 
$nivñ
++;

277 i‡(
	`is_¨øy
(
$v¨
)) {

279 
	`f‹óch
(
$v¨
 
as
 
$key
 => 
$vÆue
) {

281 i‡(
	`is_¨øy
(
$vÆue
)) {

282 
$°rög
 ."\n".
$èbuœd‹
.
$key
.': ';

283 
$°rög
 .
	`dïuør
(
$vÆue
, 
Ál£
, 
$nivñ
);

284 } 
	`ñ£if
(
	`gëty≥
(
$vÆue
) == 'object') {

285 
$°rög
 ."\n".
$èbuœd‹
.
$key
.': ';

286 
$°rög
 ."Obje˘ o‡˛as†" . 
	`gë_˛ass
(
$vÆue
);

288 
$°rög
 ."\n".
$èbuœd‹
.
$key
.': ';

289 
$°rög
 .= "$value" ;

294 } 
	`ñ£if
(
	`gëty≥
(
$v¨
) == 'object') {

295 
$°rög
 ."Obje˘ o‡˛as†" . 
	`gë_˛ass
(
$v¨
);

297 
$°rög
 .= "$var" ;

300  
$°rög
;

301 
	}
}

311 
fun˘i⁄
 
	$ªcogî_∑ømëros
(
$∑ømëros
){

313 
$ªt‹no
 = 
	`¨øy
();

315 i‡–
	`is£t
–
$∑ømëros
 ) ) {

317 i‡–!
	`is_¨øy
(
$∑ømëros
) ) {

319 i‡–
	`sub°r_cou¡
(
$∑ømëros
,'&') > 0 ) {

320 
$d©os
 = 
	`ex∂ode
('&',
$∑ømëros
);

322 
$d©os
 = 
	`¨øy
(
$∑ømëros
);

326 
$d©os
 = 
$∑ømëros
;

329 
	`f‹óch
 (
$d©os
 
as
 
$∑ømëro
) {

330 i‡–
	`sub°r_cou¡
(
$∑ømëro
,'=') > 0 ) {

331 
	`li°
(
$v¨
,
$vÆ
Ë
	`ex∂ode
('=',
$∑ømëro
);

332 
$ªt‹no
[
$v¨
] = 
$vÆ
;

337  
$ªt‹no
;

338 
	}
}

355 
fun˘i⁄
 
	$¥e£¡¨Byãs
(
$byãs
) {

357 
$Kb
 = 
	`•rötf
("%.1f", 
$byãs
 / 1000);

359  
$Kb
.'Kb';

361 
	}
}

385 
fun˘i⁄
 
¥e£¡¨Fecha
(
$time
, 
$f‹m©o_ßlida
=1, 
$f‹m©o_íåada
='unix') {

387 
ªgi°ør
(
__FILE__
,
__LINE__
, "<br>time: $time / formato_entrada: $formato_entrada / formato_salida: $formato_salida");

389 i‡–
	g$f‹m©o_íåada
 ='sqlôe' ) 
$f‹m©o_íåada
 = 'unix';

391 i‡–
	g$f‹m©o_íåada
 == 'deducir' ) {

393 i‡–
is_öt
(
$time
) ) {

394 
$f‹m©o_íåada
 = 'unix';

396 
ªgi°ør
(
__FILE__
,
__LINE__
, "Nÿ£ÖudÿdedicúÉ»f‹m©ÿdêœ fech®[".
$time
."]",'ADMIN');

400 i‡–
	g$f‹m©o_íåada
 != 'unix' ) {

402 
$f‹m©o_íåada
) {

405 
$time
 = 
°πŸime
–
d©e
($time) );

408 
$time
 = 
°πŸime
–
d©e
($time) );

413 
	g$mes
 = 
d©e
('F', 
$time
);

414 
	g$dü
 = 
d©e
('d', 
$time
);

415 
	g$™yo
 = 
d©e
('Y', 
$time
);

416 
	g$h‹a
 = 
d©e
('H', 
$time
);

417 
	g$möutos
 = 
d©e
('i', 
$time
);

419 
	g$mes
 = 
lôîÆ
(
$mes
);

421 
	g$f‹m©o_ßlida
) {

424  
$dü
.' dê'.
$mes
.', '.
$™yo
. ' '.
$h‹a
.':'.
$möutos
;

428  
$dü
.' dê'.
$mes
;

432  
$dü
.' dê'.
$mes
.', '.
$™yo
;

452 
fun˘i⁄
 
	$modifiˇrGë
(
$v¨
, 
$vÆ‹
) {

454 
globÆ
 
$s
, 
$c
 ;

456 
$ßlida
 = "?".
$v¨
."=".
$vÆ‹
;

457 
	`f‹óch
(
$_GET
 
as
 
$key
 => 
$vÆ
 ) {

458 i‡–
$key
 !
$v¨
 ) {

460 i‡–
$key
 != "url" ) {

461 
$ßlida
 ."&".
$key
."=".
$vÆ
;

465  
$ßlida
;

467 
	}
}

475 
fun˘i⁄
 
	$c⁄°ruú_gë
 (
$v¨übÀs
) {

477 
$ªsu…ado
 = 
	`¨øy_mîge
–
$_GET
, 
$v¨übÀs
 );

479 
$simbﬁo
 = '?';

480 
$ßlida
 = '';

482 
	`f‹óch
 ( 
$ªsu…ado
 
as
 
$v¨übÀ
 => 
$vÆ‹
) {

484 
$ßlida
 .
$simbﬁo
.
$v¨übÀ
."=".
$vÆ‹
;

485 
$simbﬁo
 = '&';

488  
$ßlida
;

490 
	}
}

492 if–! 
fun˘i⁄_exi°s
("permiso") ) {

512 
fun˘i⁄
 
≥rmiso
(
$acci⁄
='admöi°ør', 
$modulo
 = 'admö', 
$ßlú
=
FALSE
, 
$míßje
=FALSE) {

514 
globÆ
 
$gcm
;

516 i‡–
	g$gcm
->
	gau
->
≥rmiso
(
$acci⁄
, 
$modulo
ËË 
	gTRUE
;

518 i‡–
	g$ßlú
 ) {

519 
ªgi°ør
(
__FILE__
,
__LINE__
,'SeÇecesitanÖermisosÖaraÉstaácci√≥n','ERROR');

520 
hódî
('loˇti⁄:'.
Rouãr
::
$ba£
.Rouãr::
$s
.Rouãr::
$c
);

521 
exô
();

522 } 
ñ£if
 ( 
$míßje
 ) {

523 
ªgi°ør
(
__FILE__
,
__LINE__
,'SeÇecesitanÖermisosÖaraÉstaácci√≥n','ERROR');

526  
	gFALSE
;

544 
fun˘i⁄
 
	$limpürC⁄ãnido
(
$c⁄ãnido
){

545 
$c⁄ãnido

	`¥eg_ª∂a˚
( '/\\\"/', '\"', $contenido);

546 
$c⁄ãnido

	`¥eg_ª∂a˚
( "/\\\'/", "'", $contenido);

547 
$c⁄ãnido

	`¥eg_ª∂a˚
( "/\'/", "'", $contenido);

548 
$c⁄ãnido
 = 
	`°rù¶ashes
($contenido);

549  
$c⁄ãnido
;

550 
	}
}

570 
fun˘i⁄
 
	$¨øy_li°a
(
$c⁄ãnido
, 
$nivñ
=0, 
$f‹m
=
FALSE
) {

572 i‡–
	`em±y
(
$c⁄ãnido
ËË 
FALSE
;

574 
$f‹m©o_f‹m
 = '<input checkedÅype="checkbox"Çame="seleccionado[]" value="%s" /> ';

576 
echo
 "\n".
	`°r_ª≥©
("\t",
$nivñ
)."<ul>";

577 
	`f‹óch
 ( 
$c⁄ãnido
 
as
 
$key
 => 
$vÆ
 ) {

578 i‡–
	`is_¨øy
(
$vÆ
) ) {

579 
echo
 "\n".
	`°r_ª≥©
("\t",
$nivñ
);

580 i‡–
$f‹m
 ) 
	`¥ötf
(
$f‹m©o_f‹m
,
$key
);

581 
echo
 "<b>$key</b>";

582 
	`¨øy_li°a
(
$vÆ
, ++
$nivñ
, 
$f‹m
);

584 i‡–
	`em±y
(
$vÆ
) ) {

585 
echo
 "\n\t".
	`°r_ª≥©
("\t",
$nivñ
)."<li>";

586 i‡–
$f‹m
 ) 
	`¥ötf
(
$f‹m©o_f‹m
,
$key
);

587 
echo
 
$key
,'</li>';

589 
echo
 "\n\t".
	`°r_ª≥©
("\t",
$nivñ
)."<li>";

590 i‡–
$f‹m
 ) 
	`¥ötf
(
$f‹m©o_f‹m
,
$vÆ
);

591 
echo
 
$vÆ
,'</li>';

595 
echo
 "\n".
	`°r_ª≥©
("\t",
$nivñ
)."</ul>";

596 
	}
}

602 
fun˘i⁄
 
	$mb_un£rülize
(
$£rül_°r
) {

603 
$out
 = 
	`¥eg_ª∂a˚
('!s:(\d+):"(.*?)";!£', "'s:'.°æí('$2').':\"$2\";'", 
$£rül_°r
);

604  
	`un£rülize
(
$out
);

605 
	}
}

614 
fun˘i⁄
 
	$gë_ö˛ude_c⁄ã¡s
(
$fûíame
,
$d©os
=
NULL
) {

616 
globÆ
 
$gcm
;

618 i‡(
	`is_fûe
(
$fûíame
)) {

620 
	`ob_°¨t
();

621 
ö˛ude
 
$fûíame
;

622 
$c⁄ã¡s
 = 
	`ob_gë_c⁄ã¡s
();

623 
	`ob_íd_˛ón
();

624  
$c⁄ã¡s
;

627  
Ál£
;

629 
	}
}

633 
fun˘i⁄
 
	$mo°ør_ù
() {

635 if–
	`is£t
(
$_SERVER
['HTTP_X_FORWARDED_FOR']) ) {

637 
$˛õ¡_ù
 =

638 –!
	`em±y
(
$_SERVER
['REMOTE_ADDR']) ) ?

639 
$_SERVER
['REMOTE_ADDR']

641 ––!
	`em±y
(
$_ENV
['REMOTE_ADDR']) ) ?

642 
$_ENV
['REMOTE_ADDR']

652 
$íåõs
 = 
	`ex∂ode
('[, ]', 
$_SERVER
['HTTP_X_FORWARDED_FOR']);

654 
	`ª£t
(
$íåõs
);

655 
	`li°
(, 
$íåy
Ë
	`óch
(
$íåõs
)) {

657 
$íåy
 = 
	`åim
($entry);

658 i‡–
	`¥eg_m©ch
("/^([0-9]+.[0-9]+.[0-9]+.[0-9]+)/", 
$íåy
, 
$ù_li°
) ) {

660 
$¥iv©e_ù
 = 
	`¨øy
(

667 
$found_ù
 = 
	`¥eg_ª∂a˚
(
$¥iv©e_ù
, 
$˛õ¡_ù
, 
$ù_li°
[1]);

669 i‡(
$˛õ¡_ù
 !
$found_ù
) {

670 
$˛õ¡_ù
 = 
$found_ù
;

678 
$˛õ¡_ù
 =

679 –!
	`em±y
(
$_SERVER
['REMOTE_ADDR']) ) ?

680 
$_SERVER
['REMOTE_ADDR']

682 ––!
	`em±y
(
$_ENV
['REMOTE_ADDR']) ) ?

683 
$_ENV
['REMOTE_ADDR']

688  
$˛õ¡_ù
;

690 
	}
}

698 
fun˘i⁄
 
	$mkdú_ªcursivo
(
$ruè
) {

700 
$dúe˘‹ios
 = 
	`ex∂ode
('/',
$ruè
);

701 
$dú
 = '';

702  
$i
=0;$i<=
	`cou¡
(
$dúe˘‹ios
)-1;$i++ ) {

703 
$dú
=$dú.
$dúe˘‹ios
[
$i
];

704 i‡–! 
	`is_dú
(
$dú
) ) {

705 i‡–! @
	`mkdú
–
$dú
) ) {

706 
$mís
 = 'Debê¸ór£É»dúe˘‹iÿdêlo†idioma†c⁄Üo†lôîÆe†í: ['.
$dú
.'] conÜosÖermisosádecuados' ;

707 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

708  
FALSE
;

711 
$dú
=$dir.'/';

714  
TRUE
;

715 
	}
}

724 
fun˘i⁄
 
	$exi°e_èbœ
(
$pdo
, 
$èbœ
) {

726 
åy
 {

728 
$sql
 = 'SELECT COUNT(*ËFROM '.
$èbœ
;

730 i‡–! 
$°h
 = 
$pdo
->
	`¥ï¨e
(
$sql
) ) {

732  
FALSE
;

736 i‡(!
$°h
->
	`execuã
()) {

738  
FALSE
;

744 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

746  
FALSE
;

750  
TRUE
;

752 
	}
}

761 
fun˘i⁄
 
	$b‹ør_èbœ
(
$pdo
, 
$èbœ
) {

763 i‡–
	`exi°e_èbœ
(
$pdo
,
$èbœ
) ) {

764 
$sql
="dr›ÅabÀ ".
$èbœ
;

765 
$sqlResu…
 = 
$pdo
->
	`quîy
(
$sql
);

768 
	}
}

777 
fun˘i⁄
 
	$b‹ør_c⁄ãnido_èbœ
(
$pdo
, 
$èbœ
) {

779 i‡–
	`exi°e_èbœ
(
$pdo
,
$èbœ
) ) {

780 
$sql
="dñëê‰om ".
$èbœ
;

781 
$sqlResu…
 = 
$pdo
->
	`quîy
(
$sql
);

784 
	}
}

799 
fun˘i⁄
 
rglob
(
$∑âîn
='*', 
$Êags
 = 0, 
$∑th
=
Ál£
) {

801 i‡(!
$∑th
Ë{ $∑th=
dú«me
(
$∑âîn
).
DIRECTORY_SEPARATOR
; }

802 
	g$∑âîn
=
ba£«me
(
$∑âîn
);

803 
	g$∑ths
=
glob
(
$∑th
.'*', 
GLOB_MARK
|
GLOB_ONLYDIR
|
GLOB_NOSORT
);

804 
	g$fûes
=
glob
(
$∑th
.
$∑âîn
, 
$Êags
);

805 i‡–!
is_¨øy
(
$fûes
ËË{ 
	g$fûes
 = 
¨øy
(); }

806 i‡–
em±y
(
$∑ths
ËË 
	gFALSE
;

807 
f‹óch
 (
$∑ths
 
as
 
$∑th
) {

808 
	g$mas
 = 
rglob
(
$∑âîn
, 
$Êags
, 
$∑th
);

809 i‡–
	g$mas
 && !
em±y
(
$mas
Ë&& 
is_¨øy
($masËË{ 
	g$fûes
=
¨øy_mîge
(
$fûes
,$mas); }

811  
	g$fûes
;

824 
fun˘i⁄
 
	$dú_¨øy
(
$∑th
, 
$desˇπados
=
NULL
) {

826 
globÆ
 
$gcm
;

828 
$c⁄ãnido
 = 
FALSE
;

830 i‡–!
	`is_dú
(
$∑th
) ) {

831 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"ERROR::$path NoÉs un directorio",'ERROR');

832  
FALSE
;

835 
$dúe˘‹io
=
	`dú
(
$∑th
);

837 
$¨chivo
 = 
$dúe˘‹io
->
	`ªad
()) {

839 i‡(
$¨chivo
 !="." && $archivo != ".." && $archivo != ".svn" ) {

841 
$fûe
 = 
$∑th
."/".
$¨chivo
;

845 i‡–
	`is£t
(
$desˇπados
) ) {

847 
$desˇπ¨
 = 
FALSE
;

848 
	`f‹óch
 ( 
$desˇπados
 
as
 
$desˇπado
 ) {

849 i‡–
	`°Ωos
(
$¨chivo
,
$desˇπado
Ë!=
FALSE
 ) {

850 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$¨chivo
. ' coöcidêc⁄ '.
$desˇπado
);

851 
$desˇπ¨
 = 
TRUE
;

855 i‡–
$desˇπ¨
 ) {

860 i‡–
	`is_dú
(
$∑th
."/".
$¨chivo
) ) {

861 
$dúe˘‹ios
[]=
$∑th
."/".
$¨chivo
;

862 } 
	`ñ£if
 ( 
	`is_fûe
(
$∑th
."/".
$¨chivo
) ) {

863 
$fichîos
[]=
$∑th
."/".
$¨chivo
 ;

870 i‡–
	`is£t
(
$fichîos
Ë&& 
	`is_¨øy
($ficheros) ) {

872 
	`f‹óch
 ( 
$fichîos
 
as
 
$f
 ) {

874 
$c⁄ãnido
[] = 
$f
 ;

880 i‡–
	`is£t
(
$dúe˘‹ios
Ë&& 
	`is_¨øy
($directorios) ) {

882 
	`f‹óch
 ( 
$dúe˘‹ios
 
as
 
$d
 ) {

884 
$c⁄ãnido
[
$d
]=
	`dú_¨øy
($d,
$desˇπados
);

890 
$dúe˘‹io
->
	`˛o£
();

892  
$c⁄ãnido
;

894 
	}
}

911 
fun˘i⁄
 
	$rmdú_ªcursivo
(
$dúe˘‹io
) {

913 i‡(
$dú
 = 
	`›ídú
(
$dúe˘‹io
)) {

915 
$fûe
 = 
	`ªaddú
(
$dú
)) {

917 i‡(
$fûe
 != "." && $file != ".." ) {

919 i‡–
	`is_dú
(
$dúe˘‹io
.'/'.
$fûe
) ) {

921 
	`rmdú_ªcursivo
(
$dúe˘‹io
.'/'.
$fûe
);

925 if(
	`u∆ök
(
$dúe˘‹io
.'/'.
$fûe
)) {

927 
$fichîo
=
$dúe˘‹io
.
$fûe
;

931 
	`åiggî_îr‹
(
	`lôîÆ
('Eº‹').' '.lôîÆ('Elimö™dÿc⁄ãnido').': '.
$dúe˘‹io
.'/'.
$fûe
, 
E_USER_ERROR
);

936 
	`˛o£dú
(
$dú
);

940 i‡(
	`rmdú
(
$dúe˘‹io
) ) {

942  
TRUE
;

946 
	`åiggî_îr‹
(
	`lôîÆ
('Eº‹').' '.lôîÆ('Nÿ£Öudÿñimö¨').' '.lôîÆ('£cci⁄').': '.
$dúe˘‹io
, 
E_USER_ERROR
);

948  
FALSE
;

952 
	}
}

958 
fun˘i⁄
 
	$möimiz¨_css
(
$buf„r
) {

959 
$buf„r
 = 
	`¥eg_ª∂a˚
('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $buffer);

960 
$buf„r
 = 
	`°r_ª∂a˚
(
	`¨øy
("\r\n", "\r", "\n", "\t"), '', $buffer);

961  
$buf„r
;

962 
	}
}

977 
fun˘i⁄
 
	$möutos2tõmpo
(
$möutos
) {

979 
$h‹as
 = 
	`numbî_f‹m©
(
$möutos
/60,0);

980 
$mö
 = 
	`numbî_f‹m©
(
$möutos
%60,0);

981 
$tõmpo
 = 
$h‹as
.':'.
$mö
;

983  
$tõmpo
;

985 
	}
}

998 
fun˘i⁄
 
	$‹dí¨_p‹_≥so
(
$a
, 
$b
) {

1000 
$aPeso
 = ( 
	`is£t
(
$a
['peso']) ) ? $a['peso'] : 0 ;

1001 
$bPeso
 = ( 
	`is£t
(
$b
['peso']) ) ? $b['peso'] : 0 ;

1003 i‡(
$aPeso
 =
$bPeso
)  1;

1004  (
$aPeso
 < 
$bPeso
) ? -1 : 1;

1005 
	}
}

1012 
fun˘i⁄
 
	$gëTemp
() {

1013 i‡–! 
	`fûe_exi°s
('tmp'ËË
	`mkdú
('tmp');

1015 
	}
}

1027 
fun˘i⁄
 
	$b‹ør_¨chivos_võjos
(
$h‹as
, 
$∑å⁄
) {

1029 
$fôxes
 = 
	`glob
(
$∑å⁄
);

1031 i‡–! 
	`em±y
(
$fôxes
) ) {

1033 
	`f‹óch
 ( 
$fôxes
 
as
 
$fôxî
 ) {

1035 
$d©a_fôxî
 = 
	`fûemtime
(
$fôxî
);

1037 
$ãmps
 = ( 
	`time
(Ë- 
$d©a_fôxî
 ) / 60 ;

1039 i‡–
$ãmps
 > 
$h‹as
 ) {

1040 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

1041 'B‹ømo†¨chivo†võjo†['.
$fôxî
.'] ['.
	`d©e
("Y-m-d H:i:s",
$d©a_fôxî
).']',

1043 i‡–
	`is_dú
(
$fôxî
) ) {

1044 
	`rmdú_ªcursivo
(
$fôxî
);

1046 
	`u∆ök
(
$fôxî
);

1052 
	}
}

1054 i‡–! 
fun˘i⁄_exi°s
("sesion") ) {

1064 
fun˘i⁄
 
£si⁄
(
$ñemíto
, 
$vÆ‹
=
FALSE
) {

1066 
globÆ
 
$gcm
;

1068 i‡–
	g$vÆ‹
 ) {

1069 
	g$_SESSION
[
$gcm
->
sufijo
.
$ñemíto
] = 
$vÆ‹
 ;

1073 i‡–
is£t
(
$_SESSION
[
$gcm
->
sufijo
.
$ñemíto
]) )

1074  
	g$_SESSION
[
$gcm
->
sufijo
.
$ñemíto
];

1076  
	gFALSE
;

	@gcm/lib/int/gcm/test/EventosTest.php

1 <?
php


4 i‡(!
deföed
("PHPUnit_MAIN_METHOD")) {

5 
deföe
("PHPUnit_MAIN_METHOD", "EventosTest::main");

8 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestCase.php";

9 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestSuite.php";

14 
DEFINE
('GCM_DIR',
dú«me
(
__FILE__
).'/../../../../../gcm/');

15 
ªquúe
(
GCM_DIR
.'inicio.php');

22 ˛as†
	cEvítosTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
 {

24 
¥iv©e
 
	m$e
;

33 
public
 
fun˘i⁄
 
	$maö
() {

35 
ªquúe_⁄˚
 "PHPUnit/TextUI/TestRunner.php";

37 
$suôe
 = 
√w
 
	`PHPUnô_Fømew‹k_Te°Suôe
("EventosTest");

38 
$ªsu…
 = 
PHPUnô_TextUI_Te°Ru¬î
::
	`run
(
$suôe
);

48 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£tUp
() {

52 
$dú_ejem∂o
 = '/tmp/test_eventos/';

53 i‡–
	`is_dú
(
$dú_ejem∂o
ËË`
rm
 -
‰
 $dir_ejemplo.'/*'`;

54 i‡–!
	`is_dú
(
$dú_ejem∂o
ËË
	`mkdú
($dir_ejemplo);

55 i‡–!
	`is_dú
(
$dú_ejem∂o
.'modulo1'ËË
	`mkdú
($dir_ejemplo.'modulo1');

56 i‡–!
	`is_dú
(
$dú_ejem∂o
.'modulo2'ËË
	`mkdú
($dir_ejemplo.'modulo2');

57 i‡–!
	`is_dú
(
$dú_ejem∂o
.'modulo1/lib'ËË
	`mkdú
($dir_ejemplo.'modulo1/lib');

58 i‡–!
	`is_dú
(
$dú_ejem∂o
.'modulo2/lib'ËË
	`mkdú
($dir_ejemplo.'modulo2/lib');

62 
$c⁄ãnido
 = "\n".'<?php ';

63 
$c⁄ãnido
 .= "\n\$eventos['evento1']['accion1'][1]='';";

64 
$c⁄ãnido
 .= "\n\$eventos['evento2']['accion2'][1]='';";

65 
$c⁄ãnido
 .= "\n\$eventos['evento3']['accion3'][1]='';";

66 
$c⁄ãnido
 .= "\n".'?>';

67 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo1/evítos_admö.php', 
$c⁄ãnido
);

69 
$c⁄ãnido
 = "\n".'<?php ';

70 
$c⁄ãnido
 .= "\n\$eventos['evento4']['accion1'][1]='';";

71 
$c⁄ãnido
 .= "\n\$eventos['evento5']['accion2'][1]='';";

72 
$c⁄ãnido
 .= "\n\$eventos['evento6']['accion3'][1]='';";

73 
$c⁄ãnido
 .= "\n\$cEventos['evento6']='unico';";

74 
$c⁄ãnido
 .= "\n".'?>';

75 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo1/evítos_usu¨io.php', 
$c⁄ãnido
);

77 
$c⁄ãnido
 = "\n".'<?php ';

78 
$c⁄ãnido
 .= "\n\$eventos['evento1']['accion1'][1]='';";

79 
$c⁄ãnido
 .= "\n\$eventos['evento2']['accion2'][1]='';";

80 
$c⁄ãnido
 .= "\n\$eventos['evento3']['accion3'][1]='';";

81 
$c⁄ãnido
 .= "\n".'?>';

82 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo2/evítos_admö.php', 
$c⁄ãnido
);

84 
$c⁄ãnido
 = "\n".'<?php ';

85 
$c⁄ãnido
 .= "\n\$eventos['evento4']['accion1'][1]='';";

86 
$c⁄ãnido
 .= "\n\$eventos['evento5']['accion2'][1]='';";

87 
$c⁄ãnido
 .= "\n\$eventos['evento6']['accion3'][1]='';";

88 
$c⁄ãnido
 .= "\n".'?>';

89 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo2/evítos_usu¨io.php', 
$c⁄ãnido
);

91 
$c⁄ãnido
 = "\n".'<?php ';

92 
$c⁄ãnido
 .= "\nclass modulo1 {";

93 
$c⁄ãnido
 .= "\nfunctionáccion1(\$e) {";

94 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

95 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo1'] = 'accion1';";

96 
$c⁄ãnido
 .= "\n}";

97 
$c⁄ãnido
 .= "\nfunctionáccion2(\$e) {";

98 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

99 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo1'] = 'accion2';";

100 
$c⁄ãnido
 .= "\n}";

101 
$c⁄ãnido
 .= "\nfunctionáccion3(\$e) {";

102 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

103 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo1'] = 'accion3';";

104 
$c⁄ãnido
 .= "\n}";

105 
$c⁄ãnido
 .= "\n}";

106 
$c⁄ãnido
 .= "\n".'?>';

107 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo1/lib/Modulo1.php', 
$c⁄ãnido
);

109 
$c⁄ãnido
 = "\n".'<?php ';

110 
$c⁄ãnido
 .= "\nclass modulo2 {";

111 
$c⁄ãnido
 .= "\nfunctionáccion1(\$e) {";

112 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

113 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo2'] = 'accion1';";

114 
$c⁄ãnido
 .= "\n}";

115 
$c⁄ãnido
 .= "\nfunctionáccion2(\$e) {";

116 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

117 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo2'] = 'accion2';";

118 
$c⁄ãnido
 .= "\n}";

119 
$c⁄ãnido
 .= "\nfunctionáccion3(\$e) {";

120 
$c⁄ãnido
 .= "\nglobal \$_GLOBALS;";

121 
$c⁄ãnido
 .= "\n\$_GLOBALS['eventos'][\$e]['Modulo2'] = 'accion3';";

122 
$c⁄ãnido
 .= "\n}";

123 
$c⁄ãnido
 .= "\n}";

124 
$c⁄ãnido
 .= "\n".'?>';

125 
	`fûe_put_c⁄ã¡s
(
$dú_ejem∂o
.'modulo2/lib/Modulo2.php', 
$c⁄ãnido
);

127 
$this
->
e
 = 
√w
 
	`Evítos
(
$dú_ejem∂o
,
FALSE
);

128 
$this
->
a
 = 
√w
 
	`Evítos
(
$dú_ejem∂o
,
TRUE
);

129 
	}
}

137 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ã¨Down
() {

138 
	}
}

140 
public
 
fun˘i⁄
 
	$ã°Lìr_evítos
() {

142 
$this
->
	`as£πFÆ£
(
	`em±y
($this->
e
->
evítos
), 'HayÉventos');

143 
$this
->
	`as£πFÆ£
(
	`em±y
($this->
a
->
evítos
), 'HayÉventos');

145 
	}
}

147 
public
 
fun˘i⁄
 
	$ã°Vîifiˇr_evíto
() {

149 
$this
->
	`as£πTrue
($this->
e
->
	`vîifiˇr_evíto
('evento4'),'VerificarÉvento usuario');

150 
$this
->
	`as£πTrue
($this->
a
->
	`vîifiˇr_evíto
('evento4'),'VerificarÉvento usuario');

151 
$this
->
	`as£πTrue
($this->
a
->
	`vîifiˇr_evíto
('evento2'),'VerificarÉvento usuario');

152 
	}
}

154 
public
 
fun˘i⁄
 
	$ã°L™z¨Evíto
() {

156 
$this
->
	`as£πTrue
($this->
e
->
	`œnz¨Evíto
('evento4'),'LanzarÉvento usuario');

157 
$this
->
	`as£πTrue
($this->
a
->
	`œnz¨Evíto
('evento5'),'LanzarÉvento usuario');

158 
$this
->
	`as£πTrue
($this->
a
->
	`œnz¨Evíto
('evento2'),'LanzarÉvento usuario');

159 
	}
}

161 
public
 
fun˘i⁄
 
	$ã°Comp‹èmõ¡os
() {

163 
globÆ
 
$_GLOBALS
;

167 
$_GLOBALS
 = 
	`¨øy
();

170 
$this
->
a
->
cEvítos
['evento3']['unico'] = 'modulo1';

171 
$this
->
a
->
	`œnz¨Evíto
('evento3');

172 
$num_evítos
 = 
	`cou¡
(
$_GLOBALS
['eventos']['evento3']);

174 
$this
->
	`as£πTrue
(
$num_evítos
 == 1,'Evento unico');

179 
$this
->
e
->
cEvítos
['evento4']['anular'] = 'modulo1';

180 
$this
->
e
->
	`œnz¨Evíto
('evento4');

181 
$num_evítos
 = 
	`cou¡
(
$_GLOBALS
['eventos']['evento4']);

182 
$this
->
	`as£πTrue
(
$num_evítos
 == 0,'Eventoánulado');

185 
	}
}

189 i‡(
	gPHPUnô_MAIN_METHOD
 == "EventosTest::main") {

190 
EvítosTe°
::
maö
();

	@gcm/lib/int/gcm/test/RouterTest.php

1 <?
php


8 
	gecho
 "No funciona, crea directorio deÜogáraÑegistros";

9 
exô


11 
deföe
("GCM_DIR",
dú«me
(
__FILE__
).'/../../../../../gcm/');

13 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

16 
ªquúe
(
dú«me
(
__FILE__
).'/../lib/Gcm.php');

18 
	g$gcm
 = 
√w
 
Gcm
();

24 ˛as†
	cRouãrTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

26 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£tUp
() {

27 
globÆ
 
$gcm
;

34 
fun˘i⁄
 
	$ã°desgloßrUæ
() {

36 
globÆ
 
$gcm
;

38 
$uæ
 = '/index.html?e=buscar&args=palabra_a_buscar';

40 
Rouãr
::
	`desgloßrUæ
(
$uæ
);

42 
$this
->
	`as£πEquÆs
(
Rouãr
::
$uæ
,'index.html');

44 
	}
}

	@gcm/lib/int/gcm_imagen.php

1 <?
php


35 
fun˘i⁄
 
gcm_imagí_c›ür
(
$imagí
, 
$de°öo
, 
$imagíA…o
='0', 
$imagíAncho
='0', 
$möütuø
='no', 
$möütuøA…o
='0', 
$möütuøAncho
='0') {

37 
globÆ
 
$_FILES
;

39 
	g$imagíFûe
 = 
$imagí
['tmp_name'];

40 
	g$imagíName
 = 
$imagí
['name'];

41 
	g$imagíSize
 = 
$imagí
['size'];

42 
	g$imagíTy≥
 = 
$imagí
['type'];

43 
	g$imagíEº‹
 = 
$imagí
['error'];

46 i‡–
is_dú
(
$de°öo
) ) {

47 
	g$dúFöÆ
 = 
$de°öo
."/";

48 
	g$nombªFöÆ
 = 
$dúFöÆ
.
$imagíName
 ;

50 
	g$dúFöÆ
 = 
$de°öo
;

51 
	g$nombªFöÆ
 = 
$dúFöÆ
;

54 i‡–
	g$imagíEº‹
 == 4 ) {

56 
$imagíFûe
 = 
nuŒ
;

57 
	g$imagíName
 = 
nuŒ
;

58 
	g$imagíSize
 = 
nuŒ
;

59 
	g$imagíTy≥
 = 
nuŒ
;

61 
	g$mís
 = "No se subioÇing√∫n fichero";

62 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

64  
	gNULL
 ;

70 i‡(
	g$imagíEº‹
>0){

72 
	g$imagíEº‹
){

74 
$mís
 = "Tama√±oÉxcesivo deárchivo";

75 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

76 
	gecho
 '<s¸ùt>Æît("Tama√±ÿdñárchivÿex˚sivo\nMaxÖîmôido: '.
öi_gë
('upload_max_filesize').'");</script>';

77  
	gNULL
 ;

80 
$mís
 = "Tama√±oÉxcesivo deárchivo";

81 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

82 
	gecho
 '<s¸ùt>Æît("Tama√±ÿdñárchivÿex˚sivo\nMaxÖîmôido: '.
öi_gë
('upload_max_filesize').'");</script>';

83  
	gNULL
 ;

86 
$mís
 = "Errorál subirÜa im√°gen";

87 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

88  
	gNULL
 ;

91 
	g$mís
 = "Errorál subirÜa im√°gen";

92 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

93  
	gNULL
 ;

97 i‡(!
is_u∂ﬂded_fûe
(
$imagíFûe
)){

98 
	g$mís
 = "AccesoÇoÖermitido,Öosible violaci√≥n de seguridad";

99 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

100  
	gNULL
 ;

104 i‡–
	g$imagíTy≥
 == 'application/zip' ) {

106 
$zù
 = 
√w
 
ZùArchive
;

109 i‡–
	g$zù
->
›í
(
$imagíFûe
Ë==
TRUE
 ) {

110 
$num_imagíes
 = 
$zù
->
numFûes
;

112 
	g$mís
 = 'Nÿ£ÖudÿabrúÉ»¨chivÿzù: '.
$imagíName
;

113 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

114 
	gecho
 '<s¸ùt>Æît(\'Nÿ£ÖudÿabrúÉ»¨chivÿzù: '.
	g$imagíName
.'\');</script>';

115  
	gnuŒ
 ;

118 i‡–
	g$num_imagíes
 < 1 ) {

119 
	g$mís
 = 
$imagíName
.' vacio';

120 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

121 
	gecho
 '<s¸ùt>Æît(\'Vaciÿ'.
	g$imagíName
.'\');</script>';

122  
	gnuŒ
 ;

126 i‡–
	g$zù
->
exåa˘To
(
$dúFöÆ
) ) {

127 
	gecho
 '<s¸ùt>∑ª¡.ªsu…adoU∂ﬂd (\'0\', \''.
	g$imagíName
.'\');</script>';

129 
	g$mís
 = 'Archivÿ'.
$imagíName
.'Ço seÖudo descomprimir';

130 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

131 
	gecho
 '<s¸ùt>∑ª¡.ªsu…adoU∂ﬂd (\'4\', \'Nÿ£Öudÿdescom¥imú '.
	g$imagíName
.'\');</script>';

132  
	gNULL
 ;

135 
	gecho
 "gcm_imagen_copiar::Numero de imagenes: <b>$num_imagenes</b>";

136 i‡–
	g$num_imagíes
 > 0 ) {

137 
	g$i
=0 ; $i!=
$num_imagíes
; $i++) {

138 
	g$fûíame
 = 
$zù
->
gëNameIndex
(
$i
);

139 
	g$fûeöfo
 = 
∑thöfo
(
$fûíame
);

140 
	g$imagí
 = 
$dúFöÆ
.
$fûíame
 ;

141 
	g$ßlida
.=
$imagí
.'\n';

144 
gíî¨Imagí
(
$imagí
, 
$dúFöÆ
, 
$imagíA…o
, 
$imagíAncho
);

147 
	g$ha˚rMöütuø
 = 
NULL
;

149 i‡–
	g$möütuø
 !"" && 
$möütuø
 != 'no' ) {

150 
$ha˚rMöütuø
 = 
TRUE
;

151 
gíî¨Imagí
(
$imagí
, 
$möütuø
, 
$möütuøA…o
, 
$möütuøAncho
);

157 
	gecho
 '<s¸ùt>∑ª¡.ªsu…adoU∂ﬂd (\'0\', \''.
	g$imagíName
.' '.
	g$num_imagíes
.' imagíes\\n'.
	g$ßlida
.'\');</script>';

159  
	gTRUE
 ;

165 i‡(!
c›y
(
$imagíFûe
 ,
$nombªFöÆ
)) {

166 
åiggî_îr‹
('Eº‹á»c›ü∏imagí ['.
$imagíFûe
.']á ['.
$nombªFöÆ
.']', 
E_USER_ERROR
);

167  
	gNULL
 ;

170 
	g$imagí
 = 
$nombªFöÆ
 ;

173 i‡–
	g$imagíA…o
 !0 && 
$imagíAncho
 != 0 ) {

174 
gíî¨Imagí
(
$imagí
, 
$dúFöÆ
, 
$imagíA…o
, 
$imagíAncho
);

178 
	g$ha˚rMöütuø
 = 
NULL
;

180 i‡–
	g$möütuø
 !"" && 
$möütuø
 != 'no' ) {

181 
$ha˚rMöütuø
 = 
TRUE
;

182 
gíî¨Imagí
(
$imagí
, 
$möütuø
, 
$möütuøA…o
, 
$möütuøAncho
);

185  
	gTRUE
 ;

210 
fun˘i⁄
 
gíî¨Imagí
(
$imagí
, 
$de°öo
, 
$Æto
, 
$™cho
, 
$möütuø
='si') {

212 
$dúFöÆ
 = 
com¥ob¨_b¨ø
(
$de°öo
);

215 
	g$vD©osImg
 = 
gëimagesize
(
$imagí
);

216 
	g$imagíName
 = 
ba£«me
(
$imagí
);

218 i‡(!
	g$vD©osImg
) {

219 
	g$mís
 = 
lôîÆ
('Error conÜas datos deÜa imagen',3);

220 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

221  
	gNULL
 ;

224 
	g$imgAncho
 = 
$vD©osImg
[0];

225 
	g$imgA…o
 = 
$vD©osImg
[1];

228 i‡–
is£t
(
$vD©osImg
['mime']) ) {

229 
	g$sTùo
 = 
$vD©osImg
['mime'];

230 } 
ñ£if
 ( 
is£t
(
$vD©osImg
[2]) ) {

231 
	g$sTùo
 = 
image_ty≥_to_mime_ty≥
(
$vD©osImg
[2]);

232 } 
ñ£if
 ( 
is£t
(
$iTùo
) ) {

233 
	g$sTùo
 = 
image_ty≥_to_mime_ty≥
(
$iTùo
);

235 
	g$mís
 = 
lôîÆ
('Error con datos mime deÜa imagen',3);

236 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

237  
	gNULL
 ;

241 
	g$ˇmbürMöütuø
 = 
NULL
;

243 i‡–
	g$™cho
 < 
	g$imgAncho
 ) {

244 
	g$ˇmbürMöütuø
=
TRUE
;

245 } 
ñ£if
 ( 
$Æto
 < 
$imgA…o
) {

246 
	g$ˇmbürMöütuø
=
TRUE
;

252 i‡–
	g$möütuø
 == 'si' ) {

253 i‡–! 
is_dú
(
$dúFöÆ
) ) {

254 i‡–! 
mkdú
(
com¥ob¨_b¨ø
(
$dúFöÆ
,'eliminar')) ) {

255 
$mís
 = 
lôîÆ
('Eº‹á»¸ó∏dúe˘‹iÿde°öo',3).'['.
	g$dúFöÆ
.']';

256 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

257  
	gNULL
 ;

263 i‡–
	g$ˇmbürMöütuø
 ) {

265 
	g$sTùo
){

267 
$fuíã
 = 
image¸óã‰omgif
(
$imagí
) ;

270 
$fuíã
 = 
image¸óã‰omj≥g
(
$imagí
) ;

273 
$fuíã
 = 
image¸óã‰om≤g
(
$imagí
) ;

279 i‡–!
	g$fuíã
 ) {

280 
ªgi°ør
(
__FILE__
,
__LINE__
,
lôîÆ
('Eº‹ c⁄ d©o†mime',3).'['.
$sTùo
.']','ERROR');

281  
	gNULL
 ;

285 i‡–
	g$™cho
 > 0 ) {

286 
	g$™choFöÆ
 = 
$™cho
;

287 
	g$ÆtoFöÆ
 = 
$imgA…o
 * 
$™cho
 / 
$imgAncho
 ;

289 i‡–
	g$ÆtoFöÆ
 > 
	g$Æto
 ) {

290 
	g$ÆtoFöÆ
 = 
$Æto
;

291 
	g$™choFöÆ
 = 
$imgAncho
 * 
$Æto
 / 
$imgA…o
 ;

293 } 
ñ£if
 ( 
$Æto
 > 0 ) {

294 
	g$ÆtoFöÆ
 = 
$Æto
;

295 
	g$™choFöÆ
 = 
$imgAncho
 * 
$Æto
 / 
$imgA…o
 ;

296 i‡–
	g$™choFöÆ
 > 
	g$™cho
 ) {

297 
	g$™choFöÆ
 = 
$™cho
 ;

298 
	g$ÆtoFöÆ
 = 
$imgA…o
 * 
$™cho
 / 
$imgAncho
 ;

302 
	g$imagí

ImageCª©eTrueCﬁ‹
(
$™choFöÆ
, 
$ÆtoFöÆ
)

303 
‹
 
	g$imagí
=
ImageCª©e
(
$™choFöÆ
, 
$ÆtoFöÆ
);

305 
ImageC›yResized
(
$imagí
,
$fuíã
,0,0,0,0,
$™choFöÆ
,
$ÆtoFöÆ
,
$imgAncho
,
$imgA…o
);

312 
	g$sTùo
){

314 
imagegif
(
$imagí
,
$dúFöÆ
.
$imagíName
);

317 
imagej≥g
(
$imagí
,
$dúFöÆ
.
$imagíName
, 100);

320 
imagïng
(
$imagí
,
$dúFöÆ
.
$imagíName
);

323 
ªgi°ør
(
__FILE__
,
__LINE__
,
lôîÆ
('TùÿdêimagíÇÿs›‹èda',3).' ['.
$sTùo
.']','ERROR');

324  
	gNULL
 ;

330 i‡(!
c›y
(
$imagí
 ,
com¥ob¨_b¨ø
(
$dúFöÆ
).
$imagíName
)) {

331 
ªgi°ør
(
__FILE__
,
__LINE__
,
lôîÆ
('Falloál generar imagen',3),'ERROR');

332 
åiggî_îr‹
("Eº‹á»c›ü∏imagí", 
E_USER_ERROR
);

334  
	gNULL
 ;

354 
fun˘i⁄
 
	$gcm_li°aImagíes
(
$∑th
, 
$tùo
=1) {

356 
globÆ
 
$gcm
;

360 
$li°a
 = 
	`¨øy
();

362 
$ÆtoMaxMöütuø
 = 
$gcm
->
	`c⁄fig
('imagenes','altoMaxMiniatura');

363 
$™choMaxMöütuø
 = 
$gcm
->
	`c⁄fig
('imagenes','anchoMaxMiniatura');

365 
$exãnsi⁄es
 = 
	`¨øy
("jpg", "jpeg", "JPG", "JPEG", "GIF", "gif", "png", "PNG", "tiff", "TIFF");

366 
$exãnsi⁄es_∑ø_exif
 = 
	`¨øy
("jpg", "jpeg", "JPG", "JPEG", "tiff", "TIFF");

368 
$ba£_imagíes
='';

370 i‡–! 
	`is_dú
(
$∑th
) ) {

371 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$∑th
.' '.
	`lôîÆ
('NoÉs un directorio',3),'ERROR');

372  
NULL
;

376 
$ŸøsSecci⁄es
 = 
	`¨øy
() ;

378 
$uri
 = 
	`ex∂ode
("/",
$∑th
);

379 
$u…imo
 = ( 
$uri
[
	`cou¡
($uri)-1] ) ? $uri[count($uri)-1] : $uri[count($uri)-2];

380 
	`un£t
(
$uri
[
	`cou¡
($uri)-1]);

381 
	`un£t
(
$uri
[
	`cou¡
($uri)-1]);

382 
$¨riba
 = 
	`im∂ode
("/",
$uri
);

390 i‡–
$u…imo
 !=
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto') ) {

391 
$ŸøsSecci⁄es
[] = 
	`¨øy
 (
	`lôîÆ
('subú'),
	`im∂ode
("/",
$uri
));

392 
$e°amos
 = 
$u…imo
;

394 
$e°amos
 = 'inicio';

398 
$∑th
 = 
	`com¥ob¨_b¨ø
($path);

400 
$dúe˘‹io
 = 
	`dú
(
$∑th
);

402 
$¨chivo
 = 
$dúe˘‹io
->
	`ªad
()) {

404 
$fûe
 = 
$∑th
.
$¨chivo
 ;

406 i‡–
$¨chivo
 !".svn" && 
	`is_dú
(
$fûe
Ë&& $¨chivÿ!"thumb«û" && $fûê!
$∑th
 && $archivo != "." && $archivo != ".." ) {

407 
$ŸøsSecci⁄es
[]
	`¨øy
 (
$fûe
,
	`lôîÆ
(
$¨chivo
));

409 
$fûeInfo
 = 
	`∑thöfo
(
$fûe
);

410 
$ext
 = ( ! 
	`em±y
(
$fûeInfo
['exãnsi⁄']ËË? $fûeInfo['exãnsi⁄'] : 
NULL
 ;

412 i‡–
	`ö_¨øy
(
$ext
,
$exãnsi⁄es
) ) {

414 
$mö
=
$∑th
.'thumb«û/'.
$¨chivo
;

415 i‡–! 
	`is_fûe
(
$mö
) ) {

416 i‡–! 
	`is_dú
(
$∑th
.'thumbnail') ) {

417 i‡–! 
	`mkdú
(
$∑th
.'thumbnail') ) {

418 
$mís
 = 
	`lôîÆ
('Eº‹á»¸ó∏dúe˘‹iÿde°öo',3).'['.
$∑th
.'thumbnail'.']';

419 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'ERROR');

420  
NULL
 ;

423 i‡–
	`gíî¨Imagí
(
$fûe
, 
$∑th
.'thumb«û', 
$ÆtoMaxMöütuø
, 
$™choMaxMöütuø
Ë==
FALSE
 ) {

424 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Eº‹á»gíî¨ möütuø',3).' ['.
$fûe
.']É¿['.
$∑th
.'thumbnail'.']','ERROR');

430 i‡–
	`ö_¨øy
(
$ext
,
$exãnsi⁄es_∑ø_exif
) ) {

431 
$exif
 = @
	`exif_ªad_d©a
(
$∑th
.'/'.
$¨chivo
, 0, 
åue
);

433 
$exif
 = 
FALSE
;

435 
$i_size
 = 
	`gëfûesize
(
	`fûesize
(
$∑th
.'/'.
$¨chivo
));

436 
$i_¨ó
 = 
	`gëimagesize
(
$∑th
.'/'.
$¨chivo
);

437 
$i_width
 = 
$i_¨ó
[0];

438 
$i_height
 = 
$i_¨ó
[1];

439 
$li°a
[]=
	`¨øy
(
$¨chivo
, 
$ba£_imagíes
.
$∑th
.$¨chivo, $ba£_imagíes.$∑th.'thumb«û/'.$¨chivo, 
$i_width
, 
$i_height
, 
$i_size
, 
$exif
) ;

444 
$dúe˘‹io
->
	`˛o£
();

448 
	`f‹óch
 ( 
$ŸøsSecci⁄es
 
as
 &
$£cci⁄_c⁄_imagíes
 ) {

449 i‡–
	`is_dú
(
$£cci⁄_c⁄_imagíes
[0]) && $seccion_con_imagenes[0] != '..' ) {

450 
$£cci⁄_c⁄_imagíes
[1] = $£cci⁄_c⁄_imagíes[1]. ' ('.
	`c⁄èbûiz¨_imagíes_dúe˘‹io
($seccion_con_imagenes[0]).')';

454 i‡–
$tùo
 == 1 ) {

456 
$num
 = 
	`cou¡
(
$li°a
);

457 i‡–
$num
 > 0 ) {

459 
$¨chivo
 = 
$∑th
."/.listaImg.js";

460 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Archivÿdêli°®dêimg, '.
$¨chivo
);

462 i‡(!
$fûe
 = 
	`f›í
(
$¨chivo
, "w")) {

463 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'No seÖuedeábrirÉlárchivoÖaraÉscribir','ERROR');

464  
FALSE
;

466 
	`Âuts
(
$fûe
, "varÅinyMCEImageList =Çew Array (\n");

468 
$i
=0 ; $i!=
$num
-1; $i++) {

469 
	`Âuts
(
$fûe
, "[\"möi/".
$li°a
[
$i
][0]."\",\"".$lista[$i][2]."\"],\n");

470 
	`Âuts
(
$fûe
, "[\"".
$li°a
[
$i
][0]."\",\"".$lista[$i][1]."\"],\n");

472 
	`Âuts
(
$fûe
, "[\"möi/".
$li°a
[
$i
][0]."\",\"".$lista[$i][2]."\"],\n");

473 
	`Âuts
(
$fûe
, "[\"".
$li°a
[
$i
][0]."\",\"".$lista[$i][1]."\"]");

475 
	`Âuts
(
$fûe
, ");\n");

476 
	`f˛o£
(
$fûe
);

477  
TRUE
;

481 } 
	`ñ£if
 ( 
$tùo
 == 5 ) {

483 
$ªt‹no
['e°amos'] = 
$e°amos
 ;

484 
$ªt‹no
['Ÿøs_£cci⁄es'] = 
$ŸøsSecci⁄es
;

485 
$ªt‹no
['li°a'] = 
$li°a
;

486  
$ªt‹no
;

488 } 
	`ñ£if
 ( 
$tùo
 == 3 ) {

489 
$devﬁvî
 = 
	`¨øy
 ();

490 
$devﬁvî
['imgs'] = ( 
	`is£t
(
$li°a
ËË? $li°®: 
NULL
;

491 
$devﬁvî
['£c']
$ŸøsSecci⁄es
;

492 
¥öt
 
	`js⁄_ícode
(
$devﬁvî
);

494 } 
	`ñ£if
 ( 
$tùo
 == 4 ) {

495 
echo
 "\nv¨Üi°®".
	`js⁄_ícode
(
$li°a
);

498 
¥öt
 
	`js⁄_ícode
(
$li°a
);

501 
	}
}

513 
fun˘i⁄
 
	$c⁄èbûiz¨_imagíes_dúe˘‹io
(
$dúe˘‹io
, 
$numîo_a˘uÆ
=0) {

515 
$exãnsi⁄es
 = 
	`¨øy
("jpg", "jpeg", "JPG", "JPEG", "GIF", "gif", "png", "PNG", "tiff", "TIFF");

518 
$∑th
 = 
	`πrim
(
$dúe˘‹io
,'/').'/';

520 
$imagíes
 = 
	`glob
(
$∑th
."{*.GIF,*.JPG,*.PNG,*.gif,*.jpg,*.≤g}", 
GLOB_BRACE
);

522 
$numîo
 = 
$numîo_a˘uÆ
 + (
$imagíes
);

524 
$dú
 = 
	`glob
(
$∑th
.'*');

526 
$ã√mos_subdúe˘‹io
 = 
FALSE
 ;

528 i‡–
$dú
 ) {

530 
	`f‹óch
 ( 
$dú
 
as
 
$ôem
 ) {

532 i‡–
	`is_dú
(
$ôem
) ) {

533 
	`c⁄èbûiz¨_imagíes_dúe˘‹io
(
$ôem
, 
$numîo
);

534 
$ã√mos_subdúe˘‹io
 = 
TRUE
 ;

540  
$numîo
;

541 
	}
}

556 
fun˘i⁄
 
	$gcm_b‹ørImagí
(
$uæ
) {

558 i‡–! 
	`is_fûe
(
$uæ
) ) {

561 
$uæ
 = 
	`îeg_ª∂a˚
('.*'.
$dd
,$dd,$url);

562 i‡–! 
	`is_fûe
(
$uæ
) ) {

563 
$îr‹
=
	`lôîÆ
(
$dd
."L®im√°gíÇÿexi°e").'::'.
$uæ
;

564 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$îr‹
,'ERROR');

565  
NULL
 ;

569 i‡–! 
	`u∆ök
(
$uæ
) ) {

570 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Nÿ£Öudÿb‹ø∏ñ fichîo',3).' ['.
$uæ
.']','ERROR');

573 
$mö
 = 
	`dú«me
(
$uæ
).'/thumb«û/'.
	`ba£«me
($url);

574 i‡–
	`is_fûe
(
$mö
) ) {

575 i‡–! 
	`u∆ök
(
$mö
) ) {

576 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Nÿ£ b‹ø∏ñ fichîo',3).' ['.
$mö
.']','ERROR');

577  
nuŒ
 ;

580 
	`gcm_li°aImagíes
(
	`dú«me
(
$uæ
));

581  
TRUE
;

585 
	`gcm_li°aImagíes
(
	`dú«me
(
$uæ
));

586  
TRUE
;

590 
	}
}

607 
fun˘i⁄
 
gcm_vîImagíes
(
$∑th
 = "Image") {

609 
globÆ
 
$gcm
;

611 
	g$exãnsi⁄es
 = 
¨øy
("jpg", "jpeg", "JPG", "JPEG", "GIF", "gif", "png", "PNG", "tiff", "TIFF");

613 i‡–! 
is_dú
(
$∑th
) ) {

614 
ªgi°ør
(
__FILE__
,
__LINE__
,
$∑th
.', '.
lôîÆ
('NoÉs un directorio',3),'ERROR');

615  
	gNULL
;

617 
	g$dúe˘‹io
=
dú
(
$∑th
);

619 
	g$¨chivo
 = 
$dúe˘‹io
->
ªad
()) {

621 
$fûe
 = 
$∑th
."/".
$¨chivo
 ;

622 
	g$fûeInfo
 = 
∑thöfo
(
$fûe
);

623 
	g$ext
 = 
$fûeInfo
['extension'];

625 i‡–
ö_¨øy
(
$ext
,
$exãnsi⁄es
) ) {

627 
	g$mö
=
$∑th
.'/thumb«û/'.
$¨chivo
;

629 i‡–! 
is_fûe
(
$mö
) ) {

630 
gíî¨Imagí
(
$fûe
, 
$∑th
.'/thumb«û', 
$ÆtoMaxMöütuø
, 
$™choMaxMöütuø
);

633 
	g$exif
 = @
exif_ªad_d©a
(
$∑th
.'/'.
$¨chivo
, 0, 
åue
);

634 
	g$exif
 = ( 
$exif
 ==
FALSE
 ) ? FALSE : $exif ;

635 
	g$li°a
[]=
¨øy
(
$¨chivo
, 
$∑th
."/".$¨chivo, 
$mö
, 
$exif
) ;

640 
	g$dúe˘‹io
->
˛o£
();

642 
	g$num
 = 
cou¡
(
$li°a
);

643 
	gecho
 "Numero de imagenes: <b>$num</b>";

644 i‡–
	g$num
 > 0 ) {

646 
	gecho
 "\n<div id='thumbnails'>";

647 
	g$i
=0 ; $i!=
$num
; $i++) {

648 
	g$i_size
 = 
gëfûesize
(
fûesize
(
$li°a
[
$i
][1]));

649 
	g$i_¨ó
 = 
gëimagesize
(
$li°a
[
$i
][1]);

650 
	g$i_width
 = 
$i_¨ó
[0];

651 
	g$i_height
 = 
$i_¨ó
[1];

652 
	gecho
 "\n<p class='thumb' ><tt>";

653 
	gecho
 "<®ªl='thumb«û' on˛ick=\"javas¸ùt:›í('",
	g$li°a
[
$i
][1],"','",$li°a[$i][0],"','toﬁb¨Úo,s¸ﬁlb¨sÚo,width=",
	g$i_width
 + 20 ,",height=",
	g$i_height
 + 20,"')\" >";

654 
	gecho
 "<img id='thumb_",
	g$i
,"' src='",
	g$li°a
[
$i
][2],"' ";

655 
	gecho
 "alt='Imagen' /> </a>";

656 
	gecho
 "<b∏/><•™ cœss='idim'>[",
	g$i_width
,"x",
	g$i_height
,"] ",
	g$i_size
;

657 i‡–
cou¡
(
$li°a
[
$i
][3]) > 1 ) {

658 
	gecho
 " [<®⁄˛ick='visuÆiz¨(\"exif_",
	g$i
,"\");visualizar(\"thumb_",$i,"\")' >exif</a>]";

659 
	gecho
 "</span>";

660 
	gecho
 "<br/> <•™ id='exif_",
	g$i
,"' class='isize' style='display:Çone'><p>";

661 
f‹óch
 (
$li°a
[
$i
][3] 
as
 
$key
 => 
$£˘i⁄
) {

662 
f‹óch
 (
$£˘i⁄
 
as
 
$«me
 => 
$vÆ
) {

663 
echo
 "<b>$key.$name:</b> $val<br />\n";

666 
	gecho
 "</p></span></tt></p>";

668 
	gecho
 "</span></tt></p>";

671 
	gecho
 "\n</div> <!-- AcabaÅhumbnails -->";

672  
	gTRUE
;

675  
	gTRUE
;

692 
fun˘i⁄
 
	$gëfûesize
(
$size
) {

694 
$unôs
 = 
	`¨øy
(' B', ' KB', ' MB', ' GB', ' TB');

695 
$i
 = 0; 
$size
 > 1024; $i++) { $size /= 1024; }

696  
	`round
(
$size
, 2).
$unôs
[
$i
];

697 
	}
}

	@gcm/lib/int/idiomas/lib/IdiomasCore.php

1 <?
php


18 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/gcm/lib/helpers.php');

40 ˛as†
	cIdiomasC‹e
 {

48 
¥iv©e
 
	m$¥oye˘o
;

50 
¥iv©e
 
	m$idiomas_a˘ivados
;

51 
¥iv©e
 
	m$idiomaxde„˘o
;

52 
¥iv©e
 
	m$dú_idiomas
;

54 
¥iv©e
 
	m$idioma_a˘uÆ
;

67 
fun˘i⁄
 
	$__c⁄°ru˘
(
$aC⁄figuøci⁄
) {

69 i‡–! 
	`is£t
(
$aC⁄figuøci⁄
) ) {

70 
	`åiggî_îr‹
("E†√˚ßriÿdeföúÜa†v¨übÀ†dêc⁄figuøci⁄", 
E_USER_ERROR
);

75 
$GLOBALS
['LG'] = 
	`¨øy
();

77 
	`f‹óch
 ( 
$aC⁄figuøci⁄
 
as
 
$key
 => 
$vÆ‹
 ) {

78 
$this
->
$key
 = 
$vÆ‹
;

81 
$this
->
¥oye˘o
 = ( 
	`is£t
($this->proyecto) ) ? $this->proyecto : 'default';

83 i‡–! 
	`is£t
(
$this
->
idiomas_a˘ivados
) ) {

84 
	`åiggî_îr‹
("E†√˚ßriÿdeföú idiomas_a˘ivado†díåÿdñáºay dêc⁄figuøci⁄", 
E_USER_ERROR
);

87 i‡–! 
	`is£t
(
$this
->
idiomaxde„˘o
) ) {

88 
	`åiggî_îr‹
("E†√˚ßriÿdeföú idiomaxde„˘ÿdíåÿdñáºay dêc⁄figuøci⁄", 
E_USER_ERROR
);

91 i‡–! 
	`is£t
(
$this
->
dú_idiomas
) ) {

92 
	`åiggî_îr‹
("E†√˚ßriÿdeföú dú_idioma†díåÿdñáºay dêc⁄figuøci⁄", 
E_USER_ERROR
);

95 
$this
->
	`idioma_a˘uÆ
();

103 
fun˘i⁄
 
	$idioma_a˘uÆ
() {

106 i‡–
$this
->
idioma_a˘uÆ
 )  $this->idioma_actual;

109 i‡(
	`is£t
(
$_GET
["idioma"])) {

110 
$_SESSION
[
$this
->
¥oye˘o
."-idioma"] = 
$_GET
["idioma"];

111 
$this
->
idioma_a˘uÆ
 = 
$_GET
['idioma'];

112  
$_GET
['idioma'];

116 i‡(
	`is£t
(
$_SESSION
[
$this
->
¥oye˘o
."-idioma"])) {

118 
$this
->
idioma_a˘uÆ
 = 
$_SESSION
[$this->
¥oye˘o
."-idioma"] ;

124 
$sôñ™g
 = 
	`gëív
("HTTP_ACCEPT_LANGUAGE");

125 
$sôñ™g
 = $sitelang[0].$sitelang[1];

127 i‡–
	`¨øy_key_exi°s
(
$sôñ™g
,
$this
->
idiomas_a˘ivados
 ) ) {

129 
$_SESSION
[
$this
->
¥oye˘o
."-idioma"] = 
$sôñ™g
;

130 
$this
->
idioma_a˘uÆ
 = 
$sôñ™g
;

134 
$_SESSION
[
$this
->
¥oye˘o
."-idioma"] = $this->
idiomaxde„˘o
;

135 
$this
->
idioma_a˘uÆ
 = $this->
idiomaxde„˘o
;

141 
	}
}

149 
fun˘i⁄
 
	$ö°Æaci⁄
() {

150 i‡–! 
	`fûe_exi°s
(
$this
->
dú_idiomas
) ) {

151  
	`mkdú_ªcursivo
(
$this
->
dú_idiomas
);

154 
	}
}

170 
public
 
fun˘i⁄
 
	$£Àcci⁄_idioma
() {

172 
globÆ
 
$LG
, 
$GCM_LG
;

176 
$this
->
	`ö˛uú_lôîÆes
(
GCM_DIR
.'DATOS/idiomas/GCM_LG_'.$this->
idiomaxde„˘o
.'.php', $this->idiomaxdefecto, 'GCM_LG_');

178 i‡–
$this
->
idioma_a˘uÆ
 !$this->
idiomaxde„˘o
 ) {

179 
$this
->
	`ö˛uú_lôîÆes
(
GCM_DIR
.'DATOS/idiomas/GCM_LG_'.$this->
idioma_a˘uÆ
.'.php', $this->idioma_actual, 'GCM_LG_');

184 
$this
->
	`ö˛uú_lôîÆes
($this->
dú_idiomas
."LG_".$this->
idiomaxde„˘o
.".php", $this->idiomaxdefecto);

190 i‡–
$this
->
idioma_a˘uÆ
 !$this->
idiomaxde„˘o
 ) {

191 
$this
->
	`ö˛uú_lôîÆes
($this->
dú_idiomas
."LG_".$this->
idioma_a˘uÆ
.".php", $this->idioma_actual);

194 
	}
}

205 
¥iv©e
 
fun˘i⁄
 
ö˛uú_lôîÆes
(
$fûe
, 
$idioma
, 
$¥efijo_¨øy
 = 'LG_') {

207 
globÆ
 
$LG
;

209 i‡–
fûe_exi°s
(
$fûe
) ) {

210 
ö˛ude
(
$fûe
);

211 i‡–
is£t
(
$
{
$¥efijo_¨øy
.
$idioma
}ËË
	g$LG
 = 
¨øy_mîge
(
$LG
,${$prefijo_array.$idioma});

220 
fun˘i⁄
 
	$gëIdiomaxde„˘o
() {

221  ( 
	`is£t
(
$this
->
idiomaxde„˘o
ËË? $this->idiomaxde„˘ÿ: 
FALSE
;

222 
	}
}

228 
fun˘i⁄
 
	$gëIdioma_a˘uÆ
() {

229  ( 
	`is£t
(
$this
->
idioma_a˘uÆ
ËË? $this->idioma_a˘uÆ : 
FALSE
;

230 
	}
}

236 
fun˘i⁄
 
	$gëDú_idiomas
() {

237  ( 
	`is£t
(
$this
->
dú_idiomas
ËË? $this->dú_idioma†: 
FALSE
;

238 
	}
}

242 
fun˘i⁄
 
	$gëIdiomasA˘ivados
() {

243  
$this
->
idiomas_a˘ivados
;

244 
	}
}

250 
fun˘i⁄
 
	$£À˘‹_idiomas
() {

252 
globÆ
 
$gcm
;

255 i‡–
	`cou¡
(
$this
->
idiomas_a˘ivados
) > 1 ) {

258 <
s¸ùt
 
ty≥
="text/javascript">

259 
fun˘i⁄
 
	`vÆidaSñe˘
(
theLi°
){ÅheLi°.
f‹m
.
	`submô
(); }

260 </
s¸ùt
>

261 <?
php


263 
echo
 "\n<div id='idiomas'>" ;

264 
echo
 "\n<formáction='#'>";

265 
echo
 "<selectÇame='idioma' onChange='validaSelect(this);' >";

266 
	`f‹óch
(
$this
->
idiomas_a˘ivados
 
as
 
$idioma
) {

267 i‡(
$idioma
!=
$_SESSION
[
$this
->
¥oye˘o
."-idioma"]) {

268 
echo
 "<›ti⁄ vÆue='".
$idioma
."' >".
	`lôîÆ
($idioma)."</option>";

270 
echo
 "<›ti⁄ sñe˘ed vÆue='".
$idioma
."' >".
	`lôîÆ
($idioma)."</option>";

273 
echo
 "</select>\n</form>";

274 
echo
 "\n</div> <!-- ACABA idiomas -->";

277 
	}
}

288 
fun˘i⁄
 
	$b™dîas
(
$∂™tûœ
 = 
FALSE
) {

290 
globÆ
 
$gcm
;

292 i‡–! 
$∂™tûœ
 ) {

295 i‡–
	`cou¡
(
$this
->
idiomas_a˘ivados
) > 1 ) {

296 
echo
 '<div id="banderas">';

297 
	`f‹óch
(
$this
->
idiomas_a˘ivados
 
as
 
$idioma
) {

299 
$b™dîa
 = ( 
	`fûe_exi°s
(
$this
->
dú_idiomas
.''.
$idioma
.'.≤g'ËË? $this->dú_idiomas.''.$idioma.'.≤g' : 
Rouãr
::
$ba£
.
GCM_DIR
.'lib/int/idiomas/img/'.$idioma.'.png' ;

301 i‡(
$idioma
 !
$_SESSION
[
$this
->
¥oye˘o
."-idioma"]) {

302 
echo
 '<®hªf="?idioma='.
$idioma
.'" ><imgá…="'.$idioma.'" src="'.
$b™dîa
.'" /></a> ';

304 
echo
 '<®˛ass="idioma_a˘ivado" hªf="?idioma='.
$idioma
.'" ><imgá…="'.$idioma.'" src="'.
$b™dîa
.'" /></a> ';

307 
echo
 '</div>';

310 
	`ö˛ude
(
$∂™tûœ
);

312 
	}
}

	@gcm/lib/int/mimetypes.php

1 <?
php


2 
	g$mimëy≥s
=
¨øy
(

	@gcm/lib/int/registro/Registro.php

1 <?
php


15 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/gcm/lib/helpers.php');

48 ˛as†
	cRegi°ro
 {

50 
¥iv©e
 
	m$tùos_admôidos
;

51 
¥iv©e
 
	m$c⁄exi⁄
 = 
NULL
;

52 
¥iv©e
 
	m$sufijo
 = '';

58 
¥iv©e
 
	m$îr‹es
 = 
FALSE
;

64 
public
 
	m$ªgi°ros
;

66 
public
 
	m$tùos_ªgi°ros
 = 
¨øy
('DEBUG', 'NORMAL', 'ADMIN', 'AVISO', 'ERROR');

67 
public
 
	m$£si⁄
 = 
NULL
;

68 
public
 
	m$limôe_míßjes
 = 500;

69 
public
 
	m$limôe_des¸ùci⁄
 = 1300;

70 
public
 
	m$ba£_d©os
;

72 
¥iv©e
 
	m$mŸ‹_bd
;

81 
fun˘i⁄
 
__c⁄°ru˘
(
$ba£_d©os
=
NULL
, 
$sufijo
='') {

83 
$this
->
sufijo
 = 
$sufijo
;

87 
	m$this
->
nivñ
('AVISO');

89 i‡–
$ba£_d©os
 
ö°™˚of
 
	mPDO
 ) {

91 
	m$this
->
	mc⁄exi⁄
 = 
$ba£_d©os
;

93 } 
ñ£if
 ( 
is_dú
(
$ba£_d©os
) ) {

95 
	m$this
->
	mba£_d©os
 = 
$ba£_d©os
.'/'.
d©e
("d-m-Y").'_registros.bd';

96 
	m$this
->
	mc⁄exi⁄
 = 
√w
 
PDO
('sqlôe:'.
$this
->
ba£_d©os
);

100 
	m$this
->
	mba£_d©os
 = 
$ba£_d©os
;

101 
	m$this
->
	mc⁄exi⁄
 = 
√w
 
PDO
('sqlôe:'.
$this
->
ba£_d©os
);

106 
	m$this
->
exi°e_èbœ
(
$this
->
sufijo
.'registros');

110 
	m$u…ima_£si⁄
 = 
$this
->
u…ima_£si⁄
();

111 
	m$this
->
	m£si⁄
 = 
$u…ima_£si⁄
 + 1;

113 
	m$this
->
	mmŸ‹_bd
 = 
$this
->
c⁄exi⁄
->
gëAâribuã
(
c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

114 
	m$this
->
ªgi°ø
(
__FILE__
,
__LINE__
,"Sesi⁄: ".
$this
->
£si⁄
."\n".'SêöicüÑegi°rÿ®œ†'.
°r·ime
("%d dê%b dñ %YáÜa†%r").'É¿'.$this->
ba£_d©os
,'NORMAL');

122 
fun˘i⁄
 
	$exi°e_èbœ
(
$èbœ
) {

124 
åy
 {

126 
$sql
 = 'SELECT COUNT(*ËFROM '.
$èbœ
;

128 i‡–! 
$°h
 = 
$this
->
c⁄exi⁄
->
	`¥ï¨e
(
$sql
) ) {

130 
$this
->
	`¸ór_èbœ
(
$èbœ
);

134 i‡(!
$°h
->
	`execuã
()) {

136 
$this
->
	`¸ór_èbœ
(
$èbœ
);

141 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

143 
$this
->
	`¸ór_èbœ
(
$èbœ
);

152  
TRUE
;

154 
	}
}

167 
fun˘i⁄
 
	$¸ór_èbœ
(
$èbœ
) {

169 i‡–
$this
->
c⁄exi⁄
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME")) == 'sqlite' ) {

170 
$autoö¸emít
 = '';

172 
$autoö¸emít
 = 'AUTO_INCREMENT';

175 
$SQL
 = "CREATE TABLE $tabla (

176 
id
 
INTEGER
 
PRIMARY
 
KEY
 
$autoö¸emít
,

177 
£si⁄
 
INTEGER
,

178 
„cha
 
	`INT
(14),

179 
tùo
 
	`VARCHAR
(10),

180 
fichîo
 
	`VARCHAR
(100),

181 
löó
 
INTEGER
,

182 
míßje
 
	`VARCHAR
(".$this->limite_mensajes."),

183 
des¸ùci⁄
 
	`VARCHAR
(".$this->limite_descripcion.")

186 i‡–! 
$sqlResu…
 = 
$this
->
c⁄exi⁄
->
	`quîy
(
$SQL
) ) {

188 
$îr
 = 
$this
->
c⁄exi⁄
->
	`îr‹Info
();

189 
throw
 
√w
 
	`Ex˚±i⁄
("Eº‹á»¸ó∏èbœ dê".
$èbœ
."\n".
$îr
[2]);

190  
FALSE
;

194 
	}
}

198 
fun˘i⁄
 
	$îr‹es
(Ë{  
$this
->
îr‹es
; 
	}
}

202 
public
 
fun˘i⁄
 
	$gëIn°™˚
() {

204 
$objëoRegi°ro
;

206 i‡–!
	`is£t
(
$objëoRegi°ro
) ) {

207 
$objëoRegi°ro
 = 
√w
 
	`Regi°ro
();

210  
$objëoRegi°ro
;

212 
	}
}

221 
fun˘i⁄
 
	$tùoAªgi°ro
(
$tùo
) {

223 i‡–
	`ö_¨øy
(
$tùo
,
$this
->
tùos_admôidos
) ) {

224  
TRUE
;

226  
FALSE
;

229 
	}
}

238 
fun˘i⁄
 
nivñ
(
$nivñ
='AVISO') {

240 i‡–! 
$this
->
vÆid¨_tùo
(
$nivñ
) ) {

241 
throw
 
√w
 
Ex˚±i⁄
('Nivñ '.
$nivñ
.' inexistente');

242  
	gFALSE
;

245 
	g$m¨ˇ
 = 
NULL
;

246 
	g$this
->
	gtùos_admôidos
 = 
¨øy
();

248 
f‹óch
–
$this
->
tùos_ªgi°ros
 
as
 
$tùo
 ) {

250 i‡–
	g$tùo
 =
$nivñ
 || 
$m¨ˇ
 ) {

251 
$this
->
tùos_admôidos
[] = 
$tùo
;

252 
	g$m¨ˇ
 = 
TRUE
;

257 
	g$this
->
ªgi°ø
(
__FILE__
,
__LINE__
,'Nivñ dêªgi°ro†®'.
$nivñ
. "\nTùo†admöôidos: ".
dïuør
(
$this
->
tùos_admôidos
));

259  
	gTRUE
;

265 
fun˘i⁄
 
	$u…ima_£si⁄
() {

267 
$sql
 = 'SELECT sesi⁄ FROM '.
$this
->
sufijo
.'registros order by sesion descÜimit 1';

268 
$ªsu…
 = 
$this
->
c⁄exi⁄
->
	`quîy
(
$sql
,
PDO
::
FETCH_NUM
);

270 i‡(!
$ªsu…
) {

273 
	`f‹óch
 ( 
$ªsu…
 
as
 
$u…imo
 ) {

274  
$u…imo
[0];

277 
	}
}

288 
fun˘i⁄
 
	$vÆid¨_tùo
(
$tùo
) {

290 i‡–! 
	`ö_¨øy
(
$tùo
, 
$this
->
tùos_ªgi°ros
) ) {

291 
throw
 
√w
 
	`Ex˚±i⁄
('VÆidaci⁄ dêtùÿ√g©iv®['.
$tùo
.']');

292  
FALSE
;

294  
TRUE
;

297 
	}
}

313 
fun˘i⁄
 
ªgi°ø
(
$fichîo
,
$löó
, 
$m
, 
$tùo
 = 'DEBUG', 
$des¸ùci⁄
 = 
NULL
) {

315 
$tõmpo
 = 
time
();

317 i‡–!
	g$m
 || $m == '' ) {

318 
throw
 
√w
 
Ex˚±i⁄
('SeÑequiere de contenidoáÑegistrar');

319  
	gÁl£
;

322 i‡–! 
	g$this
->
vÆid¨_tùo
–
$tùo
 ) ) {

323 
throw
 
√w
 
Ex˚±i⁄
('Tipo_incorrecto');

324  
	gÁl£
;

327 
	g$ßlida
 = '';

333 i‡–
is_¨øy
(
$m
) ) {

334 
	g$ßlida
 = '';

335 
f‹óch
 ( 
$m
 
as
 
$key
 => 
$míßje
 ) {

336 i‡–
is_¨øy
(
$míßje
) ) {

337 
f‹óch
 (
$míßje
 
as
 
$key2
 => 
$vÆ‹2
) {

338 i‡–
is_¨øy
(
$vÆ‹2
) ) {

339 
$ßlida
 .
$key2
." => ".
v¨_exp‹t
(
$vÆ‹2
,
åue
)."\n";

341 
	g$ßlida
 .
$key2
." => ".
$vÆ‹2
."\n";

345 
	g$ßlida
 .
$key
." => ".
$míßje
."\n";

349 
	g$ßlida
 = 
$m
;

356  
°æí
(
$ßlida
Ë> 
	g$this
->
	glimôe_míßjes
 ) {

358 
	g$ßlidaAºay
[] = 
sub°r
(
$ßlida
,0,
$this
->
limôe_míßjes
).'@->';

359 
	g$ßlida
 = 
sub°r
(
$ßlida
,
$this
->
limôe_míßjes
);

363 
	g$ßlidaAºay
[] = 
$ßlida
;

365 
f‹óch
 ( 
$ßlidaAºay
 
as
 
$ßlida
 ) {

366 
	g$ƒ
 = ( 
cou¡
(
$this
->
ªgi°ros
) > 0 ) ? count($this->registros) : 0 ;

367 
	g$this
->
	gªgi°ros
[
$ƒ
] = 
¨øy
($ƒ,
$this
->
£si⁄
,
$tõmpo
,
$tùo
,
$fichîo
,
$löó
,
$ßlida
,
$des¸ùci⁄
);

372 i‡–! 
	g$this
->
tùoAªgi°ro
(
$tùo
) ) ;

376 
	g$_SESSION
[
$this
->
sufijo
.'ªgi°ros'][
$tùo
][] = 
¨øy
(
$fichîo
,
$löó
,
$ßlida
);

380 
f‹óch
 ( 
$ßlidaAºay
 
as
 
$ßlida
 ) {

382 i‡–
	g$tùo
 == 'ERROR' ) {

384 
$this
->
îr‹es
 = 
TRUE
;

386 i‡–
	gGCM_DEBUG
 ) {

388 
	gecho
 "<div class='error'>";

389 
	gecho
 "<pre>$salida</b></pre>";

390 
	gecho
 '<®hªf="vim://'.
	g$fichîo
.'@'.
	g$löó
.'">';

391 
	gecho
 "<p>$fichero : $linea</p>";

392 
	gecho
 "</a>";

393 
	gecho
 "</div>";

398 
	g$SQL
 = "INSERT INTO ".
$this
->
sufijo
."registros ( sesion, fecha,Åipo, mensaje, fichero,Üinea, descripcion ) VALUES ";

399 
	g$SQL
 .= "(?,?,?,?,?,?,?)";

400 
	g$com™do
 = 
$this
->
c⁄exi⁄
->
¥ï¨e
(
$SQL
);

401 i‡–!
	g$com™do
 ) {

402 
	g$îr
 = 
$this
->
c⁄exi⁄
->
îr‹Info
();

403 
	g$mí_îr‹
 = 
$îr
[2];

404 
throw
 
√w
 
Ex˚±i⁄
('Eº‹á»¥ï¨¨ sql'.
$mí_îr‹
);

407 i‡–! 
	g$com™do
->
execuã
(
¨øy
(
$this
->
£si⁄
,
$tõmpo
,
$tùo
,
$ßlida
, 
$fichîo
, 
$löó
, 
$des¸ùci⁄
) ) ) {

408 
	g$îr
 = 
$this
->
c⁄exi⁄
->
îr‹Info
();

409 
	g$mí_îr‹
 = 
$îr
[2];

410 
throw
 
√w
 
Ex˚±i⁄
('Eº‹á»ö£π¨Ñegi°ro: '.
$mí_îr‹
);

414  
	g$tõmpo
.'::'.
	g$tùo
.'::'.
	g$ßlida
;

424 
fun˘i⁄
 
	$vî_ªgi°ros
(
$tùos
 = 
NULL
, 
$c⁄dici⁄
 = NULL ) {

426 
$„cha_mysql
 = "FROM_UNIXTIME( fecha )";

427 
$„cha_sqlôe
 = "datetime(fecha, 'unixepoch', 'localtime')";

429 i‡–
$this
->
c⁄exi⁄
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME")) == 'sqlite' ) {

430 
$„cha
 = 
$„cha_sqlôe
;

432 
$„cha
 = 
$„cha_mysql
;

435 
$sql0
 = 'SELECT id, sesi⁄, '.
$„cha
.',Åipo, fichero,Üinea, mensaje, descripcion ';

436 
$sql1
 = 'FROM '.
$this
->
sufijo
.'registros WHERE 1 ';

440 i‡–
	`is_¨øy
(
$tùos
) ) {

442 
$sql1
 .= ' AND (';

444 
	`f‹óch
 ( 
$tùos
 
as
 
$tùo
 ) {

445 i‡–
$tùo
 =
$tùos
[0] ) {

446 
$sql1
 .'Åùÿ"'.
$tùo
.'"';

448 
$sql1
 .' ORÅùÿ"'.
$tùo
.'"';

451 
$sql1
 .= ')';

455 i‡–
$tùos
 ) {

456 
$sql1
 .' ANDÅùo="'.
$tùos
.'"';

463 i‡–
$c⁄dici⁄
 ) {

464 
$sql1
 .' AND '.
	`°rù¶ashes
(
$c⁄dici⁄
) ;

466 
$sql1
 .' AND sesi⁄='.
$this
->
£si⁄
;

469 
$c⁄su…a
 = 
$sql0
.
$sql1
;

470 
$ªsu…
 = 
$this
->
c⁄exi⁄
->
	`¥ï¨e
(
$c⁄su…a
);

472 i‡–! 
$ªsu…
 ) {  
FALSE
; }

474 
$ªsu…
->
	`execuã
();

475 
$ªt‹no
 = 
$ªsu…
->
	`„tchAŒ
(
PDO
::
FETCH_NUM
);

479 i‡(!
$ªsu…
) {

481 
$îr
 = 
$this
->
c⁄exi⁄
->
	`îr‹Info
();

482 
$mí_îr‹
 = 
$îr
[2];

483 
throw
 
√w
 
	`Ex˚±i⁄
('Eº‹Éjecuèndÿquîy: '.
$mí_îr‹
. ' sql: '.
$c⁄su…a
);

485 } 
	`ñ£if
 ( 
	`cou¡
(
$ªt‹no
) > 0 ) {

488 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Regi°ro::C⁄Ñesu…ado::'.
$sql1
);

489  
$ªt‹no
;

493 
$this
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Regi°ro::SöÑesu…ados::'.
$sql0
.
$sql1
);

494  
FALSE
;

498 
	}
}

504 
fun˘i⁄
 
	$ªgi°ros_£si⁄
() {

506 i‡–! 
	`is£t
(
$_SESSION
[
$this
->
sufijo
.'ªgi°ros']Ë|| 
	`em±y
($_SESSION[$this->sufijo.'ªgi°ros']ËË{  
FALSE
; }

508 
$ªgi°ros
 = 
$_SESSION
[
$this
->
sufijo
.'registros'];

509 
	`un£t
(
$_SESSION
[
$this
->
sufijo
.'registros']);

510  
$ªgi°ros
;

512 
	}
}

520 
fun˘i⁄
 
	$b‹ødo_ªgi°ros_™tiguos
(
$düs
) {

522 i‡–
$this
->
mŸ‹_bd
 == 'sqlite' ) {

524 
$h‹as
 = ( 
$düs
 * 24 );

525 
	`b‹ør_¨chivos_võjos
(
$h‹as
, 
	`dú«me
(
$this
->
ba£_d©os
).'/*' );

529 
$„cha_unix_b‹ødo
 = 
	`time
(Ë- ( 
$düs
 * 24 * 60 * 60 );

531 
$c⁄dici⁄
 = "„ch®< ".
$„cha_unix_b‹ødo
;

533 
$sql
 = "DELETE FROM ".
$this
->
sufijo
.'ªgi°ro†WHERE '.
$c⁄dici⁄
;

534 
$ªsu…
 = 
$this
->
c⁄exi⁄
->
	`¥ï¨e
(
$sql
);

535 
$ªsu…
->
	`execuã
();

539 
	}
}

	@gcm/lib/int/registro/RegistroFactory.php

1 <?
php


29 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/Registro.php');

31 ˛as†
	cRegi°roFa˘‹y
 {

33 
public
 
fun˘i⁄
 
gëRegi°ro
(
$ba£_d©os
=
NULL
,
$sufijo
='') {

35 
$key
 = 
md5
(
£rülize
(
$ba£_d©os
));

37 i‡–! 
is£t
(
$GLOBALS
['Regi°ro']Ë|| ! (
	m$GLOBALS
['Regi°ro'][
$key
] 
ö°™˚of
 
	mRegi°ro
) ) {

39 
	m$GLOBALS
['Regi°ro'][
$key
] = 
√w
 
Regi°ro
(
$ba£_d©os
,
$sufijo
);

43  
	m$GLOBALS
['Regi°ro'][
$key
];

	@gcm/lib/int/registro/RegistroFactoryTest.php

1 <?
php


7 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

9 
ªquúe
(
dú«me
(
__FILE__
).'/RegistroFactory.php');

11 ˛as†
	cRegi°roFa˘‹yTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

13 
public
 
	m$ªgi°roFa˘‹y
;

14 
public
 
	m$¨chivo
;

16 
fun˘i⁄
 
	$__c⁄°ru˘
() {

18 
$this
->
¨chivo
 = '/tmp/TestRegistroFactory.db';

19 
$this
->
ªgi°roFa˘‹y
 = 
Regi°roFa˘‹y
::
	`gëRegi°ro
($this->
¨chivo
);

25 
fun˘i⁄
 
	$ã°AnyadúRegi°ros
() {

27 
$this
->
ªgi°roFa˘‹y
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Test sobre Registro');

28 
$this
->
	`as£πTrue
(
	`fûe_exi°s
($this->
¨chivo
), 'Archivo deÑegistro creado');

32 
$this
->
¨chivo
 = '/tmp/TestRegistroFactory2.db';

33 
$this
->
ªgi°roFa˘‹y
 = 
Regi°roFa˘‹y
::
	`gëRegi°ro
($this->
¨chivo
);

35 
$this
->
ªgi°roFa˘‹y
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Test sobre Registro2');

36 
$this
->
	`as£πTrue
(
	`fûe_exi°s
($this->
¨chivo
), 'Archivo deÑegistro creado');

38 
	}
}

	@gcm/lib/int/registro/RegistroTest.php

1 <?
php


3 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

5 
ªquúe_⁄˚
('Registro.php');

7 ˛as†
	cRegi°roTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
{

9 
public
 
	m$ªgi°ro
 = '';

11 
fun˘i⁄
 
	$__c⁄°ru˘
() {

13 
$this
->
ªgi°ro
 = 
√w
 
	`Regi°ro
('/tmp/test.bd');

17 
fun˘i⁄
 
	$ã°Cª™doNuevoRegi°ro
() {

19 
$this
->
ªgi°ro
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Test sobre Registro');

21 
$this
->
	`as£πTrue
(
	`fûe_exi°s
('/tmp/test.bd'), 'Archivo deÑegistro creado');

23 
	}
}

29 
fun˘i⁄
 
	$ã°In£π™doAºay
() {

31 
$¨øy
 = 
	`¨øy
('Test deÉntrada deárray');

32 
$¨øy
[1]['Li°adÿsubdúe˘‹io'] = 
	`glob
("../*");

33 
$¨øy
[2]['Li°adÿdúe˘‹iÿãmp‹Æ'] = 
	`glob
("/tmp/*");

34 
$this
->
	`as£πNŸNuŒ
($this->
ªgi°ro
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
$¨øy
), 'Ingresar unárray');

36 
	}
}

40 
public
 
fun˘i⁄
 
	$ã°Ex˚±i⁄
() {

42 
åy
 {

43 @
$this
->
ªgi°ro
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Test sobre Registro','SIN_TIPO');

45 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex≥˘ed
) {

50 
$this
->
	`Áû
('SeÉsperaba unÉrror queÇo seÖrodujo');

51 
	}
}

55 
fun˘i⁄
 
	$ã°Regi°roNulo
() {

57 
åy
 {

58 @
$this
->
ªgi°ro
->
	`ªgi°ø
();

60 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex≥˘ed
) {

65 
$this
->
	`Áû
('RegistroÇulo sinÉrror');

67 
	}
}

71 
fun˘i⁄
 
	$ã°Regi°roGønde
() {

73 
$this
->
	`as£πNŸNuŒ
($this->
ªgi°ro
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`°r_ª≥©
("Test de Registro grande ",80)), 'Ingresar unÑegistro grande');

75 
	}
}

79 
public
 
fun˘i⁄
 
	$ã°Sessi⁄A˘uÆ
() {

81 
$this
->
	`as£πNŸNuŒ
($this->
ªgi°ro
->
	`vî_ªgi°ros
(), 'Registros deÜa sesi√≥náctual');

82 
$this
->
	`as£πNŸNuŒ
($this->
ªgi°ro
->
	`vî_ªgi°ros
(
	`¨øy
('DEBUG','ADMIN')), 'Registros deÜa sesi√≥náctual');

83 
$this
->
	`as£πFÆ£
($this->
ªgi°ro
->
	`vî_ªgi°ros
(
	`¨øy
('AVISO')), 'No debe heberÑegistros de AVISO');

85 
	}
}

89 
fun˘i⁄
 
	$ã°VÆid¨_tùo
() {

91 
$this
->
	`as£πTrue
($this->
ªgi°ro
->
	`vÆid¨_tùo
('DEBUG'), 'ValidarÅipoÑegistros');

93 
åy
 {

94 
$this
->
ªgi°ro
->
	`vÆid¨_tùo
('TIPO_NO_VALIDO');

95 } 
	`ˇtch
 (
Ex˚±i⁄
 
$e
) {

99 
$this
->
	`Áû
('Validador deÅipo deÑegistro dio uno maloÖor bueno');

101 
	}
}

105 
fun˘i⁄
 
	$ã°Nivñ
() {

107 
$this
->
	`as£πTrue
($this->
ªgi°ro
->
	`nivñ
('ADMIN'), 'CambiamosÇivel');

109 
	}
}

	@gcm/lib/int/rst2html/lib/Rst2html.php

1 <?
php


38 ˛as†
	cR°2html
 {

40 
fun˘i⁄
 
	$c⁄vîtú
(
$öput
) {

42 
$r°2html
 = '/usr/bin/rst2html';

44 i‡(!
	`is_execuèbÀ
(
$r°2html
)) {

50 #I‡
pùe
 
îr‹s
 
¨e
 
ªp‹ãd
, 
íabÀ
 
ouçut
 
to
 
the
 
fûe
.

51 #Buà
make
 
˚πaö
 
the
 
fûe
 
d€¢
'tálreadyÉxist orÉlse

52 #thê
web£rvî
 
may
 
nŸ
 
have
 
≥rmissi⁄
 
to
 
¸óã
 
ô
.

53 
$io_desc
 = 
	`¨øy
(

54 0 => 
	`¨øy
('pipe', 'r'),

55 1 => 
	`¨øy
('pipe', 'w'),

58 
$ªs
 = 
	`¥oc_›í
(
$r°2html
 . " --stylesheet-path='' " .

61 
$io_desc
, 
$pùes
, '/tmp', 
NULL
);

63 i‡(
	`is_ªsour˚
(
$ªs
)) {

65 
	`fwrôe
(
$pùes
[0], 
$öput
);

66 
	`f˛o£
(
$pùes
[0]);

68 
$html
 = 
	`°ªam_gë_c⁄ã¡s
(
$pùes
[1]);

69 
	`f˛o£
(
$pùes
[1]);

71 
$html
 = 
	`¥eg_ª∂a˚
('/.*<body>\n(.*)<\/body>.*/s', '${1}', $html);

75 
$html
 = "<strong class='error'>" .

80  
$html
;

83 
	}
}

	@gcm/lib/int/solicitud/lib/Restricciones.php

1 <?
php


3 
ªquúe_⁄˚
("constantes.php");

5 ˛as†
	cRe°ricci⁄es
 {

7 
¥iv©e
 
	m$_ötC⁄°øötTy≥
;

8 
¥iv©e
 
	m$_°rC⁄°øötO≥ønd
;

10 
fun˘i⁄
 
	$__c⁄°ru˘
(
$ötC⁄°øötTy≥
, 
$°rC⁄°øötO≥ønd
) {

11 
$this
->
_ötC⁄°øötTy≥
 = 
$ötC⁄°øötTy≥
;

12 
$this
->
_°rC⁄°øötO≥ønd
 = 
$°rC⁄°øötO≥ønd
;

15 
fun˘i⁄
 
	$GëC⁄°øötTy≥
() {

16 (
$this
->
_ötC⁄°øötTy≥
);

17 
	}
}

19 
fun˘i⁄
 
	$GëC⁄°øötO≥ønd
() {

20 (
$this
->
_°rC⁄°øötO≥ønd
);

21 
	}
}

	@gcm/lib/int/solicitud/lib/RestriccionesFallidas.php

1 <?
php


3 ˛as†
	cRe°ricci⁄esFÆlidas
 {

5 
¥iv©e
 
	m$_°rP¨amëîName
;

6 
¥iv©e
 
	m$_ötVîbMëhod
;

7 
¥iv©e
 
	m$_objFaûedC⁄°øötObje˘
;

9 
fun˘i⁄
 
	$__c⁄°ru˘
(
$°rP¨amëîName
, 
$ötVîbMëhod
,

10 
$objFaûedC⁄°øötObje˘
) {

11 
$this
->
_°rP¨amëîName
 = 
$°rP¨amëîName
;

12 
$this
->
_ötVîbMëhod
 = 
$ötVîbMëhod
;

13 
$this
->
_objFaûedC⁄°øötObje˘
 = 
$objFaûedC⁄°øötObje˘
;

16 
fun˘i⁄
 
	$GëP¨amëîName
() {

17 (
$this
->
_°rP¨amëîName
);

18 
	}
}

20 
fun˘i⁄
 
	$GëVîbMëhod
() {

21 (
$this
->
_ötVîbMëhod
);

22 
	}
}

24 
fun˘i⁄
 
	$GëFaûedC⁄°øötObje˘
() {

25 (
$this
->
_objFaûedC⁄°øötObje˘
);

26 
	}
}

	@gcm/lib/int/solicitud/lib/Solicitud.php

1 <?
php


18 
ªquúe_⁄˚
('constantes.php');

19 
ªquúe_⁄˚
('Restricciones.php');

20 
ªquúe_⁄˚
('RestriccionesFallidas.php');

27 ˛as†
	cSﬁicôud
 {

29 
¥iv©e
 
	m$_¨GëV¨s
;

30 
¥iv©e
 
	m$_¨Po°V¨s
;

31 
¥iv©e
 
	m$_¨CookõV¨s
;

32 
¥iv©e
 
	m$_¨Reque°V¨s
;

41 
¥iv©e
 
	m$_objOrigöÆReque°Obje˘
;

48 
¥iv©e
 
	m$_blIsRedúe˘FﬁlowögC⁄°øötFaûuª
 = 
FALSE
;

55 
¥iv©e
 
	m$_blRedúe˘OnC⁄°øötFaûuª
;

64 
¥iv©e
 
	m$_°rC⁄°øötFaûuªRedúe˘T¨gëURL
;

73 
¥iv©e
 
	m$_°rC⁄°øötFaûuªDeÁu…Redúe˘T¨gëURL
;

83 
¥iv©e
 
	m$_¨ObjP¨amëîMëhodC⁄°øötHash
;

90 
¥iv©e
 
	m$_¨ObjC⁄°øötFaûuª
;

96 
¥iv©e
 
	m$_hasRunC⁄°øötTe°s
;

112 
fun˘i⁄
 
	$__c⁄°ru˘
(
$check_f‹_cookõ
 = 
åue
) {

115 
globÆ
 
$_REQUEST
;

116 
globÆ
 
$_GET
;

117 
globÆ
 
$_POST
;

118 
globÆ
 
$_COOKIE
;

119 
$this
->
_¨GëV¨s
 = 
$_GET
;

120 
$this
->
_¨Po°V¨s
 = 
$_POST
;

121 
$this
->
_¨CookõV¨s
 = 
$_COOKIE
;

122 
$this
->
_¨Reque°V¨s
 = 
$_REQUEST
;

124 i‡(
$check_f‹_cookõ
) {

127 i‡–
	`is£t
(
$_SESSION
['RESPUESTA_ERRONEA']) ) {

130 
$cookõVÆ
 = 
$_SESSION
['RESPUESTA_ERRONEA'];

131 
	`un£t
(
$_SESSION
['RESPUESTA_ERRONEA']);

132 
$this
->
_blIsRedúe˘FﬁlowögC⁄°øötFaûuª
 = 
åue
;

134 i‡(
	`°æí
(
$cookõVÆ
) > 0) {

135 
$°rResu…
 = 
	`£tcookõ
 ("ph¥qcOrigöÆReque°Obje˘", "",
	`time
() - 3600,'/');

136 
$‹igObj
 = 
	`un£rülize
(
	`°rù¶ashes
(
$cookõVÆ
));

137 
$this
->
_objOrigöÆReque°Obje˘
 = &
$‹igObj
;

138 
$this
->
_¨Reque°V¨s
["phprqcOriginalRequestObject"] = "";

139 
$this
->
_¨GëV¨s
["phprqcOriginalRequestObject"] = "";

140 
$this
->
_¨Po°V¨s
["phprqcOriginalRequestObject"] = "";

142 
$this
->
_blIsRedúe˘OnC⁄°øötFaûuª
 = 
åue
;

144 
$this
->
_blIsRedúe˘OnC⁄°øötFaûuª
 = 
Ál£
;

147 
$this
->
_blIsRedúe˘OnC⁄°øötFaûuª
 = 
Ál£
;

149 
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
 = 
	`Aºay
();

150 
$this
->
_¨ObjC⁄°øötFaûuª
 = 
	`Aºay
();

151 
$this
->
_blHasRunC⁄°øötTe°s
 = 
Ál£
;

161 
fun˘i⁄
 
	$IsRedúe˘FﬁlowögC⁄°øötFaûuª
() {

162 (
$this
->
_blIsRedúe˘OnC⁄°øötFaûuª
);

163 
	}
}

172 
fun˘i⁄
 
	$GëOrigöÆReque°Obje˘FﬁlowögC⁄°øötFaûuª
() {

173 i‡(
$this
->
_blIsRedúe˘OnC⁄°øötFaûuª
) {

174 (
$this
->
_objOrigöÆReque°Obje˘
);

176 
	}
}

187 
fun˘i⁄
 
	$SëRedúe˘OnC⁄°øötFaûuª
(
$blTrueOrFÆ£
) {

188 
$this
->
_blRedúe˘OnC⁄°øötFaûuª
 = 
$blTrueOrFÆ£
;

189 
	}
}

199 
fun˘i⁄
 
	$SëC⁄°øötFaûuªRedúe˘T¨gëURL
(
$°rURL
) {

200 
$this
->
_°rC⁄°øötFaûuªRedúe˘T¨gëURL
 = 
$°rURL
;

201 
	}
}

211 
fun˘i⁄
 
	$SëC⁄°øötFaûuªDeÁu…Redúe˘T¨gëURL
(
$°rURL
) {

212 
$this
->
_°rC⁄°øötFaûuªDeÁu…Redúe˘T¨gëURL
 = 
$°rURL
;

213 
	}
}

221 
fun˘i⁄
 
	$GëP¨amëîVÆue
(
$°rP¨amëî
) {

222 (
$this
->
_¨Reque°V¨s
[
$°rP¨amëî
]);

223 
	}
}

227 
fun˘i⁄
 
	$GëP¨amëîs
() {

228 (
$this
->
_¨Reque°V¨s
);

229 
	}
}

233 
fun˘i⁄
 
	$GëCookõs
() {

234 (
$this
->
_¨CookõV¨s
);

235 
	}
}

239 
fun˘i⁄
 
	$GëPo°V¨übÀs
() {

240 (
$this
->
_¨Po°V¨übÀs
);

241 
	}
}

245 
fun˘i⁄
 
	$GëGëV¨übÀs
() {

246 (
$this
->
_¨GëV¨übÀs
);

247 
	}
}

259 
fun˘i⁄
 
	$AddC⁄°øöt
(
$°rP¨amëî
, 
$ötMëhod
, 
$objC⁄°øöt
) {

260 
$√wHash
["PARAMETER"] = 
$°rP¨amëî
;

261 
$√wHash
["METHOD"] = 
$ötMëhod
;

262 
$√wHash
["CONSTRAINT"] = 
$objC⁄°øöt
;

263 
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
[] = 
$√wHash
;

264 
	}
}

274 
fun˘i⁄
 
	$vÆ‹_∑ømëro
(
$∑ømëro
) {

276 i‡(
	`is£t
(
$this
->
_¨CookõV¨s
[
$∑ømëro
])) {

277  
$this
->
_¨CookõV¨s
[
$∑ømëro
];

278 } 
	`ñ£if
 (
	`is£t
(
$this
->
_¨GëV¨s
[
$∑ømëro
])) {

279  
$this
->
_¨GëV¨s
[
$∑ømëro
];

280 } 
	`ñ£if
 (
	`is£t
(
$this
->
_¨Po°V¨s
[
$∑ømëro
])) {

281  
$this
->
_¨Po°V¨s
[
$∑ømëro
];

283  
FALSE
;

285 
	}
}

295 
fun˘i⁄
 
	$Te°C⁄°øöts
() {

297 
$this
->
_blHasRunC⁄°øötTe°s
 = 
åue
;

298 
$™yFaû
 = 
Ál£
;

300 
$i
=0; $i<=(
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
) -1; $i++) {

302 
$°rThisP¨amëî
 =

303 
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
[
$i
] ["PARAMETER"];

304 
$ötThisMëhod
 = 
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
[
$i
]["METHOD"];

305 
$objThisC⁄°øöt
 =

306 
$this
->
_¨ObjP¨amëîMëhodC⁄°øötHash
[
$i
] ["CONSTRAINT"];

307 
$v¨A˘uÆVÆue
 = "";

308 i‡(
$ötThisMëhod
 =
ENTRADAS_COOKIE
) {

309 
$v¨A˘uÆVÆue
 = 
$this
->
_¨CookõV¨s
[
$°rThisP¨amëî
];

311 i‡(
$ötThisMëhod
 =
ENTRADAS_GET
) {

312 
$v¨A˘uÆVÆue
 = 
$this
->
_¨GëV¨s
[
$°rThisP¨amëî
];

314 i‡(
$ötThisMëhod
 =
ENTRADAS_POST
) {

315 
$v¨A˘uÆVÆue
 = 
$this
->
_¨Po°V¨s
[
$°rThisP¨amëî
];

317 
$ötC⁄°øötTy≥
 = 
$objThisC⁄°øöt
->
	`GëC⁄°øötTy≥
();

318 
$°rC⁄°øötO≥ønd
 = 
$objThisC⁄°øöt
->
	`GëC⁄°øötO≥ønd
();

319 
$thisFaû
 = 
Ál£
;

320 
$objFaûuªObje˘
 = 
√w
 
	`Re°ricci⁄esFÆlidas
(
$°rThisP¨amëî
,

321 
$ötThisMëhod
, 
$objThisC⁄°øöt
);

323 
$ötC⁄°øötTy≥
) {

325 
RT_MAIL
:

326 if(! 
	`îegi
("^([_a-z0-9-]+)(\.[_a-z0-9-]+)*@([a-z0-9-]+)(\.[a-z0-9-]+)*(\.[a-z]{2,4})$", (
°rög
)
$v¨A˘uÆVÆue
)) {

327 
$thisFaû
 = 
åue
;

328 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'ElÉmailÇoÖarece valido');

332 
RT_LONG_MIN
:

333 i‡(
	`°æí
((
°rög
)
$v¨A˘uÆVÆue
Ë< (
öãgî
Ë
$°rC⁄°øötO≥ønd
) {

334 
$thisFaû
 = 
åue
;

335 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' suÜ⁄gôudÉ†mí‹á '.
$°rC⁄°øötO≥ønd
);

339 
RT_LONG_MAX
:

340 i‡(
	`°æí
((
°rög
)
$v¨A˘uÆVÆue
Ë> (
öãgî
Ë
$°rC⁄°øötO≥ønd
) {

341 
$thisFaû
 = 
åue
;

342 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' suÜ⁄gôudÉ†may‹á '.
$°rC⁄°øötO≥ønd
);

346 
RT_CARACTERES_PERMITIDOS
:

347 
$j
=0; $j<=
	`°æí
(
$v¨A˘uÆVÆue
)-1; $j++) {

348 
$thisCh¨
 = 
	`sub°r
(
$v¨A˘uÆVÆue
, 
$j
, 1);

349 i‡(
	`°Ωos
(
$°rC⁄°øötO≥ønd
, 
$thisCh¨
Ë==
Ál£
) {

350 
$thisFaû
 = 
åue
;

351 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' con caracteresÇoÖermitidos');

356 
RT_CARACTERES_NO_PERMITIDOS
:

357 
$j
=0; $j<=
	`°æí
(
$v¨A˘uÆVÆue
)-1; $j++) {

358 
$thisCh¨
 = 
	`sub°r
(
$v¨A˘uÆVÆue
, 
$j
, 1);

359 i‡(!(
	`°Ωos
(
$°rC⁄°øötO≥ønd
, 
$thisCh¨
Ë==
Ál£
)) {

360 
$thisFaû
 = 
åue
;

361 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' con caracteresÇoÖermitidos');

366 
RT_MENOR_QUE
:

367 i‡(
$v¨A˘uÆVÆue
 >
$°rC⁄°øötO≥ønd
) {

368 
$thisFaû
 = 
åue
;

369 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' mí‹á '.
$°rC⁄°øötO≥ønd
);

373 
RT_MAYOR_QUE
:

374 i‡(
$v¨A˘uÆVÆue
 <
$°rC⁄°øötO≥ønd
) {

375 
$thisFaû
 = 
åue
;

376 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' may‹á '.
$°rC⁄°øötO≥ønd
);

380 
RT_IGUAL_QUE
:

381 i‡(
$v¨A˘uÆVÆue
 !
$°rC⁄°øötO≥ønd
) {

382 
$thisFaû
 = 
åue
;

383 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' iguÆ quê'.
$°rC⁄°øötO≥ønd
);

387 
RT_NO_IGUAL
:

388 i‡(
$v¨A˘uÆVÆue
 =
$°rC⁄°øötO≥ønd
) {

389 
$thisFaû
 = 
åue
;

390 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.'Çÿe†iguÆá '.
$°rC⁄°øötO≥ønd
);

394 
RT_PASA_EXPRESION_REGULAR
:

395 i‡(!(
	`¥eg_m©ch
(
$°rC⁄°øötO≥ønd
, 
$v¨A˘uÆVÆue
))) {

396 
$thisFaû
 = 
åue
;

397 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.'ÖaßÉx∞'.
$°rC⁄°øötO≥ønd
);

401 
RT_NO_PASA_EXPRESION_REGULAR
:

402 i‡(
	`¥eg_m©ch
(
$°rC⁄°øötO≥ønd
, 
$v¨A˘uÆVÆue
)) {

403 
$thisFaû
 = 
åue
;

404 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.'Çÿ∑ßÉxp'.
$°rC⁄°øötO≥ønd
);

408 
RT_NO_ES_NUMERO
:

409 i‡–! 
	`is_numîic
(
$v¨A˘uÆVÆue
) ) {

410 
$thisFaû
 = 
åue
;

411 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' mí‹á '.
$°rC⁄°øötO≥ønd
);

415 
RT_REQUERIDO
:

416 i‡–! 
	`is£t
(
$v¨A˘uÆVÆue
Ë|| 
	`em±y
($varActualValue) ) {

417 
$thisFaû
 = 
åue
;

418 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.'É†ªquîidÿ'.
$°rC⁄°øötO≥ønd
);

422 
RT_PASSWORD
:

423 i‡–! 
	`is£t
(
$_REQUEST
['verificacion']) ) {

424 
$thisFaû
 = 
åue
;

425 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'SeÇecesita un campo "verificacion"ÖaraÖoder verificarÜa contrase√±a ','ERROR');

427 i‡–
$v¨A˘uÆVÆue
 !
$_REQUEST
['verificacion'] ) {

428 
$thisFaû
 = 
åue
;

429 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$°rThisP¨amëî
.' c⁄åa£√±®di„ª¡ê®vîifiˇci√≥¿'.
$°rC⁄°øötO≥ønd
);

430 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$v¨A˘uÆVÆue
.' !'.
$_REQUEST
['verificacion'],'ADMIN');

436 i‡(
$thisFaû
) {

437 
$™yFaû
 = 
åue
;

438 
$this
->
_¨ObjC⁄°øötFaûuª
[] = 
$objFaûuªObje˘
;

443 i‡(
$™yFaû
) {

445 i‡(
$this
->
_blRedúe˘OnC⁄°øötFaûuª
) {

447 
$èrgëURL
 = 
$_SERVER
["REDIRECT_URL"];

448 i‡(!
$èrgëURL
) {

449 
$èrgëURL
 = 
$this
->
_°rC⁄°øötFaûuªDeÁu…Redúe˘T¨gëURL
;

451 i‡(
$this
->
_°rC⁄°øötFaûuªRedúe˘T¨gëURL
) {

452 
$èrgëURL
 = 
$this
->
_°rC⁄°øötFaûuªRedúe˘T¨gëURL
;

454 i‡(
$èrgëURL
) {

455 
$objToSîülize
 = 
$this
;

456 
$°rSîüliz©i⁄
 = 
	`£rülize
(
$objToSîülize
);

458 
$_SESSION
['RESPUESTA_ERRONEA'] = 
$°rSîüliz©i⁄
;

459 
	`hódî
("Location: $targetURL");

460 
	`exô
(0);

464 (!(
$™yFaû
));

466 
	}
}

476 
fun˘i⁄
 
	$GëC⁄°øötFaûuªs
() {

477 i‡(!
$this
->
_blHasRunC⁄°øötTe°s
) {

478 
$this
->
	`Te°C⁄°øöts
();

480 (
$this
->
_¨ObjC⁄°øötFaûuª
);

481 
	}
}

	@gcm/lib/int/solicitud/lib/constantes.php

1 <?
php


18 
deföe
('ENTRADAS_COOKIE',1);

19 
deföe
('ENTRADAS_GET',2);

20 
deföe
('ENTRADAS_POST',4);

24 
deföe
('RT_LONG_MIN',1);

25 
deföe
('RT_LONG_MAX',2);

26 
deföe
('RT_CARACTERES_PERMITIDOS',3);

27 
deföe
('RT_CARACTERES_NO_PERMITIDOS',4);

28 
deföe
('RT_MENOR_QUE',5);

29 
deföe
('RT_MAYOR_QUE',6);

30 
deföe
('RT_IGUAL_QUE',7);

31 
deföe
('RT_NO_IGUAL',8);

32 
deföe
('RT_PASA_EXPRESION_REGULAR',9);

33 
deföe
('RT_NO_PASA_EXPRESION_REGULAR',10);

34 
deföe
('RT_NO_ES_NUMERO',11);

35 
deföe
('RT_REQUERIDO',12);

36 
deföe
('RT_MAIL',13);

37 
deföe
('RT_PASSWORD',14);

	@gcm/lib/int/temas/lib/TemaGcm.php

1 <?
php


22 ˛as†
	cTemaGcm
 {

26 
public
 
	m$fichîos
;

30 
public
 
	m$cﬁ‹es
;

34 
¥Ÿe˘ed
 
	m$cﬁ‹es_Á…™ãs
 = 
NULL
 ;

44 
public
 
fun˘i⁄
 
	$__c⁄°ru˘
(
$fichîos
, 
$cﬁ‹es
) {

46 
$this
->
fichîos
 = 
$fichîos
;

47 
$this
->
cﬁ‹es
 = 
$cﬁ‹es
;

63 
public
 
fun˘i⁄
 
	$ö˛uú_javas¸ùt
(
$fichîos
=
NULL
,
$libªrüs
=NULL,
$uæ_ba£
) {

65 
$fichîos
 = ( $fichîo†Ë? $fichîo†: 
$this
->
fichîos
[
js
];

67 
$li°a
 = ( !
	`em±y
(
$fichîos
ËË? 
	`im∂ode
(',',$fichîosË: 
NULL
 ;

69 i‡–
$libªrüs
 && !
	`em±y
($librerias) ) {

70 
	`f‹óch
 ( 
$libªrüs
 
as
 
$ôems
 ) {

71 
	`li°
(
$modulo
,
$nombª
Ë
	`ex∂ode
(':',
$ôems
);

72 
$f
 = 
$this
->
	`ruè
(
	`°πﬁowî
(
$modulo
),'libjs',
$nombª
);

73 
echo
 "\n".'<s¸ùà§c="'.
$uæ_ba£
.
$f
.'"Åype="text/javascript"></script>';

78 i‡–
$li°a
 ) 
echo
 "\n".'<script src="proyecto.js?arch='.$lista.'"Åype="text/javascript"></script>';

80 i‡–! 
$li°a
 ) 
echo
 "\n<!-- sin javascriptÖaraá√±adir -->";

82 
	}
}

94 
fun˘i⁄
 
	$cﬁ‹
(
$cﬁ‹
, 
$vÆ‹
 = 
FALSE
) {

96 i‡–
	`is£t
(
$this
->
cﬁ‹es
[
$cﬁ‹
]) ) {

97  
$this
->
cﬁ‹es
[
$cﬁ‹
];

100 i‡–
$vÆ‹
 ) {

101 
$this
->
cﬁ‹es
[
$cﬁ‹
] = 
$vÆ‹
;

102 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Cﬁ‹Öªdeföidÿ('.
$cﬁ‹
.'): '.
$vÆ‹
,'DEBUG');

103  
$vÆ‹
;

106 
$this
->
cﬁ‹es_Á…™ãs
[
$cﬁ‹
] = 
NULL
;

107 
$this
->
cﬁ‹es
[
$cﬁ‹
] = 'red';

108 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$cﬁ‹
.') ColorÇo definido','ADMIN');

112 
	}
}

129 
fun˘i⁄
 
	$c⁄°ruú_css
() {

131 
globÆ
 
$gcm
;

133 
echo
 "/* Archivÿgíîadÿp‹ ".
__CLASS__
." */\n\n";

137 
$fich_v¨übÀs
 = 
	`dú«me
(
$this
->
fichîos
['css']['temas/css/body.css']).'/../../../variables.php';

139 i‡–
	`fûe_exi°s
–
$fich_v¨übÀs
 ) ) 
	`ö˛ude
 ($fich_variables);

144 i‡–
	`is£t
(
$_GET
['css']Ë&& !
	`em±y
 ($_GET['css']) ) {

146 
$css
 = 
$_GET
['css'];

148 
echo
 "\n/* body */\n";

149 
	`ö˛ude
(
$this
->
fichîos
['css']['temas/css/body.css']);

150 
echo
 "\n/* cs†e•ecifico: " . 
$css
 . " */\n\n";

151 
$ö˛uú
 = 
$this
->
fichîos
['css'][
$css
];

152 i‡–
$ö˛uú
 ) {

153 
	`ö˛ude
(
$ö˛uú
);

156 
	`åiggî_îr‹
('Archivÿcs†nÿíc⁄åado: ['.
$_GET
['css'].']',
E_USER_ERROR
);

158 
echo
 "\n";

162 
echo
 "\n/* fichero:temas/css/body.css: */\n";

163 
	`ö˛ude
(
$this
->
fichîos
['css']['temas/css/body.css']);

164 
echo
 "\n/*ácaba:temas/css/body.css: */\n";

166 
	`f‹óch
 ( 
$this
->
fichîos
['css'] 
as
 
$Œave
 => 
$fichîo
) {

168 i‡–
$Œave
 != 'temas/css/body.css' ) {

169 
echo
 "\n/* fichîo:".
$Œave
.": */\n";

170 
	`ö˛ude
(
$fichîo
);

171 
echo
 "\n/*áˇba:".
$Œave
.": */\n";

178 
$SALIDA
 = 
	`ob_gë_c⁄ã¡s
();

179 
	`ob_íd_˛ón
();

181 i‡–
GCM_DEBUG
 ) {

182  
$SALIDA
;

184  
	`möimiz¨_css
(
$SALIDA
);

187 
	}
}

200 
fun˘i⁄
 
	$c⁄°ruú_js
() {

202 
globÆ
 
$gcm
;

206 
$fichîos
 = 
$gcm
->
	`li°a_js
();

207 
$uæ_ba£
 = 
Rouãr
::
$dú
;

209 
$fichîos
 = ( $fichîo†Ë? $fichîo†: 
$this
->
fichîos
[
js
];

211 
$li°a
 = ( !
	`em±y
(
$fichîos
ËË? 
	`im∂ode
(',',$fichîosË: 
NULL
 ;

213 i‡–!
	`is£t
(
$_GET
['arch']) ) {

214 
echo
 "\n /**********************************************/";

215 
echo
 "\n /* ERROR: No seÉspecificoárchivosá incluir */";

216 
echo
 "\n /**********************************************/";

217 
	`exô
();

220 i‡–
GCM_DEBUG
 ) 
echo
 "\n/* Fichîo†javas¸ùà®ö˛uú\n".
	`dïuør
(
$_GET
['arch'])."\n*/\n";

233 
$SALIDA
='';

236 
$fichîos_js
 = 
	`ex∂ode
(',',
$_GET
['arch']);

238 
echo
 "\n\n/* Archivo javascript deÖroyecto */\n\n";

242 
echo
 "/* Fichîos: ".
	`dïuør
(
$fichîos_js
)."*/";

244 i‡–
$fichîos_js
 ) {

246 
	`f‹óch
 ( 
$fichîos_js
 
as
 
$ôems
 ) {

248 i‡–
	`em±y
(
$ôems
) ) ;

249 
	`li°
(
$modulo
,
$nombª
Ë
	`ex∂ode
(':',
$ôems
);

250 
echo
 "\n/* $modulo: $nombre */\n\n";

251 
$f
 = 
$this
->
	`ruè
(
	`°πﬁowî
(
$modulo
),'js',
$nombª
);

252 
	`ö˛ude
 (
$f
);

253 
echo
 "\n";

258 
$SALIDA
 = 
	`ob_gë_c⁄ã¡s
();

259 
	`ob_íd_˛ón
();

261  
$SALIDA
;

263 
	}
}

273 
fun˘i⁄
 
	$ruè
(
$modulo
, 
$tùo
, 
$fichîo
) {

275 
$ruè
 = 
$modulo
.'/'.
$tùo
.'/'.
$fichîo
;

276 
$fichîo_ãma
 = ( 
	`is£t
(
$this
->
fichîos
[
$tùo
][
$ruè
]ËË? $this->fichîos[$tùo][$ruè] : 
FALSE
;

278 i‡–
$fichîo_ãma
 ) {

279  
$fichîo_ãma
;

282 
$ruè
 = 'ãmas/'.
$tùo
.'/'.
$fichîo
;

283 
$fichîo_ãma
 = ( 
	`is£t
(
$this
->
fichîos
[
$tùo
][
$ruè
]ËË? $this->fichîos[$tùo][$ruè] : 
FALSE
;

285 i‡–
$fichîo_ãma
 ) {

286  
$fichîo_ãma
;

288 
$msg
 = 'Fichîÿdñ m√≥dulÿ['.
$modulo
.']Åùÿ['.
$tùo
.'] fichîÿ['.
$fichîo
.']Ñuè ['.
$ruè
.']ÇoÉncontrado';

289 
	`åiggî_îr‹
(
$msg
,
E_USER_ERROR
);

293  
FALSE
;

294 
	}
}

304 
public
 
fun˘i⁄
 
	$devﬁvî_cﬁ‹es_Á…™ãs
() {

305  ( 
$this
->
cﬁ‹es_Á…™ãs
 ) ? $this->cﬁ‹es_Á…™ã†: 
FALSE
 ;

306 
	}
}

317 
fun˘i⁄
 
	$ic⁄o
(
$nombª
) {

319 i‡–
	`em±y
(
$nombª
ËË 
FALSE
;

321 
globÆ
 
$gcm
;

323 
$tùo_ic⁄os
 = 
	`¨øy
('.gif','.png');

325 
	`f‹óch
 ( 
$tùo_ic⁄os
 
as
 
$tùo_ic⁄o
 ) {

327 
$ic⁄o
 = 
$nombª
.
$tùo_ic⁄o
;

329 i‡–
	`is£t
(
$this
->
fichîos
['ic⁄os']['ãmas/ic⁄os/'.
$ic⁄o
]) ) {

331 
$ruè
 = 
$this
->
fichîos
['ic⁄os']['ãmas/ic⁄os/'.
$ic⁄o
];

333 i‡–
	`is_fûe
(
$ruè
) ) {

334  
Rouãr
::
$dú
.
$ruè
;

336  
FALSE
;

342  
FALSE
;

344 
	}
}

	@gcm/lib/int/temas/lib/TemaGcmTest.php

1 <?
php


2 
	gªquúe_⁄˚
 'PHPUnit/Framework.php';

4 
	gªquúe_⁄˚
 '/home/eduardo/SERVIDOR/subversion/gcm/trunk/gcm/modulos/temas/lib/TemaGcm.php';

10 ˛as†
	cTemaGcmTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£


15 
¥Ÿe˘ed
 
	m$obje˘
;

21 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£tUp
()

23 
$this
->
obje˘
 = 
√w
 
TemaGcm
;

30 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ã¨Down
()

32 
	}
}

37 
public
 
fun˘i⁄
 
	$ã°_c⁄°ru˘
()

40 
$this
->
	`m¨kTe°Incom∂ëe
(

43 
	}
}

48 
public
 
fun˘i⁄
 
	$ã°In˛uú_javas¸ùt
()

51 
$this
->
	`m¨kTe°Incom∂ëe
(

54 
	}
}

59 
public
 
fun˘i⁄
 
	$ã°Cﬁ‹
()

62 
$this
->
	`m¨kTe°Incom∂ëe
(

65 
	}
}

70 
public
 
fun˘i⁄
 
	$ã°C⁄°ruú_css
()

73 
$this
->
	`m¨kTe°Incom∂ëe
(

76 
	}
}

81 
public
 
fun˘i⁄
 
	$ã°C⁄°ruú_js
()

84 
$this
->
	`m¨kTe°Incom∂ëe
(

87 
	}
}

92 
public
 
fun˘i⁄
 
	$ã°Ruè
()

95 
$this
->
	`m¨kTe°Incom∂ëe
(

98 
	}
}

103 
public
 
fun˘i⁄
 
	$ã°Devﬁvî_cﬁ‹es_Á…™ãs
()

106 
$this
->
	`m¨kTe°Incom∂ëe
(

109 
	}
}

	@gcm/modulos/admin/config/config.php

1 <?
php


3 
	g$c⁄fig
['Proyecto']='gcm';

4 
	g$c⁄fig
['bd_conexion']='sqlite:DATOS/proyecto.db';

5 
	g$c⁄fig
['bd_usuario'] = '';

6 
	g$c⁄fig
['bd_pass']='';

7 
	g$c⁄fig
['SufijoÖara base de datos']='';

8 
	g$c⁄fig
['IdiomaÖor defecto']='es';

9 
	g$c⁄fig
['Palabra secretaÖara depurar']='debug';

10 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'cache_http';

11 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'comentarios';

12 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'descargables';

13 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'indexador';

14 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'referencias';

15 
	g$c⁄fig
['M√≥dulosáctivados'][] = 'widgets';

17 
	g$c⁄fig
['bd_conexion']='sqlite:DATOS/proyecto.db';

18 
	g$c⁄fig
['bd_usuario'] = '';

19 
	g$c⁄fig
['bd_pass']='';

20 
	g$c⁄fig
['SufijoÖara base de datos']='';

	@gcm/modulos/admin/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['Proyecto']='Dominio delÖroyecto';

3 
	g$c⁄fig_DESC
['M√≥dulosáctivados']='Desactivaci√≥n de m√≥dulos';

4 
	g$c⁄fig_DESC
['Palabra secretaÖara depurar']='A√±adiendoÜaÖalabra seleccionadaáÜa url (?<palabra_secreta>=1), se inicia sesi√≥n de depuraci√≥n, con un cero seÅermina';

6 
	g$c⁄fig_DESC
['bd_conexion'] = 'Producci√≥n: Driverá usarÖara conexi√≥n con base de datos (PDO). Ejemplos sqlite:/DATOS/proyecto.db o mysql:dbname=gcm';

7 
	g$c⁄fig_DESC
['bd_usuario']='Producci√≥n: UsuarioÖaraÉl servidor de base de datos,Én caso de utilizar sqliteÇoÉsÇecesario';

8 
	g$c⁄fig_DESC
['bd_pass']='Producci√≥n: Contrase√±aÖara servidor de base de datos,Én caso de sqliteÇoÉsÇecesario';

9 
	g$c⁄fig_DESC
['SufijoÖara base de datos']='Producci√≥n: NosÖermite diferenciarÜasÅablas deÜos diferentesÖroyectosÉn una misma base de datos';

	@gcm/modulos/admin/eventos_admin.php

1 <?
php


8 
	g$evítos
['menuadmin']['presentar_menu_administrativo'][1]='';

9 
	g$evítos
['infoserver']['infoserver'][1]='';

10 
	g$evítos
['test']['ejecutar_tests_modulos'][1]='';

14 
	g$evítos
['precarga']['activar_tema_admin'][1]='';

18 i‡–! 
	g$gcm
->
c⁄fig
('admin','configuracion_confirmada') ) {

20 
	g$evítos
['precontenido']['confirmar_configuracion'][1]='';

28 
	g$acci⁄es
['admin']['presentar_menu_administrativo'][] = 'usuario';

29 
	g$acci⁄es
['admin']['ejecutar_tests_modulos'][] = 'usuario';

30 
	g$acci⁄es
['admin']['perfil_usuario'][] = 'usuario';

	@gcm/modulos/admin/eventos_usuario.php

1 <?
php


3 
	g$evítos
['menuadmin']['menuadmin_sin_login'][1]='';

4 
	g$evítos
['columna']['panel_login'][10]='';

5 
	g$evítos
['registro']['formulario_registro'][10]='';

	@gcm/modulos/admin/lib/Admin.php

1 <?
php


25 ˛as†
	cAdmö
 
exãnds
 
	mModulos
 {

27 
fun˘i⁄
 
	$__c⁄°ru˘
() {

29 
globÆ
 
$gcm
;

31 
∑ª¡
::
	`__c⁄°ru˘
();

62 
fun˘i⁄
 
	$vÆid¨_d©os
(
$aD©os
) {

64 
globÆ
 
$gcm
;

66 
$vÆe
 = 
TRUE
;

68 i‡–
	`is£t
(
$aD©os
['usu¨io']Ë&& 
	`°rùos
($aDatos['usuario'],'javascript') ) {

69 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('EsteÇombre de usuarioÇoÉsÖermitido'),'ERROR');

70 
$vÆe
 = 
NULL
;

73 i‡–
	`is£t
(
$aD©os
['usu¨io']Ë&& 
	`°rùos
($aD©os['usu¨io'],'<?'Ë!=
FALSE
 ) {

74 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('EsteÇombre de usuarioÇoÉsÖermitido'),'ERROR');

75 
$vÆe
 = 
NULL
;

78 i‡–
	`is£t
(
$aD©os
['pass']) && $aDatos['pass'] != $aDatos['pass2'] ) {

79 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('No coincidenÜas contrase√±as'),'ERROR');

80 
$vÆe
 = 
NULL
;

83 i‡–
$vÆe
 ) {

85  
$aD©os
;

89  
FALSE
;

93 
	}
}

99 
fun˘i⁄
 
	$ˇmbio_∑ssw‹d
(
$usu¨io_id
=
FALSE
) {

101 
globÆ
 
$gcm
;

104 i‡–! 
	`≥rmiso
() ) {

105 
$usu¨io_id
 = 
$gcm
->
au
->
	`logódo
();

108 i‡–! 
$usu¨io_id
 )  ;

111 <
f‹m
 
a˘i⁄
="<?=$_SERVER['PHP_SELF'];?>" 
mëhod
="post">

112 <?
php
 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('admin','html','form_cambio_pass.html')); ?>

113 <
öput
 
ty≥
="hiddí" 
«me
="a" 
vÆue
="ejecutar_cambio_password" />

114 <
öput
 
ty≥
="hiddí" 
«me
="m" 
vÆue
="admin" />

115 <
öput
 
ty≥
="hiddí" 
«me
="id" 
vÆue
="<?phpÉcho $usuario_id; ?>" />

116 </
f‹m
>

117 <?
php


119 
	}
}

125 
fun˘i⁄
 
	$ejecuèr_ˇmbio_∑ssw‹d
() {

127 
globÆ
 
$gcm
;

129 
$usu¨io_id
 = 
	`is_numîic
(
$_POST
['id'] );

132 i‡–! 
	`≥rmiso
(Ë&& 
$usu¨io_id
 !
$gcm
->
au
->
	`logódo
())  ;

134 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

136 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

137 
$gcm
->
evít
->
	`unico
('titulo','admin');

138 
$gcm
->
tôulo
 = 
	`lôîÆ
('Cambio de contrase√±a');

140 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(), 
$usu¨io_id
);

142 
$ªsu…ado
 = 
$this
->
	`vÆid¨_d©os
(
$_POST
);

144 i‡–! 
$ªsu…ado
 ) {

145 
$this
->
	`ˇmbio_∑ssw‹d
();

146  
FALSE
;

149 
$usu¨io
->
	`£tPass_md5
(
	`md5
(
$ªsu…ado
['pass']));

150 
$usu¨io
->
	`ßve
();

152 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Usuario modificado'),'AVISO');

154 
$this
->
	`≥rfû_usu¨io
(
NULL
);

156 
	}
}

162 
fun˘i⁄
 
	$ge°i⁄¨_usu¨io
(
$usu¨io_id
) {

164 
globÆ
 
$gcm
;

167 i‡–! 
	`≥rmiso
(Ë&& 
$usu¨io_id
 !
$gcm
->
au
->
	`logódo
())  ;

170 
$¥e£¡¨_f‹m
 = 
TRUE
;

171 
$™yadú_usu¨io
 = 
FALSE
;

173 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

175 i‡–
	`is£t
(
$_POST
['modificar'] ) ) {

177 
åy
 {

179 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(), 
$usu¨io_id
);

181 
$ªsu…ado
 = 
$this
->
	`vÆid¨_d©os
(
$_POST
);

183 i‡–
$ªsu…ado
 ) {

185 
$usu¨io
->
	`£tUsu¨io
(
$ªsu…ado
['usuario']);

186 
$usu¨io
->
	`£tNombª
(
$ªsu…ado
['nombre']);

187 
$usu¨io
->
	`£tA≥Œidos
(
$ªsu…ado
['apellidos']);

188 
$usu¨io
->
	`£tMaû
(
$ªsu…ado
['mail']);

189 
$usu¨io
->
	`£tTñef⁄o
(
$ªsu…ado
['telefono']);

190 
$usu¨io
->
	`£tFecha_modifiˇci⁄
(
	`d©e
('Y-m-d H:i'));

191 
$usu¨io
->
	`ßve
();

193 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Usuario modificado'),'AVISO');

197 
$ªsu…ado
 = 
$_POST
;

201 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
 ) {

203 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),$ex->
	`gëMesßge
(),'AVISO');

208 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['borrar'] ) ) {

210 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(), 
$_POST
['id']);

212 
$usu¨io
->
	`M¨kF‹Dñëi⁄
();

213 
$¥e£¡¨_f‹m
 = 
FALSE
;

214 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Usuario borrado'),'AVISO');

216 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['anyadir'] ) ) {

218 
$™yadú_usu¨io
 = 
TRUE
;

220 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['insertar'] ) ) {

222 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
());

224 
$ªsu…ado
 = 
$this
->
	`vÆid¨_d©os
(
$_POST
);

226 i‡–
$ªsu…ado
 ) {

228 
$usu¨io
->
	`£tUsu¨io
(
$ªsu…ado
['usuario']);

229 
$usu¨io
->
	`£tPass_md5
(
	`md5
(
$ªsu…ado
['pass']));

230 
$usu¨io
->
	`£tNombª
(
$ªsu…ado
['nombre']);

231 
$usu¨io
->
	`£tA≥Œidos
(
$ªsu…ado
['apellidos']);

232 
$usu¨io
->
	`£tMaû
(
$ªsu…ado
['mail']);

233 
$usu¨io
->
	`£tTñef⁄o
(
$ªsu…ado
['telefono']);

234 
$usu¨io
->
	`ßve
();

235 
$ªsu…ado
['id'] = 
$usu¨io
->
	`u…imo_idítifiˇd‹
();

237 
$gcm
->
au
->
	`ö£π¨_rﬁ_usu¨io
(
$ªsu…ado
['id'],2);

239 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Usuario insertado'),'AVISO');

243 
$ªsu…ado
 = 
$_POST
;

250 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(), 
$usu¨io_id
);

252 
$ªsu…ado
['id'] = 
$usu¨io
->
	`gëID
();

253 
$ªsu…ado
['usu¨io'] = 
$usu¨io
->
	`gëUsu¨io
();

254 
$ªsu…ado
['nombª'] = 
$usu¨io
->
	`gëNombª
();

255 
$ªsu…ado
['≠ñlidos'] = 
$usu¨io
->
	`gëA≥Œidos
();

256 
$ªsu…ado
['maû'] = 
$usu¨io
->
	`gëMaû
();

257 
$ªsu…ado
['ãÀf⁄o'] = 
$usu¨io
->
	`gëTñef⁄o
();

262 <
•™
 
˛ass
="caja">

263 <
f‹m
 
a˘i⁄
="<?=$_SERVER['PHP_SELF'];?>" 
mëhod
="post">

264 <?
php
 i‡–
$¥e£¡¨_f‹m
 ) 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../html/form_perfil.html'); ?>

265 <
br
 />

266 <
öput
 
ty≥
="hiddí" 
«me
="id" 
vÆue
="<?=$resultado['id']?>" />

267 <
öput
 
ty≥
="hiddí" 
«me
="m" 
vÆue
="admin" />

268 <
öput
 
ty≥
="hiddí" 
«me
="a" 
vÆue
="usuarios" />

269 <?
php
 i‡–
	`is£t
(
$ªsu…ado
['id']) ) { ?>

270 <
öput
 
ty≥
='submô' 
«me
='modifiˇr' 
vÆue
='<?=literal("Modificar")?>' />

271 <
öput
 
ty≥
='submô' 
«me
='b‹ør' 
vÆue
='<?=literal("Borrar")?>' />

272 <?
php
 } ?>

273 <?
php
 i‡–
$™yadú_usu¨io
 ) { ?>

274 <
öput
 
ty≥
='submô' 
«me
='ö£π¨' 
vÆue
='<?=literal("A√±adir")?>' />

275 <?
php
 } { ?>

276 <
öput
 
ty≥
='submô' 
«me
='™yadú' 
vÆue
='<?=literal("A√±adir")?>' />

277 <?
php
 } ?>

278 <
br
 /><br />

279 </
f‹m
>

280 <
s¸ùt
 
œnguage
='javascript'>

281 
documít
.
	`gëEÀmítById
('usu¨io').
	`focus
();

282 </
s¸ùt
>

283 </
•™
>

284 <?
php


286 
	}
}

315 
fun˘i⁄
 
	$¥e£¡¨_míu_admöi°øtivo
() {

317 
globÆ
 
$gcm
;

319 
$míuAdmö
 = 
	`¨øy
();

323 
$∑th
=
GCM_DIR
."modulos/";

324 
$dúe˘‹io_modulos
=
	`dú
(
$∑th
);

325 
$dúe˘‹io
 = 
$dúe˘‹io_modulos
->
	`ªad
()) {

326 i‡–
$dúe˘‹io
[0] !="." 
AND
 
	`is_dú
(
$∑th
.$directorio) ) {

327 
$fich_föÆ
=
$∑th
.
$dúe˘‹io
.'/menuAdmin.php';

328 i‡(
	`is_fûe
(
$fich_föÆ
)Ë
	`ö˛ude
($fich_final);

332 
$∑th
="modulos/";

333 i‡–
	`fûe_exi°s
(
$∑th
) ) {

334 
$dúe˘‹io_modulos
=
	`dú
(
$∑th
);

335 
$dúe˘‹io
 = 
$dúe˘‹io_modulos
->
	`ªad
()) {

336 i‡–
$dúe˘‹io
[0] !="." 
AND
 
	`is_dú
(
$∑th
.$directorio) ) {

337 
$fich_föÆ
=
$∑th
.
$dúe˘‹io
.'/menuAdmin.php';

338 i‡(
	`is_fûe
(
$fich_föÆ
)Ë
	`ö˛ude
($fich_final);

347 
$¨chivos_c⁄fig
 = 
	`glob
(
GCM_DIR
.'modulos/*/config/config.php');

348 
	`f‹óch
 ( 
$¨chivos_c⁄fig
 
as
 
$¨chivo
 ) {

350 
$¨øy
 = 
	`ex∂ode
('/',
$¨chivo
);

351 
$modulo
 = 
$¨øy
[
	`cou¡
($array)-3];

353 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['activado']= 1;

354 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['title']=literal("Configuraci√≥n de ",3).literal($modulo,3);

355 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['lök']=
Rouãr
::
$ba£
.$modulo."/configuracion";

362 
$¨chivos_c⁄fig
 = 
	`glob
('modulos/*/config/config.php');

364 i‡–! 
	`em±y
(
$¨chivos_c⁄fig
) ) {

365 
	`f‹óch
 ( 
$¨chivos_c⁄fig
 
as
 
$¨chivo
 ) {

367 
$¨øy
 = 
	`ex∂ode
('/',
$¨chivo
);

368 
$modulo
 = 
$¨øy
[
	`cou¡
($array)-3];

370 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['activado']= 1;

371 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['title']=literal("Configuraci√≥n de ",3).literal($modulo,3);

372 
$míuAdmö
[
	`lôîÆ
('M√≥dulos',3)]['bŸ⁄'][lôîÆ(
$modulo
,3)]['link']="?m=".$modulo."&a=configuracion";

379 
	`uas‹t
(
$míuAdmö
, 'ordenar_por_peso');

381 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('admin','html','menuAdmin.html'));

382 
	}
}

388 
fun˘i⁄
 
	$míuadmö_sö_logö
(
$e
, 
$¨gs
=
NULL
) {

390 
	}
}

397 
fun˘i⁄
 
	$∑√l_logö
() {

399 
globÆ
 
$gcm
;

401 i‡(! 
$gcm
->
au
->
	`logódo
() ) {

402 
$∑√l
 = 
	`¨øy
();

403 
$∑√l
['tôulo'] = 
	`lôîÆ
('Administrar');

404 
$∑√l
['ocu…o'] = 
TRUE
;

405 
$∑√l
['contenido'] =

407 <
br
 />'.literal("Usuario",3).':

408 <
br
 /><
öput
 
ty≥
="ãxt" 
size
="10" 
«me
="logöPro" 
id
="logöPro" 
vÆue
="" />

409 <
br
 />'.literal("Contrase√±a",3).':

410 <
br
 /><
öput
 
ty≥
="∑ssw‹d" 
size
="10" 
«me
="∑sswd" 
id
="∑sswd" 
vÆue
="" />

411 <
br
 /><br />

412 <
öput
 
ty≥
="submô" 
vÆue
="Entrar" />

413 </
f‹m
>';

415 
Temas
::
	`∑√l
(
$∑√l
);

418 
	}
}

429 
fun˘i⁄
 
	$f‹muœrio_ªgi°ro
(
$e
, 
$¨gs
=
NULL
) {

431 
globÆ
 
$gcm
;

433 i‡(! 
$gcm
->
au
->
	`logódo
() ) {

435 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

436 
$gcm
->
evít
->
	`unico
('titulo','admin');

437 
$gcm
->
tôulo
 = 
	`lôîÆ
('Formulario deÉntrada');

440 
$f‹muœrio
 = '<formÇame="entrada"áction="" method="post">

441 <
br
 />'.literal("Usuario",3).':

442 <
br
 /><
öput
 
ty≥
="ãxt" 
size
="10" 
«me
="logöPro" 
id
="logöPro" 
vÆue
="" />

443 <
br
 />'.literal("Contrase√±a",3).':

444 <
br
 /><
öput
 
ty≥
="∑ssw‹d" 
size
="10" 
«me
="∑sswd" 
id
="∑sswd" 
vÆue
="" />

445 <
br
 /><br />

446 <
öput
 
ty≥
="submô" 
vÆue
="Entrar" />

447 </
f‹m
>';

449 
echo
 
$f‹muœrio
;

452 
	}
}

465 
fun˘i⁄
 
	$≥rfû_usu¨io
(
$e
, 
$¨gs
=
FALSE
) {

467 
globÆ
 
$gcm
;

469 
$usu¨io_id
 = ( 
$¨gs
 ) ? $¨g†: 
$gcm
->
au
->
	`logódo
();

471 i‡–
$usu¨io_id
 ) {

473 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

474 
$gcm
->
evít
->
	`unico
('titulo','admin');

475 
$gcm
->
tôulo
 = 
	`lôîÆ
('Perfil de usuario');

477 
$this
->
	`ge°i⁄¨_usu¨io
(
$usu¨io_id
);

479 
$this
->
	`ˇmbio_∑ssw‹d
();

483 
	}
}

494 
fun˘i⁄
 
	$c⁄fúm¨_c⁄figuøci⁄
(
$e
, 
$¨gs
) {

496 
globÆ
 
$gcm
;

498 
$usu¨io_id
 = 
$gcm
->
au
->
	`logódo
();

500 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

502 
åy
 {

504 
$usu¨io
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(), 
$usu¨io_id
);

506 i‡–
$usu¨io
->
	`gëUsu¨io
(Ë='admö' && $usu¨io->
	`gëPass_md5
(Ë=
	`md5
('admin') ) {

508 
$aviso
 = 
	`lôîÆ
("EsÇecesario modificarÜos datos deládministradorÖor seguridad");

510 i‡–
	`em±y
(
$_POST
['∑ss_md5']ËË
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$aviso
,'AVISO');

512 
$usu¨ios
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
(),1);

513 
$usu¨ios
->
	`admöi°ør
(
FALSE
,FALSE,FALSE,
TRUE
,'editar');

520 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

522 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),$ex->
	`gëMesßge
());

526 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Sin usuario salimos'),'AVISO');

530 
	}
}

541 
fun˘i⁄
 
	$usu¨ios
(
$e
, 
$¨gs
) {

543 
globÆ
 
$gcm
;

545 i‡–
	`≥rmiso
('administrar','admin') ) {

547 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

548 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

549 
$gcm
->
tôulo
 = 
	`lôîÆ
('Administraci√≥n de usuarios');

551 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

552 
$usu¨ios
 = 
√w
 
	`Usu¨ios
(
$gcm
->
	`pdo_c⁄exi⁄
());

553 
$usu¨ios
->
	`admöi°ør
(
FALSE
,FALSE,FALSE,
TRUE
);

556 i‡–
$usu¨ios
->
	`gëID
() ) {

557 
echo
'<br /><br />';

558 
echo
 '<h3>Roles de usuario</h3>';

559 
$this
->
	`rﬁes_usu¨io
('öã∫o', 
$usu¨ios
->
	`gëID
());

566 
$this
->
	`≥rfû_usu¨io
('interno');

570 
	}
}

576 
fun˘i⁄
 
	$rﬁes_usu¨io
(
$e
, 
$¨gs
=
FALSE
) {

578 
globÆ
 
$gcm
;

580 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

581 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

582 
$gcm
->
tôulo
 = 
	`lôîÆ
('Administraci√≥n deÑoles de usuarios');

584 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

586 
$c⁄dici⁄
 = ( 
$¨gs
 ) ? 'rur.usu¨ios_id = '.$¨g†: 
FALSE
 ;

588 
$rﬁes
 = 
√w
 
	`R_usu¨ios_rﬁes
(
$gcm
->
	`pdo_c⁄exi⁄
());

589 
$rﬁes
->
	`admöi°ør
(
$c⁄dici⁄
,
FALSE
,FALSE,
TRUE
);

590 
	}
}

607 
fun˘i⁄
 
	$öfo£rvî
(
$e
,
$¨gs
) {

609 
globÆ
 
$gcm
;

611 
	`≥rmiso
('admöi°ør',
TRUE
);

613 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

614 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

616 
$gcm
->
tôulo
 = "Informaci√≥n de servidor";

619 <
°yÀ
 
ty≥
="text/css">

621 #phpöfÿ
¥e
 {}

622 #phpöfÿ
a
:
lök
 {}

623 #phpöfÿ
a
:
hovî
 {}

624 #phpöfÿ
èbÀ
 {}

625 #phpöfÿ.
˚¡î
 {}

626 #phpöfÿ.
˚¡î
 
èbÀ
 {}

627 #phpöfÿ.
˚¡î
 
th
 {}

628 #phpöfÿ
td
, 
th
 {}

629 #phpöfÿ
h1
 {}

630 #phpöfÿ
h2
 {}

631 #phpöfÿ.
p
 {}

632 #phpöfÿ.
e
 {}

633 #phpöfÿ.
h
 {}

634 #phpöfÿ.
v
 {}

635 #phpöfÿ.
vr
 {}

636 #phpöfÿ
img
 {}

637 #phpöfÿ
hr
 {}

638 </
°yÀ
>

640 <
div
 
id
="phpinfo">

641 <?
php


643 
	`ob_°¨t
 () ;

644 
	`phpöfo
 () ;

645 
$pöfo
 = 
	`ob_gë_c⁄ã¡s
 () ;

646 
	`ob_íd_˛ón
 () ;

649 
	`echo
 ( 
	`°r_ª∂a˚
 ( "moduÀ_Zíd O±imizî", "moduÀ_Zíd_O±imizî", 
	`¥eg_ª∂a˚
 ( '%^.*<body>(.*)</body>.*$%ms', '$1', 
$pöfo
 ) ) ) ;

652 </
div
>

653 <?
php


654 
	}
}

665 
fun˘i⁄
 
	$ejecuèr_¸⁄_modulos
(
$e
 = 
FALSE
, 
$¨gs
 = FALSE) {

667 
globÆ
 
$gcm
;

669 
$modulos_a˘ivados
 = 
	`¨øy_mîge
(
$gcm
->
modulos_basicos
,$gcm->
	`c⁄fig
('admin','M√≥dulosáctivados'));

673 
echo
 '<tr /><h2>M√≥dulos de gcm</h2>';

675 
	`f‹óch
 ( 
$modulos_a˘ivados
 
as
 
$modulo
 ) {

677 
$dú_modulo
 = 
GCM_DIR
.'modulos/'.
$modulo
;

679 i‡–! 
	`is_dú
(
$dú_modulo
) ) ;

681 
$˛a£
 = 
	`ucfú°
(
$modulo
);

683 
$hay_admö
 = ( 
	`fûe_exi°s
(
$dú_modulo
.'/lib/'.
$˛a£
.'Admö.php'ËË? 
TRUE
 : 
FALSE
 ;

686 i‡–
$hay_admö
 ) {

687 
$˛a£
 = 
	`ucfú°
(
$modulo
).'Admin';

688 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

689 
$ö°™cü
 = 
√w
 
	`$˛a£
();

691 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

692 
$ö°™cü
 = 
√w
 
	`$˛a£
();

695 i‡(
	`mëhod_exi°s
(
$ö°™cü
, 'cron') ) {

696 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

697 
$ö°™cü
->
	`¸⁄
();

698 } 
	`ñ£if
 ( 
GCM_DEBUG
 ) {

699 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

700 
echo
 'Sin m√©todo cron';

706 
echo
 '<tr /><h2>M√≥dulos deÖroyecto</h2>';

708 
	`f‹óch
 ( 
	`glob
('modulos/*'Ë
as
 
$dú_modulo
 ) {

710 i‡–! 
	`is_dú
(
$dú_modulo
) ) ;

712 
$modulo
 = 
	`ba£«me
(
$dú_modulo
);

713 
$˛a£
 = 
	`ucfú°
(
$modulo
);

714 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

715 
$ö°™cü
 = 
√w
 
	`$˛a£
();

716 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

717 i‡(
	`mëhod_exi°s
(
$ö°™cü
, '¸⁄'Ë&& 
$modulo
 != 'admin' ) {

718 
$ö°™cü
->
	`¸⁄
();

720 
echo
 'Sin m√©todo cron';

724 
	}
}

	@gcm/modulos/admin/lib/AdminAdmin.php

1 <?
php


10 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/Admin.php');

18 ˛as†
	cAdmöAdmö
 
exãnds
 
	mAdmö
 {

20 
fun˘i⁄
 
	$__c⁄°ru˘
() {

21 
∑ª¡
::
	`__c⁄°ru˘
();

31 
fun˘i⁄
 
	$a˘iv¨_ãma_admö
(
$e
, 
$¨gs
=
FALSE
) {

33 
globÆ
 
$gcm
;

35 i‡–
Rouãr
::
$m
 && Rouãr::
$a
 == 'configuracion' ) {

37 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'SeleccionamosÅemaÖaraádministraci√≥n');

38 
$gcm
->
ãma
 = 'admin';

42 
	}
}

48 
fun˘i⁄
 
	$ã°
() {

50 
	`≥rmiso
('admöi°ør',
TRUE
);

52 
globÆ
 
$gcm
;

54 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

55 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

57 
$gcm
->
tôulo
 = '<h1>TesteandoÖroyecto</h1>';

60 
$£cci⁄es
 = 
	`glob
(
Rouãr
::
$dd
.'*/*html');

61 i‡–! 
	`is£t
(
$£cci⁄es
[0]) ) {

62 
echo
 '<div class="aviso">Sin una secci√≥nÇoÖodemos comprobar</div>';

65 
$c⁄ãnido
 = 
	`ba£«me
(
$£cci⁄es
[0]);

66 
$£cci⁄
 = 
	`ba£«me
(
	`dú«me
(
$£cci⁄es
[0]));

68 i‡–! 
	`em±y
(
$£cci⁄
) ) {

70 
$uæ
 = 'busˇr/∑œbø_a_busˇr/'.
$£cci⁄
.'/'.
$c⁄ãnido
;

71 
$rouãr
 = 
Rouãr
::
	`desgloßrUæ
(
$uæ
);

73 
echo
 '<b∏/>'.
$uæ
.'<br />';

75 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏uæ',
$rouãr
['uæ'],
$£cci⁄
.'/'.
$c⁄ãnido
);

76 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏s',
$rouãr
['s'],
$£cci⁄
.'/');

77 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏c',
$rouãr
['c'],
$c⁄ãnido
);

78 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏dd',
$rouãr
['dd'],'File/es/');

79 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏d',
$rouãr
['d'],'File/es/');

80 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏ii',
$rouãr
['ii'],'es');

81 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏i',
$rouãr
['i'],'es');

82 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏a',
$rouãr
['a'],
NULL
);

83 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏m',
$rouãr
['m'],
NULL
);

84 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏¨gs',
$rouãr
['¨gs'],
	`¨øy
('palabra_a_buscar'));

85 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏e',
$rouãr
['e'],'buscar');

86 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏íœ˚_ªœtivo', 
$rouãr
['enlace_relativo'],'./');

87 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏mime/ty≥',
$rouãr
['mime_type'],'text/html');

88 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏f‹m©o',
$rouãr
['formato'],'html');

94 
$£cci⁄es
 = 
	`glob
(
Rouãr
::
$dd
.'*.html');

96 i‡–! 
	`is£t
(
$£cci⁄es
[0]) ) {

97 
echo
 '<div class="aviso">Sin un contenido creadoÇoÖodemos comprobar</div>';

100 
$c⁄ãnido
 = 
	`ba£«me
(
$£cci⁄es
[0]);

102 i‡–! 
	`em±y
(
$c⁄ãnido
) ) {

104 
$uæ
 = 'ˇ/ajax/c⁄ãnidos/b‹ør/12/28/'.
$c⁄ãnido
;

105 
$rouãr
 = 
Rouãr
::
	`desgloßrUæ
(
$uæ
);

107 
echo
 '<b∏/>'.
$uæ
.'<br />';

109 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏uæ',
$rouãr
['uæ'],
$c⁄ãnido
);

110 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏s',
$rouãr
['s'],'');

111 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏c',
$rouãr
['c'],
$c⁄ãnido
);

112 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏dd',
$rouãr
['dd'],'File/es/');

113 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏d',
$rouãr
['d'],'File/es/');

114 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏ii',
$rouãr
['ii'],'es');

115 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏i',
$rouãr
['i'],'ca');

116 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏a',
$rouãr
['a'],'borrar');

117 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏m',
$rouãr
['m'],'contenidos');

118 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏¨gs',
$rouãr
['¨gs'],
	`¨øy
('12','28'));

119 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏e',
$rouãr
['e'],
NULL
);

120 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏íœ˚_ªœtivo', 
$rouãr
['enlace_relativo'],'./');

121 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏mime/ty≥',
$rouãr
['mime_type'],'text/html');

122 
$this
->
	`ejecuè_ã°
('Vîfiˇ∏f‹m©o',
$rouãr
['formato'],'ajax');

128 
$uæ
 = 'ca/ajax/buscar/literal/';

129 
$rouãr
 = 
Rouãr
::
	`desgloßrUæ
(
$uæ
);

131 
echo
 '<p>'.
$uæ
.'</p>';

133 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏uæ',
$rouãr
['url'],'');

134 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏s',
$rouãr
['s'],'');

135 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏c',
$rouãr
['c'],'');

136 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏dd',
$rouãr
['dd'],'File/es/');

137 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏d',
$rouãr
['d'],'File/es/');

138 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏ii',
$rouãr
['ii'],'es');

139 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏i',
$rouãr
['i'],'ca');

140 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏a',
$rouãr
['e'],'buscar');

141 
$this
->
	`ejecuè_ã°
('Vîifiˇ∏¨gs',
$rouãr
['¨gs'],
	`¨øy
('literal'));

143 
	}
}

154 
fun˘i⁄
 
	$ejecuèr_ã°s_modulos
(
$e
 = 
FALSE
, 
$¨gs
 = FALSE) {

156 
globÆ
 
$gcm
;

158 
$modulos_a˘ivados
 = 
	`¨øy_mîge
(
$gcm
->
modulos_basicos
,$gcm->
	`c⁄fig
('admin','M√≥dulosáctivados'));

162 
echo
 '<tr /><h2>M√≥dulos de gcm</h2>';

164 
	`f‹óch
 ( 
$modulos_a˘ivados
 
as
 
$modulo
 ) {

166 
$dú_modulo
 = 
GCM_DIR
.'modulos/'.
$modulo
;

168 i‡–! 
	`is_dú
(
$dú_modulo
) ) ;

170 
$˛a£
 = 
	`ucfú°
(
$modulo
);

172 
$hay_admö
 = ( 
	`fûe_exi°s
(
$dú_modulo
.'/lib/'.
$˛a£
.'Admö.php'ËË? 
TRUE
 : 
FALSE
 ;

175 i‡–
$hay_admö
 ) {

176 
$˛a£
 = 
	`ucfú°
(
$modulo
).'Admin';

177 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

178 
$ö°™cü
 = 
√w
 
	`$˛a£
();

180 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

181 
$ö°™cü
 = 
√w
 
	`$˛a£
();

184 i‡(
	`mëhod_exi°s
(
$ö°™cü
, 'test') ) {

185 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

186 
$ö°™cü
->
	`ã°
();

187 } 
	`ñ£if
 ( 
GCM_DEBUG
 ) {

188 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

189 
echo
 'SinÅestsásociados';

195 
echo
 '<tr /><h2>M√≥dulos deÖroyecto</h2>';

197 
	`f‹óch
 ( 
	`glob
('modulos/*'Ë
as
 
$dú_modulo
 ) {

199 i‡–! 
	`is_dú
(
$dú_modulo
) ) ;

201 
$modulo
 = 
	`ba£«me
(
$dú_modulo
);

202 
$˛a£
 = 
	`ucfú°
(
$modulo
);

203 
	`ªquúe_⁄˚
(
$dú_modulo
.'/lib/'.
$˛a£
.'.php');

204 
$ö°™cü
 = 
√w
 
	`$˛a£
();

205 
echo
 '<b∏/><h3>'.
$modulo
.'</h3><br />';

206 i‡(
	`mëhod_exi°s
(
$ö°™cü
, 'ã°'Ë&& 
$modulo
 != 'admin' ) {

207 
$ö°™cü
->
	`ã°
();

209 
echo
 'SinÅestsásociados';

213 
	}
}

219 
fun˘i⁄
 
	$c⁄figuør_c⁄exi⁄es
(
$e
, 
$¨gs
=
NULL
) {

221 
globÆ
 
$gcm
;

223 
	`≥rmiso
('admöi°ør',
TRUE
);

225 
$gcm
->
ãma
 = 'admin';

226 
$gcm
->
∂™tûœ
 = 'administrando.html';

228 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

229 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

231 
$gcm
->
tôulo
 = 'Visualizar conexiones';

233 
$uæ
 = 'hâp://'.
$_SERVER
['HTTP_HOST'].
	`dú«me
($_SERVER['PHP_SELF']).'/?eVisualizar';

235 
echo
 '<p id="ver_plantilla"><a id="boton_ver_plantilla" class="boton" href="?eVisualizar=1" onclick="ver_plantilla();return false;">VerÖlantilla</a></p>';

238 <
s¸ùt
>

239 
fun˘i⁄
 
	`vî_∂™tûœ
() {

241 
v¨
 
c⁄ã√d‹
 = 
	`$
('p#ver_plantilla');

242 
v¨
 
uæ
 = 
	`$
('a#bŸ⁄_vî_∂™tûœ').
	`©å
("href");

243 
c⁄ã√d‹
.
	`html
("Cargando...");

245 
$
.
	`gë
(
uæ
,
	`fun˘i⁄
(
d©a
){

246 
c⁄ã√d‹
.
	`ª∂a˚Wôh
(
d©a
);

248  
Ál£
;

250 </
s¸ùt
>

251 <?
php


253 
	}
}

263 
fun˘i⁄
 
	$edô¨_c⁄exi⁄
(
$e
,
$¨gs
=
NULL
) {

265 
globÆ
 
$gcm
;

267 
$diff_usu¨io
 = 
FALSE
;

268 
$diff_admö
 = 
FALSE
;

270 
$modulo
 = 
$_GET
['md'];

272 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

273 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

275 
$gcm
->
tôulo
 = 'C⁄exi⁄e†dê'.
$modulo
;

277 
$fichîo_usu¨io
 = 'DATOS/evítos/'.
$modulo
.'/eventos_usuario.php';

278 
$fichîo_admö
 = 'DATOS/evítos/'.
$modulo
.'/eventos_admin.php';

280 
$fichîo_usu¨io_modulo
 = 
$gcm
->
evít
->
ubiˇci⁄es
[
$modulo
].'/eventos_usuario.php';

281 
$fichîo_admö_modulo
 = 
$gcm
->
evít
->
ubiˇci⁄es
[
$modulo
].'/eventos_admin.php';

283 
$c⁄ãnido_usu¨io_modulo
 = 
FALSE
;

284 
$c⁄ãnido_admö_modulo
 = 
FALSE
;

286 i‡–
	`fûe_exi°s
(
$fichîo_usu¨io
) ) {

287 
$c⁄ãnido_usu¨io
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_usu¨io
);

288 
$c⁄ãnido_usu¨io_modulo
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_usu¨io_modulo
);

289 i‡–
$c⁄ãnido_usu¨io
 !
$c⁄ãnido_usu¨io_modulo
 ) 
$diff_usu¨io
 = 
TRUE
;

291 
$c⁄ãnido_usu¨io
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_usu¨io_modulo
);

294 i‡–
	`fûe_exi°s
(
$fichîo_admö
) ) {

295 
$c⁄ãnido_admö
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_admö
);

296 
$c⁄ãnido_admö_modulo
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_admö_modulo
);

297 i‡–
$c⁄ãnido_admö
 !
$c⁄ãnido_admö_modulo
Ë
$diff_admö
 = 
TRUE
;

299 i‡–
	`fûe_exi°s
(
$fichîo_admö_modulo
) ) {

300 
$c⁄ãnido_admö
 = 
	`fûe_gë_c⁄ã¡s
(
$fichîo_admö_modulo
);

302 
$c⁄ãnido_admö
 = 
FALSE
;

307 <
f‹m
 
a˘i⁄
="<?Échÿ$_SERVER['SCRIPT_NAME'] ?>" 
mëhod
="post">

308 <
fõld£t
>

309 <
Àgíd
 
ac˚sskey
="s">
Evítos
 
∑ø
 
usu¨io
</legend>

310 <?
php
 i‡–! 
$diff_usu¨io
 ) 
echo
 '<div class="aviso">Sin diferencias conÜa versi√≥nÖor defecto</div>'; ?>

311 <
ãxèªa
 
«me
="c⁄ãnido" 
°yÀ
="width:100%;height:300px"><?=
$c⁄ãnido_usu¨io
?></textarea>

312 <
br
 /><br />

313 <
öput
 
ty≥
="hiddí" 
«me
="m" 
vÆue
="admin">

314 <
öput
 
ty≥
="hiddí" 
«me
="a" 
vÆue
="modificar_conexion">

315 <
öput
 
ty≥
="hiddí" 
«me
="modulo" 
vÆue
="<?=$modulo?>">

316 <
öput
 
ty≥
="hiddí" 
«me
="tùo" 
vÆue
="usuario">

317 <
fõld£t
>

318 <
öput
 
ty≥
='submô' 
vÆue
='<?ˆôîÆ('
Gu¨d¨
')?>' />

319 </
fõld£t
>

320 <?
php


321 i‡–
$c⁄ãnido_usu¨io
 !
$c⁄ãnido_usu¨io_modulo
 ) {

323 <
br
 />
C⁄ãnido
 
¥edëîmöado
 
dñ
 
m
√≥
dulo


324 <
ãxèªa
 
°yÀ
="width:100%;height:300px"><?=
$c⁄ãnido_usu¨io_modulo
?></textarea>

325 <?
php


328 </
fõld£t
>

329 </
f‹m
>

330 <?
php


332 i‡–
$c⁄ãnido_admö
 ) {

336 <
f‹m
 
a˘i⁄
="<?Échÿ$_SERVER['SCRIPT_NAME'] ?>" 
mëhod
="post">

337 <
fõld£t
>

338 <
Àgíd
 
ac˚sskey
="s">
Evítos
 
∑ø
 
admöi°øci
√≥
n
</legend>

339 <?
php
 i‡–! 
$diff_admö
 ) 
echo
 '<div class="aviso">Sin diferencias conÜa versi√≥nÖor defecto</div>'; ?>

340 <
ãxèªa
 
«me
="c⁄ãnido" 
°yÀ
="width:100%;height:300px"><?=
$c⁄ãnido_admö
?></textarea>

341 <
br
 /><br />

342 <
öput
 
ty≥
="hiddí" 
«me
="m" 
vÆue
="admin">

343 <
öput
 
ty≥
="hiddí" 
«me
="a" 
vÆue
="modificar_conexion">

344 <
öput
 
ty≥
="hiddí" 
«me
="modulo" 
vÆue
="<?=$modulo?>">

345 <
öput
 
ty≥
="hiddí" 
«me
="tùo" 
vÆue
="admin">

346 <
fõld£t
>

347 <
öput
 
ty≥
='submô' 
vÆue
='<?ˆôîÆ('
Gu¨d¨
')?>' />

348 </
fõld£t
>

349 <?
php


350 i‡–
$c⁄ãnido_admö
 !
$c⁄ãnido_admö_modulo
 ) {

352 <
br
 />
C⁄ãnido
 
¥edëîmöado
 
dñ
 
m
√≥
dulo


353 <
ãxèªa
 
°yÀ
="width:100%;height:300px"><?=
$c⁄ãnido_admö_modulo
?></textarea>

354 <?
php


357 </
fõld£t
>

358 </
f‹m
>

359 <?
php


362 
	}
}

372 
fun˘i⁄
 
	$modifiˇr_c⁄exi⁄
(
$e
,
$¨gs
=
NULL
) {

374 
globÆ
 
$gcm
;

376 
	`≥rmiso
('admöi°ør',
TRUE
);

378 
$modulo
 = 
$_POST
['modulo'];

379 
$tùo
 = 
$_POST
['tipo'];

380 
$c⁄ãnido
 = 
	`°rùc¶ashes
(
$_POST
['contenido']);

382 
$fichîo
 = 'DATOS/evítos/'.
$modulo
.'/evítos_'.
$tùo
.'.php';

384 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

385 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

387 
$gcm
->
tôulo
 = 'Gu¨d¨ '.
$modulo
.'Åùo: '.
$tùo
;

389 i‡–
	`fûe_put_c⁄ã¡s
(
$fichîo
, 
$c⁄ãnido
) ) {

390 
echo
 '<∞˛ass="ok">'.
$fichîo
.' modifcado</p>';

392 
echo
 'No seÖudoÑealizaráctualizaci√≥n';

395 
	}
}

402 
fun˘i⁄
 
	$rﬁes
(
$e
, 
$¨gs
 = 
FALSE
) {

404 
globÆ
 
$gcm
;

406 
$gcm
->
evít
->
	`™uœr
('contenido','admin');

407 
$gcm
->
evít
->
	`™uœr
('titulo','admin');

408 
$gcm
->
tôulo
 = 
	`lôîÆ
('Roles');

410 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/usuarios.php');

411 
$usu¨ios
 = 
√w
 
	`Rﬁes
(
$gcm
->
	`pdo_c⁄exi⁄
());

412 
$usu¨ios
->
	`admöi°ør
(
FALSE
,FALSE,FALSE,
TRUE
);

414 
	}
}

	@gcm/modulos/admin/menuAdmin.php

1 <?
	gphp


5 
	g$usu¨io
 = 
$_SESSION
[
$gcm
->
sufijo
.'usuario'];

7 
	g$míuAdmö2
[
$usu¨io
]['boton']['EditarÖerfil']['activado']= 1;

8 
	g$míuAdmö2
[
$usu¨io
]['boton']['EditarÖerfil']['title']="Editar informaci√≥n de usuario";

9 
	g$míuAdmö2
[
$usu¨io
]['bŸ⁄']['Edô¨Öîfû']['lök']=
dú«me
(
$_SERVER
['PHP_SELF'])."/admin/perfil_usuario";

11 
	g$míuAdmö2
['Salir']['title']="Cerrar sessi√≥n";

12 
	g$míuAdmö2
['Salir']['link']='./?salir=1';

14 i‡–
≥rmiso
('test','admin') ) {

16 
	g$míuAdmö
['Administraci√≥n']['boton']['Tests']['activado']= 1;

17 
	g$míuAdmö
['Administraci√≥n']['boton']['Tests']['title']="EjecutarÅests";

18 
	g$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Te°s']['lök']=
dú«me
(
$_SERVER
['PHP_SELF'])."/test";

22 i‡–
	$≥rmiso
() ) {

24 
$míuAdmö
['Administraci√≥n']['boton']['Roles']['activado']= 1;

25 
$míuAdmö
['Administraci√≥n']['boton']['Roles']['title']="Administraci√≥n deÑoles";

26 
$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Rﬁes']['lök']=
	`dú«me
(
$_SERVER
['PHP_SELF'])."/admin/roles/";

28 
$míuAdmö
['Administraci√≥n']['boton']['Usuarios']['activado']= 1;

29 
$míuAdmö
['Administraci√≥n']['boton']['Usuarios']['title']="Administraci√≥n de usuarios";

30 
$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Usu¨ios']['lök']=
	`dú«me
(
$_SERVER
['PHP_SELF'])."/admin/usuarios/";

32 
$míuAdmö
['Administraci√≥n']['boton']['Info server']['activado']= 1;

33 
$míuAdmö
['Administraci√≥n']['boton']['Info server']['title']="Informaci√≥n de servidor";

34 
$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Infÿ£rvî']['lök']=
	`dú«me
(
$_SERVER
['PHP_SELF'])."/admin/infoserver";

36 
$míuAdmö
['Administraci√≥n']['boton']['Visualizar conexiones']['activado']= 1;

37 
$míuAdmö
['Administraci√≥n']['boton']['Visualizar conexiones']['title']="Visualizar conexionesÉntre Eventos y m√≥dulos";

38 
$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['VisuÆiz¨ c⁄exi⁄es']['lök']=
	`dú«me
(
$_SERVER
['PHP_SELF'])."/admin/configurar_conexiones";

40 
	}
}

	@gcm/modulos/admin/modelos/usuarios.php

1 <?
php


8 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/databoundobject/lib/Crud.php');

21 ˛as†
	cUsu¨ios
 
exãnds
 
	mCrud
 {

23 
fun˘i⁄
 
	$DeföeTabÀName
() {

25 
globÆ
 
$gcm
;

27  
$gcm
->
au
->
sufijo
.'usuarios';

30 
fun˘i⁄
 
	$__c⁄°ru˘
(
PDO
 
$objPDO
, 
$id
=
NULL
) {

32 
globÆ
 
$gcm
;

34 
$this
->
sql_li°ado
 = 'SELECT u.id, u.usu¨io, u.nombª,u.≠ñlidos, fecha_modifiˇci⁄á†modifiˇci√≥¿FROM '.
$gcm
->
au
->
sufijo
.'usuarios u';

36 
$this
->
evíto_gu¨d¨
 = 'rol_minimo';

38 
∑ª¡
::
	`__c⁄°ru˘
(
$objPDO
, 
$id
);

40 
	}
}

48 
fun˘i⁄
 
	$rﬁ_möimo
(
$id
) {

50 
globÆ
 
$gcm
;

52 
$gcm
->
au
->
	`ö£π¨_rﬁ_usu¨io
(
$id
,2);

54 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'A√±adimosÑol "usuario"','AVISO');

56 
	}
}

64 ˛as†
	cRﬁes
 
exãnds
 
	mCrud
 {

66 
fun˘i⁄
 
	$li°ado_∑ø_£À˘
() {

67  
$this
->
	`föd
(
NULL
,
	`¨øy
('id', 'nombre'),'id');

71 
fun˘i⁄
 
	$DeföeTabÀName
() {

73 
globÆ
 
$gcm
;

75  
$gcm
->
au
->
sufijo
.'roles';

76 
	}
}

84 ˛as†
	cR_usu¨ios_rﬁes
 
exãnds
 
	mCrud
 {

86 
fun˘i⁄
 
	$__c⁄°ru˘
(
PDO
 
$objPDO
, 
$id
=
NULL
) {

88 
globÆ
 
$gcm
;

90 
$this
->
tùo_èbœ
 = 'combinatoria';

92 
$this
->
sql_li°ado
 = "

93 
SELECT
 
	`CONCAT
(
rur
.
usu¨ios_id
,',',rur.
rﬁes_id
Ë
as
 
id
, 
u
.
nombª
 
AS
 
usu¨io
, 
r
.nombª AS 
rﬁ


94 
FROM
 ".$gcm->sufijo."
r_usu¨ios_rﬁes
 
rur


95 
LEFT
 
JOIN
 ".$gcm->sufijo."
usu¨ios
 
u
 
ON
 u.
id
=
rur
.
usu¨ios_id


96 
LEFT
 
JOIN
 ".$gcm->sufijo."
rﬁes
 
r
 
ON
Ñ.
id
=
rur
.
rﬁes_id
";

98 
$this
->
›ci⁄es_¨øy2èbÀ
 = 
	`¨øy
(

100 '›' => 
	`¨øy
 (

101 'ocu…¨_id'=>
TRUE


102 ,'uæ'=>
Rouãr
::
$ba£
.'admin/roles_usuario?gmas_r_usuarios_roles_id='

104 , 'íœ˚s'=> 
	`¨øy
(

105 'uæ' => 
	`¨øy
(

108 ,'ba£_uæ'=>
Rouãr
::
$ba£
.'/admin/roles_usuario/'

114 
∑ª¡
::
	`__c⁄°ru˘
(
$objPDO
, 
$id
);

118 
fun˘i⁄
 
	$DeföeTabÀName
() {

120 
globÆ
 
$gcm
;

122  
$gcm
->
au
->
sufijo
.'r_usuarios_roles';

123 
	}
}

125 
fun˘i⁄
 
	$DeföeRñ©i⁄M≠
(
$pdo
) {

127 
$ªt‹no
['usuarios_id,roles_id'] = 'ID';

129  
$ªt‹no
;

131 
	}
}

	@gcm/modulos/aplicar_SEO/eventos_admin.php

1 <?
php


30 
	g$evítos
['seo']['seo'][1] = "";

	@gcm/modulos/aplicar_SEO/eventos_usuario.php

1 <?
	gphp


	@gcm/modulos/aplicar_SEO/lib/Aplicar_SEO.php

1 <?
php


28 ˛as†
	cA∂iˇr_SEO
 
exãnds
 
	mModulos
 {

32 
fun˘i⁄
 
	$__c⁄°ru˘
() {

34 
∑ª¡
::
	`__c⁄°ru˘
();

38 
fun˘i⁄
 
	$£o
(
$e
, 
$¨gs
=
FALSE
) {

40 
globÆ
 
$gcm
;

42 
$uæ
 = 
	`°r_ª∂a˚
('£o','',
$_SERVER
['HTTP_REFERER']);

44 
$tôulo
 = 'SEO';

45 
$c⁄ãnido
 = '

46 <
p
>

47 
Pídõ¡e
 
de
 
ha˚r
 
que
 
e°e
 
m
√≥
dulo
 
com¥uebe
 
y
 
ayude
 
a
 
ã√r
 
lo
 
√˚ßrio
 
∑ø
 
un
 
buí


48 
posici⁄amöëo
.

49 </
p
>

51 
Inf‹maci
√≥
n
 
sobª
 
SEO
 
í


52 <
a
 
hªf
="http://mamedu.com/dev/gcm/proyecto/Documentacion/SEO.html">

53 
hâp
:

54 </
a
>

56 <
br
 /><br />

57 <
h2
>
Hîømöëas
</h2>

58 <
br
 />

59 <
a
 
hªf
="hâps://devñ›îs.googÀ.com/•ìd/∑ge•ìd/ösights#uæ='.$uæ.'&mobûe=Ál£" >
Te°
 
de
 
vñocidad
</a>

60 <
br
 /><br />

64 
$gcm
->
c⁄ãnido
 = 
$c⁄ãnido
;

65 
$gcm
->
evít
->
	`™uœr
('contenido','aplicar_SEO');

66 
$gcm
->
tôulo
 = 
$tôulo
;

67 
$gcm
->
evít
->
	`™uœr
('titulo','aplicar_SEO');

70 
	}
}

	@gcm/modulos/aplicar_SEO/menuAdmin.php

1 <?
	gphp


	@gcm/modulos/cache_http/eventos_admin.php

1 <?
	gphp


	@gcm/modulos/cache_http/eventos_usuario.php

1 <?
php


29 
	g$evítos
['precarga']['alInicio'][1] = '';

30 
	g$evítos
['postcarga']['alFinal'][1] = '';

31 
	g$evítos
['borrar_cache']['borrar'][1] = 'todo';

	@gcm/modulos/cache_http/lib/Cache_http.php

1 <?
php


31 ˛as†
	cCache_hâp
 
exãnds
 
	mModulos
 {

37 
¥iv©e
 
	m$dú_ˇche
;

45 
¥iv©e
 
	m$duøci⁄
;

51 
¥iv©e
 
	m$duøci⁄_v¨übÀs
 = 3000 ;

57 
¥iv©e
 
	m$¨chivo_ˇche
;

63 
¥iv©e
 
	m$exãnsi⁄
 = '.cache';

67 
fun˘i⁄
 
	$__c⁄°ru˘
() {

69 
∑ª¡
::
	`__c⁄°ru˘
();

71 
$this
->
dú_ˇche
 = 'cache/';

72 
$this
->
duøci⁄
 = 60*60*2;

74 i‡–! 
	`fûe_exi°s
(
$this
->
dú_ˇche
) ) {

75 i‡–! 
	`mkdú
(
$this
->
dú_ˇche
) ) {

76 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'No seÖudo crear directorioÖara cache','ERROR');

82 
fun˘i⁄
 
	$ã°
() {

84 
$this
->
	`ejecuè_ã°
('Dúe˘‹iÿ∑ø cache: '.$this->
dú_ˇche
, 
	`fûe_exi°s
($this->dú_ˇche), 
TRUE
);

85 
$this
->
	`ejecuè_ã°
('Pîmiso†dêdúe˘‹io: '.$this->
dú_ˇche
,
	`is_ªadabÀ
($this->dú_ˇche), 
TRUE
);

87 
	}
}

103 
fun˘i⁄
 
	$ÆInicio
() {

105 
globÆ
 
$gcm
;

108 i‡–
$gcm
->
au
->
	`logódo
(ËË
$this
->
	`javas¸ùts
('cache_http.js');

110 i‡–
$gcm
->
au
->
	`logódo
() ) {

111 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'() En modo debugÇo cacheamos');

115 i‡–
GCM_DEBUG
 ) {

116 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'() En modo debugÇo cacheamos');

120 i‡–
	`is£t
(
$_SESSION
[
$gcm
->
sufijo
.'registros']) ) {

121 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'() ConÉrrores oávisosÇo cacheamos');

125 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/ext/detectar_navegador/browser_class_inc.php');

127 
$b
 = 
√w
 
	`brow£r
();

128 
$bb
 = 
$b
->
	`wh©Brow£r
();

130 
$«vegad‹
 = 
$bb
['browsertype'];

131 
$vîsi⁄
 = 
$bb
['version'];

132 
$∂©af‹ma
 = 
$bb
['platform'];

134 
$uæ
 = 
$_SERVER
['HTTP_HOST'].$_SERVER['REQUEST_URI'];

136 
$sﬁicôud
 = 
	`¨øy
 ('uæ' => 
$uæ
, 
$_POST
, 
$_GET
);

138 
$aBa£«me
 = 
	`ex∂ode
('?',
$uæ
);

139 
$aDú«me
 = 
	`ex∂ode
('?',
$uæ
);

140 
$ba£«me
 = 
	`ba£«me
(
$aBa£«me
[0]);

141 
$dú«me
 = 
$this
->
dú_ˇche
.
	`dú«me
(
$aDú«me
[0]);

142 
	`mkdú_ªcursivo
(
$dú«me
);

144 
$this
->
¨chivo_ˇche
 = 
$dú«me
.'/'.
$ba£«me
.'_'.

145 
$∂©af‹ma
.'_'.
$«vegad‹
.'_'.
$vîsi⁄
.'_'.

146 
	`md5
(
	`£rülize
(
$sﬁicôud
)).
$this
->
exãnsi⁄
;

148 i‡(@
	`fûe_exi°s
(
$this
->
¨chivo_ˇche
)) {

149 
$„cha_ˇche
 = @
	`fûemtime
(
$this
->
¨chivo_ˇche
);

151 
$„cha_ˇche
 = 0;

155 @
	`˛ór°©ˇche
();

158 i‡(
	`time
(Ë- 
$this
->
duøci⁄
 < 
$„cha_ˇche
) {

159 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Archivÿí cache: '.
$this
->
¨chivo_ˇche
,'ADMIN');

161 
$aExt
 = 
	`ex∂ode
('.',
Rouãr
::
$uæ
);

162 
$ext
 = 
	`íd
(
$aExt
);

163 
$ext
) {

165 
	`hódî
('Content-Type:Åext/css');

166 
$ßlida
 = "\n".'/* Archivÿí cachê'.
$this
->
¨chivo_ˇche
.' */'."\n";

169 
	`hódî
('Content-Type:Åext/javascript');

170 
$ßlida
 = "\n".'/* Archivÿí cachê'.
$this
->
¨chivo_ˇche
.' */'."\n";

173 
$ßlida
 = "\n".'<!-- Archivÿí cachê'.
$this
->
¨chivo_ˇche
.' -->'."\n";

176 
	`ªadfûe
(
$this
->
¨chivo_ˇche
);

177 
echo
 
$ßlida
;

178 
	`exô
();

183 
	}
}

194 
fun˘i⁄
 
	$ÆFöÆ
() {

196 
globÆ
 
$gcm
;

198 i‡–
	`is£t
(
$_SESSION
[
$gcm
->
sufijo
.'ªgi°ros']Ë|| $gcm->
ªg
->
	`îr‹es
(Ë|| $gcm->
au
->
	`logódo
(Ë|| 
GCM_DEBUG
 ) ;

200 
$ßlida
 = 
$gcm
->
ßlida
;

203 i‡–
	`em±y
(
$gcm
->
ßlida
) ) ;

205 i‡–
	`em±y
(
$this
->
¨chivo_ˇche
) ) ;

208 
$Â
 = 
	`f›í
(
$this
->
¨chivo_ˇche
, "w");

210 i‡–
$Â
 ) {

213 @
	`fwrôe
(
$Â
, 
$ßlida
);

214 @
	`f˛o£
(
$Â
);

218 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(ËArchivÿgu¨dadÿí cache: '.
$this
->
¨chivo_ˇche
);

219 
	}
}

231 
fun˘i⁄
 
	$b‹ør
(
$e
, 
$¨gs
) {

233 
globÆ
 
$gcm
;

235 i‡–
$¨gs
 !'todo' && !
	`em±y
($args) ) {

236 
$uæ
 = 
	`°r_ª∂a˚
('/','_',
$¨gs
);

237 
$¨chivos
 = 
	`glob
(
$this
->
dú_ˇche
.'*'.
$uæ
.'*');

239 
$¨chivos
 = 
	`glob
(
$this
->
dú_ˇche
.'*');

240 i‡–
	`fun˘i⁄_exi°s
('≠c_˛ór_ˇche'ËË
	`≠c_˛ór_ˇche
();

243 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

244 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'ËArchivo†®b‹ør: '.dïuør(
$¨chivos
));

246 i‡–!
	`is£t
(
$¨chivos
Ë|| 
	`em±y
($archivos) ) {

249 
	`exô
();

250 
$gcm
->
	`ßlú
();

253 
	`f‹óch
 ( 
$¨chivos
 
as
 
$¨chivo
 ) {

254 i‡–
	`is_dú
(
$¨chivo
) ) {

255 
	`rmdú_ªcursivo
(
$¨chivo
);

257 @
	`u∆ök
(
$¨chivo
);

261 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Archivo†b‹ødo†í cache: '.
	`cou¡
(
$¨chivos
));

265 i‡–
$e
 == 'borrar_cache' ) {

268 
	`exô
();

269 
$gcm
->
	`ßlú
();

272 
	}
}

286 
fun˘i⁄
 
	$ªcu≥ør_v¨übÀ
(
$nombª_v¨übÀ
, 
$tõmpo_expúaci⁄
=
NULL
) {

288 
$tõmpo_expúaci⁄
 = ( $tõmpo_expúaci⁄ ) ? $tõmpo_expúaci⁄ : 
$this
->
duøci⁄_v¨übÀs
;

290 i‡–
	`fun˘i⁄_exi°s
('apc_fetch') ) {

291 
$ªt‹no
 = 
	`≠c_„tch
(
$nombª_v¨übÀ
);

292 i‡–
$ªt‹no
 )  $retorno;

295 
$¨chivo_v¨übÀ
 = 
$this
->
dú_ˇche
.
$nombª_v¨übÀ
.$this->
exãnsi⁄
;

297 i‡(@
	`fûe_exi°s
(
$¨chivo_v¨übÀ
)) {

298 
$„cha_ˇche
 = @
	`fûemtime
(
$¨chivo_v¨übÀ
);

300 
$„cha_ˇche
 = 0;

304 @
	`˛ór°©ˇche
();

307 i‡(
	`time
(Ë- 
$tõmpo_expúaci⁄
 < 
$„cha_ˇche
) {

308 
$c⁄ãnido
 = 
	`fûe_gë_c⁄ã¡s
(
$¨chivo_v¨übÀ
);

309 
$ªt‹no
 = 
	`un£rülize
(
$c⁄ãnido
);

310 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Recu≥ømo†v¨übÀÉ¿ˇchê['.
$nombª_v¨übÀ
.'] '."\n".
	`dïuør
(
$ªt‹no
));

311  
$ªt‹no
;

314  
FALSE
;

316 
	}
}

322 
fun˘i⁄
 
	$gu¨d¨_v¨übÀ
(
$nombª_v¨übÀ
,
$vÆ‹
) {

324 i‡–
	`fun˘i⁄_exi°s
('≠c_add'ËË 
	`≠c_add
(
$nombª_v¨übÀ
, 
$vÆ‹
);

326 
$¨chivo_v¨übÀ
 = 
$this
->
dú_ˇche
.
$nombª_v¨übÀ
.$this->
exãnsi⁄
;

328 
$Â
 = @
	`f›í
(
$¨chivo_v¨übÀ
, "w");

329 @
	`fwrôe
(
$Â
, 
	`£rülize
(
$vÆ‹
));

330 @
	`f˛o£
(
$Â
);

332 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Gu¨damo†v¨übÀÉ¿ˇchê['.
$nombª_v¨übÀ
.'] '."\n".
	`dïuør
(
$vÆ‹
));

333 
	}
}

	@gcm/modulos/cache_http/menuAdmin.php

1 <?
php


31 
	g$míuAdmö
['Administraci√≥n']['boton']['Borrar cache']['activado']= 1;

32 
	g$míuAdmö
['Administraci√≥n']['boton']['Borrar cache']['title']="Borrar cache";

33 
	g$míuAdmö
['Administraci√≥n']['boton']['Borrar cache']['link'] =

34 "javas¸ùt:≥dúD©os(\"".
Rouãr
::
$dú
."ajax/borrar_cache\",\"respuesta_borrar_cache\");";

	@gcm/modulos/comentarios/config/config.php

1 <?
php


15 
	g$c⁄fig
['modîaci√≥n'] = 
åue
;

	@gcm/modulos/comentarios/config/config_es.php

1 <?
php


11 
	g$c⁄fig_DESC
['moderaci√≥n'] = 'SiáctivamosÜa moderaci√≥n de comentarios, soloÉstaran disponibles cuandoÉl moderador de su visto bueno';

	@gcm/modulos/comentarios/eventos_admin.php

1 <?
	gphp


	@gcm/modulos/comentarios/eventos_usuario.php

1 <?
php


12 
	g$evítos
['columna']['ultimos'][6]='';

15 
	g$evítos
['postcontenido']['presentar_comentarios'][3]='';

18 
	g$evítos
['postcontenido']['formulario'][4]='';

21 
	g$evítos
['modifiˇr_comíèrio']['modifiˇr'][1] = ( 
is£t
(
$_REQUEST
['id']ËË? $_REQUEST['id'] : 
NULL
 ;

	@gcm/modulos/comentarios/lib/Comentarios.php

1 <?
php


32 ˛as†
	cComíèrios
 
exãnds
 
	mModulos
 {

34 
¥Ÿe˘ed
 
	m$pdo
 = 
NULL
;

35 
¥Ÿe˘ed
 
	m$¥efijo
 = 
NULL
;

36 
¥Ÿe˘ed
 
	m$èbœ
 = 
NULL
;

37 
¥Ÿe˘ed
 
	m$tùo_ba£_d©os
 ;

39 
¥iv©e
 
	m$modîaci⁄
;

45 
¥iv©e
 
	m$ˇrgado_javas¸ùt
 = 
FALSE
;

49 
fun˘i⁄
 
	$__c⁄°ru˘
() {

51 
globÆ
 
$gcm
;

53 
$this
->
pdo
 = 
$gcm
->
	`pdo_c⁄exi⁄
();

54 
$this
->
¥efijo
 = 
$gcm
->
sufijo
;

55 
$this
->
èbœ
 = $this->
¥efijo
.'comentarios';

57 
$this
->
tùo_ba£_d©os
 = $this->
pdo
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

61 
$SQL
 = 'SELECT COUNT(*ËFROM '.
$this
->
èbœ
;

63 i‡–!
$this
->
pdo
 ) {  
FALSE
; }

65 
åy
 {

67 
$°h
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
);

68 
$°h
->
	`execuã
();

70 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

72 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'() CreamosÅabla comentarios');

73 
$this
->
	`gíî¨TabœComíèrios
($this->
pdo
);

77 
∑ª¡
::
	`__c⁄°ru˘
();

79 
$this
->
modîaci⁄
 = $this->
	`c⁄fig
('moderaci√≥n');

91 
fun˘i⁄
 
	$u…imos
(
$e
, 
$¨gs
=
NULL
) {

93 
globÆ
 
$gcm
;

95 
$num_ôems_df
 = 5;

97 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

99 
$num
 = ( 
	`is£t
(
$∑ømëros
['num']ËË? $∑ømëros['num'] : 
$num_ôems_df
 ;

101 i‡–!
$this
->
pdo
 ) {  
FALSE
; }

103 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/paginarPDO.php');

105 
$SQL
 = "SELECT fecha_¸óci⁄,Çombª, uæ, c⁄ãnido, comíèrio,á˘ivado, usu¨ios_id FROM ".
$this
->
èbœ
;

106 i‡–
$this
->
modîaci⁄
 && ! 
	`≥rmiso
('moderacion_comentarios') )

107 
$SQL
 ." WHERE (á˘ivadÿ1 OR usu¨ios_id = '".
	`£ssi⁄_id
()."')";

109 
$SQL
 .= " ORDER BY fecha_creacion desc";

111 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
pdo
, 
$SQL
, 'u…_', 
$num
);

113 i‡–
$pd
->
	`vÆid¨
() ) {

115 
	`ob_°¨t
();

116 
$pd
->
∂™tûœ_ªsu…ados
=
	`dú«me
(
__FILE__
).'/../html/ultimos.html';

117 
$pd
->
	`∑göa
();

118 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
();

119 
	`ob_íd_˛ón
();

120 i‡–
$ßlida
 ) {

121 
$∑√l
 = 
	`¨øy
();

122 
$∑√l
['tôulo'] = 
	`lôîÆ
('√öltimos comentarios');

123 
$∑√l
['c⁄ãnido'] =
$ßlida
;

124 
Temas
::
	`∑√l
(
$∑√l
);

131 
	}
}

142 
fun˘i⁄
 
	$com¥ob¨_≥rmisos
(
$aut‹_id
=
FALSE
) {

144 
globÆ
 
$gcm
;

146 i‡–
	`≥rmiso
('modî¨_comíèrios'ËË 
TRUE
 ;

148 i‡–
$aut‹_id
 && $aut‹_id =
$gcm
->
au
->
	`id
(ËË 
TRUE
;

150 i‡–
$aut‹_id
 && $aut‹_id =
	`£si⁄
('aut‹_comíèrio'ËË 
TRUE
;

152  
FALSE
 ;

154 
	}
}

161 
fun˘i⁄
 
	$¥e£¡¨_comíèrios
(
$e
, 
$¨gs
=
NULL
) {

163 
globÆ
 
$gcm
;

165 
$num_ôems_df
 = 5;

167 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

169 
$num
 = ( 
	`is£t
(
$∑ømëros
['num']ËË? $∑ømëros['num'] : 
$num_ôems_df
 ;

172 
$this
->
	`javas¸ùts
('comentarios.js');

174 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/paginarPDO.php');

176 
$SQL
 = "SELECT id, fecha_creacion,Çombre, url, contenido, comentario,áctivado, usuarios_id

177 
FROM
 ".$this->èbœ." 
WHERE
 
uæ
='".Router::$url."'";

181 i‡–
$this
->
modîaci⁄
 && ! 
	`≥rmiso
('moderacion_comentarios') )

182 
$SQL
 ." AND (á˘ivadÿ1 OR usu¨ios_id = '".
	`£ssi⁄_id
()."')";

184 
$SQL
 .= " ORDER BY fecha_creacion desc";

186 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
pdo
, 
$SQL
, 'comentarios_');

188 i‡–
$pd
->
	`vÆid¨
() ) {

190 
$pd
->
ñemítos_∑göa
=
$num
;

191 
$pd
->
∂™tûœ_ªsu…ados
=
	`dú«me
(
__FILE__
).'/../html/listado.html';

192 i‡–
Rouãr
::
$f‹m©o
 !'ajax' ) 
echo
 '<h2>Comentarios</h2>';

193 
$pd
->
	`gíî¨_∑göa
('&m=comentarios&a=presentar_comentarios&formato=ajax');

196 
	}
}

203 
fun˘i⁄
 
	$f‹muœrio
(
$e
, 
$¨gs
=
NULL
) {

205 
globÆ
 
$gcm
;

209 i‡–!
$this
->
ˇrgado_javas¸ùt
 && 
Rouãr
::
$f‹m©o
 != 'ajax') {

210 
$this
->
ˇrgado_javas¸ùt
 = 
TRUE
;

211 
echo
 '<s¸ùàty≥="javas¸ùt" src="'.
Rouãr
::
$dú
.
GCM_DIR
.'lib/ext/tiny_mce/tiny_mce.js"></script>';

214 
	`ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/captcha/captcha.php');

216 
$id
 = 
$¨gs
;

217 
$acci⁄
 = (
$id
) ? 'ejecutar_modificar_comentario' : 'verificar_entrada';

219 i‡–
Rouãr
::
$c
 && Router::$c !== 'index.html' ) {

222 
$usu¨io
 = 
FALSE
;

223 
$maû
 = 
FALSE
;

224 
$ãxto
 = 
FALSE
;

226 i‡–
$e
 == 'modificar_comentario' ) {

228 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

230 
$comíèrio
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
, 
$id
);

231 
$usu¨io
 = 
$comíèrio
->
	`gëNombª
();

232 
$maû
 = 
$comíèrio
->
	`gëMaû
();

233 
$ãxto
 = 
$comíèrio
->
	`gëComíèrio
();

234 
$id_u£r
 = 
$comíèrio
->
	`gëUsu¨ios_id
();

236 i‡–! 
	`≥rmiso
('modî¨_comíèrios'Ë&& 
$id_u£r
 !
	`£ssi⁄_id
() )  ;

238 
$tôulo
 = 
	`lôîÆ
('Modificar comentario');

239 
$ocu…¨
 = 
FALSE
;

243 
$tôulo
 = 
	`lôîÆ
('A√±adir comentario');

244 
$ocu…¨
 = 
TRUE
;

248 
	`ob_°¨t
();

249 
echo
 "<div id='f‹m_com_".
Rouãr
::
$uæ
."' class='form_comentario' style='label: A√±adir comentario;'>\n";

250 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('comentarios','html','form_comentario.html'));

251 
echo
 "</div>\n";

255 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

257 <
s¸ùt
 
ty≥
="text/javascript">

258 <?
php
 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('comentarios','js','editorweb.js')); ?>

259 </
s¸ùt
>

260 <?
php


263 <
s¸ùt
 
œnguage
="javas¸ùt" 
ty≥
="text/javascript"

264 
§c
="<?ph∞echÿGCM_DIR_P ?>lib/ext/töy_m˚/töy_m˚.js"></
s¸ùt
>

265 <?
php


266 
$this
->
	`javas¸ùts
('editorweb.js');

269 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
();

270 
	`ob_íd_˛ón
();

272 
$∑√l
 = 
	`¨øy
();

273 
$∑√l
['tôulo'] = 
$tôulo
;

274 
$∑√l
['c⁄ãnido'] = 
$ßlida
;

275 
$∑√l
['ocu…o'] = 
$ocu…¨
;

276 
Temas
::
	`∑√l
(
$∑√l
);

278 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

280 <
s¸ùt
 
ty≥
="text/javascript">

281 
	`$
(".sub∑√l_ocu…o").
	`hide
(3000);

282 
	`∑√Às
();

283 </
s¸ùt
>

284 <?
php


287 
	}
}

293 
fun˘i⁄
 
	$gíî¨TabœComíèrios
() {

295 
globÆ
 
$gcm
;

297 
$this
->
tùo_ba£_d©os
) {

301 
$mís
="creamosÜaÅabla de comentarios";

302 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(Ë'.
$mís
);

303 
$SQL
="CREATE TABLE ".
$this
->
èbœ
." (

304 
id
 
INTEGER
 
PRIMARY
 
KEY
 ,

305 
uæ
 
	`CHAR
(150) ,

306 
„cha_¸óci⁄
 
TIME
 
NOT
 
NULL
 
DEFAULT
 
CURRENT_TIMESTAMP
 ,

307 
nombª
 
	`CHAR
(60) ,

308 
maû
 
	`CHAR
(60) ,

309 
c⁄ãnido
 
	`CHAR
(100),

310 
comíèrio
 
	`CHAR
(500),

311 
a˘ivado
 
INTEGER
,

312 
∑dª
 
INTEGER
,

313 
usu¨ios_id
 
	`CHAR
(40)

316 i‡–! 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

318 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(ËERRORá»¸ó∏èbœ '.
$this
->
èbœ
.' '.
$pdo_îr‹
,'ERROR');

319  
FALSE
;

322 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(ËSê¸eÿœÅabœ '.
$this
->
èbœ
 );

323  
TRUE
;

330 
$mís
="creamosÜaÅabla de comentarios";

331 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(Ë'.
$mís
);

332 
$SQL
="CREATE TABLE ".
$this
->
èbœ
." (

333 
id
 
MEDIUMINT
 
NOT
 
NULL
 
AUTO_INCREMENT
 ,

334 
uæ
 
	`CHAR
(150) ,

335 
„cha_¸óci⁄
 
TIMESTAMP
 
NOT
 
NULL
 
DEFAULT
 
CURRENT_TIMESTAMP
,

336 
nombª
 
	`CHAR
(60) ,

337 
maû
 
	`CHAR
(60) ,

338 
c⁄ãnido
 
	`CHAR
(100),

339 
comíèrio
 
TEXT
,

340 
a˘ivado
 
TINYINT
,

341 
∑dª
 
MEDIUMINT
,

342 
usu¨ios_id
 
	`CHAR
(40),

343 
PRIMARY
 
	`KEY
 (
id
)

346 i‡–! 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

348 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(ËERRORá»¸ó∏èbœ '.
$this
->
èbœ
.' '.
$pdo_îr‹
,'ERROR');

349  
FALSE
;

352 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'(ËSê¸eÿœÅabœ '.
$this
->
èbœ
 );

353  
TRUE
;

359 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'E»drivî ['.
$drivî
.']ÖaraÜa base de datosÇoÉst√° soportado','ERROR');

364 
	}
}

372 
fun˘i⁄
 
	$vÆid¨_d©os
(
$aD©os
) {

374 
$∑ß_comíèrios
 = 
TRUE
;

377 
$ègs_a˚±ados
 = '<br><p><u>,<li>,<ul>,<em>,<strike>,<strong>,<blockquote>,<ol>';

379 i‡–
	`em±y
(
$aD©os
['texto']) ) {

380 
$∑ß_comíèrios
 = 
FALSE
;

381 
$mís
 = 
	`lôîÆ
('Campo de comentario vacio',3);

382 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

385 
$aD©os
['ãxto'] = 
	`°rù_ègs
($aD©os['ãxto'], 
$ègs_a˚±ados
);

387 i‡–
	`em±y
(
$aD©os
['texto']) ) {

388 
$∑ß_comíèrios
 = 
FALSE
;

389 
$mís
 = 
	`lôîÆ
('Campo de comentario conÉtiquetasÇoÖermitidas',3);

390 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

393 i‡–
	`em±y
(
$aD©os
['usu¨io']Ë|| ! 
	`is£t
($aDatos['usuario']) ) {

394 
$∑ß_comíèrios
 = 
FALSE
;

395 
$mís
=
	`lôîÆ
("SeÇecesita unÇombre de usuario");

396 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

399 i‡–
	`em±y
(
$aD©os
['ãxto']Ë|| ! 
	`is£t
($aDatos['texto']) ) {

400 
$∑ß_comíèrios
 = 
FALSE
;

401 
$mís
=
	`lôîÆ
("No hay contenidoÉnÉl comentario");

402 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

405 i‡–! 
$∑ß_comíèrios
 )  
FALSE
;

407  
$aD©os
;

409 
	}
}

415 
fun˘i⁄
 
	$vîifiˇr_íåada
(
$e
, 
$¨gs
=
NULL
) {

417 
globÆ
 
$gcm
;

423 
$mís
="A√±adirÇuevo comentario";

424 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'.
$mís
);

428 
	`ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/captcha/captcha.php');

430 i‡–! 
	`vîifiˇrC≠tcha
(4) ) {

431 
$mís
 = 
	`lôîÆ
('No seÖudoá√±adir comentario. ');

432 
$mís
 .
	`lôîÆ
('SiÇoÉstas haciendo spamÖuedesÉnviar un correoáláutor');

433 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

434  
FALSE
;

437 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

439 
$comíèrio
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
);

441 
$ªsu…ado
 = 
$this
->
	`vÆid¨_d©os
(
$_POST
);

443 i‡–
$ªsu…ado
 ) {

445 
$comíèrio
->
	`£tNombª
(
$ªsu…ado
['usuario']);

446 
$comíèrio
->
	`£tMaû
(
$ªsu…ado
['mail']);

447 
$comíèrio
->
	`£tUæ
(
Rouãr
::
$s
.Rouãr::
$c
);

448 
$comíèrio
->
	`£tC⁄ãnido
(
	`°r_ª∂a˚
('.html','',
Rouãr
::
$c
));

449 
$comíèrio
->
	`£tComíèrio
(
$ªsu…ado
['texto']);

450 i‡–
$gcm
->
au
->
	`id
() ) {

451 
$comíèrio
->
	`£tA˘ivado
(1);

452 
$comíèrio
->
	`£tUsu¨ios_id
(
$gcm
->
au
->
	`id
());

454 
$comíèrio
->
	`£tUsu¨ios_id
(
	`£ssi⁄_id
());

456 
$comíèrio
->
	`ßve
();

457 
$ªsu…ado
['id'] = 
$comíèrio
->
	`u…imo_idítifiˇd‹
();

459 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Comentario insertado'),'AVISO');

463 
$¨gs
['cuîpo'] = "<h1>".
	`lôîÆ
(
Rouãr
::
$c
)."</h1>";

464 
$¨gs
['cuerpo'] = "\n";

465 
$¨gs
['cuîpo'] ."\n<b∏/>Usu¨io: <b>".
$ªsu…ado
['usuario']."</b>";

466 
$¨gs
['cuîpo'] ."\n<b∏/>Maû: <b>".
$ªsu…ado
['mail']."</b>";

467 
$¨gs
['cuerpo'] .= "\n<br />Texto: ";

468 
$¨gs
['cuîpo'] ."\n<b>".
$ªsu…ado
['texto']."</b>";

469 
$¨gs
['cuerpo'] .= "\n<br />";

470 
$¨gs
['cuîpo'] ."\n<®hªf='".
$_SERVER
['HTTP_REFERER']."'>IráÉntrada</a>";

471 
$¨gs
['cuerpo'] .= "\n<br />";

472 
$¨gs
['cuîpo'] ."\n<b∏/><em>I∞dêusu¨io: ".
	`mo°ør_ù
()."</em>";

474 
$¨gs
['asunto'] = 'Comentarioá√±adido';

476 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('íviomaû','ívür_emaû','comíèrio_a√±adido',
$¨gs
);

477 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','comíèrio_ö£πado',
Rouãr
::
$uæ
);

481 
	}
}

487 
fun˘i⁄
 
	$ñimö¨
(
$e
, 
$¨gs
=
NULL
) {

490 i‡–! 
	`≥rmiso
('modî¨_comíèrios'Ë&& 
$fûa
->
usu¨ios_id
 !
	`£ssi⁄_id
() )  ;

492 
globÆ
 
$gcm
;

494 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

496 i‡–!
	`em±y
(
$¨gs
Ë&& 
	`is_¨øy
($args) ) {

497 
$id
 = 
$¨gs
[0] ;

498 } 
	`ñ£if
 ( !
	`em±y
(
$¨gs
Ë&& ! 
	`is_¨øy
($args) ) {

499 
$id
 = 
$¨gs
 ;

500 } 
	`ñ£if
 ( !
	`em±y
(
Rouãr
::
$¨gs
) ) {

501 
$id
 = 
Rouãr
::
$¨gs
[0];

503 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') Sin identificaorÇo seÖuede borrar comentario','ERROR');

504 
echo
 "FALSE";

505 
	`exô
();

508 
$comíèrio
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
, 
$id
);

509 
$comíèrio
->
	`M¨kF‹Dñëi⁄
();

510 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','comíèrio_ñimöado',
Rouãr
::
$s
.Rouãr::
$c
);

511 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

512 
echo
 
$id
;

513 
	`exô
();

515 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Comentario borrado'),'AVISO');

518 
	}
}

524 
fun˘i⁄
 
	$modifiˇr
(
$e
, 
$¨gs
=
NULL
) {

526 
globÆ
 
$gcm
;

528 
$id
 = 
$¨gs
;

529 
$this
->
	`f‹muœrio
('modifiˇr_comíèrio',
$id
);

531 
	}
}

537 
fun˘i⁄
 
	$ejecuèr_modifiˇr_comíèrio
(
$e
, 
$¨gs
=
NULL
) {

539 
globÆ
 
$gcm
;

541 
$mís
="Modificar comentario";

542 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'.
$mís
);

544 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

546 
$ªsu…ado
 = 
$this
->
	`vÆid¨_d©os
(
$_POST
);

548 i‡–
	`is£t
(
$ªsu…ado
['id']) ) {

550 
$comíèrio
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
, 
$ªsu…ado
['id']);

552 i‡–! 
	`≥rmiso
('modî¨_comíèrios'Ë&& 
$comíèrio
->
	`gëUsu¨ios_id
(Ë!
	`£ssi⁄_id
() ) {

553 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Acci√≥nÇoÖermitida','ERROR');

557 i‡–
$ªsu…ado
 ) {

559 
$comíèrio
->
	`£tNombª
(
$ªsu…ado
['usuario']);

560 
$comíèrio
->
	`£tMaû
(
$ªsu…ado
['mail']);

561 
$comíèrio
->
	`£tComíèrio
(
$ªsu…ado
['texto']);

562 
$comíèrio
->
	`ßve
();

564 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Comentario Modificado'),'AVISO');

566 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','comíèrio_modifiˇdo',
Rouãr
::
$uæ
);

571 
$mís
=
	`lôîÆ
("Sin IdentificadorÇo seÖuede borrar comentario",3);

572 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'.
$mís
);

577 
	}
}

	@gcm/modulos/comentarios/lib/ComentariosAdmin.php

1 <?
php


8 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/Comentarios.php');

9 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/Comentarios.php');

18 ˛as†
	cComíèriosAdmö
 
exãnds
 
	mComíèrios
 {

22 
fun˘i⁄
 
	$__c⁄°ru˘
() {

24 
∑ª¡
::
	`__c⁄°ru˘
();

32 
fun˘i⁄
 
	$li°¨
(
$e
, 
$¨gs
) {

34 
globÆ
 
$gcm
;

36 
	`≥rmiso
('moderar_comentarios');

38 
$gcm
->
evít
->
	`™uœr
('titulo','contenido');

39 
$gcm
->
evít
->
	`™uœr
('contenido','contenido');

41 i‡–
	`is£t
(
$_GET
['accion']) && $_GET['accion'] == 'eliminar' ) {

42 
$this
->
	`ñimö¨
('öã∫o',
$_GET
['comentario']);

45 
$gcm
->
tôulo
 = 
	`lôîÆ
('Listado de comentarios',3);

47 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

49 
$comíèrios
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
, 
$¨gs
['id']);

51 
$this
->
c⁄f_∑göad‹
 = 
	`¨øy
 ('url'=>'?comentario='

57 , 'ocu…¨_id'=>
TRUE


60 , 'íœ˚s'=> 
	`¨øy
('url' =>árray('campo_enlazado'=>'contenido'

62 ,'ba£_uæ'=>
Rouãr
::
$ba£


67 
$comíèrios
->
	`admöi°ør
(
FALSE
,'„cha_¸óci⁄ desc',FALSE,
TRUE
);

71 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/array2table/lib/Array2table.php');

72 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/GcmPDO.php');

74 
$c⁄dici⁄
 = ( 
$¨gs
['id'] ) ? " AND c.id=".$args['id'] : '';

77 
$sql
 = 'SELECT c.id,c. fecha_creacion `fecha creaci√≥n`,

78 
c
.
uæ
, c.
c⁄ãnido
 ,

79 
c
.
nombª
, c.
maû
, c.
comíèrio


80 
FROM
 '.$this->èbœ.' 
c
 
ORDER
 
BY
 c.
„cha_¸óci⁄
 
desc
';

82 
$gcmpdo
 = 
√w
 
	`GcmPDO
(
$this
->
pdo
, 
$sql
);

83 
$¨øy
 = 
$gcmpdo
->
	`to_¨øy
();

84 
$›ci⁄es
 = 
	`¨øy
 ('url'=>'?comentario='

90 , 'ocu…¨_id'=>
TRUE


93 , 'íœ˚s'=> 
	`¨øy
('url' =>árray('campo_enlazado'=>'contenido'

95 ,'ba£_uæ'=>
Rouãr
::
$ba£


101 i‡–
$gcmpdo
->
	`vÆid¨
() ) {

102 
$¨øy2èbÀ
 = 
√w
 
	`Aºay2èbÀ
();

103 
$¨øy2èbÀ
->
	`gíî¨_èbœ
(
$¨øy
, 
$›ci⁄es
);

105 
echo
 
	`lôîÆ
('No hay comentariosÖaraÜistar');

110 
	}
}

116 
fun˘i⁄
 
	$a˘iv¨
(
$e
, 
$¨gs
) {

118 i‡–! 
	`≥rmiso
('moderar_comentarios') )  ;

120 
globÆ
 
$gcm
;

122 
	`ªquúe_⁄˚
(
	`dú«me
(
__FILE__
).'/../modelos/comentarios_dbo.php');

124 i‡–!
	`em±y
(
$¨gs
Ë&& 
	`is_¨øy
($args) ) {

125 
$id
 = 
$¨gs
[0] ;

126 } 
	`ñ£if
 ( !
	`em±y
(
$¨gs
Ë&& ! 
	`is_¨øy
($args) ) {

127 
$id
 = 
$¨gs
 ;

128 } 
	`ñ£if
 ( !
	`em±y
(
Rouãr
::
$¨gs
) ) {

129 
$id
 = 
Rouãr
::
$¨gs
[0];

131 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') Sin identificaorÇo seÖuede borrar comentario','ERROR');

132 
echo
 "FALSE";

133 
	`exô
();

136 
$comíèrio
 = 
√w
 
	`Comíèrios_dbo
(
$this
->
pdo
, 
$id
);

137 
$comíèrio
->
	`£tA˘ivado
(1);

138 
$comíèrio
->
	`ßve
();

140 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','comíèrio_a˘ivado',
Rouãr
::
$s
.Rouãr::
$c
);

141 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

142 
echo
 
$id
;

143 
	`exô
();

145 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('comentario').' '.literal('activado'),'AVISO');

148 
	}
}

	@gcm/modulos/comentarios/menuAdmin.php

1 <?
php


11 
	g$míuAdmö
['Administraci√≥n']['boton']['Comentarios']['activado']= 1;

12 
	g$míuAdmö
['Administraci√≥n']['boton']['Comentarios']['title']="Listado de comentarios";

13 
	g$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Comíèrios']['lök'] = 
Rouãr
::
$ba£
.'comentarios/listar';

	@gcm/modulos/comentarios/modelos/comentarios_dbo.php

1 <?
php


20 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/databoundobject/lib/Crud.php');

24 
ªquúe_⁄˚
(
GCM_DIR
.'modulos/admin/modelos/usuarios.php');

32 ˛as†
	cComíèrios_dbo
 
exãnds
 
	mCrud
 {

34 
fun˘i⁄
 
	$__c⁄°ru˘
(
PDO
 
$objPdo
, 
$id
 = 
NULL
) {

36 
globÆ
 
$gcm
;

38 
∑ª¡
::
	`__c⁄°ru˘
(
$objPdo
, 
$id
);

40 
$this
->
uæ_ajax
 = '&formato=ajax';

42 
$this
->
sql_li°ado
 = 'SELECT c.id, c.fecha_creacion `fecha creaci√≥n`,

43 
c
.
uæ
, c.
c⁄ãnido
 ,

44 
c
.
nombª
, c.
maû
, c.
comíèrio


45 
FROM
 '.$gcm->sufijo.'
comíèrios
 
c
';

47 
$this
->
›ci⁄es_¨øy2èbÀ
 = 
	`¨øy
(

48 '›' => 
	`¨øy
 (

49 'ocu…¨_id'=>
TRUE


52 , 'íœ˚s'=> 
	`¨øy
(

53 'uæ' => 
	`¨øy
(

56 ,'ba£_uæ'=>
Rouãr
::
$ba£


64 
fun˘i⁄
 
	$DeföeTabÀName
() {

65 
globÆ
 
$gcm
;

66 (
$gcm
->
sufijo
.'comentarios');

67 
	}
}

	@gcm/modulos/contenidos/config/config.php

1 <?
php


6 
	g$c⁄fig
['sistema'] = 'Files';

7 
	g$c⁄fig
['descartar'][] = 'gdoxygen';

	@gcm/modulos/contenidos/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['descartar'] = 'Si unárchivo o carpeta contiene uno deÜos contenidosá descartarÇo se indexara';

	@gcm/modulos/contenidos/eventos_admin.php

1 <?
php


13 
	g$evítos
['guardar_como_borrador']['guardar'][10]='';

16 
	g$evítos
['postguardar_como_borrador']['enrutar'][100]='';

22 
	g$evítos
['publicar_borrador']['ejecutar_mover'][1]='';

25 
	g$evítos
['postpublicar_borrador']['enrutar'][100]='';

28 
	g$evítos
['actualizar_contenido']['guardar'][1]='';

31 
	g$evítos
['postactualizar_contenido']['enrutar'][100]='';

34 
	g$evítos
['borrar']['borrar'][1]='';

37 
	g$evítos
['ejecutar_borrar']['ejecutar_borrar'][1]='';

40 
	g$evítos
['postejecutar_borrar']['enrutar'][100]='';

43 
	g$evítos
['nueva_seccion']['nueva_seccion'][1]='';

46 
	g$evítos
['ejecutar_nueva_seccion']['ejecutar_nueva_seccion'][1]='';

49 
	g$evítos
['postejecutar_nueva_seccion']['enrutar'][100]='';

55 
	g$evítos
['guardar_como']['guardar_como'][1]='';

61 
	g$evítos
['vertodo']['vertodo'][1]='';

64 
	g$evítos
['traducir']['editar'][1]='';

67 
	g$evítos
['ejecutar_traducir']['guardar'][1]='';

70 
	g$evítos
['postejecutar_traducir']['enrutar'][100]='';

73 
	g$evítos
['mover']['mover'][1]='';

76 
	g$evítos
['ejecutar_mover']['ejecutar_mover'][1]='';

79 
	g$evítos
['postejecutar_mover']['enrutar'][100]='';

82 
	g$evítos
['mover_seccion']['mover_seccion'][1]='';

85 
	g$evítos
['ejecutar_mover_seccion']['ejecutar_mover_seccion'][1]='';

88 
	g$evítos
['postejecutar_mover_seccion']['enrutar'][100]='';

91 
	g$evítos
['nuevo']['nuevo'][1]='';

94 
	g$evítos
['ejecutar_nuevo']['guardar'][1]='';

97 
	g$evítos
['postejecutar_nuevo']['enrutar'][100]='';

100 
	g$evítos
['editar_contenido']['editar'][1]='';

	@gcm/modulos/contenidos/eventos_usuario.php

1 <?
php


10 
	g$evítos
['contenido']['contenido'][1]='';

13 
	g$evítos
['titulo']['titulo'][1]='';

16 
	g$evítos
['titulo_articulo']['titulo_articulo'][1]='';

19 
	g$evítos
['pie_articulo']['pie_articulo'][1]='';

22 
	g$evítos
['contenido_dinamico']['listar_contenido_seccion'][5]='';

25 
	g$evítos
['subcabecera']['camino'][2]='';

28 
	g$evítos
['precarga']['comprobar_permisos'][1]='';

31 
	g$evítos
['contenido_ajax']['contenido_ajax'][1]='';

34 
	g$evítos
['sin_contenido']['sin_contenido'][1]='';

37 
	g$evítos
['sin_seccion']['sin_seccion'][1]='';

	@gcm/modulos/contenidos/lib/ContenidoColeccion.php

1 <?
php


18 i‡–! 
	$deföed
(
GCM_DIR
ËË
	`deföe
('GCM_DIR',
	`dú«me
(
__FILE__
).'/../../../');

25 ˛as†
	cC⁄ãnidoCﬁecci⁄
 
exãnds
 
Modulos
 
im∂emíts
 
Iãøt‹
 {

27 
¥iv©e
 
$ñemítos
 = 
NULL
 ;

29 
fun˘i⁄
 
	$__c⁄°ru˘
() {

31 
$this
->
ñemítos
 = 
	`¨øy
();

33 
∑ª¡
::
	`__c⁄°ru˘
();

37 
public
 
fun˘i⁄
 
	$addIãm
(
$i
){

38 
$this
->
ñemítos
[] = 
$i
;

39 
	}
}

41 
public
 
fun˘i⁄
 
	$ªmoveIãm
(
$i
){

42 
	`un£t
(
$this
->
ñemítos
[
	`¨øy_£¨ch
(
$i
, $this->elementos)]);

43 
	}
}

45 
public
 
fun˘i⁄
 
	$ªwöd
() {

46 
	`ª£t
(
$this
->
ñemítos
);

47 
	}
}

49 
public
 
fun˘i⁄
 
	$cuºít
() {

50  
	`cuºít
(
$this
->
ñemítos
);

51 
	}
}

53 
public
 
fun˘i⁄
 
	$key
() {

54  
	`key
(
$this
->
ñemítos
);

55 
	}
}

57 
public
 
fun˘i⁄
 
	$√xt
() {

58  
	`√xt
(
$this
->
ñemítos
);

59 
	}
}

61 
public
 
fun˘i⁄
 
	$vÆid
() {

62  
$this
->
	`cuºít
(Ë!=
Ál£
;

63 
	}
}

	@gcm/modulos/contenidos/lib/Contenidos.php

1 <?
php


3 
ªquúe
(
dú«me
(
__FILE__
).'/../config/config.php');

5 
ªquúe
('C⁄ãnidos'.
$c⁄fig
['sistema'].'.php');

	@gcm/modulos/contenidos/lib/ContenidosAbstract.php

1 <?
php


18 i‡–
deföed
('GCM_DIR'Ë==
FALSE
 ) 
deföe
('GCM_DIR',
dú«me
(
__FILE__
).'/../../../');

22 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/gcm/lib/GUtil.php');

34 
ab°ø˘
 cœs†
	cC⁄ãnidosAb°ø˘
 
exãnds
 
	mModulos
 {

36 
public
 
	m$desˇπ¨
;

38 
fun˘i⁄
 
	$__c⁄°ru˘
() {

40 
∑ª¡
::
	`__c⁄°ru˘
();

42 
$this
->
desˇπ¨
 = $this->
	`c⁄fig
('descartar');

47 
ab°ø˘
 
fun˘i⁄
 
	`gu¨d¨_c⁄ãnido
(
$uæ
, 
$c⁄ãnido
);

50 
ab°ø˘
 
fun˘i⁄
 
	`gëC⁄ãnido
(
$ruè
);

53 
ab°ø˘
 
fun˘i⁄
 
	`devﬁvî_tôulo
(
$uæ
=
NULL
);

56 
ab°ø˘
 
fun˘i⁄
 
	`vîifiˇr_£cci⁄
(
$uæ
);

59 
ab°ø˘
 
fun˘i⁄
 
	`£cci⁄_m©riz
(
$£cci⁄
);

62 
ab°ø˘
 
fun˘i⁄
 
	`¸ór_nueva_£cci⁄
(
$ruè
);

65 
ab°ø˘
 
fun˘i⁄
 
	`vîifiˇr_c⁄ãnido
(
$ruè
);

68 
ab°ø˘
 
fun˘i⁄
 
	`b‹ør_c⁄ãnido
(
$ruè
);

71 
ab°ø˘
 
fun˘i⁄
 
	`ªnombør_£cci⁄
(
$ruè_‹igí
, 
$ruè_de°öo
);

74 
ab°ø˘
 
fun˘i⁄
 
	`gëFechaA˘uÆizaci⁄
(
$ruè
);

86 
fun˘i⁄
 
	$gu¨d¨_como
(
$e
, 
$¨gs
) {

88 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

90 
globÆ
 
$gcm
;

92 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

94 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

95 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

96 
$gcm
->
tôulo
 = 
	`lôîÆ
('Guardar como',3);

98 
$c⁄ãnido
 = 
$this
->
	`devﬁvî_c⁄ãnido
(
$gcm
->
£Àcci⁄ado
[0]);

99 
$tôulo
 = 
$this
->
	`devﬁvî_tôulo
(
$gcm
->
£Àcci⁄ado
);

101 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_guardar_como.html'));

103 
	}
}

116 
fun˘i⁄
 
	$b‹ør
(
$e
, 
$¨gs
) {

118 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

120 
globÆ
 
$GCM_LG
, 
$gcm
 ;

122 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

124 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

125 
$gcm
->
tôulo
 = 
	`lôîÆ
('ConfirmarÜista de contenidosá borrar');

126 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

133 
$c⁄ãnidos_b‹ør
 = 
$this
->
	`£cci⁄_m©riz
(
$gcm
->
£Àcci⁄ado
);

135 i‡–
	`em±y
(
$c⁄ãnidos_b‹ør
) ) {

137 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'NoÉxiste contenido seleccionadoÖara borrar','AVISO');

138  
FALSE
;

141 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_borrar.html'));

143 
	}
}

154 
fun˘i⁄
 
	$edô¨
(
$e
, 
$¨gs
) {

156 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

158 
globÆ
 
$gcm
;

160 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

162 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

164 
$c⁄ãnido
 = 
$this
->
	`devﬁvî_c⁄ãnido
();

166 
$e
) {

169 
$tôulo
 = 
$this
->
	`devﬁvî_tôulo
();

170 
$evíto
 = 'ejecutar_traducir';

171 
$bŸ⁄
 = 'Traducir';

174 
$evíto
 = 'actualizar_contenido';

175 
$bŸ⁄
 = 'Guardar';

179 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_editar.html'));

181 
	}
}

196 
fun˘i⁄
 
	$movî
(
$e
, 
$¨gs
) {

198 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

200 
globÆ
 
$gcm
;

202 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

204 
$c⁄ãnido
 = 
$this
->
	`devﬁvî_c⁄ãnido
(
$gcm
->
£Àcci⁄ado
[0]);

206 
$tôulo
 = 
$this
->
	`devﬁvî_tôulo
(
$gcm
->
£Àcci⁄ado
[0]);

208 
$gcm
->
rouãr
->
	`öicü
($gcm->
£Àcci⁄ado
[0]);

210 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

211 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

212 
$gcm
->
tôulo
 = 
$tôulo
;

214 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_mover.html'));

216 
	}
}

227 
fun˘i⁄
 
	$nuevo
(
$e
, 
$¨gs
) {

229 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

231 
globÆ
 
$gcm
;

233 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

235 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

237 
$tôulo
 = '';

238 
$c⁄ãnido
 = '';

240 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_nuevo.html'));

242 
	}
}

251 
fun˘i⁄
 
	$c⁄ãnido
(
$e
, 
$¨gs
) {

253 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

255 
globÆ
 
$gcm
;

259 i‡–
Rouãr
::
$sö_åaducci⁄
 ) {

260 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('ContenidoÖendiente deÅraducci√≥n',3),'AVISO');

263 
$c⁄ãnido
 = 
$this
->
	`devﬁvî_c⁄ãnido
(
Rouãr
::
$f
);

267 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

269 
$ba£
 = 
	`dú«me
(
Rouãr
::
$uæ
).'/';

271 
$buf„r
 = 
$c⁄ãnido
;

273 
$∑å⁄
 = '/src=["\'](.*?)["\']/';

274 
$su°ôuci⁄
 = '§c="'.
$ba£
.'${1}"';

275 
$buf„r
 = 
	`¥eg_ª∂a˚
(
$∑å⁄
, 
$su°ôuci⁄
, $buf„r,-1,
$numîo
);

277 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'ËNumîÿdêsu°ôuci⁄es: '.
$numîo
 );

278 
$gcm
->
c⁄ãnido
=
$buf„r
;

281 
echo
 
$c⁄ãnido
;

284 
	}
}

293 
fun˘i⁄
 
	$sö_c⁄ãnido
(
$e
, 
$¨gs
) {

295 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

297 
globÆ
 
$gcm
;

299 
$gcm
->
tôulo
 = 
	`lôîÆ
('Sin Contenido',3);

301 
$ruè
 = 
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('temas','html','sin_contenido.html');

303 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('C⁄ãnido').' ['.
Rouãr
::
$s
.Rouãr::
$c
.'] '.literal('noÉncontrado',3),'ERROR');

306 i‡–
$ruè
 ) {

307 
	`ö˛ude
(
$ruè
);

309 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('ContenidoÇoÉncontrado',3),'AVISO');

312 
	}
}

321 
fun˘i⁄
 
	$sö_£cci⁄
(
$e
, 
$¨gs
) {

323 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

325 
globÆ
 
$gcm
;

329 i‡–
	`fûe_exi°s
(
Rouãr
::
$dd
) ) {

330 
$gcm
->
tôulo
 = 
	`lôîÆ
('Sin secci√≥n',3);

331 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Secci√≥n',3).' ['.
Rouãr
::
$s
.'] '.literal('noÉncontrada',3),'ERROR');

333 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Cªamo†dúe˘‹iÿ∑ø c⁄ãnido',3).' ['.
Rouãr
::
$dd
.']','ERROR');

334 
	`mkdú_ªcursivo
(
Rouãr
::
$dd
);

339 
$ruè
 = 
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('temas','html','sin_seccion.html');

341 i‡–
$ruè
 ) {

342 
	`ö˛ude
(
$ruè
);

344 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Secci√≥nÇoÉncontrada',3),'AVISO');

347 
	}
}

356 
fun˘i⁄
 
	$tôulo
(
$e
, 
$¨gs
) {

358 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

360 
$this
->
	`tôulo_¨ticulo
();

361 
	}
}

371 
fun˘i⁄
 
	$ˇmöo
(
$e
 , 
$¨gs
=
NULL
) {

373 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

375 
globÆ
 
$gcm
;

378 
$ˇmöo
 = 
	`ex∂ode
('/',
Rouãr
::
$s
);

380 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','camino.html'));

382 
	}
}

394 
fun˘i⁄
 
	$nueva_£cci⁄
(
$e
, 
$¨gs
) {

396 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

398 
globÆ
 
$gcm
;

400 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

402 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

403 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

404 
$gcm
->
tôulo
 = 
	`lôîÆ
('Nueva secci√≥n');

406 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_nueva_seccion.html'));

408 
	}
}

420 
fun˘i⁄
 
	$movî_£cci⁄
(
$e
, 
$¨gs
) {

422 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
$¨gs
.')');

424 
globÆ
 
$gcm
;

426 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

428 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

429 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

430 
$gcm
->
tôulo
 = 
	`lôîÆ
('Mover oÑenombrar secci√≥n');

432 
$tôulo_£cci⁄
 = 
	`com¥ob¨_b¨ø
(
	`ba£«me
(
Rouãr
::
$s
),'eliminar');

433 
$tôulo_£cci⁄
 = 
	`lôîÆ
($titulo_seccion);

435 
$£cci⁄_desˇπada
 = 
	`com¥ob¨_b¨ø
(
Rouãr
::
$dd
.
	`°r_ª∂a˚
(
$tôulo_£cci⁄
,'',Rouãr::
$s
));

436 
$£cci⁄_£Àcci⁄ada
 = 
FALSE
;

438 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_mover_seccion.html'));

440 
	}
}

462 
fun˘i⁄
 
	$íruèr
(
$e
, 
$¨gs
) {

464 
globÆ
 
$gcm
;

466 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Eƒuè∏desdêevíto: ['.
$e
.']');

472 i‡–
GCM_DEBUG
 ) {

474 
echo
 '<div cœss="aviso">Eƒuè∏desdêevíto: ['.
$e
.'] DesdêdebugÇÿíruèmo†<®hªf="'.
Rouãr
::
$dú
.Rouãr::
$uæ
.'?mís='.
$gcm
->
ªg
->
£si⁄
.'">[enrutar]</a></div>';

479 
$e
) {

483 
$uæ
 = 
Rouãr
::
$s
.Rouãr::
$c
;

487  ! 
	`fûe_exi°s
(
$uæ
) ) {

488 i‡–
$uæ
 == '' || $url == '/' ) {

489 
$uæ
=
Rouãr
::
$s
;

492 
$£cs
 = 
	`ex∂ode
('/',
$uæ
);

493 i‡–
	`is£t
(
$£cs
[
	`cou¡
($secs)-1]) ) {

494 
	`un£t
(
$£cs
[
	`cou¡
($secs)-1]);

496 
$uæ
 = 
Rouãr
::
$s
;

499 
$uæ
 = 
	`im∂ode
('/',
$£cs
);

502 
$uæ
 = 
	`°r_ª∂a˚
(
Rouãr
::
$d
,'',$url);

504 
$gcm
->
rouãr
->
	`öicü
(
$uæ
);

506 
	`hódî
 ("Loˇti⁄:".
Rouãr
::
$dú
.Rouãr::
$uæ
);

507 
	`exô
();

511 
	`hódî
 ("Loˇti⁄:".
Rouãr
::
$dú
.Rouãr::
$uæ
);

512 
	`exô
();

516 
	}
}

526 
fun˘i⁄
 
	$gu¨d¨
(
$e
, 
$¨gs
) {

528 
globÆ
 
$gcm
;

530 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).')');

532 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

534 
$c⁄ãnido
 = 
$_POST
['areaTexto'];

536 
$e
) {

541 
$this
->
	`¸ór_nueva_£cci⁄
(
Rouãr
::
$d
.Rouãr::
$s
);

543 
$tôulo
 = 
$_POST
['titulo'];

544 
$nombª_c⁄ãnido
 = 
$this
->
	`devﬁvî_tôulo
();

545 
$de°öo
 = 
Rouãr
::
$d
.Rouãr::
$s
.
$nombª_c⁄ãnido
;

546 i‡–
	`sub°r_cou¡
(
$de°öo
,".html") == 0) $destino .= ".html";

547 
$mís
 = 
	`lôîÆ
('ContenidoÅraducido',3);

552 
$tôulo
 = 
$_POST
['titulo'];

553 
$nombª_c⁄ãnido
 = 
GUtû
::
	`ãxt›œno
(
$tôulo
);

554 
$c⁄ãnido
 = 
$_POST
['areaTexto'];

555 
$de°öo
 = 
$gcm
->
£Àcci⁄ado
[0].'/'.
$nombª_c⁄ãnido
;

556 i‡–
	`sub°r_cou¡
(
$de°öo
,".html"Ë=0Ë$de°öÿ
	`°r_ª∂a˚
('.html','',$destino);

557 i‡–
	`sub°r_cou¡
(
$de°öo
,".btml") == 0) $destino .= ".btml";

558 
$mís
 = 
	`lôîÆ
('Borradorá√±adido',3);

563 
$tôulo
 = 
$_POST
['titulo'];

564 
$nombª_c⁄ãnido
 = 
GUtû
::
	`ãxt›œno
(
$_POST
['titulo']);

565 
$de°öo
 = 
$_POST
['£Àcci⁄ado'][0].'/'.
$nombª_c⁄ãnido
;

566 i‡–
	`sub°r_cou¡
(
$de°öo
,".html") == 0) $destino .= ".html";

570 i‡–
$this
->
	`vîifiˇr_c⁄ãnido
(
$de°öo
) ) {

571 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
(

573 .' '.
	`lôîÆ
('Se debe cambiarÉlÇombre')

575 
$this
->
	`exi°e_c⁄ãnido
(
$c⁄ãnido
, 
$tôulo
);

576  
FALSE
;

578 
$mís
 = 
	`lôîÆ
('Contenidoá√±adido',3);

583 
$de°öo
 = 
$gcm
->
£Àcci⁄ado
[0];

584 
$mís
 = 
	`lôîÆ
('Contenidoáctualizado',3);

589 
$de°öo
 = 
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$d
.Rouãr::
$uæ
;

590 i‡–
	`sub°r_cou¡
(
$de°öo
,".html") == 0) $destino .= ".html";

591 
$mís
 = 
	`lôîÆ
('Contenido guardado',3);

596 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

597 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

598 
$gcm
->
tôulo
 = ( 
	`is£t
(
$tôulo
ËË? 
	`°rù¶ashes
($tôuloË: 
	`lôîÆ
('Guardar contenido',3);

599 
$gcm
->
c⁄ãnido
 = 
	`°rù¶ashes
(
$c⁄ãnido
);

601 i‡–! 
$this
->
	`gu¨d¨_c⁄ãnido
(
$de°öo
, 
$c⁄ãnido
) ) {

603 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

604 
	`lôîÆ
('Eº‹').' '.lôîÆ('gu¨d™dÿc⁄ãnido').': '.
$de°öo
,'ERROR');

605  
FALSE
;

607 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

611 i‡–
	`is£t
(
$tôulo
Ë&& !
	`em±y
($tôuloË&& is£t(
$nombª_c⁄ãnido
) ) {

612 
	`lôîÆ
(
$nombª_c⁄ãnido
,1,
$tôulo
);

617 
$gcm
->
rouãr
->
	`öicü
(
$de°öo
);

619 
	}
}

634 
fun˘i⁄
 
	$exi°e_c⁄ãnido
(
$c⁄ãnido
, 
$tôulo
){

636 
globÆ
 
$gcm
;

638 
$c⁄ãnido
 = 
	`limpürC⁄ãnido
($contenido);

640 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

641 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

642 
$gcm
->
tôulo
 = 
$tôulo
;

644 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','form_nuevo.html'));

647 
	}
}

658 
fun˘i⁄
 
	$vîtodo
(
$e
, 
$¨gs
=
NULL
) {

660 
globÆ
 
$gcm
;

662 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

663 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

664 
$gcm
->
tôulo
 = 
	`lôîÆ
('Listado completo de contenido',3);

666 
$∑th
 = "File";

667 
$acci⁄
 = "editar_doc";

668 
$∑th_£Àcci⁄ado
 = 
Rouãr
::
$d
.Rouãr::
$s
;

670 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','vertodo.html'));

672 
	}
}

681 
fun˘i⁄
 
	$ejecuèr_movî
(
$e
, 
$¨gs
=
NULL
) {

683 
globÆ
 
$gcm
;

685 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

687 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).')');

689 
$e
) {

693 
$‹igí
 = 
Rouãr
::
$f
;

694 
$de°öo
 = 
	`°r_ª∂a˚
('.btml','.html',
$‹igí
);

695 
$tôulo_c⁄ãnido
 = 
	`°r_ª∂a˚
('.btml','',
Rouãr
::
$c
);

696 
$mís
 = 
	`lôîÆ
('BorradorÖublicado',3);

701 
$‹igí
 = 
$_POST
['origen'];

702 
$tôulo
 = 
$_POST
['titulo'];

703 
$tôulo_c⁄ãnido
 = 
GUtû
::
	`ãxt›œno
(
$_POST
['titulo']);

704 
$de°öo
 = 
$gcm
->
£Àcci⁄ado
[0].'/'.
$tôulo_c⁄ãnido
;

705 i‡–
	`sub°r_cou¡
(
$de°öo
,".html") == 0) $destino .= ".html";

706 
$mís
 = 
	`lôîÆ
('ContenidoÑenombrado o movido',3);

710 i‡–
$this
->
	`movî_c⁄ãnido
(
$‹igí
, 
$de°öo
) ) {

711 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

712 
	`lôîÆ
(
$tôulo_c⁄ãnido
,1,
$tôulo
);

713 
$gcm
->
mem‹ü
['de°öo'] = 
$de°öo
;

714 
$gcm
->
mem‹ü
['‹igí'] = 
$‹igí
;

715 
$gcm
->
mem‹ü
['tôulo_c⁄ãnido'] = 
$tôulo_c⁄ãnido
;

716 
$gcm
->
rouãr
->
	`öicü
(
$de°öo
);

718  
FALSE
;

721 
	}
}

733 
fun˘i⁄
 
	$ejecuèr_movî_£cci⁄
(
$e
, 
$¨gs
=
NULL
) {

735 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).')');

737 
globÆ
 
$gcm
;

739 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

741 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

742 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

743 
$gcm
->
tôulo
 = 
	`lôîÆ
('Renombrando o moviendo secci√≥n',3);

745 i‡–
	`cou¡
(
$gcm
->
£Àcci⁄ado
) > 1 ) {

746 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Solo seÖuede seleccionar una secci√≥n, cogemosÜaÖrimera como v√°lida','AVISO');

749 
$lôîÆ
 = 
$_POST
['titulo_seccion'];

750 
$nombª_£cci⁄
 = 
GUtû
::
	`ãxt›œno
(
$lôîÆ
);

751 
$£cci⁄_nueva
 = ( 
$gcm
->
£Àcci⁄ado
[0] ) ? $gcm->£Àcci⁄ado[0] : 
Rouãr
::
$dd
.Rouãr::
$s
;

752 
$£cci⁄_nueva
 = 
	`com¥ob¨_b¨ø
($£cci⁄_nueva).
$nombª_£cci⁄
;

753 
$ruè_‹igí
 = 
Rouãr
::
$dd
.Rouãr::
$s
;

754 
$gcm
->
mem‹ü
['£cci⁄_movida'] = 
Rouãr
::
$s
;

756 i‡–
$this
->
	`ªnombør_£cci⁄
(
$ruè_‹igí
,
$£cci⁄_nueva
) ) {

757 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Cambio deÇombreÑealizado','AVISO');

758 
	`lôîÆ
(
$nombª_£cci⁄
,1,
$lôîÆ
);

760 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'ErrorálÑenombrar secci√≥n','ERROR');

761  
FALSE
;

764 
$gcm
->
rouãr
->
	`öicü
(
$£cci⁄_nueva
);

766 
	}
}

775 
fun˘i⁄
 
	$ejecuèr_nueva_£cci⁄
(
$e
, 
$¨gs
=
NULL
) {

777 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).')');

779 
globÆ
 
$gcm
;

781 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

783 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

784 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

785 
$gcm
->
tôulo
 = 
	`lôîÆ
('Nueva secci√≥n');

787 
$£cci⁄_madª
 = 
$gcm
->
£Àcci⁄ado
[0];

788 
$£cci⁄_nueva
 = 
GUtû
::
	`ãxt›œno
(
$_POST
['titulo_seccion']);

789 
$lôîÆ_nuevo
 = 
$_POST
['titulo_seccion'];

790 
$ruè_nueva_£cci⁄
 = 
	`com¥ob¨_b¨ø
(
$£cci⁄_madª
).
$£cci⁄_nueva
;

792 i‡–
$this
->
	`¸ór_nueva_£cci⁄
(
$ruè_nueva_£cci⁄
) ) {

793 
$mís
="Nuev®£cci√≥¿¸ód®[".
	`lôîÆ
(
$£cci⁄_nueva
,1,
$lôîÆ_nuevo
).']';

794 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
,'AVISO');

795 
$gcm
->
rouãr
->
	`öicü
(
$ruè_nueva_£cci⁄
);

797  
FALSE
;

800 
	}
}

811 
fun˘i⁄
 
	$ejecuèr_b‹ør
(
$e
, 
$¨gs
=
NULL
) {

813 
globÆ
 
$gcm
;

815 
	`≥rmiso
('edô¨_c⁄ãnido',
TRUE
);

817 
$gcm
->
evít
->
	`™uœr
('contenido','contenidos');

818 
$gcm
->
evít
->
	`™uœr
('titulo','contenidos');

819 
$gcm
->
tôulo
 = 
	`lôîÆ
('Borrado de contenido',3);

821 
	`f‹óch
 ( 
$gcm
->
£Àcci⁄ado
 
as
 
$ôem
 ) {

823 i‡–
	`is_dú
(
$ôem
) ) {

825 i‡–!
$this
->
	`ñimö¨Dúe˘‹io
(
$ôem
) ) {

826 
	`åiggî_îr‹
(
	`lôîÆ
('Dúe˘‹io').': '.
$ôem
.' '.lôîÆ('Nÿ£Öudÿb‹ør'), 
E_USER_ERROR
);

835 i‡–!
$this
->
	`vîifiˇr_c⁄ãnido
(
$ôem
Ë|| !$this->
	`b‹ør_c⁄ãnido
($item) ) {

836 i‡–
	`cou¡
(
$gcm
->
£Àcci⁄ado
Ë=1 && !
$this
->
	`vîifiˇr_c⁄ãnido
(
$ôem
) ) {

837 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
("NoÉxiste contenidoá borrar",3),'AVISO');

844 
	`¨øy_li°a
(
$gcm
->
£Àcci⁄ado
,
NULL
,
FALSE
);

845 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
("Contenido borrado",3),'AVISO');

846 
	}
}

855 
fun˘i⁄
 
	$devﬁvî_c⁄ãnido
(
$uæ
=
NULL
) {

857 
globÆ
 
$gcm
;

859 
$uæ
 = ( $uæ ) ? $uæ : 
Rouãr
::
$f
;

863 i‡–! 
$this
->
	`vîifiˇr_£cci⁄
(
Rouãr
::
$dd
.Rouãr::
$s
) ) {

864 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$uæ
.') NoÉxisteÉl documentoÜanzamosÉvento sincontenido');

865 
$gcm
->
evít
->
	`œnz¨Evíto
('sin_seccion');

866  
FALSE
;

871 i‡–
Rouãr
::
$c
 && Rouãr::$¯!'ödex.html' && ! 
$this
->
	`vîifiˇr_c⁄ãnido
(Rouãr::
$dd
.Rouãr::
$s
.Router::$c) ) {

872 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$uæ
.') NoÉxisteÉl documentoÜanzamosÉvento sincontenido');

873 
$gcm
->
evít
->
	`œnz¨Evíto
('sin_contenido');

874  
FALSE
;

880 i‡–
$this
->
	`vîifiˇr_c⁄ãnido
(
$uæ
) ) {

882  
$this
->
	`gëC⁄ãnido
(
$uæ
);

884 } 
	`ñ£if
 ( 
Rouãr
::
$c
 == 'index.html' ) {

886 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$uæ
.') EstamosÉn uns secci√≥n sin index.html,Üanzamos contenido_dinamico');

887 
$gcm
->
evít
->
	`œnz¨Evíto
('contenido_dinamico');

891 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$uæ
.') NoÉxiste fichero ['.$url.']');

892  
FALSE
;

896 
	}
}

902 
fun˘i⁄
 
	$tôulo_¨ticulo
() {

904 
globÆ
 
$gcm
;

906 
$esB‹ød‹
 = 
FALSE
;

908 i‡–
Rouãr
::
$c
 == 'index.html' || ! Router::$c ) {

909 
$tôulo
=
Rouãr
::
$e°amos
;

912 i‡–
	`°rùos
(
Rouãr
::
$c
,'.html') ) {

913 
$tôulo
=
	`°r_ª∂a˚
('.html','',
Rouãr
::
$c
);

914 } 
	`ñ£if
 ( 
	`°rùos
(
Rouãr
::
$c
,'.btml') ) {

915 
$tôulo
=
	`°r_ª∂a˚
('.btml','',
Rouãr
::
$c
);

918 
åy
 {

919 i‡(
$this
->
	`vîifiˇr_c⁄ãnido
(
Rouãr
::
$f
Ë!=
FALSE
) {

920 
$„cha
 = 
	`¥e£¡¨Fecha
(
$this
->
	`gëFechaA˘uÆizaci⁄
(
Rouãr
::
$f
),1,'unix');

922 
throw
 
√w
 
	`Ex˚±i⁄
('E»c⁄ãndÿnÿexi°ê[ '.
Rouãr
::
$f
.' ]');

924 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

925 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Öudÿªcogî fecha: '.
$ex
->
	`gëMesßge
(),'ADMIN');

929 
$tôulo
 = ( 
	`is£t
($tôuloËË? 
	`lôîÆ
($tôulo,1Ë: 
NULL
;

931 i‡–
$gcm
->
au
->
	`logódo
() ) {

933 i‡–
Rouãr
::
$esB‹ød‹
 ) 
$tôulo
 = '<bÅôÀ="'.
	`lôîÆ
('Borrador').'">(B)</b> '.$titulo;

937 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../html/titulo_articulo.html');

939 
	}
}

	@gcm/modulos/contenidos/lib/ContenidosFiles.php

1 <?
php


18 i‡–
deföed
('GCM_DIR'Ë==
FALSE
 ) 
deföe
('GCM_DIR',
dú«me
(
__FILE__
).'/../../../');

22 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/ContenidosAbstract.php');

34 ˛as†
	cC⁄ãnidos
 
exãnds
 
	mC⁄ãnidosAb°ø˘
 {

42 
¥iv©e
 
	m$fûåo_£cci⁄es
 = 
¨øy
('thumbnail');

44 
fun˘i⁄
 
	$__c⁄°ru˘
() {

46 
∑ª¡
::
	`__c⁄°ru˘
();

57 
fun˘i⁄
 
	$movî_c⁄ãnido
(
$‹igí
, 
$de°öo
) {

58 
globÆ
 
$gcm
;

59 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$‹igí
.','.
$de°öo
.')');

60 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','movî_c⁄ãnido',
$‹igí
);

61  
	`ª«me
(
$‹igí
, 
$de°öo
);

62 
	}
}

70 
fun˘i⁄
 
	$com¥ob¨_≥rmisos
(
$e
, 
$¨gs
) {

74 i‡–
	`°Ωos
(
Rouãr
::
$c
,'.btml'ËË
	`≥rmiso
('editar_contenido');

76 
	}
}

84 
fun˘i⁄
 
	$¸ór_nueva_£cci⁄
(
$ruè
) {

86 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$ruè
.')');

88  
	`mkdú_ªcursivo
(
$ruè
);

90 
	}
}

98 
fun˘i⁄
 
	$b‹ør_c⁄ãnido
(
$ruè
) {

99 
globÆ
 
$gcm
;

100 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','b‹ør_c⁄ãnido',
$ruè
);

101  
	`u∆ök
(
$ruè
);

102 
	}
}

110 
fun˘i⁄
 
	$vîifiˇr_c⁄ãnido
(
$ruè
) {

111 i‡–
	`fûe_exi°s
(
$ruè
ËË{  
TRUE
; }

112 i‡–
	`fûe_exi°s
(
Rouãr
::
$d
.
$ruè
ËË{  
TRUE
; }

113  
FALSE
;

114 
	}
}

122 
fun˘i⁄
 
	$vîifiˇr_£cci⁄
(
$ruè
) {

123 i‡–
	`fûe_exi°s
(
$ruè
ËË{  
TRUE
; }

124 i‡–
	`fûe_exi°s
(
Rouãr
::
$d
.
$ruè
ËË{  
TRUE
; }

125  
FALSE
;

126 
	}
}

134 
fun˘i⁄
 
	$gëC⁄ãnido
(
$ruè
) {

135  
	`fûe_gë_c⁄ã¡s
(
$ruè
);

136 
	}
}

159 
fun˘i⁄
 
	$£cci⁄_m©riz
(
$c⁄ãnido
) {

161 
globÆ
 
$gcm
;

163 
$c⁄ãnidos
 = 
	`¨øy
();

165 
$idiomaXde„˘o
 = 
FALSE
;

167 i‡–
$c⁄ãnido
 == "" ) {

168 
	`ªgi°ør
(
__FILE__
,
__LINE__


175 i‡–!
	`is_¨øy
(
$c⁄ãnido
) ) {

176 
$c⁄ãnido
 = 
	`¨øy
($contenido);

179 
	`f‹óch
 ( 
$c⁄ãnido
 
as
 
$dú
 ) {

181 
$dú
 = 
	`°rù¶ashes
($dir);

182 
$desglo£
 = 
Rouãr
::
	`desgloßrUæ
(
$dú
);

183 
$idioma
 = 
$desglo£
['i'];

184 i‡–
$idioma
 =
Rouãr
::
$ii
 ) 
$idiomaXde„˘o
 = 
TRUE
;

186 i‡(
	`fûe_exi°s
(
$dú
)) {

188 i‡–
	`is_dú
(
$dú
) ) {

189 
$c⁄ãnidos
[
$idioma
][
$dú
]=
	`dú_¨øy
($dir);

191 
$c⁄ãnidos
[
$idioma
][
$dú
]=$dir;

194 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Nÿexi°êc⁄ãnidÿ[ ".
$dú
." ]",'ADMIN');

197 i‡–
$idiomaXde„˘o
 ) {

199 
$todosLosIdiomas
 = 
	`glob
('File/*');

202 
	`f‹óch
 (
$todosLosIdiomas
 
as
 
$ôem
 => 
$ˇΩëa_idioma
) {

204 
$Ÿro_idioma
 = 
	`°r_ª∂a˚
('Fûe/','',
$ˇΩëa_idioma
);

207 
$dú_Ÿros_idiomas
 = 
	`°r_ª∂a˚
("Fûe/".
Rouãr
::
$ii
, 
$ˇΩëa_idioma
, 
$dú
);

209 i‡(
	`fûe_exi°s
(
$dú_Ÿros_idiomas
)) {

211 i‡–
	`is_dú
(
$dú_Ÿros_idiomas
) ) {

212 
$c⁄ãnidos
[
$Ÿro_idioma
][
$dú_Ÿros_idiomas
]=
	`dú_¨øy
($dir_otros_idiomas);

214 
$c⁄ãnidos
[
$Ÿro_idioma
][
$dú_Ÿros_idiomas
]=$dir_otros_idiomas;

222  
$c⁄ãnidos
;

223 
	}
}

233 
fun˘i⁄
 
	$devﬁvî_tôulo
(
$uæ
=
NULL
) {

235 
globÆ
 
$gcm
;

237 
$uæ
 = ( $uæ ) ? $uæ : 
Rouãr
::
$f
;

239 i‡–
	`is_fûe
(
$uæ
) ) {

240 
$uæs
 = 
	`ex∂ode
('/',
$uæ
);

241 
$tôulo
 = 
	`íd
(
$uæs
);

242 
$tôulo
 = 
	`°r_ª∂a˚
('.html','',$titulo);

243  
$tôulo
;

245  
FALSE
;

248 
	}
}

283 
fun˘i⁄
 
	$mo°ørSecci⁄es
(
$∑th
, 
$∑th_visibÀ
=
FALSE
, 
$vîDocumítos
=FALSE, 
$£Àcci⁄abÀ
=
TRUE
,

284 
$fûåo
=
FALSE
, 
$ªcursivo
=
TRUE
, 
$checkqued
=
NULL
, 
$mu…ùÀ
=TRUE, 
$ocu…¨
 = FALSE) {

286 
globÆ
 
$gcm
;

289 i‡–!
	`≥rmiso
('edô¨_c⁄ãnido'ËË
$£Àcci⁄abÀ
 = 
FALSE
;

294 
$ôems_a_desˇπ¨
 = 
$this
->
desˇπ¨
 ;

295 i‡–
$ocu…¨
 ) 
$ôems_a_desˇπ¨
[] = $ocultar;

297 i‡–(
$ôems_a_desˇπ¨
) ) {

299 
$desˇπ¨
 = 
FALSE
;

300 
	`f‹óch
 ( 
$ôems_a_desˇπ¨
 
as
 
$desˇπado
 ) {

301 i‡–
	`°Ωos
(
$∑th
,
$desˇπado
Ë!=
FALSE
 ) {

302 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$∑th
. ' coöcidêc⁄ '.
$desˇπado
);

303 
$desˇπ¨
 = 
TRUE
;

306 
	`f‹óch
 ( 
$this
->
fûåo_£cci⁄es
 
as
 
$desˇπado
 ) {

307 i‡–
	`°Ωos
(
$∑th
,
$desˇπado
Ë!=
FALSE
 ) {

308 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$∑th
. ' coöcidêc⁄ '.
$desˇπado
);

309 
$desˇπ¨
 = 
TRUE
;

313 i‡–
$desˇπ¨
 ) {

318 i‡–
$ocu…¨
 ) $ocu…¨ = 
	`com¥ob¨_b¨ø
($ocultar,'eliminar');

319 
$∑th
 = 
	`com¥ob¨_b¨ø
($path,'eliminar');

320 
$nombª_ˇmpo
 = 'seleccionado[]';

322 i‡–
$mu…ùÀ
 ) {

323 
$tùo_ˇmpo
 = 'checkbox';

325 
$tùo_ˇmpo
 = 'radio';

329 i‡–
$checkqued
 ) {

330 
$checkqued
 = 
	`com¥ob¨_b¨ø
($checkqued,'eliminar');

333 
$vî
='NO';

335 
$dú_p‹_de„˘o
='Fûe/'.
Rouãr
::
$ii
;

336 
$d
 = 
	`dú
(
$∑th
);

337 
$HAY
="NO";

338 
$sub£cci⁄es
 = 
	`¨øy
();

339 
$documítos
 = 
	`¨øy
();

340 
$íåy
=
$d
->
	`ªad
()) {

342 i‡(
	`is_dú
(
$∑th
."/".
$íåy
) && $entry{0} != "." ) {

343 
$HAY
="SI";

344 
$sub£cci⁄es
[]=
$∑th
."/".
$íåy
;

345 } 
	`ñ£if
 ( 
$vîDocumítos
 && 
$íåy
{0} != "." ) {

346 
$documítos
[
$∑th
][]=
$íåy
;

350 
$d
->
	`˛o£
();

353 i‡–
$∑th_visibÀ
 ) {

354 
$∑th1
 = 
	`ex∂ode
('/',
$d
->
∑th
);

355 
$∑th2
 = 
	`ex∂ode
('/',
$∑th_visibÀ
);

359 i‡–
	`ö_¨øy
(
$∑th1
[
	`cou¡
($∑th1)-1],
$∑th2
) ) {

360 
$vî
='SI';

364 
echo
 "\n<ul>";

367 i‡–
$£Àcci⁄abÀ
 ) {

368 i‡––
$vî
 ='SI' ) || 
$d
->
∑th
 =
$dú_p‹_de„˘o
) {

370 i‡–
$d
->
∑th
 =
$checkqued
 ) {

371 
echo
 " <öpuàcheckedÅy≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' vÆue='", 
	`htmÀ¡ôõs
(
$d
->
∑th
), "' />";

372 } 
	`ñ£if
 ( 
$d
->
∑th
 =
$ocu…¨
 ) {

373 
echo
 "Descartado";

375 
echo
 " <öpuàty≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' vÆue='", 
	`htmÀ¡ôõs
(
$d
->
∑th
), "' />";

379 
echo
 " <öpuàty≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' vÆue='", 
	`htmÀ¡ôõs
(
$d
->
∑th
), "' />";

383 
echo
 " <öpuàty≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' vÆue='", 
	`htmÀ¡ôõs
(
$d
->
∑th
), "' />";

387 i‡–
$HAY
 ="SI" || 
$vîDocumítos
) {

388 
echo
 "<®hªf='#' cœss='öãºog™ã' on˛ick=\"visuÆiz¨('",
	`htmÀ¡ôõs
(
$d
->
∑th
),"');Ñeturn false;\" >";

389 
echo
 
	`ba£«me
(
$d
->
∑th
);

390 
echo
 "</a>";

392 
echo
 
	`ba£«me
(
$d
->
∑th
);

394 i‡––
$vî
 ='SI' ) || 
$d
->
∑th
 =
$dú_p‹_de„˘o
 ) {

395 
echo
 "<div id='",
$d
->
∑th
,"' class='toggle'>";

397 
echo
 "<div id='",
$d
->
∑th
,"' class='toggle' style='display:Çone' >";

401 i‡–
$vîDocumítos
 ) {

402 i‡–! 
	`em±y
(
$documítos
[
$d
->
∑th
]Ë&& 
	`cou¡
($documentos[$d->path]) > 0 ) {

403 
	`f‹óch
–
$documítos
[
$d
->
∑th
] 
as
 
$doc
 ) {

404 
echo
 '<li>';

405 i‡–
GUtû
::
	`tùo_de_¨chivo
(
$d
->
∑th
.'/'.
$doc
) == 'text/html' ) {

406 
echo
 '<span class="datos_fichero_html">';

408 
echo
 '<span class="datos_fichero">';

410 i‡–
$£Àcci⁄abÀ
 ) {

411 
echo
 "<öpuàty≥='".
$tùo_ˇmpo
."'Çame='".
$nombª_ˇmpo
."' ";

412 
echo
 'vÆue="'.
	`htmÀ¡ôõs
(
$d
->
∑th
."/".
$doc
).'" />';

416 i‡–
	`esImagí
(
$d
->
∑th
.'/'.
$doc
) ) {

417 
echo
 "<imgálign='˚¡î' width='50px' src='".
	`htmÀ¡ôõs
(
$d
->
∑th
."/".
$doc
)."' />";

419 
echo
 '<®tôÀ="'.
	`lôîÆ
('VisuÆiz¨').'" hªf="?edôÚo&uæ='.
	`htmÀ¡ôõs
(
$d
->
∑th
.'/'.
$doc
).'">';

420 
echo
 
$doc
;

421 
echo
 "</a>";

423 i‡–
	`≥rmiso
('edô¨_c⁄ãnido'Ë&& 
GUtû
::
	`tùo_de_¨chivo
(
$d
->
∑th
.'/'.
$doc
) == 'text/html' ) {

424 
echo
 '<®tôÀ="'.
	`lôîÆ
('Edô¨').'" hªf="?eÛdô¨_c⁄ãnido&uæ='.
	`htmÀ¡ôõs
(
$d
->
∑th
.'/'.
$doc
).'"> [#]</a>';

426 
echo
 '<span class="detalles_fichero">';

427 
echo
 ' ['.
	`¥e£¡¨Byãs
(
	`fûesize
(
$d
->
∑th
.'/'.
$doc
)).', '.
	`¥e£¡¨Fecha
(
	`fûemtime
($d->path.'/'.$doc),2).']';

428 
echo
 '</span>';

429 
echo
 '</span>';

430 
echo
 '</li>';

435 
	`f‹óch
(
$sub£cci⁄es
 
as
 
$x
) {

436 
$this
->
	`mo°ørSecci⁄es
(
$x
, 
$∑th_visibÀ
, 
$vîDocumítos
, 
$£Àcci⁄abÀ
, 
$fûåo
, 
$ªcursivo
, 
$checkqued
, 
$mu…ùÀ
, 
$ocu…¨
);

439 
echo
 "</div>";

440 
echo
 "\n</ul>";

441 
	}
}

453 
fun˘i⁄
 
	$gu¨d¨_c⁄ãnido
(
$fichîo
, 
$c⁄ãnido
){

455 
globÆ
 
$gcm
;

457 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$fichîo
.','.
$c⁄ãnido
.')');

459 
$fich
 = 
$fichîo
;

461 
$c⁄ãnido
 = 
	`limpürC⁄ãnido
($contenido);

462 i‡–! 
$nuevoDoc
 = @
	`f›í
(
$fich
, 'w') ) {

463 
	`ªgi°ør
(
__FILE__
, 
__LINE__
,

464 "Nÿ£ÖuedêabrúÉ»¨chivÿ[".
$fich
."]ÖaraÉscribir

465 
La
 
ˇuß
 
m
√°
s
 
¥obabÀ
 
es
 
que
 
no
 
ãngamos
 
≥rmisos
 
í
 
ñ
 
dúe˘‹io
 
de°öo
.

467 
Com¥ueba
 
los
 
≥rmisos
 
y
 
ªˇrga
 
œ
 
∑göa
 
∑ø
 
podî
 
gu¨d¨
 
ñ
 
c⁄ãnido


469  
FALSE
;

472 i‡–
	`fwrôe
(
$nuevoDoc
, 
$c⁄ãnido
Ë==
FALSE
 ) {

473 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
("Nÿ£Öuedêes¸ibúÉ¿ñárchivo")." [".
$fich
."]",'ERROR');

474  
FALSE
;

477 
	`f˛o£
(
$nuevoDoc
);

479 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
("Fichîÿes¸ôo").' ['.
$fich
.']');

481  
TRUE
;

483 
	}
}

495 
fun˘i⁄
 
	$li°¨_c⁄ãnido_£cci⁄
(
$e
, 
$£cci⁄
=
NULL
) {

497 
globÆ
 
$gcm
;

501 i‡–
$gcm
->
evít
->
	`™uœdo
('contenido') ) {

505 i‡–! 
$£cci⁄
 ) $£cci⁄ = 
Rouãr
::
$dd
.Rouãr::
$s
;

507 
$£cci⁄
 = 
	`com¥ob¨_b¨ø
($seccion);

508 
$d
 = 
	`dú
(
$£cci⁄
);

509 
$sub£cci⁄es
 = 
	`¨øy
();

510 
$documítos
 = 
	`¨øy
();

514 i‡–
Rouãr
::
$s
 != '' ) {

515 
$sub£cci⁄es
[] = '..';

518 
$íåy
=
$d
->
	`ªad
()) {

520 i‡(
	`is_dú
(
$£cci⁄
.
$íåy
) && $entry{0} != "." ) {

521 
$sub£cci⁄es
[]=
$íåy
;

522 } 
	`ñ£if
 ( 
$íåy
{0} !"." && 
GUtû
::
	`tùo_de_¨chivo
($entry) == 'text/html' ) {

523 
$documítos
[]=
$íåy
;

526 
$d
->
	`˛o£
();

528 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('contenidos','html','listar_contenido_seccion.html'));

530 
	}
}

541 
fun˘i⁄
 
	$ªnombør_£cci⁄
(
$ruè_‹igí
, 
$ruè_de°öo
) {

543 
globÆ
 
$gcm
;

544 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','ªnombør_£cci⁄',
$ruè_‹igí
);

546 i‡–
	`ª«me
(
$ruè_‹igí
,
$ruè_de°öo
) ) {

547  
TRUE
;

549  
FALSE
;

551 
	}
}

567 
fun˘i⁄
 
	$ñimö¨Dúe˘‹io
(
$dúe˘‹io
) {

569 
globÆ
 
$gcm
;

571 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ˇche_hâp','b‹ør','ñimö¨Dúe˘‹io',
$dúe˘‹io
);

573  
	`rmdú_ªcursivo
(
$dúe˘‹io
);

575 
	}
}

583 
fun˘i⁄
 
	$gëFechaA˘uÆizaci⁄
(
$ruè
) {

584 
$„cha
 = 
	`fûemtime
(
$ruè
);

585 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Recu≥ø∏„ch®dêc⁄ãnidÿ['.
$ruè
.'] fecha: ['.
$„cha
.']');

586  
$„cha
;

587 
	}
}

	@gcm/modulos/contenidos/menuAdmin.php

1 <?
php


5 i‡–
≥rmiso
('editar_contenido') ) {

9 
	g$míuAdmö
['Contenidos']['boton']['Nuevo']['activado']= 1;

10 
	g$míuAdmö
['Contenidos']['boton']['Nuevo']['title']="CrearÇuevo contenido";

11 
	g$míuAdmö
['Contenidos']['boton']['Nuevo']['link']="?e=nuevo";

13 
	g$míuAdmö
['Contenidos']['boton']['Editar']['activado']= 1;

14 
	g$míuAdmö
['Contenidos']['boton']['Editar']['title']="Editar documentoáctual";

15 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Edô¨']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=editar_contenido";

17 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Tøducú']['a˘ivado'](
Rouãr
::
$sö_åaducci⁄
) ? 1 : 0;

18 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Tøducú']['tôÀ']=
lôîÆ
("Traducir documentoáctual",3);

19 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Tøducú']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=traducir";

21 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['B‹ør']['a˘ivado'] = ( 
is_fûe
–
Rouãr
::
$f
 ) ) ? 1 : 0;

22 
	g$míuAdmö
['Contenidos']['boton']['Borrar']['title']="Borrar documentoáctual";

23 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['B‹ør']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=borrar";

25 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Ríombø∏/ Movî']['a˘ivado']–
is_fûe
(
Rouãr
::
$f
) ) ? 1 : 0;

26 
	g$míuAdmö
['Contenidos']['boton']['Renombrar / Mover']['title']="Mover o cambiarÇombre de contenido";

27 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Ríombø∏/ Movî']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=mover";

29 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Gu¨d¨ como']['a˘ivado']–
is_fûe
–
Rouãr
::
$f
 ) ) ? 1 : 0;

30 
	g$míuAdmö
['Contenidos']['boton']['Guardar como']['title']="Guardar contenido con otroÇombre";

31 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Gu¨d¨ como']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=guardar_como";

33 
	g$míuAdmö
['Contenidos']['boton']['Nueva secci√≥n']['activado']=1;

34 
	g$míuAdmö
['Contenidos']['boton']['Nueva secci√≥n']['title']="Crear unaÇueva secci√≥n";

35 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Nuev®£cci√≥n']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=nueva_seccion";

37 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Ríombø∏£cci√≥n']['a˘ivado']–
Rouãr
::
$s
 ) ? 1 : 0;

38 
	g$míuAdmö
['Contenidos']['boton']['Renombrar secci√≥n']['title']="Renombrar o mover secci√≥náctual";

39 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['Ríombø∏£cci√≥n']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=mover_seccion";

41 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['B‹ø∏£cci√≥n']['a˘ivado']–
Rouãr
::
$s
 ) ? 1 : 0;

42 
	g$míuAdmö
['Contenidos']['boton']['Borrar secci√≥n']['title']="Borrar secci√≥n";

43 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['B‹ø∏£cci√≥n']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=borrar_seccion";

47 
	g$míuAdmö
['Contenidos']['boton']['VerÅodo']['activado']= 1;

48 
	g$míuAdmö
['Contenidos']['boton']['VerÅodo']['title']="Listar contenido";

49 
	g$míuAdmö
['C⁄ãnidos']['bŸ⁄']['VîÅodo']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?e=vertodo";

52 
	g$míuAdmö
['Administraci√≥n']['title']='AdministrarÖroyecto';

53 
	g$míuAdmö
['Configuraci√≥n']['title']='ConfigurarÖroyecto';

54 
	g$míuAdmö
['Seguimiento']['title']='Seguimiento delÖroyecto';

58 
	g$míuAdmö
['Contenidos'] ['peso'] = -10;

59 
	g$míuAdmö
['Administraci√≥n'] ['peso'] = -8;

60 
	g$míuAdmö
['Configuraci√≥n'] ['peso'] = -6;

61 
	g$míuAdmö
['Seguimiento'] ['peso'] = -4;

	@gcm/modulos/contenidos/test/ContenidoTest.php

1 <?
php


3 i‡(!
deföed
("PHPUnit_MAIN_METHOD")) {

4 
deföe
("PHPUnit_MAIN_METHOD", "ContenidoTest::main");

9 i‡–
fûe_exi°s
('/tmp/ã°s'ËË
sy°em
('rm -fr /tmp/tests') ;

11 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestCase.php";

12 
	gªquúe_⁄˚
 "PHPUnit/Framework/TestSuite.php";

14 
	gªquúe_⁄˚
 '../lib/Contenido.php';

20 ˛as†
	cC⁄ãnidoTe°
 
exãnds
 
	mPHPUnô_Fømew‹k_Te°Ca£
 {

22 
public
 
	m$c
 ;

23 
public
 
	m$dú
;

31 
public
 
fun˘i⁄
 
	$maö
() {

32 
ªquúe_⁄˚
 "PHPUnit/TextUI/TestRunner.php";

34 
$suôe
 = 
√w
 
	`PHPUnô_Fømew‹k_Te°Suôe
("ContenidoTest");

35 
$ªsu…
 = 
PHPUnô_TextUI_Te°Ru¬î
::
	`run
(
$suôe
);

44 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£tUp
() {

46 
$this
->
dú
 = '/tmp/tests/';

48 i‡–! 
	`fûe_exi°s
(
$this
->
dú
ËË
	`mkdú
($this->dir);

50 
	`chdú
(
$this
->
dú
);

52 i‡–! 
	`fûe_exi°s
(
$this
->
dú
.'log'ËË
	`mkdú
($this->dir.'log');

54 
$this
->
c
 = 
√w
 
	`C⁄ãnido
();

56 
	}
}

65 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ã¨Down
() {

67 
	}
}

71 
public
 
fun˘i⁄
 
	$ã°NuevaSecci⁄
() {

73 
$this
->
	`as£πTrue
($this->
c
->
	`nuevaSecci⁄
($this->
dú
.'seccion'),'CreamosÇueva secci√≥n');

75 
	}
}

79 
public
 
fun˘i⁄
 
	$ã°Es¸ibúArchivo
() {

81 
$this
->
	`as£πTrue
($this->
c
->
	`es¸ibúArchivo
($this->
dú
.'seccion/prueba_test.html','<p>Contenido deÉjemplo</p>'), 'Comprobar disponibilidad deárchivo');

83 
	}
}

87 
public
 
fun˘i⁄
 
	$ã°C›ürDúe˘‹io
() {

89 
$this
->
	`as£πTrue
($this->
c
->
	`c›ürDúe˘‹io
($this->
dú
.'seccion',$this->dir.'seccion_copiada'));

90 
	}
}

95 
public
 
fun˘i⁄
 
	$ã°Dú_¨øy
() {

97 
$¨øy_c⁄_c⁄ãnido
 = 
$this
->
c
->
	`dú_¨øy
($this->
dú
);

98 
$this
->
	`as£πFÆ£
(
	`em±y
(
$¨øy_c⁄_c⁄ãnido
));

100 
	}
}

104 
public
 
fun˘i⁄
 
	$ã°Elimö¨Dúe˘‹io
() {

106 
$this
->
	`as£πTrue
(
	`fûe_exi°s
($this->
dú
.'seccion'));

108 
$this
->
c
->
	`ñimö¨Dúe˘‹io
($this->
dú
.'seccion');

110 
$this
->
	`as£πFÆ£
(
	`fûe_exi°s
($this->
dú
.'seccion'));

112 
	}
}

117 i‡(
	gPHPUnô_MAIN_METHOD
 == "ContenidoTest::main") {

118 
C⁄ãnidoTe°
::
maö
();

	@gcm/modulos/descargables/config.php

1 <?
php


9 
	g$exãnsi⁄es_≥rmôidas
 = 
¨øy
 ('php','js','css','sh');

13 
	g$tùos_mime_≥rmôidos
 = 
¨øy
('text/php','text/css','application/x-javascript','text/x-sh');

	@gcm/modulos/descargables/eventos_usuario.php

1 <?
php


2 i‡–!
is£t
(
$_SESSION
['edô']Ë|| 
	g$_SESSION
['edit'] != 'si' ) {

3 
$evítos
['postcontenido']['procesar_texto'][1] = '';

5 
	g$evítos
['precarga']['presenta_contenido'][1] = '';

6 
	g$evítos
['postcontenido']['lista_descargables'][1] = '';

	@gcm/modulos/descargables/lib/Descargables.php

1 <?
php


27 ˛as†
	cDesˇrgabÀs
 
exãnds
 
	mModulos
 {

29 
¥iv©e
 
	m$ëiquëa_öicio
;

30 
¥iv©e
 
	m$ëiquëa_föÆ
;

32 
fun˘i⁄
 
	$__c⁄°ru˘
() {

34 
∑ª¡
::
	`__c⁄°ru˘
();

36 
$this
->
ëiquëa_öicio
 = '{desc{';

37 
$this
->
ëiquëa_föÆ
 = '}}';

47 
fun˘i⁄
 
	$es_desˇrgabÀ
(
$¨chivo
=
FALSE
) {

49 
	`ö˛ude
 ( 
	`dú«me
(
__FILE__
).'/../config.php');

51 i‡–! 
$¨chivo
 || 
	`em±y
($¨chivoËË 
FALSE
;

53 i‡–
	`esImagí
(
$¨chivo
ËË 
FALSE
;

56 
$fûeInfo
 = 
	`∑thöfo
(
$¨chivo
);

57 
$ext
 = ( 
	`is£t
(
$fûeInfo
['exãnsi⁄']ËË? $fûeInfo['exãnsi⁄'] : 
NULL
 ;

58 i‡–
	`is£t
(
$ext
ËË$exà
	`åim
(
	`°πﬁowî
($ext));

60 i‡–
	`ö_¨øy
(
$ext
,
$exãnsi⁄es_≥rmôidas
ËË 
TRUE
;

62 
$tùo
 = 
	`åim
(
GUtû
::
	`tùo_de_¨chivo
(
$¨chivo
));

64 i‡–
$tùo
 !'' && 
	`ö_¨øy
($tùo,
$tùos_mime_≥rmôidos
ËË 
TRUE
;

66  
FALSE
;

68 
	}
}

85 
fun˘i⁄
 
	$¥e£¡¨ArchivosDesˇrgabÀs
(
$dú
, 
$sufijo
) {

87 
globÆ
 
$gcm
;

89 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'dú: ['.
$dú
.'] sufijÿ®busˇr: ['.
$sufijo
.']');

91 i‡–
	`em±y
(
$dú
Ë||Ém±y(
$sufijo
ËË{  
FALSE
; }

93 i‡–! 
	`fûe_exi°s
(
$dú
) ) {

94 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'dú: ['.
$dú
.'] NoÉxisteÉl directorio');

95  
FALSE
;

98 
åy
 {

100 
$dd
 = @
	`dú
(
$dú
);

102  
$¨chivos
 = 
$dd
->
	`ªad
() ) {

104 
$Ø
 = 
$dú
.'/'.
$¨chivos
 ;

105 i‡–
$¨chivos
{0} !"." && 
	`sub°r_cou¡
($¨chivos,'.html')==0 && sub°r_cou¡($¨chivos,
$sufijo
Ë> 0 && ! 
	`is_dú
(
$Ø
) ) {

107 i‡–
$this
->
	`es_desˇrgabÀ
(
$dú
.'/'.
$¨chivos
) ) {

108 
$desˇrgabÀs
[]="$archivos";

115 i‡–
	`is£t
(
$desˇrgabÀs
Ë&& 
	`cou¡
($descargables) > 0 ) {

117 
$this
->
	`javas¸ùts
('descargables.js');

119 
$¨chivos_¥e£¡¨_codigo
 = 
	`¨øy
();

121 
$ßlida
 = 
	`¨øy
();

122 
	`f‹óch
 ( 
$desˇrgabÀs
 
as
 
$¨ch
 ) {

124 
$«
 = 
$dú
.'/'.
$¨ch
 ;

125 
$tùo
 = 
GUtû
::
	`tùo_de_¨chivo
(
$«
);

127 
$ßlida
[
$¨ch
]['nombre'] = $arch;

128 
$ßlida
[
$¨ch
]['uæ']=
$dú
.'/'.$arch;

129 
$ßlida
[
$¨ch
]['èm™yo']=
	`¥e£¡¨Byãs
(
	`fûesize
(
$«
));

130 
$ßlida
[
$¨ch
]['„cha']=
	`¥e£¡¨Fecha
(
	`fûótime
(
$«
));

131 
$ßlida
[
$¨ch
]['tùo']=
$tùo
;

136 
$tùo
) {

140 
$ßlida
[
$¨ch
]['codigo'] = 0;

164 
$ßlida
[
$¨ch
]['codigo'] = 1;

172 i‡–
	`cou¡
(
$ßlida
) > 0 ) {

173 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../html/descargables.html');

177 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

178 
echo
 '<script>init_descargables();</script>';

185 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

186 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),'Eº‹á»¥e£¡¨árchivo: '.$ex->
	`gëMesßge
(),'ERROR');

189 
	}
}

208 
fun˘i⁄
 
	$exå´rArchivos
(
$«
, 
$li°aZù
) {

210 
globÆ
 
$gcm
;

212 
	`ªquúe_⁄˚
(
GCM_DIR
."funciones/zip.php");

214 i‡–!
	`zù_exåa˘_to
(
$«
,
	`sys_gë_ãmp_dú
().'/', 
åue
) ) {

215 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Archivÿ'.
$«
.'Ço seÖudo descomprimir','ERROR');

216  
NULL
 ;

219 
$num
 = 
	`cou¡
(
$li°aZù
);

221 i‡–
$num
 > 0 ) {

222 
$i
=0 ; $i!=
$num
; $i++) {

223 
$¨chivo_codigo
 = 
$dúFöÆ
.
$li°aZù
[
$i
] ;

224 
$ßlida
.=
$¨chivo_codigo
.'\n';

227 
echo
 
$this
->
	`¥e£¡¨_c⁄ãnido_¨chivo
(
$¨chivo_codigo
);

232 
echo
 '<s¸ùt>∑ª¡.ªsu…adoU∂ﬂd (\'0\', \''.
$«
.' '.
$num
.' imagíes\\n'.
$ßlida
.'\');</script>';

234  
TRUE
 ;

235 
	}
}

250 
fun˘i⁄
 
	$mimëy≥2geshi
(
$mimëy≥
) {

252  
$mimëy≥
) {

271  
FALSE
;

275 
	}
}

281 
fun˘i⁄
 
	$li°a_desˇrgabÀs
(
$e
, 
$¨gs
) {

283 
$this
->
	`¥e£¡¨ArchivosDesˇrgabÀs
(
Rouãr
::
$dd
.Rouãr::
$s
,
	`°r_ª∂a˚
('.html','',Rouãr::
$c
));

285 
	}
}

289 
fun˘i⁄
 
	$¥e£¡a_c⁄ãnido
(
$e
, 
$¨gs
) {

294 
$this
->
	`javas¸ùts
('descargables.js');

296 i‡–!
	`em±y
(
$_GET
['p']) ) {

298 
echo
 
$this
->
	`¥e£¡¨_c⁄ãnido_¨chivo
(
$_GET
['p']);

299 
	`exô
();

303 
	}
}

310 
fun˘i⁄
 
	$¥o˚ßr_ãxto
() {

312 
globÆ
 
$gcm
;

314 
$buf„r
 = 
$gcm
->
c⁄ãnido
;

316  
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
Ë!=
Ál£
 ) {

318 
$pos1
 = 
NULL
;

319 
$pos2
 = 
NULL
;

320 
$¨chivo
 = 
NULL
;

321 
$ªm∂az¨
 = 
NULL
;

322 
$¨chivo
 = 
NULL
;

324 
$pos1
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
);

325 
$pos2
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_föÆ
, 
$pos1
);

326 
$ªm∂az¨
 = 
	`sub°r
(
$buf„r
, 
$pos1
, 
$pos2
 - $pos1 + 2);

327 
$¨chivo
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_öicio
,'',
$ªm∂az¨
);

328 
$¨chivo
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_föÆ
,'',$archivo);

330 
$¨chivo
 = 
Rouãr
::
$dd
.Rouãr::
$s
.$archivo;

332 i‡–
$pos1
 && 
$pos2
 && 
$¨chivo
 && 
$ªm∂az¨
 ) {

334 
$c⁄ãnido_¨chivo
 = 
$this
->
	`¥e£¡¨_c⁄ãnido_¨chivo
(
$¨chivo
);

336 
$buf„r
 = 
	`°r_ª∂a˚
(
$ªm∂az¨
,
$c⁄ãnido_¨chivo
,$buffer);

342 
$gcm
->
c⁄ãnido
=
$buf„r
;

344 
	}
}

361 
fun˘i⁄
 
¥e£¡¨_c⁄ãnido_¨chivo
(
$¨chivo
, 
$geshi
='si') {

363 
globÆ
 
$gcm
;

365 i‡–! 
is_fûe
(
$¨chivo
) ) {

366 
ªgi°ør
(
__FILE__
,
__LINE__
,"Archivÿnÿíc⁄åado".' ['.
$¨chivo
.']');

367  
	gFALSE
;

370 
	g$nombª
 = 
ba£«me
(
$¨chivo
);

371 
	g$mime
 = 
GUtû
::
tùo_de_¨chivo
(
$¨chivo
);

372 
	g$tùo
 = 
$this
->
mimëy≥2geshi
(
$mime
) ? $this->mimetype2geshi($mime) : 'txt';

373 
	g$ge°‹
 = 
f›í
(
$¨chivo
, "r");

374 
	g$c⁄ãnido
 = 
°ªam_gë_c⁄ã¡s
(
$ge°‹
);

375 
f˛o£
(
$ge°‹
);

377 i‡–
	g$geshi
 == 'si' ) {

379 i‡–
em±y
(
$c⁄ãnido
Ë||Ém±y(
$tùo
) ) {

381 
ªgi°ør
(
__FILE__
,
__LINE__
,"Falta contenido oÅipo, contenido: [$contenido],Åipo: [$tipo]",'ADMIN');

383  
	gFALSE
;

386 
ªquúe_⁄˚
(
GCM_DIR
.'lib/ext/geshi/geshi.php');

388 
	g$migeshi

√w
 
GeSHi
(
$c⁄ãnido
,
$tùo
);

390 
	g$migeshi
->
íabÀ_˛as£s
();

392 
	g$migeshi
->
íabÀ_löe_numbîs
(
GESHI_NORMAL_LINE_NUMBERS
);

393 
	g$c⁄ãnido
 = 
$migeshi
->
∑r£_code
();

395 
ob_°¨t
();

397 
ö˛ude
(
dú«me
(
__FILE__
)."/../html/codigo_decorado.html");

399 
	g$ßlida
=
ob_gë_c⁄ã¡s
();

404 
ob_°¨t
();

406 
ö˛ude
(
dú«me
(
__FILE__
)."/../html/presentar_codigo.html");

408 
	g$ßlida
=
ob_gë_c⁄ã¡s
();

412 
ob_íd_˛ón
();

414  
	g$ßlida
 ;

	@gcm/modulos/editar/eventos_admin.php

1 <?
php


8 
	g$evítos
['editar_contenido']['editor_web'][10]='';

9 
	g$evítos
['traducir']['editor_web'][10]='';

10 
	g$evítos
['nuevo']['editor_web'][10]='';

16 
	g$acci⁄es
['editar']['editar_contenido'][] = 'editor';

17 
	g$acci⁄es
['editar']['nuevo'][] = 'editor';

18 
	g$acci⁄es
['editar']['traducir'][] = 'editor';

19 
	g$acci⁄es
['editar']['traducir'][] = 'traductor';

	@gcm/modulos/editar/lib/Editar.php

1 <?
php


26 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/GcmConfig/lib/GcmConfigFactory.php");

40 ˛as†
	cEdô¨
 
exãnds
 
	mModulos
 {

42 
fun˘i⁄
 
	$__c⁄°ru˘
(Ë{ 
∑ª¡
::
	`__c⁄°ru˘
() ; }

59 
fun˘i⁄
 
	$edô‹_web
(
$e
, 
$¨gs
=
NULL
) {

61 
globÆ
 
$gcm
;

63 
$idiomaxde„˘o
 = 
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto');

67 
$gcm
->
evít
->
	`acci⁄2evíto
('columna','editar','panel_insertarEmail',6);

68 
$gcm
->
evít
->
	`acci⁄2evíto
('columna','editar','panel_constantes',6);

71 <
s¸ùt
 
œnguage
="javas¸ùt" 
ty≥
="ãxt/javas¸ùt" 
§c
="<?phpÉcho GCM_DIR_P ?>lib/ext/tiny_mce/tiny_mce.js"></script>

73 <
s¸ùt
 
œnguage
="javas¸ùt" 
ty≥
="text/javascript">

74 
töyMCE
.
	`öô
({

75 
mode
 : "textareas",

76 
edô‹_£À˘‹
 : "editor_completo",

77 
theme
 : "advanced",

78 
œnguages
 : 'es',

79 
≠∂y_sour˚_f‹m©tög
 : 
åue
,

80 
c⁄ã¡_css
 : "proyectos.css?css=contenidos/css/contenido.css",

81 
∂ugös
 : "table,advhr,advimage,advlink,insertdatetime,preview,searchreplace,print,contextmenu,fullscreen,spellchecker",

82 
theme_adv™˚d_buâ⁄s1_add
 : "fontselect,fontsizeselect",

83 
theme_adv™˚d_buâ⁄s2_add
 : "separator,insertdate,inserttime,preview,separator,forecolor,backcolor",

84 
theme_adv™˚d_buâ⁄s2_add_bef‹e
: "cut,copy,paste,code,separator,search,replace,separator",

85 
theme_adv™˚d_buâ⁄s3_add_bef‹e
 : "tablecontrols,separator",

86 
theme_adv™˚d_buâ⁄s3_add
 : "emotions,iespell,advhr,separator,print,fullscreen,spellchecker",

87 
theme_adv™˚d_toﬁb¨_loˇti⁄
 : "top",

88 
theme_adv™˚d_toﬁb¨_Æign
 : "left",

89 
theme_adv™˚d_∑th_loˇti⁄
 : "bottom",

90 
∂ugö_ö£πd©e_d©eF‹m©
 : "%Y-%m-%d",

91 
∂ugö_ö£πd©e_timeF‹m©
 : "%H:%M:%S",

92 
exãnded_vÆid_ñemíts
 : "a[name|href|target|title|onclick],img[class|src|border=0|alt|title|hspace|vspace|width|height|align|onmouseover|onmouseout|name],hr[class|width|size|noshade],font[face|size|color|style],span[class|align|style]",

93 
fûe_brow£r_ˇŒback
 : "fileBrowserCallBack",

94 
exã∫Æ_lök_li°_uæ
 : "example_data/example_link_list.js",

95 
exã∫Æ_image_li°_uæ
 : "<?='File/'.$idiomaxdefecto.'/'.Router::$s ?>/.listaImg.js",

96 
•ñlcheckî_œnguages
 : "+spanish=es,Catala=ca,English=en,Swedish=sv"

99 
fun˘i⁄
 
	`fûeBrow£rCÆlBack
(
fõld_«me
, 
uæ
, 
ty≥
, 
wö
) {

101 
	`Æît
("Exam∂êo‡fûebrow£∏ˇŒback: fõld_«me: " + 
fõld_«me
 + ", uæ: " + 
uæ
 + ",Åy≥: " + 
ty≥
);

104 
wö
.
documít
.
f‹ms
[0].
ñemíts
[
fõld_«me
].
vÆue
 = "someurl.htm";

107 </
s¸ùt
>

108 <?
php


110 
	}
}

118 
fun˘i⁄
 
	$∑√l_ö£π¨Emaû
() {

120 
globÆ
 
$gcm
;

122 
$∑√l
 = 
	`¨øy
();

123 
$∑√l
['tôulo'] = 
	`lôîÆ
('Insertar Email');

124 
$∑√l
['ocu…o'] = 
TRUE
;

125 
$∑√l
['c⁄ãnido'] = 
	`gë_ö˛ude_c⁄ã¡s
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('editar','html','form_insertar_email.html',$gcm));

127 
Temas
::
	`∑√l
(
$∑√l
);

129 
	}
}

140 
fun˘i⁄
 
	$devﬁvîAºay
(
$fûe
=
NULL
) {

142 
$fûe
 = ( 
	`is£t
($fûeËË? $fûê: 
$_GET
['file'];

144 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

146 
¥öt
 
	`js⁄_ícode
(
$¨r
->
	`v¨übÀs
());

148 
	}
}

161 
fun˘i⁄
 
	$™yadúAºay
() {

163 
$fûe
=
$_GET
['file'];

164 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

165 
$¨r
->
	`£t
(
$_GET
['elemento'],$_GET['valor']);

166 
$¨r
->
	`gu¨d¨_v¨übÀs
();

168 
echo
 "EÀmítÿ[ ".
$_GET
['elemento']." ]á√±adido o modificadoÖor [ ".$_GET['valor']." ]";

170 
	}
}

185 
fun˘i⁄
 
	$modifiˇrAºay
() {

187 
globÆ
 
$gcm
;

189 
$fûe
=
$_GET
['file'];

191 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

193 
$¨r
->
	`£t
(
$_GET
['elemento'],$_GET['valor']);

195 
$¨r
->
	`gu¨d¨_v¨übÀs
();

197 
echo
 "EÀmítÿ[ ".
$_GET
['elemento']." ]á√±adido o modificadoÖor [ ".$_GET['valor']." ]";

199 
	}
}

214 
fun˘i⁄
 
ˇmbio_nombª_c⁄ãnido
(
$e
,
$¨gs
='') {

216 
globÆ
 
$gcm
, 
$LG
;

218 
	g$‹igöÆ
 = 
$_POST
['original'];

219 
	g$de°öo
 = 
$_POST
['destino'];

221 
	g$‹igöÆ_r
 = 
$gcm
->
rouãr
->
desgloßrUæ
(
$‹igöÆ
);

222 
	g$de°öo_r
 = 
$gcm
->
rouãr
->
desgloßrUæ
(
$de°öo
);

224 
	g$‹igöÆ
 = 
°r_ª∂a˚
('\.html','',
$‹igöÆ_r
['c']);

225 
	g$de°öo
 = 
°r_ª∂a˚
('\.html','',
$de°öo_r
['c']);

227 
	g$fûe
=
$gcm
->
c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
	gRouãr
::
$ii
.".php";

229 
	g$¨r
 = 
GcmC⁄figFa˘‹y
::
GëGcmC⁄fig
(
$fûe
);

231 
	g$¨r
->
dñ
(
$‹igöÆ
);

232 
	g$¨r
->
£t
(
GUtû
::
ãxt›œno
(
$de°öo
),$destino);

234 
	g$¨r
->
gu¨d¨_v¨übÀs
();

236 
globÆ
 
	g$LG
;

237 
	g$LG
[
GUtû
::
ãxt›œno
(
$de°öo
)]=$destino;

247 
fun˘i⁄
 
	$∑√l_c⁄°™ãs
() {

249 
globÆ
 
$gcm
;

251 
$this
->
	`javas¸ùts
('generico.js');

253 i‡–
$gcm
->
au
->
	`logódo
() ) {

255 
$∑√l
 = 
	`¨øy
();

256 
$∑√l
['tôulo'] = 
	`lôîÆ
('Constantes',3);

257 
$∑√l
['ocu…o'] = 
TRUE
;

258 
$∑√l
['ajax'] = "pedirDatos('?formato=ajax&m=editar&a=devolverArray&file=DATOS/constantes/GCM_CONS.php','presentaConstantes');";

259 
$∑√l
['contenido'] = '<div id="panelConstantes"></div>';

260 
Temas
::
	`∑√l
(
$∑√l
);

263 
	}
}

269 
fun˘i⁄
 
	$f‹mAdmöC⁄°™ãs
() {

271 
globÆ
 
$gcm
;

273 
$this
->
	`javas¸ùts
('generico.js');

276 <
br
 />

277 <
f‹m
 
mëhod
='post' >

278 <
fõld£t
>

279 <
Àgíd
><?
php
 
	`lôîÆ
('Administraci√≥n de constantes',3);?></legend>

280 <
öput
 
ty≥
='hiddí' 
«me
='m' 
vÆue
='editar' />

281 <
öput
 
ty≥
='hiddí' 
«me
='a' 
vÆue
='administrar_constantes' />

282 <
öput
 
ty≥
='submô' 
«me
='c⁄f' 
vÆue
='Configurar' />

283 <
öput
 
ty≥
='submô' 
«me
='c›ü' 
vÆue
='Recuperar copia de seguridad' />

284 </
fõld£t
>

285 </
f‹m
>

286 <
br
 />

287 <?
php


288 
$gcm
->
evít
->
	`™uœr
('contenido','editar');

290 
	}
}

299 
fun˘i⁄
 
	$admöi°ør_c⁄°™ãs
() {

301 
globÆ
 
$gcm
;

303 i‡–
$gcm
->
au
->
	`logódo
() ) {

305 
$ARCHIVO
="DATOS/constantes/GCM_CONS.php";

307 
	`ö˛ude_⁄˚
(
$ARCHIVO
);

309 
$gcm
->
evít
->
	`™uœr
('contenido','editar');

311 i‡–
	`is£t
(
$_POST
['conf'])) {

313 
	`ö˛ude_⁄˚
(
GCM_DIR
."funciones/gcm_arrayFile.php");

314 
	`gcm_ÀîAºay
(
$ARCHIVO
, 'es', 'si', 'si');

316 } 
	`ñ£if
 ( 
$_POST
['accion'] == 'escribir') {

318 
	`ö˛ude_⁄˚
(
GCM_DIR
."funciones/gcm_arrayFile.php");

320 i‡(
	`gcm_es¸ibúAºay
(
$ARCHIVO
Ë==
FALSE
){

321 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"No seÖudo guardarÜos cambios",'ERROR');

322  
Ál£
;

324 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Archivo modificado",'AVISO');

326 
$this
->
	`f‹mAdmöC⁄°™ãs
();

327  
åue
;

331 
$this
->
	`f‹mAdmöC⁄°™ãs
();

336 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Las constantes soloÖueden serádministradasÖorÜosádministradores",'AVISO');

339 
	}
}

	@gcm/modulos/editar/menuAdmin.php

1 <?
php


4 
	g$míuAdmö
['Configuraci√≥n']['boton']['Constantes']['activado']=1;

5 
	g$míuAdmö
['Configuraci√≥n']['boton']['Constantes']['title']="Editar constantes";

6 
	g$míuAdmö
['Configuraci√≥n']['boton']['Constantes']['link']="?m=editar&a=administrar_constantes";

9 
	g$míuAdmö
['Configuraci√≥n']['boton']['Literales']['activado']=1;

10 
	g$míuAdmö
['Configuraci√≥n']['boton']['Literales']['title']="EditarÜiterales";

11 
	g$míuAdmö
['Configuraci√≥n']['boton']['Literales']['link']="?m=editar&a=administrar_literales";

	@gcm/modulos/enviomail/eventos_admin.php

1 <?
php


7 
	g$evítos
['columna']['formulario']['10']='';

8 
	g$evítos
['enviar_email_error']['enviar_email_error'][1]='';

14 
	g$acci⁄es
['enviomail']['enviar_email_error'][] = 'usuario';

	@gcm/modulos/enviomail/lib/Enviomail.php

1 <?
php


14 
ö˛ude_⁄˚
(
GCM_DIR
.'lib/ext/phpMailer/class.phpmailer.php');

25 ˛as†
	cEnviomaû
 
exãnds
 
	mModulos
 {

45 
fun˘i⁄
 
ívüMaûHtml
(
$asu¡o
,
$c⁄ãnidoMaû
,
$nombªDe°ö©¨io
,
$emaûDe°ö©¨io
,
$nombªRemôe
,
$emaûRemôíã
,
$ocu…os
=
NULL
,
$html
='true'){

47 
globÆ
 
$gcm
;

49 
	m$¥oye˘o
 = 
$gcm
->
c⁄fig
('admin','Proyecto');

51 i‡–
	m$html
 == 'true' ) {

53 
$∂™tûœ
['uæ_absﬁuè'] = 'hâp://'.
$_SERVER
['HTTP_HOST'].
dú«me
($_SERVER['REQUEST_URI']).'/';

54 
	m$∂™tûœ
['tôulo'] = 
lôîÆ
(
$¥oye˘o
,1);

55 
	m$∂™tûœ
['„cha'] = 
¥e£¡¨Fecha
(
time
());

56 
	m$∂™tûœ
['c⁄ãnido'] = 
$c⁄ãnidoMaû
;

58 
	m$c⁄ãnido
 = 
gë_ö˛ude_c⁄ã¡s
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
ruè
('íviomaû','html','maû.html'),
$∂™tûœ
);

62 
	m$c⁄ãnido
 = 
$c⁄ãnidoMaû
;

65 i‡–
	m$this
->
¥o˚ßEnvioMaû
(
$asu¡o
,
$c⁄ãnido
,
$nombªDe°ö©¨io
,
$emaûDe°ö©¨io
,
$nombªRemôe
,
$emaûRemôíã
,
$ocu…os
,
$html
) ) {

66  
	mTRUE
;

68  
	mFALSE
;

90 
fun˘i⁄
 
¥o˚ßEnvioMaû
(
$asu¡o
,
$c⁄ãnidoMaû
,
$nombªDe°ö©¨io
,
$emaûDe°ö©¨io
,
$nombªRemôe
,
$emaûRemôíã
,
$ocu…os
=
NULL
, 
$html
='true'){

92 
globÆ
 
$gcm
;

95 
	g$idioma
 = (
$_SESSION
[
$gcm
->
c⁄fig
('admö','Proye˘o')."-idioma"]Ë? 
	g$_SESSION
[$gcm->c⁄fig('admö','Proye˘o')."-idioma"] : 
LG_PRE
;

100 i‡–
	g$html
 == 'true' ) {

102 
$c⁄ãnidos
 = 
ex∂ode
(' ',
$c⁄ãnidoMaû
);

103 
	g$c⁄ãnido
 = '';

104 
f‹óch
 ( 
$c⁄ãnidos
 
as
 
$∑œbø
 ) {

105 i‡–
°rùos
(
$∑œbø
,'§c'Ë!=
FALSE
 ) {

106 
$c⁄ãnido
 .
îeg_ª∂a˚
–"§c=('|\")(.*)Fûe/(.*)('|\")", "§c=\"Fûe/\\3\"", 
$∑œbø
 );

107 
	g$c⁄ãnido
 .= ' ';

108 } 
ñ£if
 ( 
°rùos
(
$∑œbø
,'hªf'Ë!=
FALSE
 ){

109 
$c⁄ãnido
 .
¥eg_ª∂a˚
("/hªf=('|\")(.*)Fûe\/(.*)('|\")/", "hªf=\"Fûe/\3\"", 
$∑œbø
 );

110 
	g$c⁄ãnido
 .= ' ';

112 
	g$c⁄ãnido
 .
$∑œbø
.' ';

118 
	g$c⁄ãnido
 = 
$c⁄ãnidoMaû
;

122 
	g$maû
 = 
√w
 
PHPMaûî
();

124 
	g$maû
->
SëL™guage
(
$idioma
);

125 
	g$maû
->
	gCh¨Së
 = "UTF-8";

126 
	g$maû
->
	gFrom
 = 
$emaûRemôíã
;

127 
	g$maû
->
	gFromName
 = 
$nombªRemôe
;

128 
	g$maû
->
	gSubje˘
 = 
$asu¡o
;

129 
	g$maû
->
AddAddªss
(
$emaûDe°ö©¨io
,
$nombªDe°ö©¨io
);

130 i‡–
	g$html
 == 'true' ) {

131 
$maû
->
IsHTML
(
$html
);

132 
	g$maû
->
	gA…Body
 = 
lôîÆ
('Para verÉlÉmail,Çecesita compatibilidad con html');

133 
	g$maû
->
MsgHTML
(
$c⁄ãnido
);

135 
	g$maû
->
	gBody
 = 
$c⁄ãnido
;

139 i‡–
	g$ocu…os
 ) {

140 
f‹óch
–
$ocu…os
 
as
 
$emaû
 => 
$nom
 ) {

141 
$maû
->
AddBCC
(
$emaû
, 
$nom
);

145 if(!
	g$maû
->
Síd
()) {

146 
åiggî_îr‹
(
lôîÆ
('Eº‹').' '.lôîÆ('ívündÿemaû').': '.
$maû
->
Eº‹Info
, 
E_USER_ERROR
);

147  
	gFALSE
;

149 
	g$mís
 = 'EmaûÉnvüdÿ®['.
$emaûDe°ö©¨io
.']';

150 
	g$mís
 .'Dê ['.
$emaûRemôíã
.']';

151 
	g$mís
 .'Asu¡ÿ ['.
$asu¡o
.']';

152 
ªgi°ør
(
__FILE__
,
__LINE__
,
$mís
);

153  
	gTRUE
;

160 
fun˘i⁄
 
	$f‹muœrio
() {

161 
	`ob_°¨t
();

162 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../html/form_enviomail.html');

163 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
();

164 
	`ob_íd_˛ón
();

166 
$∑√l
 = 
	`¨øy
();

167 
$∑√l
['tôulo'] = 
	`lôîÆ
('Informe deÉrrores',3);

168 
$∑√l
['ocu…o'] = 
TRUE
;

169 
$∑√l
['c⁄ãnido'] =
$ßlida
;

171 
Temas
::
	`∑√l
(
$∑√l
);

175 
	}
}

182 
fun˘i⁄
 
	$ívür_emaû_îr‹
() {

184 
globÆ
 
$gcm
;

186 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Enviando mail de usuario conÉrror');

190 i‡–!
$gcm
->
au
->
	`logódo
() ) {

192 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'No seÖuedeÉnviar informe sin serádministrador','AVISO');

197 i‡–
$_SERVER
['HTTP_HOST'] == 'localhost' ) {

198 
$maû_dev
 = 'eduardo@localhost';

200 
$maû_dev
 = 'eduardo@mamedu.com';

203 
$ßlida
 = 
	`v¨_exp‹t
(
$_SESSION
,
TRUE
);

205 i‡–!
	`em±y
(
$_POST
['comentario_usuario']) ) {

206 
$c⁄ãnido_maû
 .= "\n".'------------------';

207 
$c⁄ãnido_maû
 = "\n".'Comentario usuario';

208 
$c⁄ãnido_maû
 .= "\n".'------------------';

209 
$c⁄ãnido_maû
 .= "\n";

210 
$c⁄ãnido_maû
 ."\n".
	`°rù_ègs
(
$_POST
['comentario_usuario']);

211 
$c⁄ãnido_maû
 .= "\n";

214 
$c⁄ãnido_maû
 ."\n".
$ßlida
;

216 i‡–
$this
->
	`ívüMaûHtml
('Eº‹É¿gcm', 
$c⁄ãnido_maû
, 'Edu¨do', 
$maû_dev
, 'RobŸ dêgcm', 'admö@mamedu.com',
NULL
,'false') ) {

218 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('ElÉmailá sidoÉnviado',3).' '.literal('Gracias',3),'AVISO');

219  
TRUE
;

221  
FALSE
;

226 
	}
}

230 
fun˘i⁄
 
	$ívür_emaû
(
$e
, 
$¨gs
) {

232 
globÆ
 
$gcm
;

234 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') ');

236 i‡–
	`is£t
(
$¨gs
['mail']) ) {

237 
$maû
 = 
$¨gs
['mail'];

240 i‡–
$_SERVER
['HTTP_HOST'] == 'localhost' ) {

241 
$maû
 = 'eduardo@mamedu.com';

243 
$maû
 = 'eduardo@mamedu.com';

247 i‡–!
	`is£t
(
$¨gs
['cuerpo']) ) {

248 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).')

249 
Sö
 
c⁄ãnido
 
∑ø
 
ívür
','
ERROR
');

250  
FALSE
;

253 i‡–
	`is£t
(
$¨gs
['nombre_destinatario']) ) {

254 
$nombª_de°ö©¨io
 = 
$¨gs
['nombre_destinatario'];

256 
$nombª_de°ö©¨io
 = 'Eduardo';

259 i‡–
	`is£t
(
$¨gs
['nombre_remitente']) ) {

260 
$nombª_ªmôíã
 = 
$¨gs
['nombre_remitente'];

262 
$nombª_ªmôíã
 = 'Eduardo';

265 i‡–
	`is£t
(
$¨gs
['mail_remitente']) ) {

266 
$maû_ªmôíã
 = 
$¨gs
['mail_remitente'];

268 
$maû_ªmôíã
 = 'eduardo@mamedu.com';

272 
$c⁄ãnido_maû
 = 
$¨gs
['cuerpo'];

273 
$asu¡o_maû
 = 
$¨gs
['asunto'];

275 i‡–
$this
->
	`ívüMaûHtml
(
$asu¡o_maû
, 
$c⁄ãnido_maû
, 
$nombª_de°ö©¨io
, 
$maû
, 
$nombª_ªmôíã
, 
$maû_ªmôíã
,
NULL
,
TRUE
) ) {

277  
TRUE
;

279  
FALSE
;

282 
	}
}

	@gcm/modulos/gdoxygen/eventos_admin.php

1 <?
php


7 
	g$evítos
['postreindexar']['reindexar'][1] = '';

8 
	g$evítos
['reindexado_completo']['reindexado_completo'][2] = '';

	@gcm/modulos/gdoxygen/eventos_usuario.php

1 <?
php


22 
	g$evítos
['buscar']['presentar_busquedas'][5]='';

24 
	g$evítos
['precarga']['detectar_gdoxygen'][5] = '';

	@gcm/modulos/gdoxygen/lib/Gdoxygen.php

1 <?
php


37 ˛as†
	cGdoxygí
 
exãnds
 
	mModulos
 {

44 
¥iv©e
 
	m$nombª_ˇΩëas_doxygí
 = 'gdoxygen';

48 
fun˘i⁄
 
	$__c⁄°ru˘
() {

50 
∑ª¡
::
	`__c⁄°ru˘
();

62 
fun˘i⁄
 
	$dëe˘¨_gdoxygí
(
$e
, 
$¨gs
) {

64 
globÆ
 
$gcm
;

66 
$öicio
 = 'index.htm';

68 i‡–
Rouãr
::
$e°amos
 =
$this
->
nombª_ˇΩëas_doxygí
 ) {

70 i‡–
Rouãr
::
$e
 == 'indexar' ) {

71 
$this
->
	`™uœrEvíto
('indexar');

72 
$this
->
	`ödexado
(
$_GET
['url']);

73 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) ;

76 
$this
->
	`™uœrEvíto
('titulo');

77 
$gcm
->
evít
->
	`unico
('c⁄ãnido',
$this
->
nombª_ˇΩëas_doxygí
);

78 
$this
->
	`™uœrEvíto
('columna');

80 i‡–
	`fûe_exi°s
(
Rouãr
::
$d
.Rouãr::
$s
.'ödex.htm'Ë==
FALSE
 ) {

82 
$öicio
 = 'main.htm';

86 i‡–
Rouãr
::
$f‹m©o
 != 'ajax' ) {

87 
echo
 '<style>#contenedor { width: 100%;}</style>';

89 
echo
 '<b∏/><i‰amês¸ﬁlög="auto" fømeb‹dî="0" width="99%" height="1000" src="hâp://'.
$_SERVER
['HTTP_HOST'].'/'.
	`dú«me
($_SERVER['PHP_SELF']).'/'.
Rouãr
::
$dd
.Rouãr::
$s
.'">';

92 
	}
}

100 
fun˘i⁄
 
	$ªödexado_com∂ëo
(
$e
, 
$¨gs
=
NULL
) {

102 
$this
->
	`li°¨_gdoxygí
();

118 
	}
}

127 
fun˘i⁄
 
	$ªödex¨
(
$e
, 
$¨gs
) {

129 
$this
->
	`li°¨_gdoxygí
();

131 
	}
}

142 
fun˘i⁄
 
	$ödexado
(
$¨chivo
) {

144 
globÆ
 
$gcm
;

146 
$ˇΩëa
 = 
	`dú«me
(
$¨chivo
);

147 
$aCamöo
 = 
	`ex∂ode
('/',
$ˇΩëa
);

148 
$¥oye˘o
 = 
$aCamöo
[
	`cou¡
($aCamino)-2];

149 
$¨chivo_c⁄ãnido
 = 
$ˇΩëa
.'/main.htm';

151 i‡–
	`fûe_exi°s
(
$¨chivo_c⁄ãnido
Ë==
FALSE
 ) {

152 
$¨chivo_c⁄ãnido
 = 
$¨chivo
;

155 i‡–
	`fûe_exi°s
(
$¨chivo
Ë==
FALSE
 ) {

156 
$mí
 = "No seÉncuentraÇi $archivo";

157 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$mí
,'ERROR');

158  
FALSE
;

161 
$∑ømëros
 = 'uæ='.
$¨chivo
;

162 
$∑ømëros
 .'&lôîÆ=Documíèci√≥¿'.
$¥oye˘o
;

163 
$∑ømëros
 .= '&sin_comprobar_extension=1';

164 
$∑ømëros
 .'&¨chivo_des¸ùci⁄='.
$¨chivo_c⁄ãnido
;

165 
$∑ømëros
 .= '&inicio_descripcion="contents">';

167 i‡–
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('ödexad‹','ödex¨_¨chivo_pdo','gdoxygí',
$∑ømëros
Ë!=
FALSE
 ) {

168 
$ßlida
 = "C⁄ãnidÿªödexado: Documíèci√≥¿".
$¥oye˘o
;

170 
$ßlida
 = '<p class="error">';

171 
$ßlida
 .= 'Errorál indexar contenido';

172 
$ßlida
 .= '</p>';

173  
FALSE
;

176 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

177 
echo
 
$ßlida
;

179 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$ßlida
,'AVISO');

182 
	}
}

189 
fun˘i⁄
 
	$li°¨_gdoxygí
() {

191 
globÆ
 
$gcm
;

193 
$funci⁄_js_ödex¨
 = 'indexar';

195 
$ˇΩëas_doxygí
 = 
	`rglob
('Fûe/*/'.
$this
->
nombª_ˇΩëas_doxygí
);

197 i‡–! 
$ˇΩëas_doxygí
 ) { ; }

199 
echo
 '<h2>Listado de gdoxygen</h2>';

201 
	`f‹óch
 ( 
$ˇΩëas_doxygí
 
as
 
$ˇΩëa
 ) {

203 
$¨chivo
 = 
$ˇΩëa
.'/'.'index.htm';

204 
$aCamöo
 = 
	`ex∂ode
('/',
$ˇΩëa
);

205 
$¥oye˘o
 = 
$aCamöo
[
	`cou¡
($aCamino)-2];

207 
$ˇmöo
 = 
$¨chivo
;

208 
$ñemíto
 = 
$¨chivo
;

210 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('indexador','html','elemento_lista_indexar.html'));

214 
	}
}

220 
fun˘i⁄
 
	$¥e£¡¨_busquedas
(
$e
, 
$¨gs
) {

222 i‡–
	`is£t
(
$_GET
['buscar']) ) {

224 
$quîy
 = 
$_GET
['buscar'];

226 
	`ö˛ude
('search_doxygen.php');

228 
$ˇΩëas_doxygí
 = 
	`rglob
('Fûe/*/'.
$this
->
nombª_ˇΩëas_doxygí
);

230 i‡–! 
$ˇΩëas_doxygí
 ) { ; }

232 
	`f‹óch
 ( 
$ˇΩëas_doxygí
 
as
 
$ˇΩëa
 ) {

234 
$¥oye˘os
 = 
	`ex∂ode
('/',
$ˇΩëa
);

235 
$¥oye˘o
 = 
$¥oye˘os
[3];

236 
echo
 '<h2>Resu…ado†íÉ»c√≥digÿdê'.
$¥oye˘o
.'</h2>';

238 i‡(!(
$fûe
=
	`f›í
(
$ˇΩëa
."/search/search.idx","rb")))

240 
	`dõ
("Error: Search index file could NOT be opened!");

242 
$ªsu…s
 = 
	`¨øy
();

243 
$ªquúedW‹ds
 = 
	`¨øy
();

244 
$f‹biddíW‹ds
 = 
	`¨øy
();

245 
$foundW‹ds
 = 
	`¨øy
();

246 
$w‹d
=
	`°πok
(
$quîy
," ");

247 
$w‹d
)

249 i‡((
$w‹d
{0}=='+')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$ªquúedW‹ds
[]=$word; }

250 i‡((
$w‹d
{0}=='-')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$f‹biddíW‹ds
[]=$word; }

251 i‡(!
	`ö_¨øy
(
$w‹d
,
$foundW‹ds
))

253 
$foundW‹ds
[]=
$w‹d
;

254 
	`£¨ch
(
$fûe
,
	`°πﬁowî
(
$w‹d
),
$ªsu…s
);

256 
$w‹d
=
	`°πok
(" ");

258 
$docs
 = 
	`¨øy
();

259 
	`comböe_ªsu…s
(
$ªsu…s
,
$docs
);

262 
$fûãªdDocs
 = 
	`fûãr_ªsu…s
(
$docs
,
$ªquúedW‹ds
,
$f‹biddíW‹ds
);

264 
$s‹ãd
 = 
	`¨øy
();

265 
	`s‹t_ªsu…s
(
$fûãªdDocs
,
$s‹ãd
);

267 
$¥efijo_uæ
 = 
	`°r_ª∂a˚
(
Rouãr
::
$dd
,'',
$ˇΩëa
);

268 i‡–!
	`em±y
(
$s‹ãd
) ) {

269  
$i
=0; $ò< (
$s‹ãd
); ++$i ) {

270 
$s‹ãd
[
$i
]['uæ'] = 
$¥efijo_uæ
.'/'.$sorted[$i]['url'];

273 
	`ªp‹t_ªsu…s
(
$s‹ãd
);

274 
echo
 "</div>\n";

275 
	`íd_∑ge
();

276 
	`f˛o£
(
$fûe
);

279 
	}
}

	@gcm/modulos/gdoxygen/lib/search_doxygen.php

1 <?
php


3 
fun˘i⁄
 
	$m©ches_ãxt
(
$num
)

5 i‡(
$num
==0)

9 i‡(
$num
==1)

17 
	}
}

19 
fun˘i⁄
 
	$ªp‹t_m©ches
()

22 
	}
}

23 
fun˘i⁄
 
	$íd_∑ge
()

26 
echo
 "\n\n";

27 
	}
}

29 
fun˘i⁄
 
	$ªadI¡
(
$fûe
)

31 
$b1
 = 
	`‹d
(
	`fgëc
(
$fûe
)); 
$b2
 = ord(fgetc($file));

32 
$b3
 = 
	`‹d
(
	`fgëc
(
$fûe
)); 
$b4
 = ord(fgetc($file));

33  (
$b1
<<24)|(
$b2
<<16)|(
$b3
<<8)|
$b4
;

34 
	}
}

36 
fun˘i⁄
 
	$ªadSåög
(
$fûe
)

38 
$ªsu…
="";

39 
	`‹d
(
$c
=
	`fgëc
(
$fûe
))Ë
$ªsu…
.=$c;

40  
$ªsu…
;

41 
	}
}

43 
fun˘i⁄
 
	$compuãIndex
(
$w‹d
)

46 i‡(
	`°æí
(
$w‹d
)<2)  -1;

48 
$hi
 = 
	`‹d
(
$w‹d
{0});

49 i‡(
$hi
==0)  -1;

51 
$lo
 = 
	`‹d
(
$w‹d
{1});

52 i‡(
$lo
==0)  -1;

54  
$hi
*256+
$lo
;

55 
	}
}

57 
fun˘i⁄
 
	$£¨ch
(
$fûe
,
$w‹d
,&
$°©sLi°
)

59 
$ödex
 = 
	`compuãIndex
(
$w‹d
);

60 i‡(
$ödex
!=-1)

62 
	`f£ek
(
$fûe
,
$ödex
*4+4);

63 
$ödex
 = 
	`ªadI¡
(
$fûe
);

64 i‡(
$ödex
)

66 
$°¨t
=(
$°©sLi°
);

67 
$cou¡
=
$°¨t
;

68 
	`f£ek
(
$fûe
,
$ödex
);

69 
$w
 = 
	`ªadSåög
(
$fûe
);

70 
$w
)

72 
$°©Idx
 = 
	`ªadI¡
(
$fûe
);

73 i‡(
$w‹d
==
	`sub°r
(
$w
,0,
	`°æí
($word)))

75 
$°©sLi°
[
$cou¡
++]=
	`¨øy
(

76 "w‹d"=>
$w‹d
,

77 "m©ch"=>
$w
,

78 "ödex"=>
$°©Idx
,

79 "fuŒ"=>
	`°æí
(
$w
)==°æí(
$w‹d
),

80 "docs"=>
	`¨øy
()

83 
$w
 = 
	`ªadSåög
(
$fûe
);

85 
$tŸÆHi
=0;

86 
$tŸÆFªqHi
=0;

87 
$tŸÆFªqLo
=0;

88 
$cou¡
=
$°¨t
;$cou¡<(
$°©sLi°
);$count++)

90 
$°©Info
 = &
$°©sLi°
[
$cou¡
];

91 
$mu…ùlõr
 = 1;

93 i‡(
$°©Info
["fuŒ"]Ë
$mu…ùlõr
=2;

94 
	`f£ek
(
$fûe
,
$°©Info
["index"]);

95 
$numDocs
 = 
	`ªadI¡
(
$fûe
);

96 
$docInfo
 = 
	`¨øy
();

98 
$i
=0;$i<
$numDocs
;$i++)

100 
$idx
=
	`ªadI¡
(
$fûe
);

101 
$‰eq
=
	`ªadI¡
(
$fûe
);

102 
$docInfo
[
$i
]=
	`¨øy
("idx" => 
$idx
,

103 "‰eq" => 
$‰eq
>>1,

105 "hi" => 
$‰eq
&1

107 i‡(
$‰eq
&1)

109 
$tŸÆHi
++;

110 
$tŸÆFªqHi
+=
$‰eq
*
$mu…ùlõr
;

114 
$tŸÆFªqLo
+=
$‰eq
*
$mu…ùlõr
;

118 
$i
=0;$i<
$numDocs
;$i++)

120 
	`f£ek
(
$fûe
,
$docInfo
[
$i
]["idx"]);

121 
$docInfo
[
$i
]["«me"]=
	`ªadSåög
(
$fûe
);

122 
$docInfo
[
$i
]["uæ"]=
	`ªadSåög
(
$fûe
);

124 
$°©Info
["docs"]=
$docInfo
;

126 
$tŸÆFªq
=(
$tŸÆHi
+1)*
$tŸÆFªqLo
 + 
$tŸÆFªqHi
;

127 
$cou¡
=
$°¨t
;$cou¡<(
$°©sLi°
);$count++)

129 
$°©Info
 = &
$°©sLi°
[
$cou¡
];

130 
$mu…ùlõr
 = 1;

132 i‡(
$°©Info
["fuŒ"]Ë
$mu…ùlõr
=2;

133 
$i
=0;$i<(
$°©Info
["docs"]);$i++)

135 
$docInfo
 = &
$°©Info
["docs"];

137 
$‰eq
=
$docInfo
[
$i
]["freq"];

138 i‡(
$docInfo
[
$i
]["hi"])

140 
$°©Info
["docs"][
$i
]["rank"]=

141 ()(
$‰eq
*
$mu…ùlõr
+
$tŸÆFªqLo
)/
$tŸÆFªq
;

145 
$°©Info
["docs"][
$i
]["rank"]=

146 ()(
$‰eq
*
$mu…ùlõr
)/
$tŸÆFªq
;

152  
$°©sLi°
;

153 
	}
}

155 
fun˘i⁄
 
	$comböe_ªsu…s
(
$ªsu…s
,&
$docs
)

157 
	`f‹óch
 (
$ªsu…s
 
as
 
$w‹dInfo
)

159 
$docsLi°
 = &
$w‹dInfo
["docs"];

160 
	`f‹óch
 (
$docsLi°
 
as
 
$di
)

162 
$key
=
$di
["url"];

163 
$ønk
=
$di
["rank"];

164 i‡(
	`is£t
(
$docs
[
$key
]))

166 
$docs
[
$key
]["ønk"]+=
$ønk
;

170 
$docs
[
$key
] = 
	`¨øy
("url"=>$key,

171 "«me"=>
$di
["name"],

172 "ønk"=>
$ønk


175 
$docs
[
$key
]["w‹ds"][] = 
	`¨øy
(

176 "w‹d"=>
$w‹dInfo
["word"],

177 "m©ch"=>
$w‹dInfo
["match"],

178 "‰eq"=>
$di
["freq"]

182  
$docs
;

183 
	}
}

185 
fun˘i⁄
 
	$fûãr_ªsu…s
(
$docs
,&
$ªquúedW‹ds
,&
$f‹biddíW‹ds
)

187 
$fûãªdDocs
=
	`¨øy
();

188 
	`li°
 (
$key
, 
$vÆ
Ë
	`óch
 (
$docs
))

190 
$w‹ds
 = &
$docs
[
$key
]["words"];

191 
$c›y
=1;

192 i‡((
$ªquúedW‹ds
)>0)

194 
	`f‹óch
 (
$ªquúedW‹ds
 
as
 
$ªqW‹d
)

196 
$found
=0;

197 
	`f‹óch
 (
$w‹ds
 
as
 
$w‹dInfo
)

199 
$found
 = 
$w‹dInfo
["w‹d"]==
$ªqW‹d
;

200 i‡(
$found
) ;

202 i‡(!
$found
)

204 
$c›y
=0;

209 i‡((
$f‹biddíW‹ds
)>0)

211 
	`f‹óch
 (
$w‹ds
 
as
 
$w‹dInfo
)

213 i‡(
	`ö_¨øy
(
$w‹dInfo
["w‹d"],
$f‹biddíW‹ds
))

215 
$c›y
=0;

220 i‡(
$c›y
Ë
$fûãªdDocs
[
$key
]=
$docs
[$key];

222  
$fûãªdDocs
;

223 
	}
}

225 
fun˘i⁄
 
	$com∑ª_ønk
(
$a
,
$b
)

227 i‡(
$a
["ønk"] =
$b
["rank"])

231  (
$a
["ønk"]>
$b
["rank"]) ? -1 : 1;

232 
	}
}

234 
fun˘i⁄
 
	$s‹t_ªsu…s
(
$docs
,&
$s‹ãd
)

236 
$s‹ãd
 = 
$docs
;

237 
	`us‹t
(
$s‹ãd
,"compare_rank");

238  
$s‹ãd
;

239 
	}
}

241 
fun˘i⁄
 
	$ªp‹t_ªsu…s
(&
$docs
)

243 
echo
 "<div class=\"searchresults\">\n";

244 
echo
 "<table cellspacing=\"2\">\n";

245 
$numDocs
 = (
$docs
);

246 i‡(
$numDocs
==0)

248 
echo
 " <tr>\n";

249 
echo
 " <td cﬁ•™=\"2\">".
	`m©ches_ãxt
(0)."</td>\n";

250 
echo
 " </tr>\n";

254 
echo
 " <tr>\n";

255 
echo
 " <td cﬁ•™=\"2\">".
	`m©ches_ãxt
(
$numDocs
);

256 
echo
 "\n";

257 
echo
 " </td>\n";

258 
echo
 " </tr>\n";

259 
$num
=1;

260 
	`f‹óch
 (
$docs
 
as
 
$doc
)

262 
echo
 " <tr>\n";

263 
echo
 " <tdálign=\"right\">$num.</td>";

264 
echo
 "<td><®˛ass=\"ñ\" hªf=\"".
$doc
["url"]."\">".$doc["name"]."</a></td>\n";

265 
echo
 " <tr>\n";

266 
echo
 " <td></td><td cœss=\"töy\">".
	`ªp‹t_m©ches
()." ";

267 
	`f‹óch
 (
$doc
["w‹ds"] 
as
 
$w‹dInfo
)

269 
$w‹d
 = 
$w‹dInfo
["word"];

270 
$m©chRight
 = 
	`sub°r
(
$w‹dInfo
["m©ch"],
	`°æí
(
$w‹d
));

271 
echo
 "<b>$w‹d</b>$m©chRight(".
$w‹dInfo
["freq"].") ";

273 
echo
 " </td>\n";

274 
echo
 " </tr>\n";

275 
$num
++;

278 
echo
 "</table>\n";

279 
	}
}

281 
fun˘i⁄
 
	$maö
()

283 if(
	`°rcmp
('4.1.0', 
	`phpvîsi⁄
()) > 0)

285 
	`dõ
("Error: PHP version 4.1.0 oráboveÑequired!");

287 i‡(!(
$fûe
=
	`f›í
("search/search.idx","rb")))

289 
	`dõ
("Error: Search index file could NOT be opened!");

291 i‡(
	`ªadHódî
(
$fûe
)!="DOXS")

293 
	`dõ
("Error: Header of index file is invalid!");

295 
$quîy
="";

296 i‡(
	`¨øy_key_exi°s
("quîy", 
$_GET
))

298 
$quîy
=
$_GET
["query"];

300 
	`íd_f‹m
(
	`¥eg_ª∂a˚
("/[^a-zA-Z0-9\-\_\.]/i", " ", 
$quîy
 ));

301 
$ªsu…s
 = 
	`¨øy
();

302 
$ªquúedW‹ds
 = 
	`¨øy
();

303 
$f‹biddíW‹ds
 = 
	`¨øy
();

304 
$foundW‹ds
 = 
	`¨øy
();

305 
$w‹d
=
	`°πok
(
$quîy
," ");

306 
$w‹d
)

308 i‡((
$w‹d
{0}=='+')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$ªquúedW‹ds
[]=$word; }

309 i‡((
$w‹d
{0}=='-')Ë{ $w‹d=
	`sub°r
($w‹d,1); 
$f‹biddíW‹ds
[]=$word; }

310 i‡(!
	`ö_¨øy
(
$w‹d
,
$foundW‹ds
))

312 
$foundW‹ds
[]=
$w‹d
;

313 
	`£¨ch
(
$fûe
,
	`°πﬁowî
(
$w‹d
),
$ªsu…s
);

315 
$w‹d
=
	`°πok
(" ");

317 
$docs
 = 
	`¨øy
();

318 
	`comböe_ªsu…s
(
$ªsu…s
,
$docs
);

321 
$fûãªdDocs
 = 
	`fûãr_ªsu…s
(
$docs
,
$ªquúedW‹ds
,
$f‹biddíW‹ds
);

323 
$s‹ãd
 = 
	`¨øy
();

324 
	`s‹t_ªsu…s
(
$fûãªdDocs
,
$s‹ãd
);

326 
	`ªp‹t_ªsu…s
(
$s‹ãd
);

327 
echo
 "</div>\n";

328 
	`íd_∑ge
();

329 
	`f˛o£
(
$fûe
);

330 
	}
}

	@gcm/modulos/idiomas/config/config.php

1 <?
php


2 
	g$c⁄fig
['IdiomaÖor defecto'] = 'es';

3 
	g$c⁄fig
['Idiomasáctivados'][] = 'ca';

4 
	g$c⁄fig
['Idiomasáctivados'][] = 'es';

5 
	g$c⁄fig
['Directorio idiomas'] = 'DATOS/configuracion/idiomas/';

	@gcm/modulos/idiomas/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['IdiomaÖor defecto']='IdiomaÖredeterminado';

	@gcm/modulos/idiomas/eventos_usuario.php

1 <?
php


5 
	g$evítos
['precarga']['seleccion_idioma'][1] = '';

6 
	g$evítos
['precarga']['definir_idioma'][2] = '';

7 
	g$evítos
['cabeceraDerecha']['selector_idiomas'][1] = '';

	@gcm/modulos/idiomas/info.php

1 <?
php


2 
	g$idiomas
['nombre']="Idiomas";

3 
	g$idiomas
['title']="Administrar idiomas";

	@gcm/modulos/idiomas/lib/Idiomas.php

1 <?
php


18 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/idiomas/lib/IdiomasCore.php');

40 ˛as†
	cIdiomas
 
exãnds
 
	mModulos
 {

42 
¥iv©e
 
	m$iIdiomas
;

44 
fun˘i⁄
 
	$__c⁄°ru˘
() {

46 
∑ª¡
::
	`__c⁄°ru˘
();

48 
globÆ
 
$gcm
;

50 
$¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

52 
$dú_idiomas
 = 
$gcm
->
	`c⁄fig
('idiomas','Directorio idiomas');

54 
$idiomaxde„˘o
 = 
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto');

56 
$idiomas_a˘ivados
 = 
$gcm
->
	`c⁄fig
('idiomas','Idiomasáctivados');

58 
$c⁄figuøci⁄
 = 
	`¨øy
–'dú_idiomas' => 
$dú_idiomas


59 , 'idiomaxde„˘o' => 
$idiomaxde„˘o


60 , 'idiomas_a˘ivados' => 
$idiomas_a˘ivados


61 , '¥oye˘o' => 
$¥oye˘o


64 
$this
->
iIdiomas
 = 
√w
 
	`IdiomasC‹e
(
$c⁄figuøci⁄
);

74 
fun˘i⁄
 
	$ö°Æaci⁄
(Ë{  
$this
->
iIdiomas
->
	`ö°Æaci⁄
(); 
	}
}

82 
fun˘i⁄
 
	$deföú_idioma
(){

84 
globÆ
 
$gcm
;

86 i‡–! 
	`is_fûe
(
Rouãr
::
$f
) ) {

89 
Rouãr
::
$f
=Rouãr::
$dd
.Rouãr::
$s
.Rouãr::
$c
;

91 i‡–! 
	`is_fûe
(
Rouãr
::
$f
) ) {

98 
$gcm
->
	`ªgi°ø
(
__FILE__
, 
__LINE__
, 'BuscamosÉn otros idioamas');

100 
	`f‹óch
(
$this
->
iIdiomas
->
	`gëIdiomasA˘ivados
(Ë
as
 
$key
 => 
$idioma
) {

101 
$fichîo_posibÀ
='Fûe/'.
$key
.
Rouãr
::
$s
.Rouãr::
$c
;

102 i‡–
	`is_fûe
(
$fichîo_posibÀ
) ) {

103 
$idiomas_posibÀs
[
$idioma
]=
$fichîo_posibÀ
;

108 i‡–! 
	`is£t
(
$idiomas_posibÀs
) ) {

109 
Rouãr
::
$sö_c⁄ãnido
=
TRUE
;

112 } 
	`ñ£if
 ( 
	`cou¡
(
$idiomas_posibÀs
) == 1 ) {

114 
	`li°
(
$idioma
, 
Rouãr
::
$f
Ë
	`óch
(
$idiomas_posibÀs
);

115 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Nÿ£Énc⁄åÿc⁄ãnidÿc⁄É»idiom®¥edëîmöado, sê¥e£¡®í ".
$idioma
,'AVISO');

120 
	`li°
(
$idioma
, 
Rouãr
::
$f
Ë
	`óch
(
$idiomas_posibÀs
);

127 
Rouãr
::
$sö_åaducci⁄
 = 
TRUE
;

131 
	}
}

143 
public
 
fun˘i⁄
 
	$£Àcci⁄_idioma
(Ë{  
$this
->
iIdiomas
->
	`£Àcci⁄_idioma
(); 
	}
}

149 
fun˘i⁄
 
	$¥ötF‹m
() {

151 
globÆ
 
$_POST
, 
$gcm
 ;

153 
echo
 'M√≥dulo sinácabar';

155 
$gcm
->
evít
->
	`™uœr
('contenido','idiomas');

160 
	`ö˛ude
(
$this
->
dú_idiomas
."idiomas.php");

164 
	`ö˛ude
(
$this
->
dú_idiomas
."desactivados.php");

166 
	`ö˛ude
 (
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('idiomas','html','form_idiomas.html'));

168 
	}
}

177 
public
 
fun˘i⁄
 
	$admöi°ør
() {

179 
globÆ
 
$gcm
;

182 
$¥e£¡¨_c⁄ãnido
 = 
FALSE
;

184 i‡–
	`is£t
(
$_POST
['conf'])) {

186 
	`ö˛ude
(
GCM_DIR
."funciones/gcm_arrayFile.php");

187 
	`gcm_ÀîAºay
(
$ARCHIVO
, 
$_SESSION
[
$gcm
->
	`c⁄fig
('admin','Proyecto').'-idioma'], 'si', 'si');

189 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['accion']) && $_POST['accion'] == 'escribir') {

191 
	`ö˛ude
(
GCM_DIR
."funciones/gcm_arrayFile.php");

193 i‡–! 
	`c›üSeguridad
(
$ARCHIVO
) ) {

194 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'No seÖudo hacer copia de seguridad','ADMIN');

198 i‡(
	`gcm_es¸ibúAºay
(
$ARCHIVO
Ë==
FALSE
){

199 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'No seÖudo guardarÜos cambios','ERROR');

200  
Ál£
;

202 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Archivo modificado','AVISO');

204 
$this
->
	`¥ötF‹m
();

205  
åue
;

207 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['idioma']) ) {

209 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Sêˇmbü idiom®¥edëîmöadÿ®'.
$_POST
['idioma'],'AVISO');

211 
$gcm
->
	`c⁄fig
('idiomas','Idiom®p‹ de„˘o',
$_POST
['idioma']);

213 
$this
->
	`¥ötF‹m
();

215 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['nuevoIdioma']) ) {

216 
$nombªIdioma
=
$_POST
['idiomaNombre'];

217 
$codIdioma
=
	`sub°r
(
$_POST
['idiomaNombre'],0,3);

220 
$¨chivoIdioma
=
$this
->
dú_idiomas
."LG_".
$codIdioma
.".php";

221 i‡(!
$fûe
 = 
	`f›í
(
$¨chivoIdioma
, "w")) {

222 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Nÿ£Öuedê¸ó∏¨chivÿidiom®".
$¨chivoIdioma
,'ERROR');

223  
FALSE
;

225 
	`Âuts
(
$fûe
, "<?php\n");

226 
	`Âuts
(
$fûe
, "?>");

227 
	`f˛o£
(
$fûe
);

230 i‡–
	`is£t
(
$_FILES
['imagenIdioma'])) {

231 
	`ö˛ude
(
GCM_DIR
."lib/int/gcm_imagen.php");

232 
echo
 "C›ündÿimagíá DATOS/idiomas/".
$codIdioma
.".gif";

233 i‡–! 
	`gcm_imagí_c›ür
(
$_FILES
["imagíIdioma"],
$this
->
dú_idiomas
."".
$codIdioma
.".gif") ) {

234 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'No seÖudo subir im√°gen','AVISO');

238 
	`ö˛ude_⁄˚
(
GCM_DIR
."funciones/gcm_arrayFile.php");

239 i‡–
	`gcm_™yadúEÀmíto
(
$this
->
dú_idiomas
."idiomas.php", 
$codIdioma
, 
$nombªIdioma
Ë==
FALSE
 ) {

240 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'No seÖudoá√±adir idiomaÇuevo','ERROR');

243 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['modificarIdioma']) ) {

244 
$nombªIdioma
=
$_POST
['idiomaNombre'];

245 
$codIdioma
=
$_POST
['codIdioma'];

248 i‡–
	`is£t
(
$_FILES
['imagenIdioma'])) {

249 
	`ö˛ude
(
GCM_DIR
."lib/int/gcm_imagen.php");

250 
echo
 "C›ündÿimagíá DATOS/idiomas/".
$codIdioma
.".gif";

251 i‡–! 
	`gcm_imagí_c›ür
(
$_FILES
["imagíIdioma"],
$this
->
dú_idiomas
."".
$codIdioma
.".gif") ) {

252 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'No seÖudo subir im√°gen','AVISO');

256 
	`ö˛ude_⁄˚
(
GCM_DIR
."funciones/gcm_arrayFile.php");

257 i‡–
	`gcm_™yadúEÀmíto
(
$this
->
dú_idiomas
."idiomas.php", 
$codIdioma
, 
$nombªIdioma
Ë==
FALSE
 ) {

258 
$GCM_ERROR
[]="Mod:idiomas::No seÖudoá√±adir idiomaÇuevoá DATOS/idiomas/idiomas.php";

260 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Idioma modificado','AVISO');

261 
$this
->
	`¥ötF‹m
();

263 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['eliminarIdioma']) ) {

265 
echo
 "PENDIENTE DE PROGRAMAR: Elimö¨ ".
$_POST
['codIdioma'];

271 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['desactivarIdioma']) ) {

273 
	`ö˛ude
(
GCM_DIR
."funciones/gcm_arrayFile.php");

276 
$fûeIdiomas
=
$this
->
dú_idiomas
."idiomas.php";

277 
$fûeDeß˘ivados
=
$this
->
dú_idiomas
."desactivados.php";

278 
$codIdioma
=
$_POST
['codIdioma'];

279 
$«meIdioma
=
$_POST
['nameIdioma'];

281 i‡–
	`gcm_™yadúEÀmíto
(
$fûeDeß˘ivados
, 
$codIdioma
, 
$«meIdioma
Ë==
FALSE
 ) {

282 
$gcm
->
	`ªgi°ø
(
__FILE__
, 
__LINE__
, "Nÿ£Öudÿa√±adúÉÀmítÿí ".
$fûeIdiomas
,'ERROR');

285 
	`gcm_ñimö¨EÀmíto
(
$fûeIdiomas
, 
$codIdioma
);

286 
$gcm
->
	`ªgi°ø
(
__FILE__
, 
__LINE__
, 'Idioma: '.
$«meIdioma
." desactivado",'AVISO');

288 
$this
->
	`¥ötF‹m
();

290 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['activarIdioma']) ) {

292 
	`ö˛ude
(
GCM_DIR
."funciones/gcm_arrayFile.php");

295 
$fûeIdiomas
=
$this
->
dú_idiomas
."idiomas.php";

296 
$fûeDeß˘ivados
=
$this
->
dú_idiomas
."desactivados.php";

297 
$codIdioma
=
$_POST
['codIdioma'];

298 
$«meIdioma
=
$_POST
['nameIdioma'];

300 i‡–
	`gcm_™yadúEÀmíto
(
$fûeIdiomas
, 
$codIdioma
, 
$«meIdioma
Ë==
FALSE
 ) {

301 
$gcm
->
	`ªgi°ø
(
__FILE__
, 
__LINE__
, "Nÿ£Öudÿa√±adúÉÀmítÿí ".
$fûeIdiomas
, 'ERROR');

304 
	`gcm_ñimö¨EÀmíto
(
$fûeDeß˘ivados
, 
$codIdioma
);

305 
$gcm
->
	`ªgi°ø
(
__FILE__
, 
__LINE__
, 'Idioma: '.
$«meIdioma
."áctivado",'AVISO');

307 
$this
->
	`¥ötF‹m
();

311 
$this
->
	`¥ötF‹m
();

315 
	}
}

323 
fun˘i⁄
 
	$£À˘‹_idiomas
(Ë{ 
$this
->
iIdiomas
->
	`£À˘‹_idiomas
(); 
	}
}

330 
fun˘i⁄
 
	$b™dîas
() {

332 
globÆ
 
$gcm
;

334 
$this
->
iIdiomas
->
	`b™dîas
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('idiomas','html','banderas.html'));

335 
	}
}

	@gcm/modulos/idiomas/menuAdmin.php

1 <?
php


2 
	g$míuAdmö
['Administraci√≥n']['boton']['idiomas']['activado']=1;

3 
	g$míuAdmö
['Administraci√≥n']['boton']['idiomas']['nombre']="Idiomas";

4 
	g$míuAdmö
['Administraci√≥n']['boton']['idiomas']['title']="Administracion deÜos diferentes idiomas";

5 
	g$míuAdmö
['Administraci√≥n']['boton']['idiomas']['link']="?m=idiomas&a=administrar";

	@gcm/modulos/imagenes/config/config.php

1 <?
php


2 
	g$c⁄fig
['altoMaxImg']='800';

3 
	g$c⁄fig
['altoMaxMiniatura']='200';

4 
	g$c⁄fig
['anchoMaxImg']='1000';

5 
	g$c⁄fig
['anchoMaxMiniatura']='300';

	@gcm/modulos/imagenes/config/config_ca.php

1 <?
php


2 
	g$c⁄fig_DESC
['anchoMaxImg']='amplada m√†xima deÜes imatges';

3 
	g$c⁄fig_DESC
['altoMaxImg']='Altura m√†xima deÜes imatges';

4 
	g$c⁄fig_DESC
['anchoMaxMiniatura']='';

5 
	g$c⁄fig_DESC
['altoMaxMiniatura']='';

	@gcm/modulos/imagenes/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['anchoMaxImg']='';

3 
	g$c⁄fig_DESC
['altoMaxImg']='';

4 
	g$c⁄fig_DESC
['anchoMaxMiniatura']='';

5 
	g$c⁄fig_DESC
['altoMaxMiniatura']='';

	@gcm/modulos/imagenes/eventos_admin.php

1 <?
php


7 
	g$evítos
['columna']['formulario'][3] = '';

13 
	g$acci⁄es
['imagenes']['formulario'][] = 'editor';

	@gcm/modulos/imagenes/eventos_usuario.php

1 <?
php


19 
	g$evítos
['postcontenido']['imagenes2thickbox'][3] = '';

	@gcm/modulos/imagenes/lib/Imagenes.php

1 <?
php


21 ˛as†
	cImagíes
 
exãnds
 
	mModulos
 {

23 
public
 
	m$ÆtoMaxImg
;

24 
public
 
	m$™choMaxImg
;

25 
public
 
	m$ÆtoMaxMöütuø
;

26 
public
 
	m$™choMaxMöütuø
;

30 
¥iv©e
 
	m$¥oye˘o
;

34 
¥iv©e
 
	m$idioma
;

38 
fun˘i⁄
 
	$__c⁄°ru˘
() {

40 
globÆ
 
$gcm
;

42 
∑ª¡
::
	`__c⁄°ru˘
();

44 
$this
->
ÆtoMaxImg
 = $this->
	`c⁄fig
('altoMaxImg');

45 
$this
->
™choMaxImg
 = $this->
	`c⁄fig
('anchoMaxImg');

46 
$this
->
ÆtoMaxMöütuø
 = $this->
	`c⁄fig
('altoMaxMiniatura');

47 
$this
->
™choMaxMöütuø
 = $this->
	`c⁄fig
('anchoMaxMiniatura');

49 
$this
->
¥oye˘o
 = 
$gcm
->
	`c⁄fig
('admin','Proyecto');

50 
$this
->
idioma
 = 
$gcm
->
	`c⁄fig
('idiomas','IdiomaÖor defecto');

63 
fun˘i⁄
 
	$gÆîü
(
$e
, 
$¨gs
 = 
FALSE
) {

65 
globÆ
 
$gcm
;

67 
$£cci⁄
 = ( 
	`is£t
(
$_REQUEST
['s']ËË? $_REQUEST['s'] : 
FALSE
;

68 i‡–! 
$£cci⁄
 ) $£cci⁄ = 
Rouãr
::
$dd
.Rouãr::
$s
 ;

69 
$£cci⁄
 = 
	`com¥ob¨_b¨ø
($seccion);

70 i‡–
	`°Ωos
(
$£cci⁄
,
Rouãr
::
$dd
Ë==
FALSE
 ) {

71 
$£cci⁄
 = 
Rouãr
::
$dd
.$seccion;

74 
$imagí_a˘uÆ
 = ( 
	`is£t
(
$_GET
['img']ËË? $_GET['img'] : 
FALSE
 ;

76 i‡–
Rouãr
::
$f‹m©o
 != 'ajax' ) {

78 
$gcm
->
tôulo
 = 
	`lôîÆ
('Galer√≠a de im√°genes',3);

79 
$gcm
->
evít
->
	`™uœr
('contenido','imagenes');

80 
$gcm
->
evít
->
	`™uœr
('titulo','imagenes');

84 
$this
->
	`libªrüs_js
('jquery.ui.widget.js');

85 
$this
->
	`libªrüs_js
('jquery.iframe-transport.js');

86 
$this
->
	`libªrüs_js
('jquery.fileupload.js');

88 
$this
->
	`libªrüs_js
('jquery.colorbox.js');

89 
$this
->
	`javas¸ùts
('imagenes.js');

90 
$this
->
	`javas¸ùts
('aplicar_colorbox.js');

94 <
div
 
id
='thumbnails' >

96 <?
php


99 i‡–
	`≥rmiso
('administrar_imagenes') ) {

103 <
f‹m
>

104 <
öput
 
°yÀ
="di•œy:Ç⁄e;" 
⁄˛ick
="subida_imagíes_jquîy('fûeu∂ﬂd','¥ogeso','gÆîü','<?ph∞echÿ$£cci⁄ ?>');" 
id
="fûeu∂ﬂd" 
ty≥
="fûe" 
«me
="fûes[]" 
∂a˚hﬁdî
="Subú im√°gíes" 
d©a
-
uæ
="?f‹m©o˜jax&m=imagíes&a=u∂ﬂd&£cci⁄=<?ph∞echÿ$£cci⁄;?>" 
mu…ùÀ
>

105 <
öput
 
⁄˛ick
="$('#fûeu∂ﬂd').˛ick();ªtu∫ fÆ£;" 
ty≥
="submô" 
vÆue
="<?phpÉchoÜiteral('Subir imagen');?>">

106 </
f‹m
>

107 <
div
 
id
="progreso">

108 <
div
 
˛ass
="b¨" 
°yÀ
="width: 0%;"></div>

109 </
div
>

110 <
div
 
id
="mensajes"></div>

112 <?
php
 } ?>

114 <
div
 
id
='cajaImg'>

116 <?
php


117 
	`ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/gcm_imagen.php');

118 
$d©os
 = 
	`gcm_li°aImagíes
(
$£cci⁄
, 5);

119 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('imagenes','html','contenido.phtml'));

121 </
div
> <!-- 
Aˇba
 
ˇjaImg
 -->

122 </
div
> <!-- 
Aˇba
 
thumb«ûs
 -->

123 <?
php


125 
	}
}

134 
fun˘i⁄
 
	$imagíes2thickbox
(
$e
, 
$¨gs
=
FALSE
) {

136 
globÆ
 
$gcm
;

138 
$this
->
	`libªrüs_js
('jquery.colorbox.js');

139 
$this
->
	`javas¸ùts
('imagenes.js');

141 <
s¸ùt
>

142 
	`addLﬂdEvít
(
	`fun˘i⁄
(){

143 
	`img2thickbox
();

145 </
s¸ùt
>

146 <?
php


147 
	}
}

	@gcm/modulos/imagenes/lib/ImagenesAdmin.php

1 <?
php


8 
ªquúe_⁄˚
 ( 'Imagenes.php' );

14 ˛as†
	cImagíesAdmö
 
exãnds
 
	mImagíes
 {

18 
fun˘i⁄
 
	$__c⁄°ru˘
() {

20 
globÆ
 
$gcm
;

22 
∑ª¡
::
	`__c⁄°ru˘
();

35 
fun˘i⁄
 
	$f‹muœrio
(
$e
, 
$¨gs
 = 
FALSE
) {

37 i‡–! 
	`≥rmiso
('administrar_imagenes') )  ;

40 
$this
->
	`libªrüs_js
('jquery.ui.widget.js');

41 
$this
->
	`libªrüs_js
('jquery.iframe-transport.js');

42 
$this
->
	`libªrüs_js
('jquery.fileupload.js');

43 
$this
->
	`libªrüs_js
('jquery.colorbox.js');

44 
$this
->
	`javas¸ùts
('imagenes.js');

45 
$this
->
	`javas¸ùts
('aplicar_colorbox.js');

46 
$c⁄ãnido
 = '<div id="thumbnails_columna"></div>';

48 
$∑√l
 = 
	`¨øy
();

49 
$∑√l
['tôulo'] = 
	`lôîÆ
('Im√°genes',3);

50 
$∑√l
['href'] = '/imagenes/galeria';

51 
$∑√l
['ocu…o'] = 
TRUE
;

52 
$∑√l
['jajax'] = 
Rouãr
::
$dú
.'?f‹m©o˜jax&m=imagíes&a=gÆîü_cﬁum«&s='.Rouãr::
$dd
.Rouãr::
$s
;

53 
$∑√l
['c⁄ãnido'] = 
$c⁄ãnido
;

55 
Temas
::
	`∑√l
(
$∑√l
);

58 
	}
}

64 
fun˘i⁄
 
	$b‹ørImg
() {

66 
globÆ
 
$gcm
;

68 
	`ob_íd_˛ón
();

69 
	`ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/gcm_imagen.php');

70 i‡–! 
	`gcm_b‹ørImagí
(
$_GET
['img']) ) {

71 
¥öt
 
	`js⁄_ícode
(
	`¨øy
('Errorál borrar imagen'));

73 
$ªs
[] = 0;

74 
$ªs
[] = 
	`dú«me
(
$_GET
['img']) ;

75 
¥öt
 
	`js⁄_ícode
(
$ªs
);

77 
	`exô
();

78 
	}
}

84 
fun˘i⁄
 
	$gÆîü_cﬁum«
(
$e
, 
$¨gs
 = 
FALSE
) {

86 
globÆ
 
$gcm
;

88 
$£cci⁄
 = ( 
	`is£t
(
$_REQUEST
['s']ËË? $_REQUEST['s'] : 
FALSE
;

89 i‡–! 
$£cci⁄
 ) $£cci⁄ = 
Rouãr
::
$dd
.Rouãr::
$s
 ;

90 
$£cci⁄
 = 
	`com¥ob¨_b¨ø
($seccion);

91 i‡–
	`°Ωos
(
$£cci⁄
,
Rouãr
::
$dd
Ë==
FALSE
 ) {

92 
$£cci⁄
 = 
Rouãr
::
$dd
.$seccion;

96 <
div
 
id
='thumbnails_columna' >

98 <?
php


101 i‡–
	`≥rmiso
('administrar_imagenes') ) {

105 <
f‹m
>

106 <
öput
 
°yÀ
="di•œy:Ç⁄e;" 
⁄˛ick
="subida_imagíes_jquîy('fûeu∂ﬂd_cﬁum«','¥ogªso_cﬁum«','gÆîü_cﬁum«','<?ph∞echÿ$£cci⁄ ?>');" 
id
="fûeu∂ﬂd_cﬁum«" 
ty≥
="fûe" 
«me
="fûes[]" 
∂a˚hﬁdî
="Subú im√°gíes" 
d©a
-
uæ
="?f‹m©o˜jax&m=imagíes&a=u∂ﬂd&£cci⁄=<?ph∞echÿ$£cci⁄;?>" 
mu…ùÀ
>

107 <
öput
 
⁄˛ick
="$('#fûeu∂ﬂd_cﬁum«').˛ick();ªtu∫ fÆ£;" 
ty≥
="submô" 
vÆue
="<?phpÉchoÜiteral('Subir imagen');?>">

108 </
f‹m
>

109 <
div
 
id
="progreso_columna">

110 <
div
 
˛ass
="b¨" 
°yÀ
="width: 0%;"></div>

111 </
div
>

112 <
div
 
id
="mensajes"></div>

114 <?
php
 } ?>

116 <
div
 
id
='cajaImg'>

118 <?
php


119 
	`ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/gcm_imagen.php');

120 
$d©os
 = 
	`gcm_li°aImagíes
(
$£cci⁄
, 5);

121 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('imagenes','html','columna.phtml'));

123 </
div
> <!-- 
Aˇba
 
ˇjaImg
 -->

124 </
div
> <!-- 
Aˇba
 
thumb«ûs
 -->

125 <?
php


127 
	}
}

133 
fun˘i⁄
 
	$u∂ﬂd
(
$e
, 
$¨gs
 = 
FALSE
) {

135 
globÆ
 
$gcm
;

137 
	`ªquúe
('UploadHandler.php');

138 
$›ci⁄es
 = 
	`¨øy
(

139 'image_vîsi⁄s' => 
	`¨øy
(

140 '' => 
	`¨øy
(

141 'max_width' => 
$this
->
™choMaxImg
,

142 'max_height' => 
$this
->
ÆtoMaxImg
,

145 'thumb«û' => 
	`¨øy
(

146 'max_width' => 
$this
->
™choMaxMöütuø
,

147 'max_height' => 
$this
->
ÆtoMaxMöütuø


152 
$u∂ﬂd_h™dÀr
 = 
√w
 
	`U∂ﬂdH™dÀr
(
$›ci⁄es
);

155 
	}
}

	@gcm/modulos/imagenes/lib/UploadHandler.php

1 <?
php


13 ˛as†
	cU∂ﬂdH™dÀr


15 
¥Ÿe˘ed
 
	m$›ti⁄s
;

18 
¥Ÿe˘ed
 
	m$îr‹_mesßges
 = 
¨øy
(

37 
fun˘i⁄
 
	$__c⁄°ru˘
(
$›ti⁄s
 = 
nuŒ
, 
$öôülize
 = 
åue
) {

39 
globÆ
 
$gcm
;

41 
$£cci⁄
 = ( 
	`is£t
(
$_REQUEST
['£cci⁄']ËË? $_REQUEST['£cci⁄'] : 
Rouãr
::
$dd
.Rouãr::
$s
;

43 
$this
->
›ti⁄s
 = 
	`¨øy
(

44 's¸ùt_uæ' => 
$this
->
	`gë_fuŒ_uæ
().'/',

45 'u∂ﬂd_dú' => 
$£cci⁄
,

46 'u∂ﬂd_uæ' => 
$this
->
	`gë_fuŒ_uæ
().'/'.
$£cci⁄
,

47 'u£r_dús' => 
Ál£
,

54 'ac˚ss_c⁄åﬁ_Ælow_¸edítüls' => 
Ál£
,

55 'ac˚ss_c⁄åﬁ_Ælow_mëhods' => 
	`¨øy
(

64 'ac˚ss_c⁄åﬁ_Ælow_hódîs' => 
	`¨øy
(

70 'dow∆ﬂd_vü_php' => 
Ál£
,

77 'max_fûe_size' => 
nuŒ
,

80 'max_numbî_of_fûes' => 
nuŒ
,

82 'max_width' => 
nuŒ
,

83 'max_height' => 
nuŒ
,

87 'disˇrd_ab‹ãd_u∂ﬂds' => 
åue
,

89 '‹õ¡_image' => 
Ál£
,

90 'image_vîsi⁄s' => 
	`¨øy
(

108 'thumb«û' => 
	`¨øy
(

114 i‡(
$›ti⁄s
) {

115 
$this
->
›ti⁄s
 = 
	`¨øy_mîge
($this->›ti⁄s, 
$›ti⁄s
);

117 i‡(
$öôülize
) {

118 
$this
->
	`öôülize
();

122 
¥Ÿe˘ed
 
fun˘i⁄
 
	$öôülize
() {

123 
$_SERVER
['REQUEST_METHOD']) {

126 
$this
->
	`hód
();

129 
$this
->
	`gë
();

134 
$this
->
	`po°
();

137 
$this
->
	`dñëe
();

140 
$this
->
	`hódî
('HTTP/1.1 405 Method Not Allowed');

142 
	}
}

144 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fuŒ_uæ
() {

145 
$hâps
 = !
	`em±y
(
$_SERVER
['HTTPS']) && $_SERVER['HTTPS'] !== 'off';

147 (
$hâps
 ? 'https://' : 'http://').

148 (!
	`em±y
(
$_SERVER
['REMOTE_USER']) ? $_SERVER['REMOTE_USER'].'@' : '').

149 (
	`is£t
(
$_SERVER
['HTTP_HOST']) ? $_SERVER['HTTP_HOST'] : ($_SERVER['SERVER_NAME'].

150 (
$hâps
 && 
$_SERVER
['SERVER_PORT'] === 443 ||

151 
$_SERVER
['SERVER_PORT'] === 80 ? '' : ':'.$_SERVER['SERVER_PORT']))).

152 
	`sub°r
(
$_SERVER
['SCRIPT_NAME'],0, 
	`°ºpos
($_SERVER['SCRIPT_NAME'], '/'));

153 
	}
}

155 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_u£r_id
() {

156 @
	`£ssi⁄_°¨t
();

157  
	`£ssi⁄_id
();

158 
	}
}

160 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_u£r_∑th
() {

161 i‡(
$this
->
›ti⁄s
['user_dirs']) {

162  
$this
->
	`gë_u£r_id
().'/';

165 
	}
}

167 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_u∂ﬂd_∑th
(
$fûe_«me
 = 
nuŒ
, 
$vîsi⁄
 =Çull) {

168 
$fûe_«me
 = $file_name ? $file_name : '';

169 
$vîsi⁄_∑th
 = 
	`em±y
(
$vîsi⁄
) ? '' : $version.'/';

170  
$this
->
›ti⁄s
['u∂ﬂd_dú'].$this->
	`gë_u£r_∑th
()

171 .
$vîsi⁄_∑th
.
$fûe_«me
;

172 
	}
}

174 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_quîy_£∑øt‹
(
$uæ
) {

175  
	`°Ωos
(
$uæ
, '?'Ë==
Ál£
 ? '?' : '&';

176 
	}
}

178 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_dow∆ﬂd_uæ
(
$fûe_«me
, 
$vîsi⁄
 = 
nuŒ
) {

179 i‡(
$this
->
›ti⁄s
['download_via_php']) {

180 
$uæ
 = 
$this
->
›ti⁄s
['script_url']

181 .
$this
->
	`gë_quîy_£∑øt‹
($this->
›ti⁄s
['script_url'])

182 .'fûe='.
	`øwuæícode
(
$fûe_«me
);

183 i‡(
$vîsi⁄
) {

184 
$uæ
 .'&vîsi⁄='.
	`øwuæícode
(
$vîsi⁄
);

186  
$uæ
.'&download=1';

188 
$vîsi⁄_∑th
 = 
	`em±y
(
$vîsi⁄
Ë? '' : 
	`øwuæícode
($version).'/';

189  
$this
->
›ti⁄s
['u∂ﬂd_uæ'].$this->
	`gë_u£r_∑th
()

190 .
$vîsi⁄_∑th
.
	`øwuæícode
(
$fûe_«me
);

191 
	}
}

193 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£t_fûe_dñëe_¥›îtõs
(
$fûe
) {

194 
$fûe
->
dñëe_uæ
 = 
$this
->
›ti⁄s
['script_url']

195 .
$this
->
	`gë_quîy_£∑øt‹
($this->
›ti⁄s
['script_url'])

196 .'fûe='.
	`øwuæícode
(
$fûe
->
«me
);

197 
$fûe
->
dñëe_ty≥
 = 
$this
->
›ti⁄s
['delete_type'];

198 i‡(
$fûe
->
dñëe_ty≥
 !== 'DELETE') {

199 
$fûe
->
dñëe_uæ
 .= '&_method=DELETE';

201 i‡(
$this
->
›ti⁄s
['access_control_allow_credentials']) {

202 
$fûe
->
dñëe_wôh_¸edítüls
 = 
åue
;

204 
	}
}

208 
¥Ÿe˘ed
 
fun˘i⁄
 
	$fix_öãgî_ovîÊow
(
$size
) {

209 i‡(
$size
 < 0) {

210 
$size
 +2.0 * (
PHP_INT_MAX
 + 1);

212  
$size
;

213 
	}
}

215 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fûe_size
(
$fûe_∑th
, 
$˛ór_°©_ˇche
 = 
Ál£
) {

216 i‡(
$˛ór_°©_ˇche
) {

217 
	`˛ór°©ˇche
(
åue
, 
$fûe_∑th
);

219  
$this
->
	`fix_öãgî_ovîÊow
(
	`fûesize
(
$fûe_∑th
));

221 
	}
}

223 
¥Ÿe˘ed
 
fun˘i⁄
 
	$is_vÆid_fûe_obje˘
(
$fûe_«me
) {

224 
$fûe_∑th
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
);

225 i‡(
	`is_fûe
(
$fûe_∑th
Ë&& 
$fûe_«me
[0] !== '.') {

226  
åue
;

228  
Ál£
;

229 
	}
}

231 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fûe_obje˘
(
$fûe_«me
) {

232 i‡(
$this
->
	`is_vÆid_fûe_obje˘
(
$fûe_«me
)) {

233 
$fûe
 = 
√w
 
	`°dCœss
();

234 
$fûe
->
«me
 = 
$fûe_«me
;

235 
$fûe
->
size
 = 
$this
->
	`gë_fûe_size
(

236 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
)

238 
$fûe
->
uæ
 = 
$this
->
	`gë_dow∆ﬂd_uæ
($fûe->
«me
);

239 
	`f‹óch
(
$this
->
›ti⁄s
['image_vîsi⁄s'] 
as
 
$vîsi⁄
 => 
$›ti⁄s
) {

240 i‡(!
	`em±y
(
$vîsi⁄
)) {

241 i‡(
	`is_fûe
(
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
, 
$vîsi⁄
))) {

242 
$fûe
->{
$vîsi⁄
.'_uæ'} = 
$this
->
	`gë_dow∆ﬂd_uæ
(

243 
$fûe
->
«me
,

244 
$vîsi⁄


249 
$this
->
	`£t_fûe_dñëe_¥›îtõs
(
$fûe
);

250  
$fûe
;

252  
nuŒ
;

253 
	}
}

255 
¥Ÿe˘ed
 
fun˘i⁄
 
gë_fûe_obje˘s
(
$ôî©i⁄_mëhod
 = 'get_file_object') {

256 
$u∂ﬂd_dú
 = 
$this
->
gë_u∂ﬂd_∑th
();

257 i‡(!
is_dú
(
$u∂ﬂd_dú
)) {

258  
¨øy
();

260  
¨øy_vÆues
(
¨øy_fûãr
(
¨øy_m≠
(

261 
¨øy
(
$this
, 
$ôî©i⁄_mëhod
),

262 
sˇndú
(
$u∂ﬂd_dú
)

266 
¥Ÿe˘ed
 
fun˘i⁄
 
	$cou¡_fûe_obje˘s
() {

267  
	`cou¡
(
$this
->
	`gë_fûe_obje˘s
('is_valid_file_object'));

268 
	}
}

270 
¥Ÿe˘ed
 
fun˘i⁄
 
	$¸óã_sˇÀd_image
(
$fûe_«me
, 
$vîsi⁄
, 
$›ti⁄s
) {

271 
$fûe_∑th
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
);

272 i‡(!
	`em±y
(
$vîsi⁄
)) {

273 
$vîsi⁄_dú
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
nuŒ
, 
$vîsi⁄
);

274 i‡(!
	`is_dú
(
$vîsi⁄_dú
)) {

275 
	`mkdú
(
$vîsi⁄_dú
, 
$this
->
›ti⁄s
['mkdú_mode'], 
åue
);

277 
$√w_fûe_∑th
 = 
$vîsi⁄_dú
.'/'.
$fûe_«me
;

279 
$√w_fûe_∑th
 = 
$fûe_∑th
;

281 
	`li°
(
$img_width
, 
$img_height
Ë@
	`gëimagesize
(
$fûe_∑th
);

282 i‡(!
$img_width
 || !
$img_height
) {

283  
Ál£
;

285 
$sˇÀ
 = 
	`mö
(

286 
$›ti⁄s
['max_width'] / 
$img_width
,

287 
$›ti⁄s
['max_height'] / 
$img_height


289 i‡(
$sˇÀ
 >= 1) {

290 i‡(
$fûe_∑th
 !=
$√w_fûe_∑th
) {

291  
	`c›y
(
$fûe_∑th
, 
$√w_fûe_∑th
);

293  
åue
;

295 
$√w_width
 = 
$img_width
 * 
$sˇÀ
;

296 
$√w_height
 = 
$img_height
 * 
$sˇÀ
;

297 
$√w_img
 = @
	`image¸óãåuecﬁ‹
(
$√w_width
, 
$√w_height
);

298 
	`°πﬁowî
(
	`sub°r
(
	`°ºchr
(
$fûe_«me
, '.'), 1))) {

301 
$§c_img
 = @
	`image¸óã‰omj≥g
(
$fûe_∑th
);

302 
$wrôe_image
 = 'imagejpeg';

303 
$image_quÆôy
 = 
	`is£t
(
$›ti⁄s
['jpeg_quality']) ?

304 
$›ti⁄s
['jpeg_quality'] : 75;

307 @
	`imagecﬁ‹å™•¨ít
(
$√w_img
, @
	`imagecﬁ‹Æloˇã
($new_img, 0, 0, 0));

308 
$§c_img
 = @
	`image¸óã‰omgif
(
$fûe_∑th
);

309 
$wrôe_image
 = 'imagegif';

310 
$image_quÆôy
 = 
nuŒ
;

313 @
	`imagecﬁ‹å™•¨ít
(
$√w_img
, @
	`imagecﬁ‹Æloˇã
($new_img, 0, 0, 0));

314 @
	`imagóÕhabÀndög
(
$√w_img
, 
Ál£
);

315 @
	`imageßvóÕha
(
$√w_img
, 
åue
);

316 
$§c_img
 = @
	`image¸óã‰om≤g
(
$fûe_∑th
);

317 
$wrôe_image
 = 'imagepng';

318 
$image_quÆôy
 = 
	`is£t
(
$›ti⁄s
['png_quality']) ?

319 
$›ti⁄s
['png_quality'] : 9;

322 
$§c_img
 = 
nuŒ
;

324 
$suc˚ss
 = 
$§c_img
 && @
	`imagec›yªßm∂ed
(

325 
$√w_img
,

326 
$§c_img
,

328 
$√w_width
,

329 
$√w_height
,

330 
$img_width
,

331 
$img_height


332 Ë&& 
	`$wrôe_image
(
$√w_img
, 
$√w_fûe_∑th
, 
$image_quÆôy
);

334 @
	`imagede°roy
(
$§c_img
);

335 @
	`imagede°roy
(
$√w_img
);

336  
$suc˚ss
;

337 
	}
}

339 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_îr‹_mesßge
(
$îr‹
) {

340  
	`¨øy_key_exi°s
(
$îr‹
, 
$this
->
îr‹_mesßges
) ?

341 
$this
->
îr‹_mesßges
[
$îr‹
] : $error;

342 
	}
}

344 
fun˘i⁄
 
	$gë_c⁄fig_byãs
(
$vÆ
) {

345 
$vÆ
 = 
	`åim
($val);

346 
$œ°
 = 
	`°πﬁowî
(
$vÆ
[
	`°æí
($val)-1]);

347 
$œ°
) {

349 
$vÆ
 *= 1024;

351 
$vÆ
 *= 1024;

353 
$vÆ
 *= 1024;

355  
$this
->
	`fix_öãgî_ovîÊow
(
$vÆ
);

356 
	}
}

358 
¥Ÿe˘ed
 
fun˘i⁄
 
	$vÆid©e
(
$u∂ﬂded_fûe
, 
$fûe
, 
$îr‹
, 
$ödex
) {

359 i‡(
$îr‹
) {

360 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
(
$îr‹
);

361  
Ál£
;

363 
$c⁄ã¡_Àngth
 = 
$this
->
	`fix_öãgî_ovîÊow
(
	`ötvÆ
(
$_SERVER
['CONTENT_LENGTH']));

364 
$po°_max_size
 = 
$this
->
	`gë_c⁄fig_byãs
(
	`öi_gë
('post_max_size'));

365 i‡(
$po°_max_size
 && (
$c⁄ã¡_Àngth
 > $post_max_size)) {

366 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('post_max_size');

367  
Ál£
;

369 i‡(!
	`¥eg_m©ch
(
$this
->
›ti⁄s
['ac˚±_fûe_ty≥s'], 
$fûe
->
«me
)) {

370 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('accept_file_types');

371  
Ál£
;

373 i‡(
$u∂ﬂded_fûe
 && 
	`is_u∂ﬂded_fûe
($uploaded_file)) {

374 
$fûe_size
 = 
$this
->
	`gë_fûe_size
(
$u∂ﬂded_fûe
);

376 
$fûe_size
 = 
$c⁄ã¡_Àngth
;

378 i‡(
$this
->
›ti⁄s
['max_file_size'] && (

379 
$fûe_size
 > 
$this
->
›ti⁄s
['max_file_size'] ||

380 
$fûe
->
size
 > 
$this
->
›ti⁄s
['max_file_size'])

382 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('max_file_size');

383  
Ál£
;

385 i‡(
$this
->
›ti⁄s
['min_file_size'] &&

386 
$fûe_size
 < 
$this
->
›ti⁄s
['min_file_size']) {

387 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('min_file_size');

388  
Ál£
;

390 i‡(
	`is_öt
(
$this
->
›ti⁄s
['max_number_of_files']) && (

391 
$this
->
	`cou¡_fûe_obje˘s
(Ë>$this->
›ti⁄s
['max_number_of_files'])

393 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('max_number_of_files');

394  
Ál£
;

396 
	`li°
(
$img_width
, 
$img_height
Ë@
	`gëimagesize
(
$u∂ﬂded_fûe
);

397 i‡(
	`is_öt
(
$img_width
)) {

398 i‡(
$this
->
›ti⁄s
['max_width'] && 
$img_width
 > $this->options['max_width']) {

399 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('max_width');

400  
Ál£
;

402 i‡(
$this
->
›ti⁄s
['max_height'] && 
$img_height
 > $this->options['max_height']) {

403 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('max_height');

404  
Ál£
;

406 i‡(
$this
->
›ti⁄s
['mö_width'] && 
$img_width
 < $this->options['min_width']) {

407 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('min_width');

408  
Ál£
;

410 i‡(
$this
->
›ti⁄s
['mö_height'] && 
$img_height
 < $this->options['min_height']) {

411 
$fûe
->
îr‹
 = 
$this
->
	`gë_îr‹_mesßge
('min_height');

412  
Ál£
;

415  
åue
;

416 
	}
}

418 
¥Ÿe˘ed
 
fun˘i⁄
 
	$upcou¡_«me_ˇŒback
(
$m©ches
) {

419 
$ödex
 = 
	`is£t
(
$m©ches
[1]Ë? 
	`ötvÆ
($matches[1]) + 1 : 1;

420 
$ext
 = 
	`is£t
(
$m©ches
[2]) ? $matches[2] : '';

421  ' ('.
$ödex
.')'.
$ext
;

422 
	}
}

424 
¥Ÿe˘ed
 
fun˘i⁄
 
	$upcou¡_«me
(
$«me
) {

425  
	`¥eg_ª∂a˚_ˇŒback
(

427 
	`¨øy
(
$this
, 'upcount_name_callback'),

428 
$«me
,

431 
	}
}

433 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_unique_fûíame
(
$«me
, 
$ty≥
, 
$ödex
, 
$c⁄ã¡_ønge
) {

434 
	`is_dú
(
$this
->
	`gë_u∂ﬂd_∑th
(
$«me
))) {

435 
$«me
 = 
$this
->
	`upcou¡_«me
($name);

438 
$u∂ﬂded_byãs
 = 
$this
->
	`fix_öãgî_ovîÊow
(
	`ötvÆ
(
$c⁄ã¡_ønge
[1]));

439 
	`is_fûe
(
$this
->
	`gë_u∂ﬂd_∑th
(
$«me
))) {

440 i‡(
$u∂ﬂded_byãs
 ==
$this
->
	`gë_fûe_size
(

441 
$this
->
	`gë_u∂ﬂd_∑th
(
$«me
))) {

444 
$«me
 = 
$this
->
	`upcou¡_«me
($name);

446  
$«me
;

447 
	}
}

449 
¥Ÿe˘ed
 
fun˘i⁄
 
	$åim_fûe_«me
(
$«me
, 
$ty≥
, 
$ödex
, 
$c⁄ã¡_ønge
) {

453 
$«me
 = 
	`åim
(
	`ba£«me
(
	`°rù¶ashes
($name)), ".\x00..\x20");

455 i‡(!
$«me
) {

456 
$«me
 = 
	`°r_ª∂a˚
('.', '-', 
	`mi¸Ÿime
(
åue
));

459 i‡(
	`°Ωos
(
$«me
, '.'Ë==
Ál£
 &&

460 
	`¥eg_m©ch
('/^image\/(gif|j≥?g|≤g)/', 
$ty≥
, 
$m©ches
)) {

461 
$«me
 .'.'.
$m©ches
[1];

463  
$«me
;

464 
	}
}

466 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fûe_«me
(
$«me
, 
$ty≥
, 
$ödex
, 
$c⁄ã¡_ønge
) {

467  
$this
->
	`gë_unique_fûíame
(

468 
$this
->
	`åim_fûe_«me
(
$«me
, 
$ty≥
, 
$ödex
, 
$c⁄ã¡_ønge
),

469 
$ty≥
,

470 
$ödex
,

471 
$c⁄ã¡_ønge


473 
	}
}

475 
¥Ÿe˘ed
 
fun˘i⁄
 
	$h™dÀ_f‹m_d©a
(
$fûe
, 
$ödex
) {

477 
	}
}

479 
¥Ÿe˘ed
 
fun˘i⁄
 
	$‹õ¡_image
(
$fûe_∑th
) {

480 i‡(!
	`fun˘i⁄_exi°s
('exif_read_data')) {

481  
Ál£
;

483 
$exif
 = @
	`exif_ªad_d©a
(
$fûe_∑th
);

484 i‡(
$exif
 ==
Ál£
) {

485  
Ál£
;

487 
$‹õ¡©i⁄
 = 
	`ötvÆ
(@
$exif
['Orientation']);

488 i‡(!
	`ö_¨øy
(
$‹õ¡©i⁄
, 
	`¨øy
(3, 6, 8))) {

489  
Ál£
;

491 
$image
 = @
	`image¸óã‰omj≥g
(
$fûe_∑th
);

492 
$‹õ¡©i⁄
) {

494 
$image
 = @
	`imagîŸ©e
($image, 180, 0);

497 
$image
 = @
	`imagîŸ©e
($image, 270, 0);

500 
$image
 = @
	`imagîŸ©e
($image, 90, 0);

503  
Ál£
;

505 
$suc˚ss
 = 
	`imagej≥g
(
$image
, 
$fûe_∑th
);

507 @
	`imagede°roy
(
$image
);

508  
$suc˚ss
;

509 
	}
}

511 
¥Ÿe˘ed
 
fun˘i⁄
 
	$h™dÀ_fûe_u∂ﬂd
(
$u∂ﬂded_fûe
, 
$«me
, 
$size
, 
$ty≥
, 
$îr‹
,

512 
$ödex
 = 
nuŒ
, 
$c⁄ã¡_ønge
 =Çull) {

513 
$fûe
 = 
√w
 
	`°dCœss
();

514 
$fûe
->
«me
 = 
$this
->
	`gë_fûe_«me
(
$«me
, 
$ty≥
, 
$ödex
, 
$c⁄ã¡_ønge
);

515 
$fûe
->
size
 = 
$this
->
	`fix_öãgî_ovîÊow
(
	`ötvÆ
(
$size
));

516 
$fûe
->
ty≥
 = 
$ty≥
;

517 i‡(
$this
->
	`vÆid©e
(
$u∂ﬂded_fûe
, 
$fûe
, 
$îr‹
, 
$ödex
)) {

518 
$this
->
	`h™dÀ_f‹m_d©a
(
$fûe
, 
$ödex
);

519 
$u∂ﬂd_dú
 = 
$this
->
	`gë_u∂ﬂd_∑th
();

520 i‡(!
	`is_dú
(
$u∂ﬂd_dú
)) {

521 
	`mkdú
(
$u∂ﬂd_dú
, 
$this
->
›ti⁄s
['mkdú_mode'], 
åue
);

523 
$fûe_∑th
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe
->
«me
);

524 
$≠≥nd_fûe
 = 
$c⁄ã¡_ønge
 && 
	`is_fûe
(
$fûe_∑th
) &&

525 
$fûe
->
size
 > 
$this
->
	`gë_fûe_size
(
$fûe_∑th
);

526 i‡(
$u∂ﬂded_fûe
 && 
	`is_u∂ﬂded_fûe
($uploaded_file)) {

528 i‡(
$≠≥nd_fûe
) {

529 
	`fûe_put_c⁄ã¡s
(

530 
$fûe_∑th
,

531 
	`f›í
(
$u∂ﬂded_fûe
, 'r'),

532 
FILE_APPEND


535 
	`move_u∂ﬂded_fûe
(
$u∂ﬂded_fûe
, 
$fûe_∑th
);

539 
	`fûe_put_c⁄ã¡s
(

540 
$fûe_∑th
,

541 
	`f›í
('php://input', 'r'),

542 
$≠≥nd_fûe
 ? 
FILE_APPEND
 : 0

545 
$fûe_size
 = 
$this
->
	`gë_fûe_size
(
$fûe_∑th
, 
$≠≥nd_fûe
);

546 i‡(
$fûe_size
 ==
$fûe
->
size
) {

547 i‡(
$this
->
›ti⁄s
['orient_image']) {

548 
$this
->
	`‹õ¡_image
(
$fûe_∑th
);

550 
$fûe
->
uæ
 = 
$this
->
	`gë_dow∆ﬂd_uæ
($fûe->
«me
);

551 
	`f‹óch
(
$this
->
›ti⁄s
['image_vîsi⁄s'] 
as
 
$vîsi⁄
 => 
$›ti⁄s
) {

552 i‡(
$this
->
	`¸óã_sˇÀd_image
(
$fûe
->
«me
, 
$vîsi⁄
, 
$›ti⁄s
)) {

553 i‡(!
	`em±y
(
$vîsi⁄
)) {

554 
$fûe
->{
$vîsi⁄
.'_uæ'} = 
$this
->
	`gë_dow∆ﬂd_uæ
(

555 
$fûe
->
«me
,

556 
$vîsi⁄


559 
$fûe_size
 = 
$this
->
	`gë_fûe_size
(
$fûe_∑th
, 
åue
);

563 } i‡(!
$c⁄ã¡_ønge
 && 
$this
->
›ti⁄s
['discard_aborted_uploads']) {

564 
	`u∆ök
(
$fûe_∑th
);

565 
$fûe
->
îr‹
 = 'abort';

567 
$fûe
->
size
 = 
$fûe_size
;

568 
$this
->
	`£t_fûe_dñëe_¥›îtõs
(
$fûe
);

570  
$fûe
;

571 
	}
}

573 
¥Ÿe˘ed
 
fun˘i⁄
 
	$ªadfûe
(
$fûe_∑th
) {

574  
	`ªadfûe
(
$fûe_∑th
);

575 
	}
}

577 
¥Ÿe˘ed
 
fun˘i⁄
 
	$body
(
$°r
) {

578 
echo
 
$°r
;

579 
	}
}

581 
¥Ÿe˘ed
 
fun˘i⁄
 
	$hódî
(
$°r
) {

582 
	`hódî
(
$°r
);

583 
	}
}

585 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gíî©e_ª•⁄£
(
$c⁄ã¡
, 
$¥öt_ª•⁄£
 = 
åue
) {

586 i‡(
$¥öt_ª•⁄£
) {

587 
$js⁄
 = 
	`js⁄_ícode
(
$c⁄ã¡
);

588 
$ªdúe˘
 = 
	`is£t
(
$_REQUEST
['redirect']) ?

589 
	`°rù¶ashes
(
$_REQUEST
['ªdúe˘']Ë: 
nuŒ
;

590 i‡(
$ªdúe˘
) {

591 
$this
->
	`hódî
('Loˇti⁄: '.
	`•rötf
(
$ªdúe˘
, 
	`øwuæícode
(
$js⁄
)));

594 
$this
->
	`hód
();

595 i‡(
	`is£t
(
$_SERVER
['HTTP_CONTENT_RANGE'])) {

596 
$fûes
 = 
	`is£t
(
$c⁄ã¡
[
$this
->
›ti⁄s
['param_name']]) ?

597 
$c⁄ã¡
[
$this
->
›ti⁄s
['∑øm_«me']] : 
nuŒ
;

598 i‡(
$fûes
 && 
	`is_¨øy
($fûesË&& 
	`is_obje˘
($fûes[0]Ë&& $fûes[0]->
size
) {

599 
$this
->
	`hódî
('R™ge: 0-'.($this->
	`fix_öãgî_ovîÊow
(
	`ötvÆ
(
$fûes
[0]->
size
)) - 1));

602 
$this
->
	`body
(
$js⁄
);

604  
$c⁄ã¡
;

605 
	}
}

607 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_vîsi⁄_∑øm
() {

608  
	`is£t
(
$_GET
['vîsi⁄']Ë? 
	`ba£«me
(
	`°rù¶ashes
($_GET['vîsi⁄'])Ë: 
nuŒ
;

609 
	}
}

611 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fûe_«me_∑øm
() {

612  
	`is£t
(
$_GET
['fûe']Ë? 
	`ba£«me
(
	`°rù¶ashes
($_GET['fûe'])Ë: 
nuŒ
;

613 
	}
}

615 
¥Ÿe˘ed
 
fun˘i⁄
 
	$gë_fûe_ty≥
(
$fûe_∑th
) {

616 
	`°πﬁowî
(
	`∑thöfo
(
$fûe_∑th
, 
PATHINFO_EXTENSION
))) {

627 
	}
}

629 
¥Ÿe˘ed
 
fun˘i⁄
 
	$dow∆ﬂd
() {

630 i‡(!
$this
->
›ti⁄s
['download_via_php']) {

631 
$this
->
	`hódî
('HTTP/1.1 403 Forbidden');

634 
$fûe_«me
 = 
$this
->
	`gë_fûe_«me_∑øm
();

635 i‡(
$this
->
	`is_vÆid_fûe_obje˘
(
$fûe_«me
)) {

636 
$fûe_∑th
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
, $this->
	`gë_vîsi⁄_∑øm
());

637 i‡(
	`is_fûe
(
$fûe_∑th
)) {

638 i‡(!
	`¥eg_m©ch
(
$this
->
›ti⁄s
['ölöe_fûe_ty≥s'], 
$fûe_«me
)) {

639 
$this
->
	`hódî
('Content-Description: File Transfer');

640 
$this
->
	`hódî
('Content-Type:ápplication/octet-stream');

641 
$this
->
	`hódî
('C⁄ã¡-Di•osôi⁄:áâachmít; fûíame="'.
$fûe_«me
.'"');

642 
$this
->
	`hódî
('Content-Transfer-Encoding: binary');

645 
$this
->
	`hódî
('X-Content-Type-Options:Çosniff');

646 
$this
->
	`hódî
('C⁄ã¡-Ty≥: '.$this->
	`gë_fûe_ty≥
(
$fûe_∑th
));

647 
$this
->
	`hódî
('C⁄ã¡-Di•osôi⁄: i∆öe; fûíame="'.
$fûe_«me
.'"');

649 
$this
->
	`hódî
('C⁄ã¡-Lígth: '.$this->
	`gë_fûe_size
(
$fûe_∑th
));

650 
$this
->
	`hódî
('La°-Modifõd: '.
	`gmd©e
('D, d M Y H:i:†T', 
	`fûemtime
(
$fûe_∑th
)));

651 
$this
->
	`ªadfûe
(
$fûe_∑th
);

654 
	}
}

656 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£nd_c⁄ã¡_ty≥_hódî
() {

657 
$this
->
	`hódî
('Vary: Accept');

658 i‡(
	`is£t
(
$_SERVER
['HTTP_ACCEPT']) &&

659 (
	`°Ωos
(
$_SERVER
['HTTP_ACCEPT'], '≠∂iˇti⁄/js⁄'Ë!=
Ál£
)) {

660 
$this
->
	`hódî
('Content-type:ápplication/json');

662 
$this
->
	`hódî
('Content-type:Åext/plain');

664 
	}
}

666 
¥Ÿe˘ed
 
fun˘i⁄
 
	$£nd_ac˚ss_c⁄åﬁ_hódîs
() {

667 
$this
->
	`hódî
('Ac˚ss-C⁄åﬁ-AŒow-Origö: '.$this->
›ti⁄s
['access_control_allow_origin']);

668 
$this
->
	`hódî
('Access-Control-Allow-Credentials: '

669 .(
$this
->
›ti⁄s
['access_control_allow_credentials'] ? 'true' : 'false'));

670 
$this
->
	`hódî
('Access-Control-Allow-Methods: '

671 .
	`im∂ode
(', ', 
$this
->
›ti⁄s
['access_control_allow_methods']));

672 
$this
->
	`hódî
('Access-Control-Allow-Headers: '

673 .
	`im∂ode
(', ', 
$this
->
›ti⁄s
['access_control_allow_headers']));

674 
	}
}

676 
public
 
fun˘i⁄
 
	$hód
() {

677 
$this
->
	`hódî
('Pragma:Ço-cache');

678 
$this
->
	`hódî
('Cache-Control:Ço-store,Ço-cache, must-revalidate');

679 
$this
->
	`hódî
('Content-Disposition: inline; filename="files.json"');

681 
$this
->
	`hódî
('X-Content-Type-Options:Çosniff');

682 i‡(
$this
->
›ti⁄s
['access_control_allow_origin']) {

683 
$this
->
	`£nd_ac˚ss_c⁄åﬁ_hódîs
();

685 
$this
->
	`£nd_c⁄ã¡_ty≥_hódî
();

686 
	}
}

688 
public
 
fun˘i⁄
 
	$gë
(
$¥öt_ª•⁄£
 = 
åue
) {

689 i‡(
$¥öt_ª•⁄£
 && 
	`is£t
(
$_GET
['download'])) {

690  
$this
->
	`dow∆ﬂd
();

692 
$fûe_«me
 = 
$this
->
	`gë_fûe_«me_∑øm
();

693 i‡(
$fûe_«me
) {

694 
$ª•⁄£
 = 
	`¨øy
(

695 
	`sub°r
(
$this
->
›ti⁄s
['∑øm_«me'], 0, -1Ë=> $this->
	`gë_fûe_obje˘
(
$fûe_«me
)

698 
$ª•⁄£
 = 
	`¨øy
(

699 
$this
->
›ti⁄s
['∑øm_«me'] => $this->
	`gë_fûe_obje˘s
()

702  
$this
->
	`gíî©e_ª•⁄£
(
$ª•⁄£
, 
$¥öt_ª•⁄£
);

703 
	}
}

705 
public
 
fun˘i⁄
 
	$po°
(
$¥öt_ª•⁄£
 = 
åue
) {

706 i‡(
	`is£t
(
$_REQUEST
['_method']) && $_REQUEST['_method'] === 'DELETE') {

707  
$this
->
	`dñëe
(
$¥öt_ª•⁄£
);

709 
$u∂ﬂd
 = 
	`is£t
(
$_FILES
[
$this
->
›ti⁄s
['param_name']]) ?

710 
$_FILES
[
$this
->
›ti⁄s
['∑øm_«me']] : 
nuŒ
;

712 
$fûe_«me
 = 
	`is£t
(
$_SERVER
['HTTP_CONTENT_DISPOSITION']) ?

713 
	`øwuædecode
(
	`¥eg_ª∂a˚
(

716 
$_SERVER
['HTTP_CONTENT_DISPOSITION']

717 )Ë: 
nuŒ
;

720 
$c⁄ã¡_ønge
 = 
	`is£t
(
$_SERVER
['HTTP_CONTENT_RANGE']) ?

721 
	`¥eg_•lô
('/[^0-9]+/', 
$_SERVER
['HTTP_CONTENT_RANGE']Ë: 
nuŒ
;

722 
$size
 = 
$c⁄ã¡_ønge
 ? $c⁄ã¡_ønge[3] : 
nuŒ
;

723 
$fûes
 = 
	`¨øy
();

724 i‡(
$u∂ﬂd
 && 
	`is_¨øy
($upload['tmp_name'])) {

727 
	`f‹óch
 (
$u∂ﬂd
['tmp_«me'] 
as
 
$ödex
 => 
$vÆue
) {

728 
$fûes
[] = 
$this
->
	`h™dÀ_fûe_u∂ﬂd
(

729 
$u∂ﬂd
['tmp_«me'][
$ödex
],

730 
$fûe_«me
 ? $fûe_«mê: 
$u∂ﬂd
['«me'][
$ödex
],

731 
$size
 ? $sizê: 
$u∂ﬂd
['size'][
$ödex
],

732 
$u∂ﬂd
['ty≥'][
$ödex
],

733 
$u∂ﬂd
['îr‹'][
$ödex
],

734 
$ödex
,

735 
$c⁄ã¡_ønge


741 
$fûes
[] = 
$this
->
	`h™dÀ_fûe_u∂ﬂd
(

742 
	`is£t
(
$u∂ﬂd
['tmp_«me']Ë? $u∂ﬂd['tmp_«me'] : 
nuŒ
,

743 
$fûe_«me
 ? $fûe_«mê: (
	`is£t
(
$u∂ﬂd
['name']) ?

744 
$u∂ﬂd
['«me'] : 
nuŒ
),

745 
$size
 ? $sizê: (
	`is£t
(
$u∂ﬂd
['size']) ?

746 
$u∂ﬂd
['size'] : 
$_SERVER
['CONTENT_LENGTH']),

747 
	`is£t
(
$u∂ﬂd
['type']) ?

748 
$u∂ﬂd
['ty≥'] : 
$_SERVER
['CONTENT_TYPE'],

749 
	`is£t
(
$u∂ﬂd
['îr‹']Ë? $u∂ﬂd['îr‹'] : 
nuŒ
,

750 
nuŒ
,

751 
$c⁄ã¡_ønge


754  
$this
->
	`gíî©e_ª•⁄£
(

755 
	`¨øy
(
$this
->
›ti⁄s
['∑øm_«me'] => 
$fûes
),

756 
$¥öt_ª•⁄£


758 
	}
}

760 
public
 
fun˘i⁄
 
	$dñëe
(
$¥öt_ª•⁄£
 = 
åue
) {

761 
$fûe_«me
 = 
$this
->
	`gë_fûe_«me_∑øm
();

762 
$fûe_∑th
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
);

763 
$suc˚ss
 = 
	`is_fûe
(
$fûe_∑th
Ë&& 
$fûe_«me
[0] !='.' && 
	`u∆ök
($file_path);

764 i‡(
$suc˚ss
) {

765 
	`f‹óch
(
$this
->
›ti⁄s
['image_vîsi⁄s'] 
as
 
$vîsi⁄
 => 
$›ti⁄s
) {

766 i‡(!
	`em±y
(
$vîsi⁄
)) {

767 
$fûe
 = 
$this
->
	`gë_u∂ﬂd_∑th
(
$fûe_«me
, 
$vîsi⁄
);

768 i‡(
	`is_fûe
(
$fûe
)) {

769 
	`u∆ök
(
$fûe
);

774  
$this
->
	`gíî©e_ª•⁄£
(
	`¨øy
('suc˚ss' => 
$suc˚ss
), 
$¥öt_ª•⁄£
);

775 
	}
}

	@gcm/modulos/imagenes/lib/presentar_galeria.php

1 <?
php


8 i‡–
	g$a
 == 'verImg' ) {

10 
ob_íd_˛ón
();

11 
	g$img
 = 
$_GET
['img'];

13 
ö˛ude
(
GCM_DIR
."includes/cabecera.php");

14 
¥e£¡¨Tôulo
();

19 
ö˛ude_⁄˚
(
GCM_DIR
.'lib/int/gcm_imagen.php');

20 
	gecho
 "\n<scriptÜanguage='javascript'>";

21 
gcm_li°aImagíes
(
$dd
.
$s
, 4);

22 
	gecho
 "\n</script>";

25 
	gecho
 '<s¸ùà§c="'.
	gGCM_DIR_P
.'modulos/gcmImgs/gcmImgs.js'.'"Åype="text/javascript"Üanguage="JavaScript">';

26 
	gecho
 "\n</script>";

34 
	gecho
 '<div id="contenido" >';

37 
	gecho
 "\n<scriptÜanguage='javascript'>";

38 
	gecho
 "\npresentar_contenido();";

39 
	gecho
 "\n</script>";

40 
	gecho
 '</div>';

41 
	gecho
 '</body></html>';

42 
exô
();

	@gcm/modulos/imagenes/menuAdmin.php

1 <?
php


2 
	g$míuAdmö
['Administraci√≥n']['boton']['Imagenes']['activado']= 1;

3 
	g$míuAdmö
['Administraci√≥n']['boton']['Imagenes']['title']="Administrar im√°genes";

4 
	g$míuAdmö
['Admöi°øci√≥n']['bŸ⁄']['Imagíes']['lök']=
Rouãr
::
$dú
.Rouãr::
$uæ
."?m=imagenes&a=galeria";

	@gcm/modulos/indexador/config/config.php

1 <?
php


2 
	g$c⁄fig
['maxLong'] = 200;

	@gcm/modulos/indexador/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['maxLong'] = 'Tama√±o deÜa descripci√≥ná indezarÉn caracteres';

	@gcm/modulos/indexador/eventos_admin.php

1 <?
php


2 
	g$evítos
['postejecutar_borrar']['borrar_archivo_pdo'][1] = '';

3 
	g$evítos
['postejecutar_nuevo']['indexar_archivo_pdo'][1] = '' ;

4 
	g$evítos
['postactualizar_contenido']['indexar_archivo_pdo'][1] = '';

5 
	g$evítos
['postejecutar_mover']['borrar_archivo_pdo'][1] = '';

6 
	g$evítos
['postejecutar_mover']['indexar_archivo_pdo'][2] = '';

7 
	g$evítos
['postpublicar_borrador']['indexar_archivo_pdo'][2] = '';

8 
	g$evítos
['postejecutar_mover_seccion']['cambio_ruta_seccion'][2] = '';

9 
	g$evítos
['reindexar']['reindexar'][1] = '';

10 
	g$evítos
['reindexado_completo']['reindexado_completo'][1] = '';

11 
	g$evítos
['indexar']['indexado'][1] = '';

	@gcm/modulos/indexador/eventos_usuario.php

1 <?
php


2 
	g$evítos
['cabeceraDerecha']['formulario_busqueda'][1]='';

3 
	g$evítos
['cﬁum«']['u…imas_íåadas'][5]="num=4&£cci⁄=".
Rouãr
::
$s
."&formato=1";

4 
	g$evítos
['contenido_dinamico']['contenido_dinamico'][1]='';

6 
	g$evítos
['buscar']['presentar_busquedas'][1]='';

8 
	g$evítos
['indexar']['indexado'][3] = '';

	@gcm/modulos/indexador/info.php

1 <?
php


2 
	g$ödexad‹
['nombre']="Indexador de contenido";

3 
	g$ödexad‹
['title']="IndexarÉl contenido deÜos directorios";

	@gcm/modulos/indexador/lib/Indexador.php

1 <?
php


32 ˛as†
	cIndexad‹
 
exãnds
 
	mModulos
 {

34 
public
 
	m$desˇπ¨
;

35 
public
 
	m$maxL⁄g
 = 200;

37 
¥iv©e
 
	m$pdo
 = 
NULL
;

38 
¥iv©e
 
	m$BD
 = 'DATOS/proyecto.db';

39 
¥iv©e
 
	m$¥efijo
 = '';

46 
¥iv©e
 
	m$u…imos_í_c⁄ãnido
 = 
FALSE
;

50 
fun˘i⁄
 
	$__c⁄°ru˘
() {

52 
globÆ
 
$gcm
;

54 
∑ª¡
::
	`__c⁄°ru˘
();

56 
$this
->
pdo
 = 
$gcm
->
	`pdo_c⁄exi⁄
($this->
BD
);

57 
$this
->
¥efijo
 = 
$gcm
->
sufijo
;

59 
$this
->
desˇπ¨
 = 
$gcm
->
	`c⁄fig
('contenidos','descartar');

60 
$this
->
maxL⁄g
 = $this->
	`c⁄fig
('maxLong');

64 i‡–! 
	`exi°e_èbœ
(
$this
->
pdo
, $this->
¥efijo
.'etiquetas') ) {

66 
$this
->
	`gíî¨_èbœs
();

76 
fun˘i⁄
 
	$ã°
() {

78 
$sql
 = 'SELECT COUNT(*ËFROM '.
$this
->
¥efijo
.'etiquetas';

80 
$this
->
	`ejecuè_ã°
('Tabœ†¸ódas', $this->
pdo
->
	`¥ï¨e
(
$sql
));

82 
	}
}

88 
fun˘i⁄
 
	$gíî¨_èbœs
() {

90 
globÆ
 
$gcm
;

92 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Creaci√≥n de base de datosÖara indexaci√≥n');

94 
$drivî
 = 
$this
->
pdo
->
	`gëAâribuã
(
	`c⁄°™t
("PDO::ATTR_DRIVER_NAME"));

96 
$drivî
) {

100 
$SQL
 = "CREATE TABLE ".
$this
->
¥efijo
."etiquetas (

101 
id
 
INTEGER
 
PRIMARY
 
KEY
,

102 
nombª
 
	`CHAR
(20Ë
UNIQUE
,

103 
des¸ùci⁄
 
	`VARCHAR
(80)

105 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

107 
$SQL
="CREATE TABLE ".
$this
->
¥efijo
."archivos (

108 
id
 
INTEGER
 
PRIMARY
 
KEY
,

109 
nombª
 
	`CHAR
(150) ,

110 
des¸ùci⁄
 
	`VARCHAR
(".$this->maxLong."),

111 
uæ
 
	`CHAR
(200Ë
UNIQUE
,

112 
„cha_¸óci⁄_©
 
TIME
 
NOT
 
NULL
 
DEFAULT
 
CURRENT_TIMESTAMP
,

113 
„cha_a˘uÆizaci⁄_ö
 
TIME


115 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

117 
$SQL
="CREATE TABLE ".
$this
->
¥efijo
."r_etiqueta_archivo (

118 
ëiquëas_id
 
INTEGER
,

119 
¨chivos_id
 
INTEGER
,

120 
PRIMARY
 
	`KEY
 (
ëiquëas_id
, 
¨chivos_id
)

122 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

127 
$SQL
 = "CREATE TABLE ".
$this
->
¥efijo
."etiquetas (

128 
id
 
MEDIUMINT
 
NOT
 
NULL
 
AUTO_INCREMENT
,

129 
nombª
 
	`CHAR
(20Ë
UNIQUE
,

130 
des¸ùci⁄
 
	`VARCHAR
(80),

131 
PRIMARY
 
	`KEY
 (
id
)

133 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

135 
$SQL
="CREATE TABLE ".
$this
->
¥efijo
."archivos (

136 
id
 
MEDIUMINT
 
NOT
 
NULL
 
AUTO_INCREMENT
,

137 
nombª
 
	`CHAR
(150) ,

138 
des¸ùci⁄
 
	`VARCHAR
(".$this->maxLong."),

139 
uæ
 
	`CHAR
(200Ë
UNIQUE
,

140 
„cha_¸óci⁄_©
 
TIMESTAMP
 
NOT
 
NULL
 
DEFAULT
 
CURRENT_TIMESTAMP
,

141 
„cha_a˘uÆizaci⁄_ö
 
TIMESTAMP
,

142 
PRIMARY
 
	`KEY
 (
id
)

144 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

146 
$SQL
="CREATE TABLE ".
$this
->
¥efijo
."r_etiqueta_archivo (

147 
ëiquëas_id
 
MEDIUMINT
 
NOT
 
NULL
,

148 
¨chivos_id
 
MEDIUMINT
 
NOT
 
NULL
,

149 
PRIMARY
 
	`KEY
 (
ëiquëas_id
, 
¨chivos_id
)

151 
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
);

155 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'E»drivî ['.
$drivî
.']ÖaraÜa base de datosÇoÉst√° soportado','ERROR');

160 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Tabœ†¸óda†∑ø '.
$drivî
.' yÖreparadasÖara indexaci√≥n','ADMIN');

162 
	}
}

169 
fun˘i⁄
 
	$f‹muœrio_busqueda
() {

171 
globÆ
 
$gcm
;

173 
$this
->
	`javas¸ùts
('indexador.js');

175 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('indexador','html','caja_buscar.html'));

177 
	}
}

194 
fun˘i⁄
 
	$sql_quŸe
(
$vÆ‹
) {

196 
$vÆ‹
 = 
	`sqlôe_esˇ≥_°rög
($valor);

197  
$vÆ‹
;

199 
	}
}

220 
fun˘i⁄
 
	$ödex¨_¨chivo_pdo
(
$e
, 
$¨gs
) {

222 
globÆ
 
$gcm
;

224 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

226 i‡–
	`is£t
(
$∑ømëros
['url']) ) {

227 
$fûe
 = 
$∑ømëros
['url'] ;

228 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø index¨ desdê¨gs[uæ] '.
$fûe
);

229 } 
	`ñ£if
 ( ! 
	`is_¨øy
(
$¨gs
Ë&& 
	`is_fûe
($args) ) {

230 
$fûe
 = 
$¨gs
 ;

231 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø index¨ desdê¨gs='.
$fûe
);

232 } 
	`ñ£if
 ( 
	`is£t
(
$gcm
->
mem‹ü
['destino']) ) {

233 
$fûe
 = 
$gcm
->
mem‹ü
['destino'] ;

234 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø index¨ desdêgcm->mem‹ü[de°öo] '.
$fûe
);

235 } 
	`ñ£if
 ( 
Rouãr
::
$f
 ) {

236 
$fûe
 = 
Rouãr
::
$f
 ;

237 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Indexamo†c⁄ãnidÿa˘uÆ: '.
$fûe
);

239 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Sê√˚sô®uæ dêc⁄ãnidÿ∑ø index¨::'.
$¨gs
,'ERROR');

240  
FALSE
;

243 
$fûe
 = 
	`°r_ª∂a˚
('//','/',$file);

247 i‡–! 
	`is£t
(
$∑ømëros
['sö_com¥ob¨_exãnsi⁄']Ë&& 
	`sub°r
(
$fûe
, -5) !== '.html' ) {

248 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).

250  
FALSE
;

255 i‡–
	`is£t
(
$∑ømëros
['literal']) ) {

256 
$nombª
 = 
$∑ømëros
['literal'];

258 
$nombª
 = 
	`°r_ª∂a˚
('.html','',
	`ba£«me
(
$fûe
) );

259 
$nombª
 = 
	`lôîÆ
($nombre);

262 
$des¸ùci⁄
='';

265 
$uæ
=
	`°r_ª∂a˚
('Fûe/'.
$gcm
->
	`c⁄fig
('idiomas','Idiom®p‹ de„˘o').'/','',
$fûe
);

267 
$fichîo
 = 'Fûe/'.
Rouãr
::
$ii
.'/'.
	`°rù¶ashes
(
	`html_ítôy_decode
(
$uæ
));

270 i‡–! @
	`fûe_exi°s
(
$fichîo
) ) {

271 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).

272 'Nÿexi°ê['.
$fichîo
.']árchivo, salimos');

276 
$„cha_¸óci⁄_©
 = 
	`d©e
('Y-m-d H:i:s', 
	`fûemtime
(
$fichîo
));

277 
$„cha_a˘uÆizaci⁄_ö
 = 
$„cha_¸óci⁄_©
;

278 
$ègs
 = 
	`¨øy
();

280 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Indexamos $file $fecha_creacion_at $fecha_actualizacion_in ");

285 
$¨chivo_c⁄ãnido
 = 
$fichîo
;

291 i‡––
	`is£t
(
$∑ømëros
['archivo_descripcion']) ) ) {

292 
$¨chivo_c⁄ãnido
 = 
$∑ømëros
['archivo_descripcion'];

295 i‡––
	`is£t
(
$∑ømëros
['inicio_descripcion']) ) ) {

297 
$c⁄ãnido
 = 
	`fûe_gë_c⁄ã¡s
(
$¨chivo_c⁄ãnido
);

298 
$posici⁄
 = 
	`°Ωos
(
$c⁄ãnido
,
$∑ømëros
['inicio_descripcion']);

299 i‡–
$posici⁄
 ==
FALSE
 ) {

300 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Énc⁄åÿ['.
$∑ømëros
['öicio_des¸ùci⁄'].']É¿['.
$¨chivo_c⁄ãnido
.']','ADMIN');

302 
$posici⁄
 = $posici⁄ + 
	`°æí
(
$∑ømëros
['inicio_descripcion']);

305 
$c⁄ãnido
 = 
	`åim
(
	`sub°r
($c⁄ãnido,
$posici⁄
));

306 
$c⁄ãnido
 = 
	`°rù_ègs
($contenido);

308 } 
	`ñ£if
 ( 
	`is£t
(
$∑ømëros
['descripcion'])) {

312 
$c⁄ãnido
 = 
	`°rù_ègs
(
$∑ømëros
['descripcion']);

316 
$c⁄ãnido
 = 
	`°rù_ègs
(
	`fûe_gë_c⁄ã¡s
(
$¨chivo_c⁄ãnido
));

319  
$pos1
 = 
	`°Ωos
(
$c⁄ãnido
, "{Tags{") ) {

320 
$pos2
 = 
	`°Ωos
(
$c⁄ãnido
, "}}", 
$pos1
);

321 i‡–
$pos1
 > 0 && 
$pos2
 < $pos1 ) {

322 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Eº‹ dêf‹m©ÿíÉtiquëa†['.
$uæ
.']','ERROR');

323 
$c⁄ãnido
 = 
	`°r_ª∂a˚
('{Tags{','',$contenido);

325 
$ªm∂az¨
 = 
	`sub°r
(
$c⁄ãnido
, 
$pos1
, 
$pos2
 - $pos1 + 2);

326 
$lô
 = 
	`°r_ª∂a˚
('{Tags{','',
$ªm∂az¨
);

327 
$lô
 = 
	`°r_ª∂a˚
('}}','',$lit);

328 
$c⁄ãnido
 = 
	`°r_ª∂a˚
(
$ªm∂az¨
,
	`lôîÆ
(
$lô
),$contenido);

329 
$ègs
 = 
	`¨øy_mîge
($ègs,
	`ex∂ode
(',',
$lô
));

333 i‡–
$pos1
 && $pos1 < 
$this
->
maxL⁄g
 ) { $this->maxLong = $pos1; }

336 
$posRef
 = 
	`°Ωos
(
$c⁄ãnido
, "{Ref{");

337 i‡–
$posRef
 && $posRe‡< 
$this
->
maxL⁄g
 ) { $this->maxLong = $posRef; }

339 
$des¸ùci⁄
=
	`åim
(
	`sub°r
(
$c⁄ãnido
,0,
$this
->
maxL⁄g
))."...";

342 
$SQL
 = "SELECT id from ".
$this
->
¥efijo
."archivos WHERE url=?";

343 i‡–
$sqlResu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
) ) {

344 
$sqlResu…
->
	`execuã
(
	`¨øy
(
$uæ
));

345 
$ªs
 = 
$sqlResu…
->
	`„tch
();

346 
$¨chivo_id
 = 
$ªs
[0];

348 
$¨chivo_id
 = 
FALSE
 ;

351 i‡–
$¨chivo_id
 ) {

352 
$SQL
 = "UPDATE ".
$this
->
¥efijo
."archivos SETÇombre=?, descripcion=?, fecha_actualizacion_in=?";

353 
$SQL
 .= " WHERE id=? ";

354 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'A˘uÆizamos: '.
$uæ
);

355 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
);

356 i‡–! 
$com™do
->
	`execuã
(
	`¨øy
(
$nombª
,
$des¸ùci⁄
, 
$„cha_a˘uÆizaci⁄_ö
, 
$¨chivo_id
) ) ) {

357 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

358 
$îr_msg
 = 
$îr
[2];

359 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'ERRORá»ejecuè∏'.
$SQL
,'ERROR');

360 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
$îr_msg
,'ERROR');

361  
FALSE
;

365 
$SQL
 = "INSERT INTO ".
$this
->
¥efijo
."archivos (Çombre, descripcion, url, fecha_creacion_at, fecha_actualizacion_in ) VALUES ";

366 
$SQL
 .= "(?,?,?,?,?)";

367 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Indexad‹::In£πamos: '.
$uæ
);

369 
åy
 {

371 
$com™do
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
);

372 
$com™do
->
	`execuã
(
	`¨øy
(
$nombª
,
$des¸ùci⁄
,
$uæ
, 
$„cha_¸óci⁄_©
, 
$„cha_a˘uÆizaci⁄_ö
) );

374 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

376 
$mís
 = 
$ex
->
	`gëMesßge
()."\nsql: ".
$SQL
.

378 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'."\n".
$mís
,'ERROR');

379  
FALSE
;

385 i‡–
	`cou¡
(
$ègs
) > 0 ) {

387 i‡–! 
$¨chivo_id
 ) {

388 
$¨chivo_id
 = 
$this
->
pdo
->
	`œ°In£πId
();

391 
	`f‹óch
 ( 
$ègs
 
as
 
$t
 ) {

394 
$SQL
="SELECT id FROM ".
$this
->
¥efijo
."ëiquëa†WHEREÇombª='".
	`åim
(
$t
)."'";

395 i‡–
$sqlResu…
 = 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

396 
$ªs
 = 
$sqlResu…
->
	`„tch
();

397 
$ëiquëa_id
 = 
$ªs
[0];

399 
$ëiquëa_id
 = 
FALSE
 ;

402 i‡–! 
$ëiquëa_id
 ) {

403 
$SQL
="INSERT INTO ".
$this
->
¥efijo
."ëiquëa†“ombªËVALUES ('".
	`åim
(
$t
)."')";

404 i‡–! 
$this
->
pdo
->
	`quîy
(
$SQL
) ) {

405 
$îr
 = 
$this
->
pdo
->
	`îr‹Info
();

406 
$îr_msg
 = 
$îr
[2];

407 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'ERRORá»ejecuè∏'.
$SQL
,'ERROR');

408 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
$îr_msg
,'ERROR');

411 
$ëiquëa_id
 = 
$this
->
pdo
->
	`œ°In£πId
();

414 
$SQL
 = "INSERT INTO ".
$this
->
¥efijo
."r_ëiquëa_¨chivÿVALUES (".
$ëiquëa_id
.",".
$¨chivo_id
.")";

416 
åy
 {

418 
$this
->
pdo
->
	`quîy
(
$SQL
);

420 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

422 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'ERRORá»ejecuè∏'.
$SQL
);

423 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
$ex
->
	`gëMesßge
());

430 i‡––
$e
 == 'indexar' ) ) {

431 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Archivo indexado','AVISO');

433 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Archivo indexado'));

435  
TRUE
;

437 
	}
}

457 
fun˘i⁄
 
	$u…imas_íåadas
(
$e
, 
$¨gs
) {

459 
globÆ
 
$gcm
;

461 
$this
->
	`javas¸ùts
('indexador.js');

463 
$sufijo
 = 'uec_';

466 
$num_ôems_df
 = 5;

467 
$f‹m©o_df
 = 0;

469 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

471 
$num
 = ( 
	`is£t
(
$∑ømëros
['num']ËË? $∑ømëros['num'] : 
$num_ôems_df
 ;

472 
$£cci⁄
 = ( 
	`is£t
(
$∑ømëros
['£cci⁄']ËË? $∑ømëros['£cci⁄'] : 
Rouãr
::
$s
 ;

473 
$f‹m©o
 = ( 
	`is£t
(
$∑ømëros
['f‹m©o']ËË? $∑ømëros['f‹m©o'] : 
$f‹m©o_df
 ;

475 i‡–
$f‹m©o
 =0 ) 
$this
->
u…imos_í_c⁄ãnido
 = 
TRUE
;

477 i‡–
$f‹m©o
 =1 && 
$this
->
u…imos_í_c⁄ãnido
 ) {

478 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

479 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') YaÅenemos ultimasÉntradas

480 
í
 
c⁄ãnido
, 
no
 
œs
 
p⁄emos
É¿
cﬁum«
');

484 i‡–!
	`em±y
(
$£cci⁄
) ) {

485 
$aSecci⁄_a˘uÆ
 = 
	`ex∂ode
('/',
	`com¥ob¨_b¨ø
(
$£cci⁄
));

486 
$£cci⁄_a˘uÆ
 = ( 
$aSecci⁄_a˘uÆ
[
	`cou¡
($aSecci⁄_a˘uÆ)-2] ) ? 
	`lôîÆ
($aSecci⁄_a˘uÆ[cou¡($aSecci⁄_a˘uÆ)-2],1Ë: 
NULL
 ;

489 
$e°amos
 = ( 
	`is£t
(
$£cci⁄_a˘uÆ
) ) ? $seccion_actual : 'inicio' ;

491 
$c⁄dici⁄
 = ( 
$£cci⁄
 ) ? "uæÜikê'".$£cci⁄."%'" : 
NULL
 ;

493 
$sql
 = "SELECTÇombª, uæ, des¸ùci⁄, fecha_a˘uÆizaci⁄_ö, fecha_¸óci⁄_© FROM ".
$this
->
¥efijo
."archivos ";

494 i‡–
$c⁄dici⁄
Ë
$sql
 .= "WHERE $condicion";

495 
$sql
 .= " ORDER BY fecha_actualizacion_in desc";

497 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/paginarPDO.php');

499 i‡–
$f‹m©o
 == 0 ) {

501 
$gcm
->
evít
->
	`™uœr
('titulo','indexador');

502 i‡–
$e°amos
 ='öicio' || 
	`em±y
(
$£cci⁄
) ) {

503 
$gcm
->
tôulo
=
	`lôîÆ
('√öltimasÉntradas');

505 
$gcm
->
tôulo
=
	`lôîÆ
('√ö…ima†íåada†í',3).' '.
$£cci⁄_a˘uÆ
;

508 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
pdo
, 
$sql
, 
$sufijo
);

510 i‡–
$pd
->
	`vÆid¨
() ) {

512 
$gcm
->
evít
->
	`™uœr
('contenido_dinamico','indexador');

514 
$pd
->
ñemítos_∑göa
=
$num
;

515 
$pd
->
∂™tûœ_ªsu…ados
=
	`dú«me
(
__FILE__
).'/../html/listado_contenido.html';

520 
$pd
->
	`gíî¨_∑göa
('&formato=ajax&m=indexador&a=ultimas_entradas');

528 
$sufijo
 = 'uecl_';

530 i‡–
$e°amos
 ='öicio' || 
	`em±y
(
$£cci⁄
) ) {

531 
$tôulo
=
	`lôîÆ
('√öltimasÉntradas');

533 
$tôulo
=
	`lôîÆ
('√ö…ima†íåada†í',3).' '.
$£cci⁄_a˘uÆ
;

536 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
pdo
, 
$sql
, 
$sufijo
);

538 i‡–
$pd
->
	`vÆid¨
() ) {

540 
$pd
->
∂™tûœ_ªsu…ados
=
	`dú«me
(
__FILE__
).'/../html/listado_columna.html';

541 
$pd
->
ñemítos_∑göa
=
$num
;

542 
	`ob_°¨t
();

543 
$pd
->
	`∑göa
();

544 
$c⁄ãnido
 = 
	`ob_gë_c⁄ã¡s
();

545 
	`ob_íd_˛ón
();

547 
$∑√l
 = 
	`¨øy
();

548 
$∑√l
['tôulo'] = 
$tôulo
;

549 
$∑√l
['ocu…o'] = 
TRUE
;

550 
$∑√l
['hªf'] = 
Rouãr
::
$dú
.'ödexad‹/u…imas_íåadas/'.Rouãr::
$s
;

551 
$∑√l
['subpanel'] ='list_ultimas_entradas';

552 
$∑√l
['c⁄ãnido'] =
$c⁄ãnido
;

554 
Temas
::
	`∑√l
(
$∑√l
);

559 
	}
}

576 
fun˘i⁄
 
	$b‹ør_¨chivo_pdo
(
$e
, 
$¨gs
) {

578 
globÆ
 
$gcm
;

580 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
$¨gs
);

582 i‡–
	`is£t
(
$∑ømëros
['url']) ) {

583 
$uæs
 = 
	`¨øy
(
$∑ømëros
['url']) ;

584 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø b‹ø∏desdêuæ ['.
$uæ
.']');

585 } 
	`ñ£if
 ( 
	`is£t
(
$∑ømëros
['ruta_origen']) ) {

586 
$uæs
 = 
	`¨øy
(
$∑ømëros
['ruta_origen']) ;

587 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø b‹ø∏desdêruè_‹igí['.
$uæ
.']');

588 } 
	`ñ£if
 ( 
	`is£t
(
$gcm
->
mem‹ü
['origen']) ) {

589 
$uæs
 = 
	`¨øy
(
$gcm
->
mem‹ü
['origen']) ;

590 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Recibimo†u¿¨chivÿ∑ø b‹ø∏desdêgcm->mem‹ü[‹igí] '.
$uæs
[0]);

591 } 
	`ñ£if
 ( 
	`is£t
(
$_POST
['seleccionado']) ) {

592 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'RecibimosÜistaÑachivosá borrar desde POST[seleccionado]: ');

593 
	`f‹óch
 ( 
$_POST
['£Àcci⁄ado'] 
as
 
$vÆ
 ) {

594 
$uæs
[]=
	`°rù¶ashes
(
$vÆ
);

597 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'SeÇecesita url de contenidoÖara borrar','ERROR');

600 
	`f‹óch
 ( 
$uæs
 
as
 
$uæ
 ) {

602 
$uæ
 = 
GUtû
::
	`desgloßr_uæ
($url);

604 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Elimöamo†¨chivÿdêœ bd: '.
$uæ
);

606 
$SQL
 = "DELETE FROM ".
$this
->
¥efijo
."archivos WHERE url=?";

608 i‡–
$sqlResu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
) ) {

609 i‡–
$sqlResu…
->
	`execuã
(
	`¨øy
(
$uæ
)) ) {

610 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Elimöadÿdêœ ba£ dêd©o†[ '.
$uæ
.' ]');

612 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'ERROR: B‹øndÿ¨chivÿdêœ ba£ dêd©os: ['.
$uæ
.']. '.
$SQL
,'ERROR');

616 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Nÿ£Öudÿb‹ø∏dêœ ba£ dêd©o†['.
$uæ
.']'."\nsql: ".
$SQL
,'ADMIN');

621  
TRUE
;

622 
	}
}

638 
fun˘i⁄
 
	$gcm_b‹ør_èbœ_pdo
(
$èbœ
) {

640 
globÆ
 
$gcm
;

642 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Elimöamo†èbœ dêœ bd: '.
$èbœ
);

644 
$SQL
 = "DROP TABLE $tabla";

646 i‡–
$sqlResu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$SQL
) ) {

647 
$sqlResu…
->
	`execuã
();

648  
TRUE
;

651 i‡–
$this
->
pdo_îr‹
) {

652 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"No seÖudo borrarárchivo deÜa base de datos",'ERROR');

653 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
$this
->
pdo_îr‹
);

654 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"SQL::".
$SQL
);

657  
FALSE
;

661 
	}
}

671 
fun˘i⁄
 
	$¥e£¡¨_busquedas
(
$e
, 
$¨gs
) {

673 
globÆ
 
$gcm
;

675 
$this
->
	`javas¸ùts
('indexador.js');

677 i‡–
	`is£t
(
$_REQUEST
['buscar']) ) {

678 
$∑œbøs
 = 
	`ex∂ode
(' ',
$_REQUEST
['buscar']);

680 
$∑œbøs
 = 
Rouãr
::
$¨gs
;

683 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,"Busˇndÿ".
	`dïuør
(
$∑œbøs
));

685 i‡–!
	`em±y
(
$∑œbøs
) ) {

687 
$CONDICION
 = "";

688 
$ORDER
 = " fecha_actualizacion_in desc ";

689 
$c⁄è
 = 0;

690 
$fö
 = 
	`cou¡
(
$∑œbøs
);

691 
	`f‹óch
 ( 
$∑œbøs
 
as
 
$∑l
 ) {

693 i‡–
	`gë_magic_quŸes_gpc
() ) {

694 
$∑l
 = 
	`°rù¶ashes
($pal);

696 
$∑l
 = 
	`add¶ashes
($pal);

697 
$∑l
 = 
	`°r_ª∂a˚
('"','',$pal);

699 i‡–
$c⁄è
 != 0 ) {

700 
$CONDICION
 .= ' OR ';

702 
$CONDICION
 ." (ÇombªÜikê'%".
$∑l
."%' OR descripcionÜike '%".$pal."%' ) ";

703 
$c⁄è
++;

706 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/GcmPDO/lib/paginarPDO.php');

710 
$gcm
->
tôulo
 = 
	`lôîÆ
('Busqued®∑ø').': <i>'.
	`im∂ode
(' ',
$∑œbøs
).'</i>';

711 
$gcm
->
evít
->
	`™uœr
('titulo','Indexador');

713 
$sql
 = "SELECTÇombª, uæ, des¸ùci⁄, fecha_a˘uÆizaci⁄_ö, fecha_¸óci⁄_© FROM ".
$this
->
¥efijo
."archivos WHERE $CONDICION ORDER BY fecha_actualizacion_in desc ";

715 
$pd
 = 
√w
 
	`Pagö¨PDO
(
$this
->
pdo
, 
$sql
);

717 i‡–
$pd
->
	`vÆid¨
() ) {

719 i‡–
$pd
->
	`numîo_ªgi°ros
() == 1 ) {

721 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Solo hubo unÑesultado, seÖresenta'),'AVISO');

722  
$fûa
 = 
$pd
->
	`to_¨øy
() ) {

723 
$uæ
 = 
GUtû
::
	`gcm_gíî¨_uæ
(
$fûa
[0]['url']);

724 
	`hódî
 ("Loˇti⁄:".
$uæ
.'?mís='.
$gcm
->
ªg
->
£si⁄
);

725 
	`exô
();

730 
$gcm
->
evít
->
	`™uœr
('contenido_dinamico','Indexador');

732 
$pd
->
uæ_ba£
 = '?e=busˇr&busˇr='.
	`htmÀ¡ôõs
(
	`im∂ode
('+',
$∑œbøs
));

733 
$pd
->
ñemítos_∑göa
=8;

734 
$pd
->
∂™tûœ_ªsu…ados
=
	`dú«me
(
__FILE__
).'/../html/listado_contenido.html';

736 
$pd
->
	`bŸ⁄îa
();

737 
$pd
->
	`∑göa
();

738 
$pd
->
	`bŸ⁄îa
();

742 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`lôîÆ
('Nÿhubÿªsu…ado†díåÿdñ c⁄ãnidÿ<b>'.
	`im∂ode
(' ',
$∑œbøs
)).'</b>','AVISO');

745 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Indexador->presentar_resultados() Sin contenidoá buscar');

748 
	}
}

755 
fun˘i⁄
 
	$c⁄ãnido_döamico
() {

757 
globÆ
 
$gcm
;

761 i‡–
$gcm
->
evít
->
	`™uœdo
('contenido') ) {

765 
$this
->
	`javas¸ùts
('indexador.js');

768 
$num_ôems_df
 = 5;

769 
$£ccci⁄_df
 = 
Rouãr
::
$s
;

770 
$f‹m©o_df
 = 0;

772 
$∑ømëros
 = 
	`ªcogî_∑ømëros
(
	`func_gë_¨gs
());

774 
$num
 = ( 
	`is£t
(
$∑ømëros
['num']ËË? $∑ømëros['num'] : 
$num_ôems_df
 ;

775 
$£cci⁄
 = ( 
	`is£t
(
$∑ømëros
['£cci⁄']ËË? $∑ømëros['£cci⁄'] : 
$£ccci⁄_df
 ;

776 
$f‹m©o
 = ( 
	`is£t
(
$∑ømëros
['f‹m©o']ËË? $∑ømëros['f‹m©o'] : 
$f‹m©o_df
 ;

778 
$this
->
	`u…imas_íåadas
(
NULL
,'num='.
$num
.'&£cci⁄='.
$£cci⁄
.'&f‹m©o='.
$f‹m©o
);

780 
	}
}

792 
fun˘i⁄
 
	$gcm_ödex¨_∑göas
(
$c⁄ãnido
) {

794 
globÆ
 
$gcm
;

796 
$funci⁄_js_ödex¨
 = 'indexar';

798 
	`f‹óch
 ( 
$c⁄ãnido
 
as
 
$ôem
 => 
$ñemíto
 ) {

800 i‡–
	`is_¨øy
(
$ñemíto
) ) {

802 
$nombª
 = 
	`ba£«me
(
$ôem
);

803 i‡–
$nombª
[0] != '.' ) {

804 
$this
->
	`gcm_ödex¨_∑göas
(
$ñemíto
);

807 } 
	`ñ£if
 ( !
	`esImagí
(
$ñemíto
Ë&& 
	`sub°r_cou¡
($elemento,'.html') > 0 ) {

809 
$nombª
 = 
	`ba£«me
(
$ñemíto
);

810 i‡–
$nombª
[0] != '.' ) {

812 
$ˇmöo
 = 
GUtû
::
	`ˇmöo
(
$ñemíto
);

814 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('indexador','html','elemento_lista_indexar.html'));

819  
TRUE
;

821 
	}
}

832 
fun˘i⁄
 
	$ödexado
() {

834 
globÆ
 
$gcm
;

836 i‡–
$this
->
	`ödex¨_¨chivo_pdo
('ödexado',
Rouãr
::
$f
Ë!=
FALSE
 ) {

837 
$ßlida
 = "ContenidoÑeindexado";

839 
$ßlida
 = '<p class="error">';

840 
$ßlida
 .= 'Errorál indexar contenido';

841 
$ßlida
 .= '</p>';

844 i‡–
Rouãr
::
$f‹m©o
 == 'ajax' ) {

845 
echo
 
$ßlida
;

847 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
$ßlida
,'AVISO');

850 
	}
}

860 
fun˘i⁄
 
	$ªödexado_com∂ëo
(
$e
, 
$¨gs
=
NULL
) {

862 
globÆ
 
$gcm
;

864 
$this
->
	`javas¸ùts
('listado_reindexado.js');

865 
$this
->
	`javas¸ùts
('reindexador_completo.js');

867 
$gcm
->
evít
->
	`™uœr
('contenido','indexador');

868 
$gcm
->
evít
->
	`™uœr
('titulo','indexador');

869 
$gcm
->
¥e£¡¨_c⁄ãnido_döamico
 = 
FALSE
;

871 
$gcm
->
tôulo
 = 
	`lôîÆ
('Reindexar contenido');

874 
$c⁄ãnido
 = 
	`dú_¨øy
('Fûe/'.
Rouãr
::
$ii
, 
$this
->
desˇπ¨
) ;

877 
	`b‹ør_èbœ
(
$this
->
pdo
,$this->
¥efijo
.'archivos');

878 
	`b‹ør_èbœ
(
$this
->
pdo
,$this->
¥efijo
.'etiquetas');

879 
	`b‹ør_èbœ
(
$this
->
pdo
,$this->
¥efijo
.'r_etiqueta_archivo');

880 
$this
->
	`gíî¨_èbœs
();

882 
$this
->
	`li°a_c⁄ãnido_ªödex¨
();

884 
	}
}

892 
fun˘i⁄
 
	$li°a_c⁄ãnido_ªödex¨
() {

895 
$c⁄ãnido
 = 
	`dú_¨øy
('Fûe/'.
Rouãr
::
$ii
, 
$this
->
desˇπ¨
) ;

897 
echo
 "\n",'<div style="display:Çone;" class="error" id="errores_reindexando"></div>';

899 
echo
 "\n".'<div id="panel_indexado">Indexados: 0</div>';

900 
echo
 "\n".'<div id="listado_reindexar">';

902 i‡–!
$this
->
	`gcm_ödex¨_∑göas
(
$c⁄ãnido
) ) {

903 
	`åiggî_îr‹
(
	`lôîÆ
('Eº‹').' '.lôîÆ('Nÿ£Öudÿªödex¨'), 
E_USER_ERROR
);

906 
echo
 "\n".'</div> <!--Üistado_reindexar -->';

908 
	}
}

920 
fun˘i⁄
 
	$ªödex¨
(
$e
, 
$¨gs
=
NULL
) {

922 
globÆ
 
$gcm
;

924 
$this
->
	`javas¸ùts
('listado_reindexado.js');

926 
$gcm
->
evít
->
	`™uœr
('contenido','indexador');

927 
$gcm
->
evít
->
	`™uœr
('titulo','indexador');

928 
$gcm
->
¥e£¡¨_c⁄ãnido_döamico
 = 
FALSE
;

930 
$gcm
->
tôulo
 = 
	`lôîÆ
('Reindexar contenido');

932 
echo
 "\n<br />";

933 
echo
 "\n<br />Directorios descartados deÑeindexado";

934 
echo
 "\n<ul>";

935 
	`f‹óch
 (
$this
->
desˇπ¨
 
as
 
$desˇπado
Ë
echo
 "<li>".$descartado."</li>";

936 
echo
 "\n</ul>";

937 
echo
 "\nTama√±ÿdes¸ùci√≥n: <b>".
$this
->
maxL⁄g
."</b>";

938 
echo
 "\n<br />";

939 
echo
 "\n<b∏/>",'<•™ cœss="bŸ⁄"><®hªf="'.
Rouãr
::
$ba£
.'?e=reindexado_completo" >EjecutarÑeindexado completo</a></span>';

940 
echo
 '<br /><br />';

942 
$this
->
	`li°a_c⁄ãnido_ªödex¨
(
$e
,
$¨gs
);

944 
	}
}

951 
fun˘i⁄
 
	$ödex¨_c⁄ãnido
(
$e
,
$¨gs
) {

953 
globÆ
 
$gcm
;

955 i‡–
$this
->
	`ödex¨_¨chivo_pdo
('ödex¨_c⁄ãnido',
Rouãr
::
$f
Ë==
FALSE
 ) {

956 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Eº‹á»ödex¨ ['.
Rouãr
::
$f
.']','ERROR');

959 
	}
}

968 
fun˘i⁄
 
	$ˇmbio_ruè_£cci⁄
(
$e
, 
$¨gs
=
NULL
) {

970 
$£cci⁄
 = ( 
$_POST
['seleccionado'][0] ) ? $_POST['seleccionado'][0] : '';

971 
$£cci⁄
 = 
	`com¥ob¨_b¨ø
($£cci⁄).
$_POST
['nuevo_nombre'];

973 i‡–
	`em±y
(
$£cci⁄
) ) {

974 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Sin secci√≥nÖara seleccionadaÖaraÑenombrar','ERROR');

975  
FALSE
;

979 
$ruè_de°öo
=
GUtû
::
	`ãxt›œno
(
$£cci⁄
);

980 
$ruè_de°öo
=
	`°r_ª∂a˚
(
Rouãr
::
$dd
,'',$ruta_destino);

981 
$ruè_‹igí
 = 
Rouãr
::
$s
;

983 
$sql
 = "SELECT id, uæ FROM ".
$this
->
¥efijo
."¨chivo†WHERE uæÜikê'%".
$ruè_‹igí
."%'";

984 
$ªsu…
 = 
$this
->
pdo
->
	`quîy
(
$sql
);

985 
$num_a„˘ados
 = 
$ªsu…
->
	`„tchCﬁumn
();

987 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modifiˇ∏uæ [ '.
$ruè_‹igí
.' ]Ö‹ [ '.
$ruè_de°öo
.' ],á„˘ados: [ '.
$num_a„˘ados
.' ]');

989 i‡–
$num_a„˘ados
 > 0 ) {

991 i‡–
$sqlResu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$sql
) ) {

993 
$sqlResu…
->
	`execuã
();

995 
$fûa
 = 
$sqlResu…
->
	`„tch
(
PDO
::
FETCH_OBJ
)) {

997 
$nueva_ruè
 = 
	`°r_ª∂a˚
(
$ruè_‹igí
,
$ruè_de°öo
.'/',
$fûa
->
uæ
);

998 
$subsql
="UPDATE ".
$this
->
¥efijo
."archivos SET url=? WHERE id=?";

999 
$subªsu…
 = 
$this
->
pdo
->
	`¥ï¨e
(
$subsql
);

1000 i‡–
$subªsu…
->
	`execuã
(
	`¨øy
(
$nueva_ruè
,
$fûa
->
id
)) ) {

1001 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Modifiˇd®uæ dê£cci√≥¿[ '.
$nueva_ruè
.' ]');

1003 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'SöÑesu…ado†∑ø ['.
$nueva_ruè
.']','ERROR');

1012 
	}
}

	@gcm/modulos/indexador/menuAdmin.php

1 <?
php


2 
	g$míuAdmö
['Seguimiento']['boton']['indexador']['activado']=1;

3 
	g$míuAdmö
['Seguimiento']['boton']['indexador']['nombre']="Reindexador";

4 
	g$míuAdmö
['Seguimiento']['boton']['indexador']['title']="ReindexarÉl contenido";

5 
	g$míuAdmö
['Seguimõ¡o']['bŸ⁄']['ödexad‹']['lök']=
Rouãr
::
$ba£
."?e=reindexar";

	@gcm/modulos/literales/eventos_admin.php

1 <?
php


19 
	g$evítos
['columna']['panel_literales'][5] = '';

33 
	g$acci⁄es
['literales']['panel_literales'][] = 'editor';

34 
	g$acci⁄es
['literales']['panel_literales'][] = 'traductor';

	@gcm/modulos/literales/eventos_usuario.php

1 <?
php


20 i‡–!
is£t
(
$_SESSION
['edô']Ë|| 
	g$_SESSION
['edit'] != 'si' ) {

21 
$evítos
['postcontenido']['procesar_texto'][1] = '';

	@gcm/modulos/literales/lib/Literales.php

1 <?
php


20 
ªquúe_⁄˚
(
GCM_DIR
."lib/int/GcmConfig/lib/GcmConfigFactory.php");

31 ˛as†
	cLôîÆes
 
exãnds
 
	mModulos
 {

33 
¥iv©e
 
	m$ëiquëa_öicio
;

34 
¥iv©e
 
	m$ëiquëa_föÆ
;

36 
fun˘i⁄
 
	$__c⁄°ru˘
() {

38 
∑ª¡
::
	`__c⁄°ru˘
();

40 
$this
->
ëiquëa_öicio
 = '{L{';

41 
$this
->
ëiquëa_föÆ
 = '}}';

50 
fun˘i⁄
 
	$¥o˚ßr_ãxto
() {

52 
globÆ
 
$gcm
; 
$LG
 ;

54 
$buf„r
 = 
$gcm
->
c⁄ãnido
;

56  
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
Ë!=
Ál£
 ) {

58 
$pos1
 = 
NULL
;

59 
$pos2
 = 
NULL
;

60 
$¨chivo
 = 
NULL
;

61 
$ªm∂az¨
 = 
NULL
;

62 
$¨chivo
 = 
NULL
;

64 
$pos1
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
);

65 
$pos2
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_föÆ
, 
$pos1
);

66 
$ªm∂az¨
 = 
	`sub°r
(
$buf„r
, 
$pos1
, 
$pos2
 - $pos1 + 2);

67 
$ëiquëa
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_öicio
,'',
$ªm∂az¨
);

68 
$ëiquëa
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_föÆ
,'',$etiqueta);

70 i‡–
$pos1
 && 
$pos2
 && 
$ëiquëa
 && 
$ªm∂az¨
 ) {

72 
$ëiquëa
 = 
$this
->
	`¥o˚ß_ëiquëa
($etiqueta);

74 
$buf„r
 = 
	`°r_ª∂a˚
(
$ªm∂az¨
,
$ëiquëa
,$buffer);

80 
$gcm
->
c⁄ãnido
=
$buf„r
;

82 
	}
}

94 
fun˘i⁄
 
	$¥o˚ß_ëiquëa
(
$ëiquëa
) {

96  
	`lôîÆ
(
$ëiquëa
,1) ;

98 
	}
}

110 
fun˘i⁄
 
∑√l_lôîÆes
(
$e
,
$¨gs
='') {

112 
$this
->
javas¸ùts
('literales.js');

114 
ob_°¨t
();

115 
	gecho
 '<div id="panelLiterales">';

117 
	gecho
 '</div>';

118 
	g$ßlida
 = 
ob_gë_c⁄ã¡s
(Ë; 
ob_íd_˛ón
();

120 
	g$∑√l
 = 
¨øy
();

121 
	g$∑√l
['tôulo'] = 
lôîÆ
('LôîÆes',3).'['.
	gRouãr
::
$i
.']';

122 
	g$∑√l
['ocu…o'] = 
TRUE
;

123 
	g$∑√l
['subpanel'] ='panelLiterales';

124 
	g$∑√l
['jajax'] = "?formato=ajax&m=literales&a=devolverLiterales";

125 
	g$∑√l
['c⁄ãnido'] = 
$ßlida
;

127 
	gTemas
::
∑√l
(
$∑√l
);

140 
fun˘i⁄
 
	$ñimö¨LôîÆ
() {

142 
globÆ
 
$gcm
;

144 
$idioma
 = 
Rouãr
::
$i
;

145 
$fûe
=
$gcm
->
	`c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
$idioma
.".php";

147 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

148 
$¨r
->
	`dñ
(
$_GET
['elemento']);

149 
$¨r
->
	`gu¨d¨_v¨übÀs
();

151 
echo
 "EÀmítÿ[ ".
$_GET
['elemento']." ]Éliminado";

153 
	}
}

166 
fun˘i⁄
 
	$devﬁvîLôîÆes
(
$fûe
=
NULL
) {

168 
globÆ
 
$gcm
;

171 
$fûe
 = 
$gcm
->
	`c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
Rouãr
::
$i
.".php";

173 i‡–!
	`fûe_exi°s
(
$fûe
) ) {

174 
	`åiggî_îr‹
('Archivÿdêidioma†['.
$fûe
.']Çÿexi°e', 
E_USER_ERROR
);

175  
FALSE
;

178 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

180 
$ßlida
 = '<div id="panelLiterales">';

181 
$ßlida
 .= '<br />';

182 
$ßlida
 .= '<a class="boton" style="cursor:Öointer;" onclick="javascript:insertarLiteral()" >'

183 .
	`lôîÆ
('A√±adir',3)

185 
$ßlida
 .= '<a class="boton" style="cursor:Öointer;" onclick="javascript:filtra()" >'

186 .
	`lôîÆ
('Filtrar',3)

188 
$ßlida
 .= '<br /><br />';

190 i‡–
$¨r
->
	`v¨übÀs
() ) {

192 
	`f‹óch
 ( 
$¨r
->
	`v¨übÀs
(Ë
as
 
$key
 => 
$vÆ‹
 ) {

194 
$˛a£
 = ( 
	`em±y
(
$vÆ‹
) ) ? 'subpanelNegativo' : "subpanel" ;

196 
$ßlida
 .= '

197 <
p
 
˛ass
="'.$clase.'">

198 <
a
 
hªf
="javascript:;"

199 
⁄˛ick
="tinyMCE.execCommand(\'mceInsertContent\',false,\'{L{'.$key.'}}\');Ñeturn false"

200 
tôÀ
="'.$valor.'" >

202 </
a
>

203 <
a
 
°yÀ
="f⁄t-size: smÆÀr;" 
tôÀ
="Eliminar"

204 
hªf
="javas¸ùt:;" 
⁄˛ick
="eliminarLiteral(\''.str_replace("'","\'",$key).'\')" >

205 [
X
]

206 </
a
>

207 <
a
 
°yÀ
="f⁄t-size: smÆÀr;" 
tôÀ
="Modificar"

208 
hªf
="javas¸ùt:;" 
⁄˛ick
="modificarLiteral(\''.$key.'\',\''.$valor.'\')" >

209 [
M
]

210 </
a
>

211 </
p
>';

215 
$ßlida
 .= '</div>';

217 
echo
 
$ßlida
;

219 
	}
}

231 
fun˘i⁄
 
	$™yadúLôîÆ
() {

233 
globÆ
 
$gcm
;

235 
$fûe
 = 
$gcm
->
	`c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
Rouãr
::
$i
.".php";

237 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

238 
$¨r
->
	`£t
(
$_GET
['elemento'],$_GET['valor']);

239 
$¨r
->
	`gu¨d¨_v¨übÀs
();

241 
echo
 "[ ".
$_GET
['ñemíto']." ] = [ ".$_GET['vÆ‹']." ]É¿[ ".
$fûe
." ]";

243 
	}
}

257 
fun˘i⁄
 
	$modifiˇrLôîÆ
() {

259 
globÆ
 
$gcm
;

261 
$fûe
 = 
$gcm
->
	`c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
Rouãr
::
$i
.".php";

263 
$¨r
 = 
GcmC⁄figFa˘‹y
::
	`GëGcmC⁄fig
(
$fûe
);

265 
$¨r
->
	`£t
(
$_GET
['elemento'],$_GET['valor']);

267 
$¨r
->
	`gu¨d¨_v¨übÀs
();

269 
echo
 "[ ".
$_GET
['ñemíto']." ] = [ ".$_GET['vÆ‹']." ]É¿[ ".
$fûe
." ]";

271 
	}
}

283 
fun˘i⁄
 
c⁄ãnido_nuevo
(
$e
, 
$¨gs
='') {

285 
$exãnsi⁄
 = ( 
$e
 == "postGuardar" ) ? '.html' : '.btml' ;

287 
	g$nombª_fichîo
 = 
°r_ª∂a˚
(
$exãnsi⁄
,'',
Rouãr
::
$c
);

288 
	g$lôîÆ_fichîo
 = 
°r_ª∂a˚
(
$exãnsi⁄
,'',
$_POST
['documento']);

292 
	g$c⁄ts
 = 
ex∂ode
('/',
$lôîÆ_fichîo
);

293 
	g$lôîÆ_fichîo
 = 
$c⁄ts
[
cou¡
($conts)-1];

295 
	g$fûe
=
$gcm
->
c⁄fig
('idiomas','Dúe˘‹iÿidiomas')."LG_".
	gRouãr
::
$ii
.".php";

297 
	g$¨r
 = 
GcmC⁄figFa˘‹y
::
GëGcmC⁄fig
(
$fûe
);

301 
	g$lôﬁd
 = 
$¨r
->
gë
(
$nombª_fichîo
);

303 i‡–
em±y
(
$lôﬁd
) ) {

305 
	g$¨r
->
£t
(
$nombª_fichîo
,
$lôîÆ_fichîo
);

307 
	g$¨r
->
gu¨d¨_v¨übÀs
();

311 
globÆ
 
	g$LG
;

312 
	g$LG
[
$nombª_fichîo
]=
°rù¶ashes
(
$lôîÆ_fichîo
);

	@gcm/modulos/literales/menuAdmin.php

1 <?
	gphp


	@gcm/modulos/menu/config/config.php

1 <?
php


2 
	g$c⁄fig
['descartar'][] = 'gdoxygen';

3 
	g$c⁄fig
['descartar'][]='thumbnail';

4 
	g$c⁄fig
['orden_presentacion'][] = 'inicio@1';

	@gcm/modulos/menu/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['descartar'] = 'Si unárchivo o carpeta contiene uno deÜos contenidosá descartarÇo se incluyenÉnÉl men√∫';

3 
	g$c⁄fig_DESC
['orden_presentacion'] = 'Especificar orden deÖresentaci√≥n deÜosÉlementos del men√∫Él formatoÉs item@orden';

	@gcm/modulos/menu/eventos_usuario.php

1 <?
php


13 
	g$evítos
['cabecera']['menu_principal'][0] = '';

14 
	g$evítos
['columna']['barra_navegacion'][1] = '';

19 
	g$this
->
£t_li°a_bœnˇ
('menu','menu_ajax');

20 
	g$this
->
£t_li°a_bœnˇ
('menu','menu_ajax_off');

	@gcm/modulos/menu/lib/Menu.php

1 <?
php


26 ˛as†
	cMíu
 
exãnds
 
	mModulos
 {

28 
public
 
	m$desˇπ¨
;

31 
public
 
	m$sOpci⁄es
, 
	m$sE∆a˚s
;

34 
public
 
	m$sMíu
;

38 
public
 
	m$SECCIONES
;

42 
	m$≥sos_míu
 = 
¨øy
() ;

53 
fun˘i⁄
 
__c⁄°ru˘
(
$sDúe˘‹io
=
NULL
, 
$fûåo
="no", 
$SECCIONES
=
åue
) {

55 
globÆ
 
$gcm
 ;

57 
	m∑ª¡
::
__c⁄°ru˘
() ;

59 
	m$this
->
	mdesˇπ¨
 = 
$this
->
c⁄fig
('descartar');

63 
	m$≥sos_c⁄figuøci⁄
 = 
$this
->
c⁄fig
('orden_presentacion');

65 i‡–
	m$≥sos_c⁄figuøci⁄
 ) {

67 
f‹óch
 ( 
$≥sos_c⁄figuøci⁄
 
as
 
$≥sos
 ) {

69 
	m$¨øy
 = 
ex∂ode
('@',
$≥sos
);

70 
	m£lf
::
$≥sos_míu
[
$¨øy
[0]] = $array[1];

77 
	m$this
->
	msOpci⁄es
 = 
¨øy
();

78 
	m$this
->
	msE∆a˚s
 = 
¨øy
();

79 
	m$this
->
	msTôÀs
 = 
¨øy
();

80 
	m$this
->
	msMíu
 = 
¨øy
();

81 
	m$this
->
	msDúe˘‹io
 = 
$sDúe˘‹io
;

82 
	m$this
->
	mSECCIONES
 = 
$SECCIONES
 ;

85 i‡–
is£t
(
$sDúe˘‹io
Ë&& 
sub°r
($sDirectorio, -1, 1) != '/' ) {

86 
$this
->
sDúe˘‹io
=
$sDúe˘‹io
.'/';

90 i‡–
fûe_exi°s
(
$this
->
sDúe˘‹io
Ë&& 
	m$dúe˘‹io
 = 
dú
($this->sDirectorio) ) {

92 
$¨chivos
 = 
$dúe˘‹io
->
ªad
()) {

96 i‡–! 
em±y
(
$this
->
desˇπ¨
) ) {

98 
$desˇπ¨
 = 
FALSE
;

99 
f‹óch
 ( 
$this
->
desˇπ¨
 
as
 
$desˇπado
 ) {

100 i‡–
°Ωos
(
$¨chivos
,
$desˇπado
Ë!=
FALSE
 ) {

101 
ªgi°ør
(
__FILE__
,
__LINE__
,'Desˇπado: '.
$¨chivos
. ' coöcidêc⁄ '.
$desˇπado
);

102 
	m$desˇπ¨
 = 
TRUE
;

106 i‡–
	m$desˇπ¨
 ) {

111 
	m$ôem
=
$this
->
sDúe˘‹io
.
$¨chivos
;

116 i‡–
	m$¨chivos
{0} !"." && 
$¨chivos
 != "index.html" ) {

118 i‡(
$fûåo
 <> "no") {

120 i‡(!
sub°r_cou¡
(
$¨chivos
,
$fûåo
)==0 || 
is_dú
(
$ôem
)){

124 i‡–
is_dú
(
$ôem
) ) {

125 
$EÀmítosDú
[] = 
$¨chivos
;

127 
	m$EÀmítos
[] = 
$¨chivos
;

133 i‡–
is_dú
(
$ôem
) ) {

134 
	m$EÀmítosDú
[] = 
$¨chivos
;

136 
	m$EÀmítos
[] = 
$¨chivos
;

144 
	m$gcm
->
ªgi°ø
(
__FILE__
, 
__LINE__
, 'Nÿ£Öuedêabrú dúe˘‹io:'.
$this
->
sDúe˘‹io
,'DEBUG');

149 i‡–!
em±y
(
$EÀmítosDú
) ) {

150 i‡(
em±y
(
$EÀmítos
)) {

151 
	m$EÀmítos
 = 
$EÀmítosDú
;

153 
	m$EÀmítos
 = 
¨øy_mîge
(
$EÀmítosDú
,
$EÀmítos
);

159 i‡(
em±y
(
$EÀmítos
)) {

164 
uas‹t
(
$EÀmítos
, 
¨øy
("Menu", 'ordenar_por_peso'));

166 
f‹óch
(
$EÀmítos
 
as
 
$EÀmíto
) {

168 i‡(
is_dú
(
$this
->
sDúe˘‹io
.
$EÀmíto
) ) {

170 i‡–
	m$SECCIONES
==
Ál£
) {  ; }

171 
	m$dúRïœ˚
=
°r_ª∂a˚
('Fûe/'.
Rouãr
::
$ii
.'/','',
$this
->
sDúe˘‹io
.
$EÀmíto
);

174 
	m$E∆a˚
 = 
$dúRïœ˚
.'/';

176 
	m$dúRïœ˚
=
°r_ª∂a˚
('Fûe/'.
Rouãr
::
$ii
.'/','',
$this
->
sDúe˘‹io
);

179 
	m$E∆a˚
 = 
$dúRïœ˚
.
$EÀmíto
;

181 
	m$Opci⁄
 = 
$EÀmíto
;

183 
	m$LôîÆ

lôîÆ
(
$EÀmíto
);

184 
	m$TôÀ
 = 
lôîÆ
(
$EÀmíto
.'_title');

185 i‡–
	m$TôÀ
 =
$EÀmíto
.'_title' ) {

186 
$TôÀ
 = '';

190 
	m$this
->
	msOpci⁄es
[] = 
$Opci⁄
;

191 
	m$this
->
	msLôîÆ
[] = 
$LôîÆ
;

192 
	m$this
->
	msE∆a˚s
[] = 
$E∆a˚
;

193 
	m$this
->
	msTôÀs
[] = 
$TôÀ
;

196 
	m$this
->
	msMíu
[
$Opci⁄
] = 
$E∆a˚
;

205 
fun˘i⁄
 
	$‹dí¨_p‹_≥so
(
$a
, 
$b
) {

207 
$aPeso
 = ( 
	`is£t
(
£lf
::
$≥sos_míu
[
$a
]) ) ? self::$pesos_menu[$a] : 0 ;

208 
$bPeso
 = ( 
	`is£t
(
£lf
::
$≥sos_míu
[
$b
]) ) ? self::$pesos_menu[$b] : 0 ;

210 i‡(
$aPeso
 =
$bPeso
)  1;

211  (
$aPeso
 < 
$bPeso
) ? -1 : 1;

212 
	}
}

226 
fun˘i⁄
 
	$In£πaMíu
(
$sA˘uÆ
, 
$iTùoMíu
) {

229 i‡(
	`em±y
(
$this
->
sOpci⁄es
)) {

233 
$iTùoMíu
) {

235 0: 
$this
->
	`MíuPagöas
(
$sA˘uÆ
, "no");

238 1: 
$this
->
	`MíuB¨ø
(
$sA˘uÆ
);

241 2: 
$this
->
	`MíuDe•ÀgabÀ
(
$sA˘uÆ
);

244 3: 
$this
->
	`MíuPagöas
(
$sA˘uÆ
, "si");

247 4: 
$this
->
	`MíuBŸ⁄es
(
$sA˘uÆ
, "si");

251 
echo
 "TipoÇo disponible";

253 
	}
}

266 
fun˘i⁄
 
	$MíuPagöas
(
$sA˘uÆ
, 
$¥öcùÆ
, 
$imagíes
 = 
FALSE
) {

269 
echo
 '<table id="menu" cellspacing="0"><tr>';

271 i‡(
$¥öcùÆ
=="si") {

273 if("öicio" =
$sA˘uÆ
) {

275 i‡–
$imagíes
 ) {

277 
echo
 '<td id="míuOff"><®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
	`lôîÆ
('öicio_tôÀ').'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
('', 
TRUE
).'"ált="'.literal('inicio').'" /></a></td>';

279 
echo
 '<td id="míuOff"><®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
	`lôîÆ
('inicio_title').'" ><img src=""ált="'.literal('inicio').'" /></a></td>';

284 i‡–
$imagíes
 ) {

285 
echo
 '<td><®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
	`lôîÆ
('öicio_tôÀ').'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
('').'"ált="'.literal('inicio').'" /></a></td>';

287 
echo
 '<td><®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
	`lôîÆ
('inicio_title').'" >'.literal('inicio').'</a></td>';

294 
	`ª£t
(
$this
->
sE∆a˚s
);

295 
	`ª£t
(
$this
->
sTôÀs
);

296 
	`ª£t
(
$this
->
sLôîÆ
);

299 
$E∆a˚
 = 
	`cuºít
(
$this
->
sE∆a˚s
);

300 
$TôÀ
 = 
	`cuºít
(
$this
->
sTôÀs
);

301 
$LôîÆ
 = 
	`cuºít
(
$this
->
sLôîÆ
);

304 
	`f‹óch
(
$this
->
sOpci⁄es
 
as
 
$Opci⁄
) {

306 i‡–
	`is_dú
(
Rouãr
::
$dd
.
$E∆a˚
) ) {

309 if(
$Opci⁄
 =
$sA˘uÆ
) {

312 i‡–
$imagíes
 ) {

313 
echo
 '<td id="míuOff"><®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
	`lôîÆ
(
$TôÀ
,1).'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
($E∆a˚, 
TRUE
).'"á…="'.
$LôîÆ
.'" /></a></td>';

315 
echo
 '<td id="míuOff"><®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
	`lôîÆ
(
$TôÀ
,1).'" >'.
$LôîÆ
.'</td>';

320 i‡–
$imagíes
 ) {

321 
echo
 '<td id="'.
$Opci⁄
.'"><®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
	`lôîÆ
(
$TôÀ
,1).'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
($E∆a˚).'"á…="'.
$LôîÆ
.'" /></a></td>';

323 
echo
 '<td id="'.
$Opci⁄
.'" ><®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
	`lôîÆ
(
$TôÀ
,1).'" >'.
$LôîÆ
.'</a></td>';

331 
$E∆a˚
 = 
	`√xt
(
$this
->
sE∆a˚s
);

332 
$TôÀ
 = 
	`√xt
(
$this
->
sTôÀs
);

333 
$LôîÆ
 = 
	`√xt
(
$this
->
sLôîÆ
);

338 
echo
 '</tr></table>';

339 
	}
}

344 
fun˘i⁄
 
	$MíuB¨ø
(
$sA˘uÆ
) {

346 
globÆ
 
$gcm
;

349 i‡–
$sA˘uÆ
 ) {

351 
$aSecci⁄es
 = 
	`ex∂ode
('/',
$sA˘uÆ
);

352 
$sA˘uÆ
 = ( 
$aSecci⁄es
[
	`cou¡
($aSecciones)-1] ) ? $aSecciones[count($aSecciones)-1] : $aSecciones[count($aSecciones)-2];

353 
$£cci⁄
=
	`lôîÆ
(
$sA˘uÆ
,1);

357 
$aSecci⁄es
 = 
	`¨øy
();

358 
$£cci⁄
=
	`lôîÆ
('inicio',1);

362 
$aURL
 = 
	`ex∂ode
('/',
$_SERVER
['REQUEST_URI']);

364 
echo
 "\n<ul>";

365 
	`f‹óch
(
$this
->
sMíu
 
as
 
$Opci⁄
 => 
$E∆a˚
) {

367 
$aE∆a˚
 = 
	`ex∂ode
('/',
$E∆a˚
);

370 
$LôîÆ
=
	`°r_ª∂a˚
('.html','',
$Opci⁄
);

372 i‡–
	`ö_¨øy
(
$Opci⁄
,
$aSecci⁄es
) ) {

374 
echo
 "\n<li>";

375 
echo
 "<®˛ass='m_⁄' hªf='".
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$dú
.
$E∆a˚
."' >";

376 
echo
 '<img src="'.
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ic⁄o
('-').'"ált="-"/>';

377 
echo
 " </a>";

378 
echo
 "<®hªf='".
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$dú
.
$E∆a˚
."'>";

379 
echo
 
	`lôîÆ
(
$LôîÆ
,1);

380 
echo
 '</a></li>';

381 
$submíu
[
$Opci⁄
] = 
√w
 
	`Míu
(
$this
->
sDúe˘‹io
.$Opci⁄.'/', '.html', 
åue
);

382 
$submíu
[
$Opci⁄
]->
	`In£πaMíu
(
Rouãr
::
$s
,1);

386 i‡–
	`sub°r
(
$E∆a˚
, -5) == '.html' ) {

387 i‡–
	`°r_ª∂a˚
('%20',' ',
$aURL
[
	`cou¡
($aURL)-1]Ë=
$aE∆a˚
[count($aEnlace)-1]) {

388 
echo
 "\n<lò˛ass='li°aOff' >".
	`lôîÆ
(
$LôîÆ
,1).'</li>';

390 
echo
 "\n<li><®hªf='".
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$dú
.
$E∆a˚
."'>".
	`lôîÆ
(
$LôîÆ
,1).'</a></li>';

393 
echo
 "\n<li>";

394 
echo
 "<®˛ass='m_off' hªf='".
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$dú
.
$E∆a˚
."'>";

395 
echo
 '<img src="'.
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ic⁄o
('+').'"ált="+"/>';

396 
echo
 " </a>";

397 
echo
 "<®hªf='".
Rouãr
::
$íœ˚_ªœtivo
.Rouãr::
$dú
.
$E∆a˚
."'>".
	`lôîÆ
(
$LôîÆ
,1);

398 
echo
 '</a></li>';

403 
echo
 "\n</ul>";

405 
	}
}

409 
fun˘i⁄
 
	$MíuDe•ÀgabÀ
(
$sA˘uÆ
) {

414 
echo
 '<formáction="">'.

420 
	`f‹óch
(
$this
->
sMíu
 
as
 
$Opci⁄
 => 
$E∆a˚
)

421 if(
$Opci⁄
 =
$sA˘uÆ
)

422 
echo
 '<›ti⁄ vÆue="'.
$E∆a˚
.

423 '" sñe˘ed>'.
	`lôîÆ
(
$Opci⁄
,1).'</option>';

425 
echo
 '<›ti⁄ vÆue="'.
$E∆a˚
.'">'.
	`lôîÆ
(
$Opci⁄
,1).'</option>';

427 
echo
 '</select></form>';

428 
	}
}

441 
fun˘i⁄
 
	$míu_¥öcùÆ_img
() {

443 
echo
 "\n<div id='menu_principal'>";

446 
$míuPröcùÆ
 = 
√w
 
	`Míu
("Fûe/".
Rouãr
::
$ii
."/");

447 
$míuPröcùÆ
->
	`In£πaMíu
(
Rouãr
::
$e°amos
,4);

449 
echo
 "\n</div> <!-- Acaba menu_principal -->";

451 
	}
}

459 
fun˘i⁄
 
	$míu_¥öcùÆ
() {

465 
echo
 "\n<div id='menu_principal'>";

468 
$míuPröcùÆ
 = 
√w
 
	`Míu
("Fûe/".
Rouãr
::
$ii
."/");

469 
$míuPröcùÆ
->
	`In£πaMíu
(
Rouãr
::
$e°amos
,3);

471 
echo
 "\n</div> <!-- Acaba menu_principal -->";

473 
	}
}

479 
fun˘i⁄
 
	$b¨ø_«vegaci⁄
() {

481 
globÆ
 
$gcm
;

483 
$this
->
	`javas¸ùts
('menu.js');

485 
	`ob_°¨t
();

486 
echo
 '<®hªf="'.
$_SERVER
['PHP_SELF'].'" >'.
	`lôîÆ
('inicio').'</a>';

487 
echo
 '<div id="barraNavegacion">';

488 
$b¨øNavegaci⁄
 = 
√w
 
	`Míu
("Fûe/".
Rouãr
::
$ii
."/", '.html', 
åue
);

489 
$b¨øNavegaci⁄
->
	`In£πaMíu
(
Rouãr
::
$s
,1);

490 
echo
 '</div>';

491 
$c⁄ãnido
 = 
	`ob_gë_c⁄ã¡s
();

492 
	`ob_íd_˛ón
();

495 
$∑√l
 = 
	`¨øy
();

496 
$∑√l
['tôulo'] = 
	`lôîÆ
('Men√∫',3);

497 
$∑√l
['c⁄ãnido'] =
$c⁄ãnido
;

499 
Temas
::
	`∑√l
(
$∑√l
);

501 
	}
}

503 
fun˘i⁄
 
	$míu_ajax
() {

505 
globÆ
 
$gcm
;

507 
	`ob_íd_˛ón
();

510 
$£cci⁄es
 = 
	`ex∂ode
('/',
	`com¥ob¨_b¨ø
(
Rouãr
::
$s
,'eliminar'));

511 
$£cci⁄
 = 
$£cci⁄es
[
	`cou¡
($secciones)-1];

512 
echo
 "\n<li>";

513 
echo
 "<®˛ass='m_⁄' hªf='".
Rouãr
::
$s
."' >";

514 
echo
 '<img src="'.
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ic⁄o
('-').'"ált="-"/>';

515 
echo
 " </a>";

516 
echo
 "<®hªf='".
Rouãr
::
$s
."'>";

517 
echo
 
	`lôîÆ
(
$£cci⁄
,1);

518 
echo
 '</a></li>';

519 
$submíu
 = 
√w
 
	`Míu
(
Rouãr
::
$dd
.Rouãr::
$s
, '.html', 
åue
);

520 
$submíu
->
	`In£πaMíu
(
Rouãr
::
$s
,1);

522 
	`exô
();

524 
	}
}

526 
fun˘i⁄
 
	$míu_ajax_off
() {

528 
globÆ
 
$gcm
;

530 
	`ob_íd_˛ón
();

532 
$£cci⁄es
 = 
	`ex∂ode
('/',
	`com¥ob¨_b¨ø
(
Rouãr
::
$s
,'eliminar'));

533 
$£cci⁄
 = 
$£cci⁄es
[
	`cou¡
($secciones)-1];

535 
echo
 "<®˛ass='m_off' hªf='".
Rouãr
::
$s
."' >";

536 
echo
 '<img src="'.
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ic⁄o
('+').'"ált="+"/>';

537 
echo
 " </a>";

539 
	`exô
();

540 
	}
}

553 
fun˘i⁄
 
	$bŸ⁄_£cci⁄
(
$£cci⁄
, 
$⁄
 = 
FALSE
) {

555 
$e°ado
 = ( 
$⁄
 ) ? 'on' : 'off';

557 
$img
 = 
Rouãr
::
$d
. 
$£cci⁄
.'míu_'.
$e°ado
.'.≤g'; i‡–
	`fûe_exi°s
($imgËË Rouãr::
$ba£
.$img;

558 
$img
 = 
Rouãr
::
$d
. 
$£cci⁄
.'míu_'.
$e°ado
.'.gif'; i‡–
	`fûe_exi°s
($imgËË Rouãr::
$ba£
.$img;

559 
$img
 = 
Rouãr
::
$dd
.
$£cci⁄
.'míu_'.
$e°ado
.'.≤g'; i‡–
	`fûe_exi°s
($imgËË Rouãr::
$ba£
.$img;

560 
$img
 = 
Rouãr
::
$dd
.
$£cci⁄
.'míu_'.
$e°ado
.'.gif'; i‡–
	`fûe_exi°s
($imgËË Rouãr::
$ba£
.$img;

562 
$£cci⁄_
 = (
$£cci⁄
)?$seccion:'inicio';

563 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Énc⁄åÿbŸ⁄ dê£cci√≥¿∑ø '.
$£cci⁄_
,'ADMIN');

564 
	}
}

576 
fun˘i⁄
 
	$MíuBŸ⁄es
(
$sA˘uÆ
, 
$¥öcùÆ
) {

578 
echo
 '<ul id="menu_botones_horizontal">';

582 
$tôÀ_öicio
 = ( 
	`lôîÆ
('inicio_title') != 'inicio_title' ) ?Üiteral('inicio_title') : '' ;

583 if("öicio" =
$sA˘uÆ
 || 
	`em±y
(
Rouãr
::
$s
) ) {

585 
echo
 '<li id="menuOff">';

586 
echo
 '<®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
$tôÀ_öicio
.'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
('', 
TRUE
).'"á…="'.
	`lôîÆ
('inicio').'" /></a>';

590 
echo
 '<li>';

591 
echo
 '<®hªf="'.
Rouãr
::
$ba£
.'"ÅôÀ="'.
$tôÀ_öicio
.'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
('').'"á…="'.
	`lôîÆ
('inicio').'" /></a>';

597 
$ßlida
 = 
FALSE
;

598 
$fichîos_£cci⁄
 = 
	`glob
(
Rouãr
::
$dd
.'*.html');

599 
$c⁄ãnidos
 = 
	`¨øy
();

600 
	`f‹óch
 ( 
$fichîos_£cci⁄
 
as
 
$fûe
 ) {

601 
$c⁄ãnidos
[] = 
	`ba£«me
(
$fûe
,'.html');

603 
	`uas‹t
(
$c⁄ãnidos
, 
	`¨øy
("Menu", 'ordenar_por_peso'));

605 
	`f‹óch
 ( 
$c⁄ãnidos
 
as
 
$nombª
 ) {

607 
$lôîÆ
 = 
	`lôîÆ
(
$nombª
,1);

608 
$íœ˚
 = 
Rouãr
::
$ba£
.
$nombª
.'.html';

609 
$˛a£
 = ( 
Rouãr
::
$c
 =
$nombª
.'.html' ) ? 'ma_on' : 'ma_off';

611 i‡–
$nombª
 != 'index' ) {

613 
$ßlida
 .'<lò˛ass="'.
$˛a£
.'">';

614 i‡–
Rouãr
::
$c
 !
$nombª
.'.html' ) 
$ßlida
 .'<®hªf="'.
$íœ˚
.'">';

615 
$ßlida
 .
$lôîÆ
;

616 i‡–
Rouãr
::
$c
 !
$nombª
.'.html' ) 
$ßlida
 .= '</a>';

617 
$ßlida
 .= '</li><br />';

623 i‡–
$ßlida
 ) 
echo
 '<ul>'.$salida.'</ul>';

624 
echo
 '</li>';

629 
	`ª£t
(
$this
->
sE∆a˚s
);

630 
	`ª£t
(
$this
->
sTôÀs
);

631 
	`ª£t
(
$this
->
sLôîÆ
);

634 
$E∆a˚
 = 
	`cuºít
(
$this
->
sE∆a˚s
);

635 
$TôÀ
 = 
	`cuºít
(
$this
->
sTôÀs
);

636 
$LôîÆ
 = 
	`cuºít
(
$this
->
sLôîÆ
);

639 
	`f‹óch
(
$this
->
sOpci⁄es
 
as
 
$Opci⁄
) {

641 i‡–
	`is_dú
(
Rouãr
::
$dd
.
$E∆a˚
) ) {

644 if(
$Opci⁄
 =
$sA˘uÆ
) {

646 
echo
 '<li id="menuOff">';

647 
echo
 '<®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
$TôÀ
.'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
($E∆a˚, 
TRUE
).'"á…="'.
$LôîÆ
.'" /></a>';

651 
echo
 '<lòid="'.
$Opci⁄
.'">';

652 
echo
 '<®hªf="'.
Rouãr
::
$ba£
.
$E∆a˚
.'"ÅôÀ="'.
$TôÀ
.'" ><img src="'.
$this
->
	`bŸ⁄_£cci⁄
($E∆a˚).'"á…="'.
$LôîÆ
.'" /></a>';

658 
$ßlida
 = 
FALSE
;

659 
$fichîos_£cci⁄
 = 
	`glob
(
Rouãr
::
$dd
.
$E∆a˚
.'*.html');

660 
$c⁄ãnidos
 = 
	`¨øy
();

661 
	`f‹óch
 ( 
$fichîos_£cci⁄
 
as
 
$fûe
 ) {

662 
$c⁄ãnidos
[] = 
	`ba£«me
(
$fûe
,'.html');

664 
	`uas‹t
(
$c⁄ãnidos
, 
	`¨øy
("Menu", 'ordenar_por_peso'));

666 
	`f‹óch
 ( 
$c⁄ãnidos
 
as
 
$nombª
 ) {

668 
$lôîÆ
 = 
	`lôîÆ
(
$nombª
,1);

669 
$íœ˚
 = 
Rouãr
::
$ba£
.
$E∆a˚
.
$nombª
.'.html';

670 
$˛a£
 = ( 
Rouãr
::
$c
 =
$nombª
.'.html' ) ? 'ma_on' : 'ma_off';

672 i‡–
$nombª
 != 'index' ) {

674 
$ßlida
 .'<lò˛ass="'.
$˛a£
.'">';

675 i‡–
Rouãr
::
$c
 !
$nombª
.'.html' ) 
$ßlida
 .'<®hªf="'.
$íœ˚
.'">';

676 
$ßlida
 .
$lôîÆ
;

677 i‡–
Rouãr
::
$c
 !
$nombª
.'.html' ) 
$ßlida
 .= '</a>';

678 
$ßlida
 .= '</li><br />';

684 i‡–
$ßlida
 ) 
echo
 '<ul>'.$salida.'</ul>';

685 
echo
 '</li>';

690 
$E∆a˚
 = 
	`√xt
(
$this
->
sE∆a˚s
);

691 
$TôÀ
 = 
	`√xt
(
$this
->
sTôÀs
);

692 
$LôîÆ
 = 
	`√xt
(
$this
->
sLôîÆ
);

697 i‡(
$¥öcùÆ
=="si"Ë
echo
 '</ul>';

700 
	}
}

	@gcm/modulos/metatags/config/config.php

1 <?
php


2 
	g$c⁄fig
['title'] = 'Gcm';

3 
	g$c⁄fig
['author'] = 'Eduardo Magran√©';

4 
	g$c⁄fig
['subject'] = 'Gestor de Contenido Gcm';

5 
	g$c⁄fig
['description'] = 'HerramientaÖaraÜa gesti√≥n de contenido variado';

6 
	g$c⁄fig
['keywords'] = 'programaci√≥n, inform√°tica,Üinux,Öhp, bash, javascript, css,ájax';

7 
	g$c⁄fig
['generator'] = 'vim';

8 
	g$c⁄fig
['language'] = 'spanish';

9 
	g$c⁄fig
['revisit'] = '1 day';

10 
	g$c⁄fig
['distribution'] = 'global';

11 
	g$c⁄fig
['robots'] = 'all';

	@gcm/modulos/metatags/config/config_ca.php

1 <?
php


2 
	g$c⁄fig_DESC
['Titulo']='Titulo delÖroyecto';

3 
	g$c⁄fig_DESC
['Subtitulo']='Subtitulo delÖroyecto';

4 
	g$c⁄fig_DESC
['Descripcion']='Descripci√≥n delÖroyecto,Öara incluirÉnÜos metaÅags';

5 
	g$c⁄fig_DESC
['keywords']='Palabras claveÖaraÜos buscadores separadasÖor unÉspacio';

	@gcm/modulos/metatags/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['title']='Titulo delÖroyecto';

3 
	g$c⁄fig_DESC
['author']='Titulo delÖroyecto';

4 
	g$c⁄fig_DESC
['subject']='Subtitulo delÖroyecto';

5 
	g$c⁄fig_DESC
['description']='Descripci√≥n delÖroyecto,Öara incluirÉnÜos metaÅags';

6 
	g$c⁄fig_DESC
['keywords']='Palabras claveÖaraÜos buscadores separadasÖor comas';

7 
	g$c⁄fig_DESC
['generator']='ProgramaÖara gene';

8 
	g$c⁄fig_DESC
['language']='C√≥digo deÜenguajeÉjemplo:És,Én';

9 
	g$c⁄fig_DESC
['revisit']='Ejemplo 1 day';

10 
	g$c⁄fig_DESC
['distribution']='Ejemplo global';

11 
	g$c⁄fig_DESC
['robots']='';

	@gcm/modulos/metatags/eventos_usuario.php

1 <?
php


2 
	g$evítos
['heads']['presentar_heads_dinamicos'][1] = '';

	@gcm/modulos/metatags/lib/Metatags.php

1 <?
php


38 ˛as†
	cMë©ags
 
exãnds
 
	mModulos
 {

40 
¥iv©e
 
	m$Proye˘o
;

41 
¥iv©e
 
	m$Tôulo
;

42 
¥iv©e
 
	m$Des¸ùci⁄
;

43 
¥iv©e
 
	m$keyw‹ds
;

48 
fun˘i⁄
 
	$__c⁄°ru˘
() {

50 
∑ª¡
::
	`__c⁄°ru˘
();

52 
$this
->
Tôulo
 = $this->
	`c⁄fig
('title');

60 
fun˘i⁄
 
	$¥e£¡¨_hóds_döamicos
() {

62 
globÆ
 
$gcm
;

64 i‡–
$gcm
->
tôulo
 ) {

65 
$tôulo
 = 
$gcm
->
tôulo
;

66 } 
	`ñ£if
 ( 
Rouãr
::
$c
 == 'index.html' || ! Router::$c ) {

67 
$tôulo
=
Rouãr
::
$e°amos
;

68 
$tôulo
 = 
	`lôîÆ
($titulo);

70 
$tôulo
=
	`°r_ª∂a˚
('.html','',
Rouãr
::
$c
);

71 
$tôulo
 = 
	`lôîÆ
($titulo);

74 
$tôulo_∑göa
 = ( 
$gcm
->
tôulo
 ) ? $gcm->tôulÿ: 
$tôulo
;

76 
$tôulo
 = 
	`°rù_ègs
(
$this
->
Tôulo
.' :: '.
$tôulo_∑göa
);

79 
	`ö˛ude
(
	`dú«me
(
__FILE__
).'/../config/config.php');

80 i‡–
	`is_fûe
('DATOS/c⁄figuøci⁄/më©ags/c⁄fig.php'ËË
	`ö˛ude
('DATOS/configuracion/metatags/config.php');

83 
	`f‹óch
 ( 
$c⁄fig
 
as
 
$«me
 => 
$vÆ‹
 ) {

85 
echo
 "\n".'<më®«me="'.
$«me
.'" c⁄ã¡="'.
$vÆ‹
.'" />';

89 
echo
 "\n\n";

91 
	`ö˛ude
 (
	`dú«me
(
__FILE__
).'/../html/heads.html');

93 
	}
}

	@gcm/modulos/referencias/eventos_admin.php

1 <?
php


2 
	g$evítos
['columna']['panel'][10]='';

	@gcm/modulos/referencias/eventos_usuario.php

1 <?
php


3 
	g$evítos
['postcontenido']['procesar_texto'][1] = '';

	@gcm/modulos/referencias/lib/Referencias.php

1 <?
php


25 ˛as†
	cRe„ªncüs
 
exãnds
 
	mModulos
 {

27 
¥iv©e
 
	m$ëiquëa_öicio
;

28 
¥iv©e
 
	m$ëiquëa_föÆ
;

30 
fun˘i⁄
 
	$__c⁄°ru˘
() {

32 
∑ª¡
::
	`__c⁄°ru˘
();

34 
$this
->
ëiquëa_öicio
 = '{Ref{';

35 
$this
->
ëiquëa_föÆ
 = '}}';

43 
fun˘i⁄
 
	$¥ïro˚ß_ãxto
() {

45 
$ßlida
 = '<div class="panel">';

46 
$ßlida
 .= '<span class="tituloPanel">';

47 
$ßlida
 .'<®hªf="javas¸ùt:visuÆiz¨(\'ˇja_íœ˚s\')" >'.
	`lôîÆ
('EnlacesÑelacionados').'</a>';

48 
$ßlida
 .= '</span>';

49 
$ßlida
 .= '<div id="caja_enlaces" class="subpanel_visible">';

50 
$ßlida
 .= '<ul>';

51  
$ßlida
;

53 
	}
}

61 
fun˘i⁄
 
	$po°¥o˚ß_ãxto
() {

63 
$ßlida
 = '</ul>';

64 
$ßlida
 .= '</div>';

65 
$ßlida
 .= '</div>';

67  
$ßlida
;

69 
	}
}

75 
fun˘i⁄
 
	$¥o˚ßr_ãxto
() {

77 
globÆ
 
$gcm
;

79 
$buf„r
 = 
	`ob_gë_c⁄ã¡s
().
$gcm
->
c⁄ãnido
 ;

80 
	`ob_˛ón
();

82 
$num_ëiquëa
 = 0;

84  
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
Ë!=
Ál£
 ) {

86 
$num_ëiquëa
++;

87 
$pos1
 = 
NULL
;

88 
$pos2
 = 
NULL
;

89 
$¨chivo
 = 
NULL
;

90 
$ªm∂az¨
 = 
NULL
;

91 
$¨chivo
 = 
NULL
;

93 
$pos1
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_öicio
);

94 
$pos2
 = 
	`°Ωos
(
$buf„r
, 
$this
->
ëiquëa_föÆ
, 
$pos1
);

95 
$ªm∂az¨
 = 
	`sub°r
(
$buf„r
, 
$pos1
, 
$pos2
 - $pos1 + 2);

96 
$ëiquëa
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_öicio
,'',
$ªm∂az¨
);

97 
$ëiquëa
 = 
	`°r_ª∂a˚
(
$this
->
ëiquëa_föÆ
,'',$etiqueta);

99 i‡–
$pos1
 && 
$pos2
 && 
$ëiquëa
 && 
$ªm∂az¨
 ) {

101 
$ëiquëa
 = 
$this
->
	`¥o˚ß_ëiquëa
($ëiquëa,
$num_ëiquëa
);

102 
$buf„r
 = 
	`°r_ª∂a˚
(
$ªm∂az¨
,
$ëiquëa
,$buffer);

110 i‡–!
	`em±y
(
$ëiquëa
) ) {

112 
$buf„r
 = 
	`°r_ª∂a˚
(
$ëiquëa
,$ëiquëa.
$this
->
	`po°¥o˚ß_ãxto
(),$buffer);

116 
$gcm
->
c⁄ãnido
=
$buf„r
;

118 
	}
}

131 
fun˘i⁄
 
	$¥o˚ß_ëiquëa
(
$ªf
,
$num_ëiquëa
) {

133 
$ßlida
 = '';

135 i‡–
$num_ëiquëa
 =1 ) 
$ßlida
 = 
$this
->
	`¥ïro˚ß_ãxto
();

137 i‡–
	`°Ωos
(
$ªf
,'href') ) {

138 
$ßlida
 .'<li>'.
$ªf
.'</li>';

139 } 
	`ñ£if
 ( 
	`°Ωos
(
$ªf
,'::') ) {

140 
	`li°
(
$ªf
,
$nombª
Ë
	`ex∂ode
('::',$ref);

141 
$ßlida
 .'<li><®hªf="'.
$ªf
.'">'.
$nombª
.'</a></li>';

143 
$nombª
 = 
$ªf
;

144 
$ßlida
 .'<li><®hªf="'.
$ªf
.'">'.
$nombª
.'</a></li>';

147  
$ßlida
;

149 
	}
}

156 
fun˘i⁄
 
	$∑√l
() {

160 i‡–
Rouãr
::
$e
 !== 'editar_contenido' && Router::$e !== 'nuevo' ) ;

162 
$∑√l
 = 
	`¨øy
();

163 
$∑√l
['tôulo'] = 
	`lôîÆ
('Insertar').' '.literal('referencia');

164 
$∑√l
['ocu…o'] = 
TRUE
;

165 
$∑√l
['href'] = 'javascript:visualizar(\'referencias_form\');';

166 
$∑√l
['subpanel'] ='referencias_form';

167 
$∑√l
['contenido'] =

169 
Nombª
: <
öput
 
ty≥
="ãxt" 
«me
="nombre" />

170 <
br
 />

171 
E∆a˚
: <
öput
 
ty≥
="ãxt" 
«me
="enlace" />

172 <
br
 />

173 <
öput
 
ty≥
="submô" 
vÆue
="'.literal('Insertar').'" />

174 </
f‹m
>';

176 
Temas
::
	`∑√l
(
$∑√l
);

178 
	}
}

	@gcm/modulos/referencias/menuAdmin.php

1 <?
	gphp


	@gcm/modulos/responsiveslides/eventos_admin.php

1 <?
	gphp


	@gcm/modulos/responsiveslides/eventos_usuario.php

1 <?
	gphp


	@gcm/modulos/responsiveslides/lib/Responsiveslides.php

1 <?
php


15 ˛as†
	cRe•⁄sive¶ides
 
exãnds
 
	mModulos
 {

19 
fun˘i⁄
 
	$__c⁄°ru˘
() {

21 
∑ª¡
::
	`__c⁄°ru˘
();

25 
fun˘i⁄
 
	$¶ide
() {

27 
	}
}

	@gcm/modulos/responsiveslides/menuAdmin.php

1 <?
	gphp


	@gcm/modulos/temas/config/config.php

1 <?
php


2 
	g$c⁄fig
['tema_actual']='zen';

	@gcm/modulos/temas/css/colores.php

1 <?
php


4 
	g$cﬁ‹es
['body-00'] = '#e9eaec';

5 
	g$cﬁ‹es
['body-01'] = '#161818';

6 
	g$cﬁ‹es
['body-02'] = 'rgba(254,254,254,1)';

7 
	g$cﬁ‹es
['body-03'] = 'rgba(252,252,252,1)';

8 
	g$cﬁ‹es
['body-04'] = 'rgba(219,219,219,1)';

9 
	g$cﬁ‹es
['body-05'] = 'rgba(129,130,133,1)';

10 
	g$cﬁ‹es
['body-06'] = '#fff';

11 
	g$cﬁ‹es
['body-07'] = '#646464';

12 
	g$cﬁ‹es
['body-08'] = 'rgba(0,0,0,0.3)';

13 
	g$cﬁ‹es
['body-09'] = 'rgba(0, 0, 0, 0.3)';

14 
	g$cﬁ‹es
['body-10'] = 'rgba(255, 255, 255, 1)';

15 
	g$cﬁ‹es
['body-11'] = '#000';

16 
	g$cﬁ‹es
['body-12'] = '#ddd';

17 
	g$cﬁ‹es
['body-13'] = '#c3c3c3';

18 
	g$cﬁ‹es
['body-14'] = '#7c7c7c';

19 
	g$cﬁ‹es
['body-15'] = '#dd0';

20 
	g$cﬁ‹es
['body-16'] = 'rgba(255, 255, 255, 0.7)';

21 
	g$cﬁ‹es
['body-17'] = '#666666';

22 
	g$cﬁ‹es
['body-18'] = '#eee';

23 
	g$cﬁ‹es
['menuAdmin-00'] = '#666';

24 
	g$cﬁ‹es
['menuAdmin-01'] = '#ccc';

25 
	g$cﬁ‹es
['comentarios-00'] = '#f0e7ca';

26 
	g$cﬁ‹es
['comentarios-01'] = '#dcd9c5';

27 
	g$cﬁ‹es
['comentarios-02'] = '#8385b5';

28 
	g$cﬁ‹es
['comentarios-03'] = '#777';

29 
	g$cﬁ‹es
['comentarios-04'] = '#789';

30 
	g$cﬁ‹es
['geshi-00'] = '#222223';

31 
	g$cﬁ‹es
['geshi-01'] = '#222';

32 
	g$cﬁ‹es
['geshi-02'] = '#f8f8f8';

33 
	g$cﬁ‹es
['geshi-03'] = '#202021';

34 
	g$cﬁ‹es
['geshi-04'] = '#505e80';

35 
	g$cﬁ‹es
['thickbox-00'] = '#333333';

36 
	g$cﬁ‹es
['thickbox-01'] = '#ffffff';

37 
	g$cﬁ‹es
['thickbox-02'] = '#000000';

38 
	g$cﬁ‹es
['thickbox-03'] = '#525252';

39 
	g$cﬁ‹es
['thickbox-04'] = '#e8e8e8';

40 
	g$cﬁ‹es
['botonera-00'] = '#d9e6fc';

41 
	g$cﬁ‹es
['listado_contenidos-00'] = '#eff0f0';

42 
	g$cﬁ‹es
['listado_contenidos-01'] = '#2c2f3f';

43 
	g$cﬁ‹es
['pie-00'] = '#eeeeee';

	@gcm/modulos/temas/eventos_admin.php

1 <?
php


5 i‡–
	gRouãr
::
$a
 ='admöi°ør' && 
Rouãr
::
$m
 == 'temas' ) {

6 
$evítos
['columna']['panel_colores'][1] = '';

	@gcm/modulos/temas/eventos_usuario.php

1 <?
php


24 
	g$evítos
['precarga']['inspeccionar_router'][3] = '';

27 
	g$evítos
['pie']['pie'][1] = '';

30 
	g$evítos
['cabeceraIzquierda']['presentar_titulo'][1]='';

33 
	g$evítos
['heads']['incluir_css_head'][5] = '';

36 
	g$evítos
['heads']['incluir_javascript_head'][5] = '';

39 
	g$evítos
['scripts']['incluir_javascript'][1] = '';

42 
	g$evítos
['precarga']['ocultar_contenido_desde_titulo'][10] = '';

	@gcm/modulos/temas/lib/Temas.php

1 <?
php


10 
ªquúe_⁄˚
(
GCM_DIR
.'lib/int/temas/lib/TemaGcm.php');

12 
ªquúe_⁄˚
(
GCM_DIR
.'lib/ext/detectar_navegador/browser_class_inc.php');

59 ˛as†
	cTemas
 
exãnds
 
	mModulos
 {

61 
public
 
	m$∂©af‹ma
;

62 
public
 
	m$«vegad‹
;

63 
public
 
	m$vîsi⁄
;

65 
¥Ÿe˘ed
 
	m$ãma
;

66 
¥Ÿe˘ed
 
	m$fichîos_xde„˘o
;

67 
¥Ÿe˘ed
 
	m$fichîos_ãma
;

68 
¥Ÿe˘ed
 
	m$cﬁ‹es
;

70 
¥Ÿe˘ed
 
	m$dú_modulos
;

71 
¥Ÿe˘ed
 
	m$dú_ãmas
 = 'temasGcm/';

73 
¥Ÿe˘ed
 
	m$ãma_a˘uÆ
;

74 
¥Ÿe˘ed
 
	m$dú_ãma_a˘uÆ
;

75 
¥Ÿe˘ed
 
	m$fich_cﬁ‹es
;

77 
¥iv©e
 
	m$tùos_fichîos
 = 
¨øy
('css','html','js','img','iconos','libjs');

79 
¥iv©e
 
	m$Tôulo
;

80 
¥iv©e
 
	m$Subtôulo
;

93 
fun˘i⁄
 
	$__c⁄°ru˘
() {

95 
globÆ
 
$gcm
;

97 
∑ª¡
::
	`__c⁄°ru˘
();

99 
$ãma_a˘uÆ
 = 
$gcm
->
ãma
;

103 i‡–
	`is£t
(
$_REQUEST
['tema']) ) {

104 
$ãma_a˘uÆ
 = 
$_REQUEST
['tema'];

105 
$_SESSION
[
$gcm
->
	`c⁄fig
('admö','Proye˘o').'_ãma'] = 
$ãma_a˘uÆ
;

106 } 
	`ñ£if
 ( 
	`is£t
(
$_SESSION
[
$gcm
->
	`c⁄fig
('admin','Proyecto').'_tema']) ) {

107 
$ãma_a˘uÆ
 = 
$_SESSION
[
$gcm
->
	`c⁄fig
('admin','Proyecto').'_tema'];

110 
$b
 = 
√w
 
	`brow£r
();

111 
$bb
 = 
$b
->
	`wh©Brow£r
();

113 
$this
->
«vegad‹
 = 
$bb
['browsertype'];

114 
$this
->
vîsi⁄
 = 
$bb
['version'];

115 
$this
->
∂©af‹ma
 = 
$bb
['platform'];

117 
$this
->
Tôulo
 = 
$gcm
->
	`c⁄fig
('metatags','title');

118 
$this
->
Subtôulo
 = 
$gcm
->
	`c⁄fig
('metatags','subject');

120 
$ãma_c⁄f
 = 
$this
->
	`c⁄fig
('tema_actual');

122 
$this
->
ãma_a˘uÆ
 = ( 
$ãma_a˘uÆ
 ) ? $ãma_a˘uÆ : 
$ãma_c⁄f
 ;

123 
$this
->
dú_ãma_a˘uÆ
 = ( $this->
ãma_a˘uÆ
 ) ? $this->
dú_ãmas
.$this->ãma_a˘uÆ.'/' : 
FALSE
;

124 
$this
->
dú_modulos
 = 
GCM_DIR
.'modulos/';

126 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Tem®a˘uÆ: '.
$this
->
ãma_a˘uÆ
);

130 i‡–
	`fûe_exi°s
(
$this
->
dú_ãma_a˘uÆ
.'modulos/temas/css/colores.php') ) {

131 
$this
->
fich_cﬁ‹es
 = $this->
dú_ãma_a˘uÆ
.'modulos/temas/css/colores.php';

133 
$this
->
fich_cﬁ‹es
 = $this->
dú_modulos
.'temas/css/colores.php';

136 
$this
->
	`c⁄åuú_li°a_cﬁ‹es
();

140 i‡–! 
	`is_dú
(
$this
->
dú_modulos
) ) {

142 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Dúe˘‹iÿdêmodulo†[".
$this
->
dú_modulos
."]ÇoÉncontrado",'ADMIN');

146 
$this
->
fichîos_xde„˘o
 = $this->
	`busˇr_fichîo
($this->
dú_modulos
);

150 i‡–
	`is_dú
('modulos') ) {

152 
$fichîos_modulos_¥oye˘o
 = 
$this
->
	`busˇr_fichîo
('modulos/');

153 
	`f‹óch
 ( 
$this
->
fichîos_xde„˘o
 
as
 
$key
 => 
$vÆ‹
 ) {

154 i‡–
	`is£t
(
$fichîos_modulos_¥oye˘o
[
$key
]) ) {

155 
$this
->
fichîos_xde„˘o
[
$key
] = 
	`¨øy_mîge
($this->fichîos_xde„˘o[$key],
$fichîos_modulos_¥oye˘o
[$key]);

167 i‡–
	`is_dú
(
$this
->
dú_ãma_a˘uÆ
) ) {

169 
$this
->
fichîos_ãma
 = $this->
	`busˇr_fichîo
($this->
dú_ãma_a˘uÆ
.'modulos/');

173 i‡–!
	`em±y
(
$this
->
fichîos_ãma
) ) {

175 
	`f‹óch
 ( 
$this
->
fichîos_xde„˘o
 
as
 
$key
 => 
$vÆ‹
 ) {

176 i‡–
	`is£t
(
$this
->
fichîos_ãma
[
$key
]) ) {

177 
$fichîos
[
$key
] = 
	`¨øy_mîge
(
$this
->
fichîos_xde„˘o
[$key],$this->
fichîos_ãma
[$key]);

179 
$fichîos
[
$key
] = 
$this
->
fichîos_xde„˘o
[$key];

184 
$fichîos
 = 
$this
->
fichîos_xde„˘o
;

187 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Fichîo†dñÅema: '.
	`dïuør
(
$fichîos
));

188 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Cﬁ‹e†dñÅema: '.
	`dïuør
(
$this
->
cﬁ‹es
));

189 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Si°ema: '.
$this
->
∂©af‹ma
.' Navegad‹: '.$this->
«vegad‹
.' Vîsi√≥n: '.$this->
vîsi⁄
);

191 
$this
->
ãma
 = 
√w
 
	`TemaGcm
(
$fichîos
,$this->
cﬁ‹es
);

199 
fun˘i⁄
 
	$c⁄åuú_li°a_cﬁ‹es
() {

201 
	`ö˛ude
(
$this
->
fich_cﬁ‹es
);

202 i‡–
	`is£t
(
$cﬁ‹es
ËË
$this
->
cﬁ‹es
 = $colores;

204 
	}
}

210 
¥iv©e
 
fun˘i⁄
 
	$busˇr_fichîo
(
$dú
) {

212 
$fichîos
 = 
	`¨øy
();

214 
	`f‹óch
 ( 
$this
->
tùos_fichîos
 
as
 
$tùo
) {

216 i‡–
	`glob
(
$dú
.'*/'.
$tùo
.'/*') ) {

218 
	`f‹óch
 ( 
	`glob
(
$dú
.'*/'.
$tùo
.'/*'.'*'Ë
as
 
$fich
) {

219 
$Œave
 = 
	`°r_ª∂a˚
(
$dú
,'',
$fich
);

220 
$fichîos
[
$tùo
][
$Œave
] = 
$fich
;

226 i‡–
$tùo
 ='ic⁄os' && 
	`glob
(
$dú
.'*/'.$tipo.'/*/*') ) {

228 
	`f‹óch
 ( 
	`glob
(
$dú
.'*/'.
$tùo
.'/*/*'.'*'Ë
as
 
$fich
) {

229 
$Œave
 = 
	`°r_ª∂a˚
(
$dú
,'',
$fich
);

230 
$fichîos
[
$tùo
][
$Œave
] = 
$fich
;

237  
$fichîos
;

239 
	}
}

245 
fun˘i⁄
 
	$ö˛uú_javas¸ùt
() {

247 
globÆ
 
$gcm
;

249 
$fichîos
 = 
$gcm
->
	`li°a_js
();

250 
$libªrüs
 = 
$gcm
->
	`li°a_lib_js
();

251 
$uæ_ba£
 = 
Rouãr
::
$dú
;

253 
$this
->
ãma
->
	`ö˛uú_javas¸ùt
(
$fichîos
,
$libªrüs
,
$uæ_ba£
);

255 
	}
}

264 
fun˘i⁄
 
	$cﬁ‹
(
$cﬁ‹
, 
$vÆ‹
=
FALSE
) {

266 
$ªtu∫
 = 
$this
->
ãma
->
	`cﬁ‹
(
$cﬁ‹
, 
$vÆ‹
);

282  
$ªtu∫
;

284 
	}
}

288 
fun˘i⁄
 
	$c⁄°ruú_css
() {

290 
echo
 "\n/* Tem®a˘uÆ: ".
$this
->
ãma_a˘uÆ
." */\n";

291  
$this
->
ãma
->
	`c⁄°ruú_css
();

292 
	}
}

296 
fun˘i⁄
 
	$c⁄°ruú_js
(Ë{  
$this
->
ãma
->
	`c⁄°ruú_js
(); 
	}
}

300 
fun˘i⁄
 
	$ruè
(
$modulo
,
$tùo
,
$¨chivo
Ë{  
$this
->
ãma
->
	`ruè
($modulo, $tùo, $¨chivo); 
	}
}

308 
fun˘i⁄
 
	$põ
(
$e
, 
$¨gs
) {

310 
$põ
 = 
$this
->
	`ruè
('temas','html','pie.html');

312 i‡–
$põ
 ) {

313 
	`ö˛ude
(
$põ
);

315  
FALSE
;

318 
	}
}

326 
fun˘i⁄
 
	$¥e£¡¨_tôulo
(
$e
, 
$¨gs
) {

328 
globÆ
 
$gcm
;

330 
$ruè
 = 
$this
->
	`ruè
('temas','html','titulo.html');

332 i‡–
$ruè
 ) {

333 
	`ö˛ude
(
$ruè
);

335 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿã√mo†∂™tûœ ['.
$ruè
.']');

337 <
a
 
hªf
="" 
tôÀ
="<?phpÉchoÜiteral('inicio');?>">

338 <
h1
>

339 <?
php
 
echo
 
	`lôîÆ
(
$this
->
Tôulo
,1); ?>

340 </
h1
>

341 <
h2
>

342 <?
php
 
echo
 
	`lôîÆ
(
$this
->
Subtôulo
,1); ?>

343 </
h2
>

344 </
a
>

345 <?
php


348 
	}
}

371 
fun˘i⁄
 
	$∑√l
(
$∑√l
) {

373 
globÆ
 
$gcm
;

375 
$sub∑√l_˛ass
 = ( 
	`is£t
(
$∑√l
['ocu…o']Ë&& $∑√l['ocu…o'] =
TRUE
 ) ? 'subpanel_oculto' : 'subpanel_visible';

376 
$íœ˚
 = ( 
	`is£t
(
$∑√l
['href']) ) ? $panel['href'] : '#' ;

378 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('temas','html','panel.html'));

380 
	}
}

388 
fun˘i⁄
 
	$ö•ecci⁄¨_rouãr
(
$e
,
$¨gs
) {

390 
globÆ
 
$gcm
;

392 
$this
->
	`javas¸ùts
('general.js');

393 
$this
->
	`javas¸ùts
('paneles.js');

394 
$this
->
	`libªrüs_js
('jquery.js');

396 i‡–
Rouãr
::
$c
 == 'proyectos.css' ) {

397 
	`hódî
('Content-Type:Åext/css');

398 
$ãma_mo°ør
 = ( 
	`em±y
(
$_GET
['t']ËË? 
$this
->
ãma_a˘uÆ
 : $_GET['t'];

402 
$gcm
->
ßlida
 = 
$this
->
	`c⁄°ruú_css
();

403 
$gcm
->
	`ßlú
();

406 i‡–
Rouãr
::
$c
 == 'proyecto.js' ) {

407 
	`hódî
('Content-Type:Åext/javascript');

408 
$gcm
->
ßlida
 = 
$this
->
	`c⁄°ruú_js
();

409 
$gcm
->
	`ßlú
();

412 
	}
}

420 
fun˘i⁄
 
	$ic⁄o
(
$ic⁄o
) {

422 
$ªt‹no
 = 
$this
->
ãma
->
	`ic⁄o
(
$ic⁄o
);

424 i‡–
$ªt‹no
 )  $retorno;

426 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿ£Énc⁄åÿic⁄ÿ['.
$ic⁄o
.']',

428  
FALSE
;

430 
	}
}

436 
fun˘i⁄
 
	$ocu…¨_c⁄ãnido_desde_tôulo
(
$e
,
$¨gs
=
NULL
) {

438 
globÆ
 
$gcm
;

440 
$this
->
	`javas¸ùts
('ocultar_contenido_desde_titulo.js');

442 
	}
}

457 
fun˘i⁄
 
	$ö˛uú_javas¸ùt_hód
(
$e
, 
$¨gs
=
NULL
) {

459 
echo
 "\n<script>\n";

460 
$f
 = 
$this
->
	`ruè
('temas','js','javascript_head.js');

461 
	`ö˛ude
 (
$f
);

462 
echo
 "\n".'</script>';

464 
	}
}

480 
fun˘i⁄
 
	$ö˛uú_css_hód
(
$e
, 
$¨gs
=
NULL
) {

482 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Tem®a˘uÆ: '.
$this
->
ãma_a˘uÆ
);

484 
echo
 "\n".'<styleÅype="text/css" media="screen,Örojection">';

485 
echo
 "\n".' @imp‹à"¥oye˘os.css?ãma='.
$this
->
ãma_a˘uÆ
.'&u='.
Rouãr
::
$d
.Rouãr::
$s
.Rouãr::
$c
.'";';

486 
echo
 "\n".'</style>';

490 i‡–! 
	`fûe_exi°s
(
$this
->
dú_ãma_a˘uÆ
.'condicion') ) {

494 
$¨chivos
 = 
	`glob
(
$this
->
dú_ãma_a˘uÆ
.'condicion/*');

496 i‡–
	`em±y
(
$¨chivos
) ) ;

498 
$¨chivos
 = 
	`¨øy_fûãr
($¨chivos, 
	`¨øy
(
$this
,"coincide_archivo_css"));

500 i‡–
	`em±y
(
$¨chivos
) ) ;

502 
	`f‹óch
 ( 
$¨chivos
 
as
 
$¨chivo
 ) {

503 
echo
 "\n".'<styleÅype="text/css" media="screen,Örojection">';

504 
echo
 "\n".' @imp‹à"'.
$¨chivo
.'";';

505 
echo
 "\n".'</style>';

508 
	}
}

531 
fun˘i⁄
 
	$coöcide_¨chivo_css
(
$¨chivo
) {

533 
$nombª_¨chivo
 = 
	`ba£«me
(
$¨chivo
);

535 i‡–!
	`¥eg_m©ch
('/(.*)_(.*)_(.*).css/i',
$nombª_¨chivo
,
$d©os
) ) {

536 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nombª dê¨chivÿmÆ f‹mado: '.
$nombª_¨chivo
,'ERROR');

537  
FALSE
;

540 i‡–
$this
->
∂©af‹ma
 !
$d©os
[1] && $datos[1] != 'all' ) {

541  
FALSE
;

544 i‡–
$this
->
«vegad‹
 !
$d©os
[2] && $datos[2] != 'all' ) {

545  
FALSE
;

548 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'C¨gamo†¨chivÿcs†£gu¿«vegad‹: '.
$nombª_¨chivo
);

550  
TRUE
;

552 
	}
}

558 
fun˘i⁄
 
	$gëTema
(Ë{  
$this
->
ãma_a˘uÆ
; 
	}
}

	@gcm/modulos/temas/lib/TemasAdmin.php

1 <?
php


54 ˛as†
	cTemasAdmö
 
exãnds
 
	mTemas
 {

62 
¥iv©e
 
	m$cﬁ‹es_ªc›ûados
 = 
FALSE
;

64 
fun˘i⁄
 
__c⁄°ru˘
(
$ãma_a˘uÆ
='') {

66 
∑ª¡
::
__c⁄°ru˘
(
$ãma_a˘uÆ
);

77 
fun˘i⁄
 
	$com¥ob¨_dúe˘‹ios
(
$dú
) {

79 
$dús
 = 
	`ex∂ode
('/',
$dú
);

81 
$n
 = '';

82 
	`f‹óch
 ( 
$dús
 
as
 
$d
) {

83 
$n
 = $n.
$d
.'/';

84 i‡–!
	`is_dú
(
$n
) ) {

85 i‡–!
	`mkdú
(
$n
, 0700) ) {

86 
	`åiggî_îr‹
(
	`lôîÆ
('Nÿ£Öudÿ¸ó∏dúe˘‹io, com¥uebê≥rmisos',3),
E_USER_ERROR
);

87  
FALSE
;

92  
TRUE
;

93 
	}
}

104 
fun˘i⁄
 
	$f‹muœrio_fichîo_css
() {

106 
globÆ
 
$gcm
;

108 
	`ö˛ude
(
$this
->
	`ruè
('temas','html','form_fichero_css.html'));

110 
	}
}

116 
¥iv©e
 
fun˘i⁄
 
	$ö˛uú_cﬁ‹
(
$£cci⁄
, 
$vÆ‹
) {

118 i‡–! 
	`is£t
(
$this
->
cﬁ‹es_ªc›ûados
[
$£cci⁄
]Ë|| ! 
	`ö_¨øy
(
$vÆ‹
, $this->colores_recopilados[$seccion]) ) {

119 
$this
->
cﬁ‹es_ªc›ûados
[
$£cci⁄
][] = 
$vÆ‹
;

122  
$£cci⁄
.'-'.
	`•rötf
("%02d",
	`¨øy_£¨ch
(
$vÆ‹
, 
$this
->
cﬁ‹es_ªc›ûados
[$seccion]));

123 
	}
}

141 
fun˘i⁄
 
	$fichîo_css
(
$e
,
$¨gs
=
NULL
) {

143 
globÆ
 
$gcm
;

145 
$this
->
	`™uœrEvíto
('contenido','temas');

146 
$this
->
	`™uœrEvíto
('titulo','temas');

148 
$gcm
->
tôulo
 = 
	`lôîÆ
('Procesar ficheroÖroyecto.css modificado',3);

150 
$fichîo
 = 
$_FILES
['fichero']['name'];

151 
$fichîo_tmp
 = 
$_FILES
['fichero']['tmp_name'];

154 i‡(
$fichîo
 == "") {

155 
	`ªgi°ør
(
__FILE__
,
__LINE__


156 ,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') No se haÉspecificado fichero'

158  
FALSE
;

161 
$vlöós
 = 
	`fûe
(
$fichîo_tmp
);

163 
$fichîos
 = 
	`¨øy
();

164 
$fichîo
 = 
FALSE
;

165 
$cou¡_cﬁ‹
 = 0;

167 
	`f‹óch
 (
$vlöós
 
as
 
$löó
) {

170 i‡–
	`°rùos
(
$löó
,'fichero:') ) {

171 
	`li°
(
$lôîÆ
,
$fichîo
,
$«da
Ë
	`ex∂ode
(':',
$löó
);

172 
$fichîos
[
$fichîo
] = '';

173 
$cou¡_cﬁ‹
=0;

174 
$£cci⁄
 = 
	`ba£«me
(
$fichîo
,'.css');

185 } 
	`ñ£if
 ( 
	`°rùos
(
$löó
,'acaba:') ) {

186 
$fichîo
 = 
FALSE
;

188 } 
	`ñ£if
 ( 
$fichîo
 ) {

191 i‡–
	`¥eg_m©ch
("/b‹dî|background|cﬁ‹/",
$löó
) ) {

193 
	`f‹óch
 ( 
	`ex∂ode
(':',
$löó
Ë
as
 
$bloque
 ) {

194 
	`f‹óch
 ( 
	`ex∂ode
(' ',
$bloque
Ë
as
 
$∑œbø
 ) {

195 
$∑œbø
 = 
	`°r_ª∂a˚
(';','',$palabra);

196 
$∑œbø
 = 
	`åim
($palabra);

199 i‡(
	`¥eg_m©ch
 ('/^#[a-f0-9]{6}$/i', 
$∑œbø
) ||Öreg_match ('/^#[a-f0-9]{3}$/i', $palabra) ) {

202 
$cﬁ‹
 = 
$∑œbø
;

203 
$˛ave
 = 
$this
->
	`ö˛uú_cﬁ‹
(
$£cci⁄
, 
$cﬁ‹
);

204 
$mod
 = '<?=$this->cﬁ‹("'.
$˛ave
.'")?>';

205 
$cou¡_cﬁ‹
++;

206 
$löó
 = 
	`°r_ª∂a˚
(
$cﬁ‹
,
$mod
,$linea);

207 } 
	`ñ£if
 ( 
	`¥eg_m©ch
("/å™•¨ít/i",
$∑œbø
,
$ªsu…ado
) ) {

208 
$cﬁ‹
 = 
$ªsu…ado
[0];

209 
$˛ave
 = 
$this
->
	`ö˛uú_cﬁ‹
(
$£cci⁄
, 
$cﬁ‹
);

210 
$mod
 = '<?=$this->cﬁ‹("'.
$˛ave
.'")?>';

211 
$löó
 = 
	`°r_ª∂a˚
(
$cﬁ‹
,
$mod
,$linea);

212 
$cou¡_cﬁ‹
++;

213 } 
	`ñ£if
 ( 
	`¥eg_m©ch
("/rgba\((.*)\){1}/",
$∑œbø
,
$ªsu…ado
) ) {

214 
$cﬁ‹
 = "rgba(".
	`°r_ª∂a˚
(')','',
$ªsu…ado
[1]).")";

215 
$˛ave
 = 
$this
->
	`ö˛uú_cﬁ‹
(
$£cci⁄
, 
$cﬁ‹
);

216 
$mod
 = '<?=$this->cﬁ‹("'.
$˛ave
.'")?>';

217 
$löó
 = 
	`°r_ª∂a˚
(
$cﬁ‹
,
$mod
,$linea);

218 
$cou¡_cﬁ‹
++;

227 i‡–
	`¥eg_m©ch
("/rgba\((.*)\){1}/",
$löó
,
$ªsu…ado
) ) {

228 
$cﬁ‹
 = "rgba(".
	`°r_ª∂a˚
(')','',
$ªsu…ado
[1]).")";

229 
$˛ave
 = 
$this
->
	`ö˛uú_cﬁ‹
(
$£cci⁄
, 
$cﬁ‹
);

230 
$mod
 = '<?=$this->cﬁ‹("'.
$˛ave
.'")?>';

231 
$löó
 = 
	`°r_ª∂a˚
(
$cﬁ‹
,
$mod
,$linea);

232 
$cou¡_cﬁ‹
++;

236 i‡–
	`¥eg_m©ch
("/uæ\(.*\)/",
$löó
, 
$coöcidícüs
, 
PREG_OFFSET_CAPTURE
) ) {

238 
$uæ
 = 
	`°r_ª∂a˚
('uæ(','',
$coöcidícüs
[0][0]);

239 
$uæ
 = 
	`°r_ª∂a˚
(')','',$url);

240 
$uæ
 = 
	`°r_ª∂a˚
('\'','',$url);

241 
$uæ_•lô
 = 
	`ex∂ode
('/',
$uæ
);

242 
$nombª
 = 
	`íd
(
$uæ_•lô
);

244 i‡–
	`em±y
(
$nombª
) ) {

246 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Uæ dêimagí sö c⁄ãnidÿí '.
$fichîo
."\nLöó: ".
$löó
,'AVISO');

248 } 
	`ñ£if
 ( 
	`ö_¨øy
('Fûe',
$uæ_•lô
) || in_array('http',$url_split) ) {

251 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Imagí dêc⁄ãnidÿnÿha˚mo†«d®í '.
$fichîo
."\nLöó: ".
$löó
,'AVISO');

256 i‡–
	`cou¡
(
$uæ_•lô
) < 3 ) {

257 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Fichîo: ".
$fichîo
." Imagí fuî®dêsi°ema: ".
	`dïuør
(
$uæ_•lô
),'AVISO');

259 
$tùo
 = 
$uæ_•lô
[
	`cou¡
($url_split)-2];

260 
$modulo
 = 
$uæ_•lô
[
	`cou¡
($url_split)-3];

261 
$nueva_uæ
 = 
Rouãr
::
$dú
.
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
(
$modulo
,
$tùo
,
$nombª
);

262 i‡–! 
$nueva_uæ
 ) {

263 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"Fichîo: ".
$fichîo
." Imagí fuî®dêsi°ema: ".
	`dïuør
(
$uæ_•lô
),'AVISO');

265 
$ªm∂azo
 = 'uæ(\'<?=Rouãr::$dú.$this->ruè("'.
$modulo
.'","'.
$tùo
.'","'.
$nombª
.'")?>\')';

266 
$imagíes
[] = 
$nueva_uæ
;

267 
$löó
 = 
	`°r_ª∂a˚
(
$coöcidícüs
[0][0],
$ªm∂azo
,$linea);

274 
$löó
 = 
	`åim
($linea,"\n\r");

275 i‡–
$löó
 !'' ) 
$fichîos
[
$fichîo
] .= "\n".$linea;

280 i‡–
	`em±y
(
$fichîos
) ) {

282 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

283 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).') No seÖudoÉspecificar contenido'

285 
echo
 'Elárchivo css que se suba debe ser unaÑeplica deÖroyecto.css modificado, sinÖerderÜas marcasÉspecificas, queÇos indicaná queárchivoÖerteneceÉl contenido';

286  
FALSE
;

290 i‡–
	`is£t
–
$this
->
cﬁ‹es_ªc›ûados
 ) ) 
echo
 '<b∏/>Numîÿdêcﬁ‹e†Öro˚ßdos: <b>'.
	`cou¡
($this->colores_recopilados).'</b>';

291 i‡–
	`is£t
–
$fichîos
 ) ) 
echo
 '<b∏/>Numîÿdêfichîo†¥o˚ßdos: <b>'.
	`cou¡
($ficheros).'</b>';

292 i‡–
	`is£t
–
$imagíes
 ) ) 
echo
 '<b∏/>Numîÿdêim√°gíe†¥o˚ßdos: <b>'.
	`cou¡
($imagenes).'</b>';

294 
echo
 '<br /><h2>FicherosÖrocesados</h2>';

295 
	`f‹óch
 ( 
$fichîos
 
as
 
$key
 => 
$vÆ‹
 ) {

296 
echo
 '<b∏/>- ',
$key
;

297 
$this
->
	`com¥ob¨_dúe˘‹ios
($this->
dú_ãma_a˘uÆ
.'modulos/'.
	`dú«me
(
$key
));

298 
	`fûe_put_c⁄ã¡s
(
$this
->
dú_ãma_a˘uÆ
.'modulos/'.
$key
,
$vÆ‹
,
LOCK_EX
);

301 
$fichîo_cﬁ‹es_ãma
 = 
$this
->
dú_ãma_a˘uÆ
.'modulos/temas/css/colores.php';

303 
$ßlida
 = "<?php\n\n/* FicheroÖrocesadoÖor TemasAdmin.php */";

304 
	`f‹óch
 ( 
$this
->
cﬁ‹es_ªc›ûados
 
as
 
$nombª_£cci⁄
 => 
$£cci⁄
 ) {

305 
	`f‹óch
 ( 
$£cci⁄
 
as
 
$numîo_cﬁ‹
 => 
$cﬁ‹
 ) {

306 
$ßlida
 ."\n".'$cﬁ‹es[\''.
$nombª_£cci⁄
.'-'.
	`•rötf
("%02d",
$numîo_cﬁ‹
).'\'] = \''.
$cﬁ‹
.'\';';

309 
$ßlida
 .= "\n?>";

310 
	`fûe_put_c⁄ã¡s
(
$fichîo_cﬁ‹es_ãma
,
$ßlida
,
LOCK_EX
);

312 i‡–
	`is£t
(
$imagíes
Ë&& 
	`cou¡
($imagenes) > 0 ) {

313 
echo
 '<br /><h2>Im√°genesÖrocesadas</h2>';

314 
	`f‹óch
 (
$imagíes
 
as
 
$imagí
) {

315 
echo
 '<b∏/>'.
$imagí
.'<br /><img src="'.$imagen.'" />';

318 
	}
}

324 
fun˘i⁄
 
	$f‹muœrio_fichîos
() {

326 
globÆ
 
$gcm
;

328 
$tùos
 = 
	`¨øy
('css','html','js');

330 
	`ö˛ude
(
$this
->
	`ruè
('temas','html','form_ficheros_tema.html'));

332 
	}
}

346 
fun˘i⁄
 
edô¨_fichîo
(
$e
, 
$¨gs
='') {

348 
globÆ
 
$gcm
;

350 
	g$this
->
™uœrEvíto
('contenido','temas');

351 
	g$this
->
™uœrEvíto
('titulo','temas');

353 i‡–
is£t
(
$_POST
['edô¨_xd„˘o']Ë&& !
em±y
($_POST['editar_xdfecto']) ) {

354 
	g$¨chivo
 = 
$_POST
['editar_xdfecto'];

355 } 
ñ£if
 ( 
is£t
(
$_POST
['edô¨_ãma']Ë&& !
em±y
($_POST['editar_tema']) ) {

356 
	g$¨chivo
 = 
$_POST
['editar_tema'];

358 
ªgi°ør
(
__FILE__
,
__LINE__


359 ,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
dïuør
(
$¨gs
).') No seÉspecifico ficheroÖaraÉditar'

364 
	g$gcm
->
	gtôulo
 = 'Edô™dÿ<b>'.
$¨chivo
.'</b>';

366 
	g$uæ_¨chivo
 = 
$this
->
dú_ãma_a˘uÆ
.'modulos/'.
$¨chivo
;

372 
	g$dú
 = 
dú«me
(
$uæ_¨chivo
);

374 i‡–! 
	g$this
->
com¥ob¨_dúe˘‹ios
(
$dú
ËË 
	gFALSE
;

378 i‡–!
is_fûe
(
$uæ_¨chivo
) ) {

380 i‡–
is_fûe
(
$this
->
dú_modulos
.'/'.
$¨chivo
) ) {

381 
c›y
(
$this
->
dú_modulos
.'/'.
$¨chivo
,
$uæ_¨chivo
);

383 i‡–
is_fûe
('modulos/'.
$¨chivo
) ) {

384 
c›y
('modulos/'.
$¨chivo
,
$uæ_¨chivo
);

386 
ªgi°ør
(
__FILE__
,
__LINE__
,
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
dïuør
(
$¨gs
).') FicheroÇoÉncontrado','ERROR');

391 
ªgi°ør
(
__FILE__
,
__LINE__
,"EditorFicheros::Editar $url_archivo");

395 i‡–
em±y
(
$tùo_¨chivo
ËË{ 
	g$tùo_¨chivo
 = 
GUtû
::
tùo_de_¨chivo
(
$uæ_¨chivo
); }

397 
	gecho
 '<p>mimëy≥: '.
	g$tùo_¨chivo
.'</p>';

401 i‡–
	g$tùo_¨chivo
 == 'text/html' ) {

403 i‡–! 
$fich

f›í
(
$uæ_¨chivo
,"r") ) {

404 
ªgi°ør
(
__FILE__
,
__LINE__
,"Nÿ£Öuedêabrúárchivÿ[".
$uæ_¨chivo
."]",'ERROR');

405  
	gFALSE
;

408 
	g$c⁄tögut_öicül
 = 
‰ód
(
$fich
, 
fûesize
(
$uæ_¨chivo
));

409 
f˛o£
(
$fich
);

411 i‡(!
	g$c⁄tögut_öicül
){

412 
ªgi°ør
(
__FILE__
,
__LINE__
,"Edô‹Fichîos::Nÿ£ÖuedêÀîÉ»¨chivÿ[".
$uæ_¨chivo
."]",'ERROR') ;

413  
	gFALSE
;

417 
	g$_SESSION
['edit']='si';

418 
	g$nom_ãxèªa
 = 'contenido_interno';

419 
ö˛ude
(
$this
->
ruè
('temas','html','form_editar.html'));

423 } 
ñ£if
 ( 
$tùo_¨chivo
 == 'text/css' || $tipo_archivo == 'application/x-javascript') {

425 i‡–! 
$fich

f›í
(
$uæ_¨chivo
,"r") ) {

426 
ªgi°ør
(
__FILE__
,
__LINE__
,"Nÿ£Öuedêabrúárchivÿ[".
$uæ_¨chivo
."]",'ERROR');

427  
	gFALSE
;

430 
	g$c⁄tögut_öicül
 = 
‰ód
(
$fich
, 
fûesize
(
$uæ_¨chivo
));

431 
f˛o£
(
$fich
);

433 i‡(!
	g$c⁄tögut_öicül
){

434 
ªgi°ør
(
__FILE__
,
__LINE__
,"Edô‹Fichîos::Nÿ£ÖuedêÀîÉ»¨chivÿ[".
$uæ_¨chivo
."]",'ERROR') ;

435  
	gFALSE
;

438 
	g$_SESSION
['edit']='si';

439 
	g$nom_ãxèªa
 = 'contenido_interno';

440 
ö˛ude
(
$this
->
ruè
('temas','html','form_editar.html'));

446 
ªgi°ør
(
__FILE__
,
__LINE__
,'Tipo deárchivo desconocido','AVISO');

447  
	gFALSE
;

455 
fun˘i⁄
 
	$rgb2html
(
$rgba
) {

457 i‡–
	`°Ωos
(
$rgba
,'rgba'Ë==
FALSE
 )  $rgba ;

459 
$rgba
 = 
	`°r_ª∂a˚
('rgba(','',$rgba);

460 
$rgba
 = 
	`°r_ª∂a˚
(')','',$rgba);

462 
	`li°
 (
$r
,
$g
,
$b
Ë
	`ex∂ode
(',',
$rgba
);

464 
$r
 = 
	`ötvÆ
($r); 
$g
 = intval($g);

465 
$b
 = 
	`ötvÆ
($b);

467 
$r
 = 
	`dechex
($r<0?0:($r>255?255:$r));

468 
$g
 = 
	`dechex
($g<0?0:($g>255?255:$g));

469 
$b
 = 
	`dechex
($b<0?0:($b>255?255:$b));

471 
$cﬁ‹
 = (
	`°æí
(
$r
) < 2?'0':'').$r;

472 
$cﬁ‹
 .(
	`°æí
(
$g
) < 2?'0':'').$g;

473 
$cﬁ‹
 .(
	`°æí
(
$b
) < 2?'0':'').$b;

474  '#'.
$cﬁ‹
;

475 
	}
}

482 
fun˘i⁄
 
	$∑√l_cﬁ‹es
() {

486 
$¨ch_cﬁ‹es_ãma_xde„˘o
 = 
$this
->
dú_modulos
.'/temas/css/colores.php';

487 
$¨ch_cﬁ‹es_ãma_a˘uÆ
 = 
$this
->
dú_ãma_a˘uÆ
.'/modulos/temas/css/colores.php';

489 
$¨ch_cﬁ‹es
 = ( 
	`is_fûe
(
$¨ch_cﬁ‹es_ãma_a˘uÆ
ËË? $¨ch_cﬁ‹es_ãma_a˘uÆ : 
$¨ch_cﬁ‹es_ãma_xde„˘o
 ;

491 
	`ö˛ude
 (
$¨ch_cﬁ‹es
);

493 
	`ks‹t
(
$cﬁ‹es
);

494 
	`ª£t
(
$cﬁ‹es
);

496 
$ßlida
 = '';

498 
	`f‹óch
 (
$cﬁ‹es
 
as
 
$key
 => 
$cﬁ‹
) {

499 
$ßlida
 .'<div styÀ="background: '.
$cﬁ‹
.'">';

500 
$ßlida
 .'&…;?=$cﬁ‹es[\''.
$key
.'\']?&gt;';

501 
$ßlida
 .= '</div>';

504 
$∑√l
 = 
	`¨øy
();

505 
$∑√l
['tôulo'] = 
	`lôîÆ
('Colores',3);

506 
$∑√l
['ocu…o'] = 
TRUE
;

507 
$∑√l
['href'] = 'javascript:visualizar(\'lista_colores\');';

508 
$∑√l
['subpanel'] ='lista_colores';

509 
$∑√l
['c⁄ãnido'] =
$ßlida
;

511 
£lf
::
	`∑√l
(
$∑√l
);

513 
	}
}

522 
fun˘i⁄
 
	$f‹muœrio_cﬁ‹es
() {

524 
$ö˛uú_cﬁ‹es
 = 
TRUE
;

526 
$this
->
	`libªrüs_js
('farbtastic.js');

527 
$this
->
	`javas¸ùts
('iniciar_selector_color.js');

531 
$¨ch_cﬁ‹es_ãma_xde„˘o
 = 
$this
->
dú_modulos
.'/temas/css/colores.php';

532 
$¨ch_cﬁ‹es_ãma_a˘uÆ
 = 
$this
->
dú_ãma_a˘uÆ
.'/modulos/temas/css/colores.php';

534 
$¨ch_cﬁ‹es
 = ( 
	`is_fûe
(
$¨ch_cﬁ‹es_ãma_a˘uÆ
ËË? $¨ch_cﬁ‹es_ãma_a˘uÆ : 
$¨ch_cﬁ‹es_ãma_xde„˘o
 ;

538 i‡–!
$this
->
	`com¥ob¨_dúe˘‹ios
($this->
dú_ãma_a˘uÆ
.'/modulos/temas/css/') ) {

539  
FALSE
;

543 
	`ob_°¨t
();

544 
$this
->
	`c⁄åuú_li°a_cﬁ‹es
();

545 
$this
->
ãma
->
cﬁ‹es
=$this->colores;

546 
echo
 "\n/* fichîo:".
$this
->
ãma
->
fichîos
['css']['temas/css/body.css'].": */\n";

547 
	`ö˛ude
(
$this
->
ãma
->
fichîos
['css']['temas/css/body.css']);

548 
echo
 "\n/*áˇba:".
$this
->
ãma
->
fichîos
['css']['temas/css/body.css'].": */\n";

550 
	`f‹óch
 ( 
$this
->
ãma
->
fichîos
['css'] 
as
 
$Œave
 => 
$fichîo
) {

552 i‡–
$Œave
 != 'temas/css/body.css' ) {

553 
echo
 "\n/* fichîo:".
$Œave
.": */\n";

554 
	`ö˛ude
(
$fichîo
);

555 
echo
 "\n/*áˇba:".
$Œave
.": */\n";

559 
$¥o˚so_css
 = 
	`ob_gë_˛ón
();

563 i‡–
	`is£t
(
$_REQUEST
['accion']) && $_REQUEST['accion'] == 'anyadir_color' ) {

565 
	`ö˛ude
 (
$¨ch_cﬁ‹es
);

567 
$ö˛uú_cﬁ‹es
 = 
FALSE
;

569 
$nuevo_cﬁ‹
 = 
$_POST
['color'];

571 i‡–
	`¨øy_key_exi°s
–
$nuevo_cﬁ‹
, 
$cﬁ‹es
 ) ) {

572 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('El color yaÉxiste',3),'ERROR');

574 } 
	`ñ£if
 ( !
	`is£t
(
$nuevo_cﬁ‹
Ë|| 
	`em±y
($nuevo_color) ) {

575 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('El colorÇoÉs v√°lido',3),'ERROR');

578 
$this
->
ãma
->
cﬁ‹es
[
$nuevo_cﬁ‹
] = '#ffffff';

579 
	`ks‹t
(
$this
->
ãma
->
cﬁ‹es
);

580 
	`ª£t
(
$this
->
ãma
->
cﬁ‹es
);

581 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`lôîÆ
('A√±ade un valorálÇuevo colorÖara queÅengaÉfectoÉl cambio',3),'AVISO');

588 i‡–
	`is£t
(
$_REQUEST
['accion']) && $_REQUEST['accion'] == 'guardar_colores' ) {

590 
$this
->
	`gu¨d¨_cﬁ‹es
();

596 
	`ks‹t
(
$this
->
ãma
->
cﬁ‹es
);

598 
	`ö˛ude
(
$this
->
	`ruè
('temas','html','form_colores.html'));

600 i‡–
GCM_DEBUG
 ) 
echo
 "\n<br /><h3>Resultado deÖrocesarárchivos css</h3><br />\n<pre>\n$proceso_css\n</pre>";

601 
	}
}

610 
fun˘i⁄
 
	$f‹muœrio_ãmas
() {

612 
$ãmas
 = 
	`glob
(
$this
->
dú_ãmas
.'*');

614 i‡–!
$ãmas
 ) {

615 
echo
 '<∞˛ass="aviso">'.
	`lôîÆ
('No hayÅemasÖara seleccionar',3).'</p>';

617 
	`f‹óch
 ( 
$ãmas
 
as
 
$ãma
 ) {

618 
	`li°
(
$dú
,
$ãma_¥oye˘o
Ë
	`ex∂ode
('/',
$ãma
);

619 
$ãmas_¥oye˘o
[] = 
$ãma_¥oye˘o
;

623 
	`ö˛ude
(
$this
->
	`ruè
('temas','html','form_temas.html'));

625 
	}
}

631 
fun˘i⁄
 
	$£Àcci⁄¨_ãma
(
$e
,
$¨gs
) {

633 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'NuevoÅema seleccionado','AVISO');

634 
$this
->
ãma_a˘uÆ
 = 
$_POST
['tema_actual'];

635 
$this
->
	`c⁄fig
('ãma_a˘uÆ',$this->
ãma_a˘uÆ
);

636 
$this
->
dú_ãma_a˘uÆ
 = $this->
dú_ãmas
.$this->
ãma_a˘uÆ
;

637 
$this
->
	`admöi°ør
();

638 
	}
}

644 
fun˘i⁄
 
	$nuevo_ãma
(
$e
,
$¨gs
) {

646 
$nuevo_ãma
 = ( 
	`is£t
(
$_POST
['nuevo_ãma']ËË? $_POST['nuevo_ãma'] : 
NULL
 ;

648 i‡–
$nuevo_ãma
 ) {

650 
$this
->
	`c⁄fig
('ãma_a˘uÆ',
$nuevo_ãma
);

651 
$this
->
ãma_a˘uÆ
 = 
$nuevo_ãma
;

652 
$this
->
dú_ãma_a˘uÆ
 = $this->
dú_ãmas
.
$nuevo_ãma
;

653 
$this
->
	`admöi°ør
();

656 
	}
}

675 
fun˘i⁄
 
	$admöi°ør
() {

677 
globÆ
 
$gcm
;

679 
$this
->
	`™uœrEvíto
('contenido','temas');

680 
$this
->
	`™uœrEvíto
('titulo','temas');

682 
$gcm
->
tôulo
 = 
	`lôîÆ
('Administraci√≥n deÅemas',3);

684 i‡–!
$gcm
->
au
->
	`logódo
() ) {

685 
	`ªgi°ør
(
__FILE__
,
__LINE__
,

686 
__CLASS__
.'->'.
__FUNCTION__
.'('.
$e
.','.
	`dïuør
(
$¨gs
).'Ë'.
	`lôîÆ
('SinÖermisos')

688  
FALSE
;

693 i‡–!
$this
->
ãma_a˘uÆ
 ) {

694 
$this
->
	`f‹muœrio_ãmas
();

703 
$this
->
	`com¥ob¨_dúe˘‹ios
($this->
dú_ãma_a˘uÆ
);

705 i‡–
$gcm
->
au
->
	`logódo
() ) {

709 i‡–
	`is£t
(
$_POST
['contenido_interno']) && isset($_POST['documento']) && isset($_POST['guardar']) ) {

711 
$¨chivo
 = 
$_POST
['documento'];

713 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"gu¨d¨ fichîo: [".
$¨chivo
."]");

717 
$¨chivo
 = 
	`°r_ª∂a˚
(
$this
->
dú_modulos
,$this->
dú_ãmas
.$this->
ãma_a˘uÆ
.'/modulos/',$archivo);

719 
	`ªgi°ør
(
__FILE__
,
__LINE__
,"gu¨d¨ fichîÿcomo: [".
$¨chivo
."]");

723 
$ˇmöo
 = 
	`ex∂ode
('/',
$¨chivo
);

724 
$dú
 = '';

726  
$n
=0; $¿< 
	`cou¡
(
$ˇmöo
)-1; $n++) {

727 
$dú
 .
$ˇmöo
[
$n
].'/';

728 i‡–!
	`em±y
(
$dú
) ) {

729 i‡–!
	`is_dú
(
$dú
) ) {

730 i‡–! 
	`mkdú
(
$dú
) ) {

731 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Nÿpudê¸ó∏dúe˘‹iÿdêãm®['.
$dú
.']','ERROR');

737 i‡–!
	`fûe_put_c⁄ã¡s
(
$¨chivo
,
	`°rù¶ashes
(
$_POST
['contenido_interno'])) ) {

738 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Eº‹á»es¸ibúárchivÿ['.
$¨chivo
.']','ERROR');

740 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Archivÿdêãm®['.
$¨chivo
.'] modificado correctamente','AVISO');

743 
$this
->
	`f‹muœrio_fichîos
();

747 
$this
->
	`f‹muœrio_ãmas
();

748 
$this
->
	`f‹muœrio_fichîos
();

749 
$this
->
	`f‹muœrio_fichîo_css
();

750 
$this
->
	`f‹muœrio_cﬁ‹es
();

756 
	}
}

762 
fun˘i⁄
 
	$gu¨d¨_cﬁ‹es
() {

764 
$¨ch_cﬁ‹es_ãma_a˘uÆ
 = 
$this
->
dú_ãma_a˘uÆ
.'/modulos/temas/css/colores.php';

766 
åy
 {

768 i‡–! ( 
$fûe
 = @
	`f›í
(
$¨ch_cﬁ‹es_ãma_a˘uÆ
, "w") ) ) {

770 
throw
 
√w
 
	`Ex˚±i⁄
('No seÖudoábrirárchivoÖaraÉditar');

774 
$nombª_¨øy
 = 'colores';

775 i‡–
	`is£t
(
$_POST
['cﬁ‹es']ËË
$this
->
ãma
->
cﬁ‹es
 = 
$_REQUEST
['colores'];

776 
	`ks‹t
(
$this
->
ãma
->
cﬁ‹es
);

777 
	`ª£t
(
$this
->
ãma
->
cﬁ‹es
);

780 
	`Âuts
(
$fûe
, "<?php\n");

781 
	`Âuts
(
$fûe
, "// Archivÿgíîadÿautom©iˇmíãÖ‹ ".
__FILE__
."\n");

783 
	`li°
(
$˛ave
, 
$vÆ
)=
	`óch
(
$this
->
ãma
->
cﬁ‹es
)){

785 i‡–
	`is_¨øy
(
$vÆ
)) {

787 
	`li°
(
$˛aveAºay
, 
$vÆ‹Aºay
)=
	`óch
(
$vÆ
)) {

789 
$vÆ‹Aºay
 = 
	`°r_ª∂a˚
("\\","",$valorArray);

790 
$vÆ‹Aºay
 = 
	`°rùc¶ashes
($valorArray);

792 i‡(
	`Âuts
(
$fûe
, '$'."$nombª_¨øy"."['".
	`°r_ª∂a˚
("'","\'",
$˛ave
)."'][]='".°r_ª∂a˚("'","\'",
$vÆ‹Aºay
)."';\n"Ë==
FALSE
 ) {

793 
throw
 
√w
 
	`Ex˚±i⁄
("Nÿ£Öuedêes¸ibúÉ¿".
$¨chivo
);

794  
FALSE
;

800 
$vÆ
 = 
	`°r_ª∂a˚
("\\","",$val);

801 
$vÆ
 = 
	`°rùc¶ashes
($val);

803 i‡(
	`Âuts
(
$fûe
, '$'."$nombª_¨øy"."['".
	`°r_ª∂a˚
("'","\'",
$˛ave
)."']='".°r_ª∂a˚("'","\'",
$vÆ
)."';\n"Ë==
FALSE
 ) {

804 
throw
 
√w
 
	`Ex˚±i⁄
("Nÿ£Öuedêes¸ibúÉ¿".
$¨chivo
);

805  
FALSE
;

811 
	`Âuts
(
$fûe
, "?>");

812 
	`f˛o£
(
$fûe
);

814 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'Colores guardados','AVISO');

816 } 
	`ˇtch
 (
Ex˚±i⁄
 
$ex
) {

817 
	`ªgi°ør
(
$ex
->
	`gëFûe
(),$ex->
	`gëLöe
(),$ex->
	`gëMesßge
(),'ERROR');

820 
$¨ch_cﬁ‹es
 = 
$¨ch_cﬁ‹es_ãma_a˘uÆ
;

821 
	}
}

	@gcm/modulos/temas/menuAdmin.php

1 <?
php


2 
	g$míuAdmö
['Administraci√≥n']['boton']['Editor deÅemas']['activado']=1;

3 
	g$míuAdmö
['Administraci√≥n']['boton']['Editor deÅemas']['nombre']="Editor";

4 
	g$míuAdmö
['Administraci√≥n']['boton']['Editor deÅemas']['title']="Editar ficheros delÖroyecto";

5 
	g$míuAdmö
['Administraci√≥n']['boton']['Editor deÅemas']['link']="?m=temas&a=administrar";

	@gcm/modulos/ver_registros/config/config.php

1 <?
php


3 
	g$c⁄fig
['NombreÉnvioÑegistros']='Eduardo Magran√©';

4 
	g$c⁄fig
['MailÉnvioÑegistros']='eduardo@mamedu.com';

5 
	g$c⁄fig
['Remitente']='Envio deÉmails de gcm';

6 
	g$c⁄fig
['MailÑemitente']='eduardo@mamedu.com';

7 
	g$c⁄fig
['PeriocidadÉn horas']=24;

8 
	g$c⁄fig
['Antiguedad deÑegistrosá borrar']=90;

	@gcm/modulos/ver_registros/config/config_es.php

1 <?
php


2 
	g$c⁄fig_DESC
['NombreÉnvioÑegstros']='Nombre deÜaÖersonaáÜa que seÜeÉnviaÜosÑegistros';

3 
	g$c⁄fig_DESC
['MailÉnvioÑegistros']='Email deÜaÖersonaáÜa que seÜeÉnvianÜosÑegistros';

4 
	g$c⁄fig_DESC
['Remitente']='Nombre delÑemitente';

5 
	g$c⁄fig_DESC
['MailÑemitente']='Email delÑemitente';

6 
	g$c⁄fig_DESC
['PeriocidadÉn horas']='PeriocidadÉn horas que se desea que seÉnvienÜosÑegistros';

7 
	g$c⁄fig_DESC
['Antiguedad deÑegistrosá borrar']='Numero de d√≠as que queremos conservarÜosÑegistros, 0Ço se borranÑegistros';

	@gcm/modulos/ver_registros/eventos_usuario.php

1 <?
php


9 
	g$evítos
['debug']['debug'][15] = '';

12 
	g$evítos
['avisos']['presentar_caja_de_avisos'][1]='';

15 
	g$evítos
['postcontenido_ajax']['postcontenido_ajax'][1]='';

18 
	g$evítos
['cron']['envio_registros_mail'][100]='';

21 
	g$evítos
['cron']['borrar_registros_antiguos'][10]='';

	@gcm/modulos/ver_registros/info.php

1 <?
php


2 
	g$vî_ªgi°ros
['nombre']="Visualizaci√≥n deÑegistros";

3 
	g$vî_ªgi°ros
['title']="Visualizaci√≥n delÑegistro deÜaáplicaci√≥nÖaraádministradores";

	@gcm/modulos/ver_registros/lib/Ver_registros.php

1 <?
php


19 ˛as†
	cVî_ªgi°ros
 
exãnds
 
	mModulos
 {

22 
¥iv©e
 
	m$nombª_ívio_emaû
;

23 
¥iv©e
 
	m$maû_ívio
;

24 
¥iv©e
 
	m$nombª_ªmôíã
;

25 
¥iv©e
 
	m$maû_ªmôíã
;

26 
¥iv©e
 
	m$≥riocidad
;

27 
¥iv©e
 
	m$düs_b‹ødo
;

29 
fun˘i⁄
 
	$__c⁄°ru˘
() {

31 
globÆ
 
$gcm
;

33 
∑ª¡
::
	`__c⁄°ru˘
();

35 
$this
->
nombª_ívio_emaû
 = $this->
	`c⁄fig
('NombreÉnvioÑegistros');

36 
$this
->
maû_ívio
 = $this->
	`c⁄fig
('MailÉnvioÑegistros');

37 
$this
->
nombª_ªmôíã
 = $this->
	`c⁄fig
('Remitente');

38 
$this
->
maû_ªmôíã
 = $this->
	`c⁄fig
('MailÑemitente');

39 
$this
->
≥riocidad
 = $this->
	`c⁄fig
('PeriocidadÉn horas');

40 
$this
->
düs_b‹ødo
 = $this->
	`c⁄fig
('Antiguedad deÑegistrosá borrar');

53 
fun˘i⁄
 
	$¥e£¡¨_ˇja_de_avisos
() {

55 
globÆ
 
$gcm
;

57 
$tùos
 = 
$gcm
->
ªg
->
	`ªgi°ros_£si⁄
();

59 i‡–
$tùos
 ) {

61 
	`f‹óch
 (
$tùos
 
as
 
$tùo
 => 
$ªgi°ros
 ) {

62 
	`ö˛ude
(
$gcm
->
evít
->
ö°™cüs
['ãmas']->
	`ruè
('ver_registros','html','presentar_avisos.html'));

67 
	}
}

69 
fun˘i⁄
 
	$ˇbe˚ø_èbœ
(
$£si⁄
) {

72 <
èbÀ
 
˛ass
='ªgi°ro' 
summ¨y
='Registros deÜaáplicaci√≥n'>

73 <
thód
>

74 <
å
><
th
 
˛ass
="£si⁄" 
cﬁ•™
="3">
Sesi⁄
: <
°r⁄g
><?=
	`¥e£¡¨Fecha
(
$£si⁄
,2);?></strong></th></tr>

75 <
å
>

76 <
th
>
Fecha
</th>

77 <
th
>
Tùo
</th>

78 <
th
 
width
="100%">
Míßje
</th>

79 </
å
>

80 </
thód
>

81 <
tbody
>

82 <?
php


84 
	}
}

88 
fun˘i⁄
 
	$f‹muœrio
(
$fûåo
=
NULL
) {

90 
globÆ
 
$gcm
;

92 
$fûåo
 = ( 
	`is£t
(
$_POST
['fûåo']ËË? $_POST['fûåo'] : '£si⁄='.
$gcm
->
ªg
->
£si⁄
;

95 <
div
 
˛ass
="registros_sesion">

96 <
fõld£t
>

97 <
Àgíd
><?=
	`lôîÆ
('Registros',3)?></legend>

98 <
div
 
˛ass
="ayuda">

99 
Podemos
 
fûå¨
 
p‹
 
id
, 
£si⁄
, 
„cha
, 
	`tùo
 ('ERROR','AVISO','ADMIN','DEBUG'), 
fichîo
, 
míßje


100 <
br
 />

101 
Ejem∂os
:

102 <
ul
>

103 <
li
>
£si⁄
>100 
AND
 
tùo
='ERROR' 
ORDER
 
BY
 
id
 
desc
</li>

104 <
li
>
míßje
 
LIKE
 "%ERROR%"</li>

105 </
ul
>

106 </
div
>

107 <
f‹m
 
«me
='f‹m_vî_ªgi°ros' 
a˘i⁄
='' 
mëhod
='po°' 
⁄Submô
='javascript: visualizar_registros(this,"<?=$gcm->reg->sesion?>");Ñeturn false;'>

108 <
fõld£t
>

109 <
Àgíd
><?
php
 
echo
 
	`lôîÆ
('Filtro',3);?></legend>

110 <
öput
 
ty≥
="ãxt" 
°yÀ
='width:98%;' 
«me
='fûåo' 
vÆue
="<?phpÉcho $filtro; ?>">

111 </
fõld£t
>

112 <
öput
 
ty≥
='hiddí' 
«me
='m' 
vÆue
='ver_registros' />

113 <
öput
 
ty≥
='hiddí' 
«me
='a' 
vÆue
='registros_ajax' />

114 <
öput
 
ty≥
='hiddí' 
«me
='f‹m©o' 
vÆue
='ajax' />

115 <
br
 />

116 <
br
 />

117 <
öput
 
ty≥
='submit' />

118 </
f‹m
>

119 <
div
 
id
='caja_registro_<?=$gcm->reg->sesion?>'>

120 </
fõld£t
>

121 <?
php


124 i‡–
	`is£t
(
$_POST
['filtro']) ) {

125 
$this
->
	`èbœ_ªgi°ros
(
$fûåo
);

128 
echo
 '</div></div>';

130 
	}
}

144 
fun˘i⁄
 
	$èbœ_ªgi°ros
(
$fûåo
=
NULL
, 
$¨øy
=NULL) {

146 
globÆ
 
$gcm
;

148 i‡–
GCM_DEBUG
 || 
$gcm
->
au
->
	`logódo
()) {

150 i‡–
$¨øy
 ) {

154 
$ªgi°ros
 = 
$¨øy
;

156 } 
	`ñ£if
 ( ! 
$fûåo
 ) {

158 
$ªgi°ros
 = 
$gcm
->
ªg
->
	`vî_ªgi°ros
();

162 
$ªgi°ros
 = 
$gcm
->
ªg
->
	`vî_ªgi°ros
(
NULL
,
$fûåo
);

166 i‡–!
	`is_¨øy
(
$ªgi°ros
Ë|| 
	`cou¡
($registros) < 1 ) {

167 
echo
 "<div class='aviso'>SinÑegistros</div>";

168  
FALSE
;

171 
$c⁄è
 = 0;

172 
	`ª£t
(
$ªgi°ros
);

173  
	`cuºít
(
$ªgi°ros
) ) {

174 
$ªgi°ro
 = 
	`cuºít
(
$ªgi°ros
);

175 
	`li°
(
$id
,
$£si⁄
,
$„cha
,
$tùo
,
$fichîo
,
$löó
,
$míßje
,
$des¸ùci⁄
Ë
$ªgi°ro
;

176 
$ªsu…ado
[
$c⁄è
]['id'] = 
$id
;

177 
$ªsu…ado
[
$c⁄è
]['£si⁄'] = 
$£si⁄
;

178 
$ªsu…ado
[
$c⁄è
]['„cha'] = 
$„cha
;

179 
$ªsu…ado
[
$c⁄è
]['tùo'] = 
$tùo
;

180 
$ªsu…ado
[
$c⁄è
]['fichîo'] = 
$fichîo
;

181 
$ªsu…ado
[
$c⁄è
]['löó'] = 
$löó
;

182 
$ªsu…ado
[
$c⁄è
]['míßje'] = 
$míßje
;

184 
$c⁄è
++;

185 
	`√xt
(
$ªgi°ros
);

188 
	`ªquúe_⁄˚
(
GCM_DIR
.'lib/int/array2table/lib/Array2table.php');

191 
$›ci⁄es
 = 
	`¨øy
 ('ocu…¨_id' => 
TRUE
,'table_id' => 'table');

194 
$¨øy2èbÀ
 = 
√w
 
	`Aºay2èbÀ
();

195 
$¨øy2èbÀ
->
	`gíî¨_èbœ
(
$ªsu…ado
, 
$›ci⁄es
);

197 
$gcm
->
	`add_lib_js
('temas', 'jquery.dataTables.js');

202  
FALSE
;

204 
	}
}

212 
fun˘i⁄
 
	$ªgi°ros_ajax
() {

214 i‡–! 
GCM_DEBUG
 && !
	`≥rmiso
('vî_ªgi°ros',
NULL
,
FALSE
,FALSE) ) {

215 
echo
 '<∞˛ass="îr‹">'.
	`lôîÆ
('SinÖermisos').'</p>';

216  
FALSE
;

219 
$fûåo
 = ( 
	`is£t
(
$_GET
['filtro']) ) ? $_GET['filtro'] : '';

221 
$this
->
	`èbœ_ªgi°ros
(
$fûåo
);

224 <
s¸ùt
>

225 
	`$
(
documít
).
	`ªady
(
	`fun˘i⁄
() {

226 
	`$
('#èbÀ').
	`d©aTabÀ
();

228 </
s¸ùt
>

229 <?
php


230 
	`exô
();

231 
	}
}

235 
fun˘i⁄
 
	$debug
() {

237 
globÆ
 
$gcm
;

239 i‡–! 
GCM_DEBUG
 ) {

241 
echo
 '<!-- debug -->';

245 
$this
->
	`javas¸ùts
('ver_registros.js');

249 i‡–
$_POST
 ) { 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`dïuør
($_POST,'Post','POST')); }

250 i‡–
$_GET
 ) { 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`dïuør
($_GET,'Get','GET')); }

251 i‡–
$_SESSION
 ) { 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`dïuør
($_SESSION,'Session')); }

253 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,
	`dïuør
(
$_SERVER
,'SERVER'));

255 
	`ªgi°ør
(
__FILE__
,
__LINE__
,
	`dïuør
(
$gcm
->
evít
->
ubiˇci⁄es
,'Ubicaciones'));

258 
	`ob_°¨t
();

259 
echo
 '<br />';

260 
$this
->
	`èbœ_ªgi°ros
(
NULL
,
$gcm
->
ªg
->
ªgi°ros
);

261 
$ßlida
 = 
	`ob_gë_c⁄ã¡s
();

262 
	`ob_íd_˛ón
();

264 i‡–
$ßlida
 ) {

266 
	`ªquúe_⁄˚
(
GCM_DIR
.'/modulos/editar/lib/Editar.php');

268 
Temas
::
	`∑√l
–
	`¨øy
–'tôulo' => 
	`lôîÆ
('Registros',3).' '.literal('de').' '.literal('p√°ginaáctual'),

269 'ocu…o' => 
TRUE
,

270 'hªf' => 'javas¸ùt:visuÆiz¨(\'vî_ªgi°ros_'.
$gcm
->
ªg
->
£si⁄
.'\');',

271 'sub∑√l' => 'vî_ªgi°ros_'.
$gcm
->
ªg
->
£si⁄
,

272 'c⁄ãnido' => 
$ßlida
) );

275 
	}
}

284 
fun˘i⁄
 
	$po°c⁄ãnido_ajax
(
$e
, 
$¨gs
) {

287 <
s¸ùt
>

288 
	`∑√Às
();

289 </
s¸ùt
>

290 <?
php


292 
	}
}

300 
fun˘i⁄
 
	$visuÆiz¨
() {

302 
globÆ
 
$gcm
;

304 
$gcm
->
	`add_lib_js
('temas', 'jquery.dataTables.js');

306 
$this
->
	`javas¸ùts
('ver_registros.js');

308 
$gcm
->
evít
->
	`™uœr
('titulo','ver_registros');

309 
$gcm
->
evít
->
	`™uœr
('contenido','ver_registros');

310 
$gcm
->
tôulo
 = 
	`lôîÆ
('Registros');

312 
$this
->
	`f‹muœrio
();

314 
	}
}

322 
fun˘i⁄
 
	$ívio_ªgi°ros_maû
(
$e
, 
$¨gs
=
FALSE
) {

324 
globÆ
 
$gcm
;

327 
$„cha_≥riocidad
 = 
	`time
(Ë- ( 
$this
->
≥riocidad
 * 60 * 60 );

329 
$fûåo
 = '„ch®> '.
$„cha_≥riocidad
.' ORDER BY id desc';

331 
$ªgi°ros
 = 
$gcm
->
ªg
->
	`vî_ªgi°ros
(
NULL
,
$fûåo
);

333 i‡–!
	`is_¨øy
(
$ªgi°ros
Ë|| 
	`cou¡
($registros) < 1 ) {

334 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'SinÑegistrosáÉnviar');

338 
$ªsu…ado
 = '<pre>

340 0: 
id


341 1: 
£si⁄


342 2: 
„cha


343 3: 
tùo


344 4: 
fichîo


345 5: 
löó


346 6: 
míßje


347 7: 
des¸ùci⁄


349 
$ªsu…ado
 .'<¥e>'.
	`dïuør
(
$ªgi°ros
).'</pre>';

353 
$¨gs
['cuîpo'] = 
$ªsu…ado
;

354 
$¨gs
['asu¡o'] = 'Regi°ro†í '.
$gcm
->
	`c⁄fig
('admin','Proyecto');

355 
$¨gs
['maû'] = 
$this
->
maû_ívio
;

356 
$¨gs
['nombª_de°ö©¨io'] = 
$this
->
nombª_ívio_emaû
;

357 
$¨gs
['nombª_ªmôíã'] = 
$this
->
nombª_ªmôíã
;

358 
$¨gs
['maû_ªmôíã'] = 
$this
->
maû_ªmôíã
;

360 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'EnviamosÉmail conÜosÑegistros');

362 
$gcm
->
evít
->
	`œnz¨_acci⁄_modulo
('íviomaû','ívür_emaû',
$e
, 
$¨gs
);

363 
	}
}

369 
fun˘i⁄
 
	$b‹ør_ªgi°ros_™tiguos
(
$e
, 
$¨gs
=
FALSE
) {

371 
globÆ
 
$gcm
;

373 i‡–
$this
->
düs_b‹ødo
 == 0 ) ;

375 
$ßlida
 = 
$gcm
->
ªg
->
	`b‹ødo_ªgi°ros_™tiguos
(
$this
->
düs_b‹ødo
);

377 i‡–
$ßlida
 ==
FALSE
 ) {

378 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'ErrorÉnÉl borrado deÑegistros','ERROR');

380 
	`ªgi°ør
(
__FILE__
,
__LINE__
,'B‹ødÿdêªgi°ro†c⁄ m√°†dê'.
$this
->
düs_b‹ødo
.' d√≠as','ADMIN');

383 
	}
}

	@gcm/modulos/ver_registros/menuAdmin.php

1 <?
php


2 
	g$míuAdmö
['Seguimiento']['boton']['Registros']['activado']=1;

3 
	g$míuAdmö
['Seguimiento']['boton']['Registros']['title']="Visualizaci√≥n deÜosÑegistros deÜaáplicaci√≥n";

4 
	g$míuAdmö
['Seguimõ¡o']['bŸ⁄']['Regi°ros']['lök']=
Rouãr
::
$ba£
.'vî_ªgi°ros/visuÆiz¨/'.Rouãr::
$uæ
;

	@gcm/modulos/widgets/eventos_usuario.php

1 <?
php


2 
	g$evítos
['columnaDerecha']['widget_con_panel'][10]='widget=Noticias';

3 
	g$evítos
['columnaDerecha']['widget_con_panel'][11]='widget=EnlacesÉxternos';

	@gcm/modulos/widgets/index.php

1 <?
php


16 i‡–
	g$e
 ) {

20 
	g$dú_widgës
 = 'DATOS/modulos/widgës/'.
$e
.'/';

22 i‡–
is_dú
(
$dú_widgës
Ë==
TRUE
 ) {

24 
$dú
=
dú
(
$dú_widgës
);

26 
	g$fich_w
 = 
$dú
->
ªad
()) {

28 i‡–
$fich_w
[0] !== '.' ) {

30 
$fichîo_widgë
=
$dú_widgës
.
$fich_w
;

31 
li°
(
$nombª_widgë
, 
$exãnsi⁄
Ë
ex∂ode
('.',
$fich_w
);

32 
	g$nombª_widgë
 = 
quô¨Utf8
(
$nombª_widgë
);

34 i‡–
	g$e
 == 'columna' ) {

36 <
div
 
˛ass
="panel">

37 <
•™
 
˛ass
="tituloPanel">

38 <
a
 
hªf
="javascript:visualizar('caja_<?=$nombre_widget;?>');">

39 <?=
lôîÆ
(
$nombª_widgë
)?>

40 </
a
>

41 </
•™
>

42 <
div
 
id
="ˇja_<?=$nombª_widgë;?>" 
˛ass
="subpanel_visible">

43 <?
php
 
ö˛ude
(
$fichîo_widgë
); ?>

44 </
	gdiv
>

45 </
	gdiv
>

46 <?
	gphp


48 
ö˛ude
(
$fichîo_widgë
);

	@gcm/modulos/widgets/lib/Widgets.php

1 <?
php


24 ˛as†
	cWidgës
 
exãnds
 
	mModulos
 {

28 
¥iv©e
 
	m$dú_widgës
 = 'DATOS/modulos/widgets/';

30 
fun˘i⁄
 
	$__c⁄°ru˘
() {

32 
∑ª¡
::
	`__c⁄°ru˘
();

36 
fun˘i⁄
 
	$¥e£¡a_widgë
(
$e
,
$widgë
=
NULL
) {

38 
globÆ
 
$gcm
;

40 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Pª£¡¨ widgë '.
$widgë
);

42 
$nomArchivo
 = 
$this
->
dú_widgës
.
$widgë
.'.php';

44 i‡–
	`fûe_exi°s
(
$nomArchivo
) ) {

45 
$ßlida
 = 
	`fûe_gë_c⁄ã¡s
(
$nomArchivo
);

46  
$ßlida
;

49 
$gcm
->
	`ªgi°ø
(
__FILE__
,
__LINE__
,'Nÿ£Énc⁄åÿwidgë ['.
$widgë
.']','ERROR');

51  
FALSE
;

53 
	}
}

55 
fun˘i⁄
 
	$widgë_c⁄_∑√l
(
$e
,
$¨gs
=
NULL
) {

57 
$¨gs
 = 
	`ªcogî_∑ømëros
($args);

59 
$widgë
 = 
$¨gs
['widget'];

61 
$c⁄ãnido
 = 
$this
->
	`¥e£¡a_widgë
(
$e
,
$widgë
);

63 i‡–
$c⁄ãnido
 ) {

66 <
div
 
˛ass
="panel">

67 <
•™
 
˛ass
="tituloPanel">

68 <
a
 
hªf
="javascript:visualizar('caja_<?=$widget;?>');">

69 <?=
	`lôîÆ
(
$widgë
)?>

70 </
a
>

71 </
•™
>

72 <
div
 
id
="ˇja_<?=$widgë;?>" 
˛ass
="sub∑√l_visibÀ" 
°yÀ
="text-align:Üeft;">

73 <?
php
 
echo
 
$c⁄ãnido
; ?>

74 </
div
>

75 </
div
>

76 <?
php


80 
	}
}

	@plantillas/index-modulos.php

1 <?
php


14 
ªquúe_⁄˚
(
dú«me
(
__FILE__
).'/lib/Modulo.php');

15 i‡–! 
	g$modulo
 ) $modulÿ
√w
 
Modulo
();

16 
	g$modulo
->
$a
(
$¨gs
);

	@plantillas/modulos/eventos_admin.php

1 <?
	gphp


	@plantillas/modulos/eventos_usuario.php

1 <?
	gphp


	@plantillas/modulos/lib/modulo.php

1 <?
php


15 
	g˛ass
 {
	gmodulo
} 
exãnds
 
	gModulos
 {

19 
fun˘i⁄
 
__c⁄°ru˘
() {

21 
	g∑ª¡
::
__c⁄°ru˘
();

	@plantillas/modulos/menuAdmin.php

1 <?
	gphp


	@plantillas/php_clase.php

14 
	g˛ass
 <
Nombª
 
de
 
œ
 
	g˛a£
> {

	@plantillas/php_fichero.php

1 <?
	gphp


	@plantillas/php_function.php

12 
fun˘i⁄
 
	$nombª
() {

14 
	}
}

	@plantillas/php_metodo.php

12 
fun˘i⁄
 
	$nombª
() {

14 
	}
}

	@proyecto/DATOS/conf/estadisticas.php

1 <?
PHP


6 
	g$e°adi°iˇs
['EXCLUIR_REFERENCIA'][]="localhost";

9 
	g$e°adi°iˇs
['EXCLUIR_CONTADOR'][]='localhost';

	@proyecto/DATOS/conf/modulos.php

1 <?
php


2 
	g$MODULOS_ACTIVOS
[]="subirimagen";

	@proyecto/DATOS/configuracion/admin/config.php

1 <?
php


3 
	g$c⁄fig
['IdiomaÖor defecto']='es';

4 
	g$c⁄fig
['M√≥dulosáctivados'][]='cache_http';

5 
	g$c⁄fig
['M√≥dulosáctivados'][]='comentarios';

6 
	g$c⁄fig
['M√≥dulosáctivados'][]='descargables';

7 
	g$c⁄fig
['M√≥dulosáctivados'][]='indexador';

8 
	g$c⁄fig
['M√≥dulosáctivados'][]='referencias';

9 
	g$c⁄fig
['M√≥dulosáctivados'][]='widgets';

10 
	g$c⁄fig
['M√≥dulosáctivados'][]='aplicar_SEO';

11 
	g$c⁄fig
['M√≥dulosáctivados'][]='literales';

12 
	g$c⁄fig
['Palabra secretaÖara depurar']='debug';

13 
	g$c⁄fig
['Proyecto']='proyecto';

14 
	g$c⁄fig
['SufijoÖara base de datos']='proyecto_';

15 
	g$c⁄fig
['bd_conexion']='sqlite:DATOS/proyecto.db';

16 
	g$c⁄fig
['bd_pass']='';

17 
	g$c⁄fig
['bd_usuario']='';

	@proyecto/DATOS/configuracion/admin/config_es.php

1 <?
php


3 
	g$c⁄fig_DESC
['Conexi√≥n con base de datos (PDO)']='En caso deÅener un servidor de base de datos,á√±adirÉl driverá utlizarÖara PDO';

4 
	g$c⁄fig_DESC
['Contrase√±a base de datos']='Contrase√±aÖara servidor de base de datos';

5 
	g$c⁄fig_DESC
['IdiomaÖor defecto']='IdiomaÖredeterminado';

6 
	g$c⁄fig_DESC
['M√≥dulosáctivados']='Desactivaci√≥n de m√≥dulos';

7 
	g$c⁄fig_DESC
['Palabra secretaÖara depurar']='A√±adiendoÜaÖalabra seleccionadaáÜa url (?<palabra_secreta>=1), se inicia sesi√≥n de depuraci√≥n, con un cero seÅermina';

8 
	g$c⁄fig_DESC
['Proyecto']='Dominio delÖroyecto';

9 
	g$c⁄fig_DESC
['SufijoÖara base de datos']='Producci√≥n: NosÖermite diferenciarÜasÅablas deÜos diferentesÖroyectosÉn una misma base de datos';

10 
	g$c⁄fig_DESC
['Usuario base de datos']='UsuarioÖaraÉl servidor de base de datos';

11 
	g$c⁄fig_DESC
['bd_conexion']='Producci√≥n: Driverá usarÖara conexi√≥n con base de datos (PDO). Ejemplos sqlite:/DATOS/proyecto.db o mysql:dbname=gcm';

12 
	g$c⁄fig_DESC
['bd_pass']='Producci√≥n: Contrase√±aÖara servidor de base de datos,Én caso de sqliteÇoÉsÇecesario';

13 
	g$c⁄fig_DESC
['bd_usuario']='Producci√≥n: UsuarioÖaraÉl servidor de base de datos,Én caso de utilizar sqliteÇoÉsÇecesario';

	@proyecto/DATOS/configuracion/comentarios/config.php

1 <?
php


6 
	g$c⁄fig
['modîaci√≥n'] = 
åue
;

	@proyecto/DATOS/configuracion/contenidos/config.php

1 <?
php


6 
	g$c⁄fig
['sistema'] = 'Files';

7 
	g$c⁄fig
['descartar'][] = 'gdoxygen';

	@proyecto/DATOS/configuracion/idiomas/LG_ca.php

1 <?
php


3 
	g$LG_ˇ
['ComoÅrata gcmÜas im√°genes']='comommmmmmmm';

4 
	g$LG_ˇ
['Documentacion']='Documentaci√≥n';

5 
	g$LG_ˇ
['Forzar_eventos_por_omision']='ForzarÉventosÖor omisi√≥n';

6 
	g$LG_ˇ
['ca']='Catal√†';

7 
	g$LG_ˇ
['es']='Castellano';

8 
	g$LG_ˇ
['ing']='';

9 
	g$LG_ˇ
['inicio']='Inici';

10 
	g$LG_ˇ
['Instalacion']='Instalaci√≥n';

11 
	g$LG_ˇ
['A_falta_de_un_script_de_instalacion_pasos_a_seguir_para_realizarla']='A falta de un script de instalaci√≥nÖasosá seguirÖaraÑealizarla';

	@proyecto/DATOS/configuracion/idiomas/LG_es.php

1 <?
php


3 
	g$LG_es
['Anyadir_javascript_desde_un_modulo']='A√±adir javascript desdeÜos m√≥dulos';

4 
	g$LG_es
['April']='Abril';

5 
	g$LG_es
['CSS_o_Como_cambiar_el_aspecto_de_tu_proyecto']='Apariencia';

6 
	g$LG_es
['Cache_http']='Cache http';

7 
	g$LG_es
['Como_crear_un_modulo']='Como crear un m√≥dulo';

8 
	g$LG_es
['Conexion_entre_modulos']='Conexi√≥nÉntre m√≥dulos';

9 
	g$LG_es
['Configuracion_para_modulos']='Configuraci√≥nÖara m√≥dulos';

10 
	g$LG_es
['Debug']='';

11 
	g$LG_es
['December']='Diciembre';

12 
	g$LG_es
['Desarrollo']='';

13 
	g$LG_es
['Documentacion']='Documentaci√≥n';

14 
	g$LG_es
['Ejemplo_de_documento']='Ejemplo de documento';

15 
	g$LG_es
['Ejemplo_de_uso_de_GcmConfig']='Ejemplo de uso de GcmConfig';

16 
	g$LG_es
['Entrada_de_prueba']='Entrada deÖrueba';

17 
	g$LG_es
['Eventos']='';

18 
	g$LG_es
['GCM']='';

19 
	g$LG_es
['Gestor de Contenido Mamedu']='';

20 
	g$LG_es
['Instalar']='Instalar';

21 
	g$LG_es
['Literales']='';

22 
	g$LG_es
['Modificar secciones definidasÉnÜaÖlantilla dinamicamente']='';

23 
	g$LG_es
['Modulos']='M√≥dulos';

24 
	g$LG_es
['November']='Noviembre';

25 
	g$LG_es
['Paginador_con_ajax']='Paginador conájax';

26 
	g$LG_es
['Permisos']='';

27 
	g$LG_es
['Permisos borrador']='';

28 
	g$LG_es
['Plantillas']='Plantillas';

29 
	g$LG_es
['Presentacion']='Presentaci√≥n';

30 
	g$LG_es
['Probando_contenido']='Probando contenido';

31 
	g$LG_es
['Referencias']='Referencias';

32 
	g$LG_es
['Seccion']='Secci√≥n';

33 
	g$LG_es
['Seccions']='Secciones';

34 
	g$LG_es
['Sistema_de_plantillas']='Sistema deÖlantillas';

35 
	g$LG_es
['Sistema_de_registros']='Sistema deÑegistros';

36 
	g$LG_es
['Subir imagená ']='Subir una imagen';

37 
	g$LG_es
['Subseccion_de_prueba']='Subsecci√≥n deÖrueba';

38 
	g$LG_es
['Tema_diferente_para_administracion']='Tema diferenteÖaraádministraci√≥n';

39 
	g$LG_es
['Trabajando_con_imagenes']=' Trabajando con imagenes';

40 
	g$LG_es
['Tratar_las_diferencias_entre_navegadores']='TratarÜas diferenciasÉntreÇavegadores';

41 
	g$LG_es
['Tratar_las_diferencias_entre_navegadores2']='TratarÜas diferenciasÉntreÇavegadores';

42 
	g$LG_es
['documento_nuevo']='DocumentoÇuevo';

43 
	g$LG_es
['eliminar']='';

44 
	g$LG_es
['es']='Castellano';

45 
	g$LG_es
['gcm']='';

46 
	g$LG_es
['inicio']='Inicio';

47 
	g$LG_es
['iniciot']='Pagina de inicio';

48 
	g$LG_es
['literales']='';

49 
	g$LG_es
['probando']='';

50 
	g$LG_es
['probandoÇuevo']='';

51 
	g$LG_es
['seccion con otroÇombre2']='';

52 
	g$LG_es
['seccionÇueva']='';

53 
	g$LG_es
['secci√≥n']='';

54 
	g$LG_es
['sin_traduccion']='No se haÉncontradoÅraducci√≥n deÉste documentoÜeÖresentamosÉl original';

55 
	g$LG_es
['tema']='';

56 
	g$LG_es
['tema_nuevo']='temaÇuevo';

57 
	g$LG_es
['tiny_mce']='';

58 
	g$LG_es
['Temas']='Temas';

59 
	g$LG_es
['Cambio_de_tema_al_vuelo']='Cambio deÅemaál vuelo';

60 
	g$LG_es
['A_falta_de_un_script_de_instalacion_pasos_a_seguir_para_realizarla']='A falta de un script de instalaci√≥n,Öasosá seguir';

61 
	g$LG_es
['Instalacion']='';

62 
	g$LG_es
['Tests_-_Creacion_de_test_sobre_modulos']='Tests - Creaci√≥n deÅest sobre m√≥dulos';

63 
	g$LG_es
['Tests,_Creacion_de_test_sobre_modulos']='Tests, Creaci√≥n deÅest sobre m√≥dulos';

64 
	g$LG_es
['proyecto']='';

65 
	g$LG_es
['SEO']='SEO';

66 
	g$LG_es
['Documentaci√≥n del framework']='';

67 
	g$LG_es
['Gcm']='';

68 
	g$LG_es
['Gestor de Contenido Gcm']='';

69 
	g$LG_es
['Documentaci√≥nÖara Gcm']='';

70 
	g$LG_es
['lib']='';

71 
	g$LG_es
['libjs']='';

72 
	g$LG_es
['js']='';

73 
	g$LG_es
['php']='';

74 
	g$LG_es
['thumbnail']='';

75 
	g$LG_es
['Seccion_de_prueba']='Secci√≥n deÖrueba';

76 
	g$LG_es
['Entrada_de_prueba_2']='Entrada deÖrueba 2';

77 
	g$LG_es
['Una_mas']='Una m√°s';

78 
	g$LG_es
['index']='index';

79 
	g$LG_es
['TinyTable']='';

80 
	g$LG_es
['Sustitucion_en_enlaces_en_caso_de_ser_llamados_mediante_ajax']='SustitucionÉnÉnlacesÉn caso de serÜlamados medianteájax';

81 
	g$LG_es
['Modificar_secciones_definidas_en_la_plantilla_dinamicamente']='Modificar secciones definidasÉnÜaÖlantilla dinamicamente';

82 
	g$LG_es
['Evitar_reenvios_a_formulario_al_actualizar_una_pagina']='EvitarÑeenviosá formularioáláctualizar unaÖagina';

83 
	g$LG_es
['Pagina_de_registro']='Pagina deÑegistro';

84 
	g$LG_es
['Forzar_eventos_por_omision']='';

85 
	g$LG_es
['Crud']='Crud';

86 
	g$LG_es
['crud']='crud';

	@proyecto/DATOS/configuracion/idiomas/LG_ing.php

1 <?
	gphp


	@proyecto/DATOS/configuracion/idiomas/config.php

1 <?
php


3 
	g$c⁄fig
['IdiomaÖor defecto']='es';

4 
	g$c⁄fig
['Idiomasáctivados'][]='ca';

5 
	g$c⁄fig
['Idiomasáctivados'][]='es';

6 
	g$c⁄fig
['Directorio idiomas'] = 'DATOS/configuracion/idiomas/';

	@proyecto/DATOS/configuracion/idiomas/config_es.php

1 <?
php


3 
	g$c⁄fig_DESC
['IdiomaÖor defecto']='IdiomaÖredeterminado';

	@proyecto/DATOS/configuracion/indexador/config.php

1 <?
php


2 
	g$c⁄fig
['maxLong'] = 200;

	@proyecto/DATOS/configuracion/menu/config.php

1 <?
php


3 
	g$c⁄fig
['descartar'][]='gdoxygen';

4 
	g$c⁄fig
['descartar'][]='thumbnail';

5 
	g$c⁄fig
['orden_presentacion'][] = 'inicio@1';

	@proyecto/DATOS/configuracion/menu/config_es.php

1 <?
php


3 
	g$c⁄fig_DESC
['descartar']='Si unárchivo o carpeta contiene uno deÜos contenidosá descartarÇo se incluyenÉnÉl men√∫';

	@proyecto/DATOS/configuracion/metatags/config.php

1 <?
php


3 
	g$c⁄fig
['title']='Gcm';

4 
	g$c⁄fig
['author']='https://plus.google.com/u/0/105169074373021028303/posts';

5 
	g$c⁄fig
['subject']='Documentaci√≥nÖara Gcm';

6 
	g$c⁄fig
['description']='HerramientaÖaraÜa gesti√≥n de contenido variado';

7 
	g$c⁄fig
['keywords']='programaci√≥n, inform√°tica,Üinux,Öhp, bash, javascript, css,ájax';

8 
	g$c⁄fig
['generator']='vim';

9 
	g$c⁄fig
['language']='spanish';

10 
	g$c⁄fig
['revisit']='1 day';

11 
	g$c⁄fig
['distribution']='global';

12 
	g$c⁄fig
['robots']='all';

	@proyecto/DATOS/configuracion/metatags/config_es.php

1 <?
php


3 
	g$c⁄fig_DESC
['Titulo']='Titulo delÖroyecto';

4 
	g$c⁄fig_DESC
['Subtitulo']='Subtitulo delÖroyecto';

5 
	g$c⁄fig_DESC
['keywords']='Palabras claveÖaraÜos buscadores separadasÖor comas';

6 
	g$c⁄fig_DESC
['title']='Titulo delÖroyecto';

7 
	g$c⁄fig_DESC
['author']='Titulo delÖroyecto';

8 
	g$c⁄fig_DESC
['subject']='Subtitulo delÖroyecto';

9 
	g$c⁄fig_DESC
['description']='Descripci√≥n delÖroyecto,Öara incluirÉnÜos metaÅags';

10 
	g$c⁄fig_DESC
['generator']='ProgramaÖara gene';

11 
	g$c⁄fig_DESC
['language']='C√≥digo deÜenguajeÉjemplo:És,Én';

12 
	g$c⁄fig_DESC
['revisit']='Ejemplo 1 day';

13 
	g$c⁄fig_DESC
['distribution']='Ejemplo global';

	@proyecto/DATOS/configuracion/temas/config.php

1 <?
php


3 
	g$c⁄fig
['tema_actual']='proyecto';

	@proyecto/DATOS/constantes/GCM_CONS.php

1 <?
php


2 
	g$GCM_CONS
['ejemplo1']='Ejemplo1 de constante';

3 
	g$GCM_CONS
['ejemplo2']='Ejemplo2 de constante';

4 
	g$GCM_CONS
['ejemplo_tres']='ejemploÅresÖara';

5 
	g$GCM_CONS
['ejemplo_4']='Este unÉjemplo';

	@proyecto/DATOS/constantes/GCM_CONS_ca.php

1 <?
php


2 
	g$GCM_CONS_DESC
['ejemplo1']='Ejemplo1 de constantÉn catala';

3 
	g$GCM_CONS_DESC
['ejemplo2']='Ejemplo2 de constante';

4 
	g$GCM_CONS_DESC
['ejemplo_tres']='e3 conÉspacios yác√©nt√≤s';

	@proyecto/DATOS/constantes/GCM_CONS_es.php

1 <?
php


2 
	g$GCM_CONS_DESC
['ejemplo1']='Ejemplo1 de constante';

3 
	g$GCM_CONS_DESC
['ejemplo2']='Ejemplo2 de constante';

4 
	g$GCM_CONS_DESC
['ejemplo_tres']='e3 conÉspacios yác√©nt√≤s';

5 
	g$GCM_CONS_DESC
['ejemplo_4']='ejemplo_4';

	@proyecto/DATOS/eventos/admin/eventos_admin.php

1 <?
php


3 
	g$evítos
['menuadmin']['presentar_menu_administrativo'][1]='';

4 
	g$evítos
['infoserver']['infoserver'][1]='';

5 
	g$evítos
['test']['ejecutar_tests_modulos'][1]='';

9 
	g$evítos
['precarga']['activar_tema_admin'][1]='';

12 i‡–! 
	g$gcm
->
c⁄fig
('admin','configuracion_confirmada') ) {

14 
	g$evítos
['precontenido']['confirmar_configuracion'][1]='';

	@proyecto/DATOS/eventos/admin/eventos_usuario.php

1 <?
php


3 
	g$evítos
['menuadmin']['menuadmin_sin_login'][1]='';

4 
	g$evítos
['columna']['panel_login'][10]='';

5 
	g$evítos
['registro']['formulario_registro'][10]='';

	@proyecto/DATOS/eventos/aplicar_SEO/eventos_admin.php

1 <?
php


30 
	g$evítos
['seo']['seo'][1] = "";

	@proyecto/DATOS/eventos/aplicar_SEO/eventos_usuario.php

1 <?
	gphp


	@proyecto/DATOS/eventos/cache_http/eventos_admin.php

1 <?
	gphp


	@proyecto/DATOS/eventos/cache_http/eventos_usuario.php

1 <?
php


29 
	g$evítos
['precarga']['alInicio'][1] = '';

30 
	g$evítos
['postcarga']['alFinal'][1] = '';

31 
	g$evítos
['borrar_cache']['borrar'][1] = 'todo';

	@proyecto/DATOS/eventos/comentarios/eventos_admin.php

1 <?
	gphp


	@proyecto/DATOS/eventos/comentarios/eventos_usuario.php

1 <?
php


12 
	g$evítos
['columna']['ultimos'][6]='';

15 
	g$evítos
['postcontenido']['presentar_comentarios'][3]='';

18 
	g$evítos
['postcontenido']['formulario'][4]='';

21 
	g$evítos
['modifiˇr_comíèrio']['modifiˇr'][1] = ( 
is£t
(
$_REQUEST
['id']ËË? $_REQUEST['id'] : 
NULL
 ;

	@proyecto/DATOS/eventos/contenidos/eventos_admin.php

1 <?
php


13 
	g$evítos
['guardar_como_borrador']['guardar'][10]='';

16 
	g$evítos
['postguardar_como_borrador']['enrutar'][100]='';

22 
	g$evítos
['publicar_borrador']['ejecutar_mover'][1]='';

25 
	g$evítos
['postpublicar_borrador']['enrutar'][100]='';

28 
	g$evítos
['actualizar_contenido']['guardar'][1]='';

31 
	g$evítos
['postactualizar_contenido']['enrutar'][100]='';

34 
	g$evítos
['borrar']['borrar'][1]='';

37 
	g$evítos
['ejecutar_borrar']['ejecutar_borrar'][1]='';

40 
	g$evítos
['postejecutar_borrar']['enrutar'][100]='';

43 
	g$evítos
['nueva_seccion']['nueva_seccion'][1]='';

46 
	g$evítos
['ejecutar_nueva_seccion']['ejecutar_nueva_seccion'][1]='';

49 
	g$evítos
['postejecutar_nueva_seccion']['enrutar'][100]='';

55 
	g$evítos
['guardar_como']['guardar_como'][1]='';

61 
	g$evítos
['vertodo']['vertodo'][1]='';

64 
	g$evítos
['traducir']['editar'][1]='';

67 
	g$evítos
['ejecutar_traducir']['guardar'][1]='';

70 
	g$evítos
['postejecutar_traducir']['enrutar'][100]='';

73 
	g$evítos
['mover']['mover'][1]='';

76 
	g$evítos
['ejecutar_mover']['ejecutar_mover'][1]='';

79 
	g$evítos
['postejecutar_mover']['enrutar'][100]='';

82 
	g$evítos
['mover_seccion']['mover_seccion'][1]='';

85 
	g$evítos
['ejecutar_mover_seccion']['ejecutar_mover_seccion'][1]='';

88 
	g$evítos
['postejecutar_mover_seccion']['enrutar'][100]='';

91 
	g$evítos
['nuevo']['nuevo'][1]='';

94 
	g$evítos
['ejecutar_nuevo']['guardar'][1]='';

97 
	g$evítos
['postejecutar_nuevo']['enrutar'][100]='';

100 
	g$evítos
['editar_contenido']['editar'][1]='';

	@proyecto/DATOS/eventos/contenidos/eventos_usuario.php

1 <?
php


10 
	g$evítos
['contenido']['contenido'][1]='';

13 
	g$evítos
['titulo']['titulo'][1]='';

16 
	g$evítos
['titulo_articulo']['titulo_articulo'][1]='';

19 
	g$evítos
['pie_articulo']['pie_articulo'][1]='';

22 
	g$evítos
['contenido_dinamico']['listar_contenido_seccion'][5]='';

25 
	g$evítos
['subcabecera']['camino'][2]='';

28 
	g$evítos
['precarga']['comprobar_permisos'][1]='';

31 
	g$evítos
['contenido_ajax']['contenido_ajax'][1]='';

34 
	g$evítos
['sin_contenido']['sin_contenido'][1]='';

37 
	g$evítos
['sin_seccion']['sin_seccion'][1]='';

	@proyecto/DATOS/eventos/descargables/eventos_usuario.php

1 <?
php


2 i‡–!
is£t
(
$_SESSION
['edô']Ë|| 
	g$_SESSION
['edit'] != 'si' ) {

3 
$evítos
['postcontenido']['procesar_texto'][1] = '';

5 
	g$evítos
['precarga']['presenta_contenido'][1] = '';

6 
	g$evítos
['postcontenido']['lista_descargables'][1] = '';

	@proyecto/DATOS/eventos/editar/eventos_admin.php

1 <?
php


11 
	g$evítos
['editar_contenido']['editor_web'][10]='';

12 
	g$evítos
['traducir']['editor_web'][10]='';

13 
	g$evítos
['nuevo']['editor_web'][10]='';

	@proyecto/DATOS/eventos/enviomail/eventos_admin.php

1 <?
php


7 
	g$evítos
['columna']['formulario']['10']='';

8 
	g$evítos
['enviar_email_error']['enviar_email_error'][1]='';

	@proyecto/DATOS/eventos/idiomas/eventos_usuario.php

1 <?
php


5 
	g$evítos
['precarga']['seleccion_idioma'][1] = '';

6 
	g$evítos
['precarga']['definir_idioma'][2] = '';

7 
	g$evítos
['cabeceraDerecha']['selector_idiomas'][1] = '';

	@proyecto/DATOS/eventos/imagenes/eventos_admin.php

1 <?
php


2 
	g$evítos
['columna']['formulario'][3] = '';

	@proyecto/DATOS/eventos/imagenes/eventos_usuario.php

1 <?
php


19 
	g$evítos
['postcontenido']['imagenes2thickbox'][3] = '';

	@proyecto/DATOS/eventos/indexador/eventos_admin.php

1 <?
php


2 
	g$evítos
['postejecutar_borrar']['borrar_archivo_pdo'][1] = '';

3 
	g$evítos
['postejecutar_nuevo']['indexar_archivo_pdo'][1] = '' ;

4 
	g$evítos
['postactualizar_contenido']['indexar_archivo_pdo'][1] = '';

5 
	g$evítos
['postejecutar_mover']['borrar_archivo_pdo'][1] = '';

6 
	g$evítos
['postejecutar_mover']['indexar_archivo_pdo'][2] = '';

7 
	g$evítos
['postpublicar_borrador']['indexar_archivo_pdo'][2] = '';

8 
	g$evítos
['postejecutar_mover_seccion']['cambio_ruta_seccion'][2] = '';

9 
	g$evítos
['reindexar']['reindexar'][1] = '';

10 
	g$evítos
['reindexado_completo']['reindexado_completo'][1] = '';

11 
	g$evítos
['indexar']['indexado'][1] = '';

	@proyecto/DATOS/eventos/indexador/eventos_usuario.php

1 <?
php


2 
	g$evítos
['cabeceraDerecha']['formulario_busqueda'][1]='';

3 
	g$evítos
['cﬁum«']['u…imas_íåadas'][5]="num=4&£cci⁄=".
Rouãr
::
$s
."&formato=1";

4 
	g$evítos
['contenido_dinamico']['contenido_dinamico'][1]='';

6 
	g$evítos
['buscar']['presentar_busquedas'][1]='';

8 
	g$evítos
['indexar']['indexado'][3] = '';

	@proyecto/DATOS/eventos/literales/eventos_admin.php

1 <?
php


19 
	g$evítos
['columna']['panel_literales'][5] = '';

	@proyecto/DATOS/eventos/literales/eventos_usuario.php

1 <?
php


20 i‡–!
is£t
(
$_SESSION
['edô']Ë|| 
	g$_SESSION
['edit'] != 'si' ) {

21 
$evítos
['postcontenido']['procesar_texto'][1] = '';

	@proyecto/DATOS/eventos/menu/eventos_usuario.php

1 <?
php


13 
	g$evítos
['cabecera']['menu_principal'][0] = '';

14 
	g$evítos
['columna']['barra_navegacion'][1] = '';

19 
	g$this
->
£t_li°a_bœnˇ
('menu','menu_ajax');

	@proyecto/DATOS/eventos/metatags/eventos_usuario.php

1 <?
php


2 
	g$evítos
['heads']['presentar_heads_dinamicos'][1] = '';

	@proyecto/DATOS/eventos/referencias/eventos_admin.php

1 <?
php


2 
	g$evítos
['columna']['panel'][10]='';

	@proyecto/DATOS/eventos/referencias/eventos_usuario.php

1 <?
php


3 
	g$evítos
['postcontenido']['procesar_texto'][1] = '';

	@proyecto/DATOS/eventos/temas/eventos_admin.php

1 <?
php


5 i‡–
	gRouãr
::
$a
 ='admöi°ør' && 
Rouãr
::
$m
 == 'temas' ) {

6 
$evítos
['columna']['panel_colores'][1] = '';

	@proyecto/DATOS/eventos/temas/eventos_usuario.php

1 <?
php


24 
	g$evítos
['precarga']['inspeccionar_router'][3] = '';

27 
	g$evítos
['pie']['pie'][1] = '';

30 
	g$evítos
['cabeceraIzquierda']['presentar_titulo'][1]='';

33 
	g$evítos
['heads']['incluir_css_head'][5] = '';

36 
	g$evítos
['heads']['incluir_javascript_head'][5] = '';

39 
	g$evítos
['scripts']['incluir_javascript'][1] = '';

42 
	g$evítos
['precarga']['ocultar_contenido_desde_titulo'][10] = '';

	@proyecto/DATOS/eventos/ver_registros/eventos_usuario.php

1 <?
php


9 
	g$evítos
['debug']['debug'][15] = '';

12 
	g$evítos
['avisos']['presentar_caja_de_avisos'][1]='';

15 
	g$evítos
['postcontenido_ajax']['postcontenido_ajax'][1]='';

18 
	g$evítos
['cron']['envio_registros_mail'][100]='';

21 
	g$evítos
['cron']['borrar_registros_antiguos'][10]='';

	@proyecto/DATOS/eventos/widgets/eventos_usuario.php

1 <?
php


2 
	g$evítos
['columnaDerecha']['widget_con_panel'][10]='widget=Noticias';

3 
	g$evítos
['columnaDerecha']['widget_con_panel'][11]='widget=EnlacesÉxternos';

	@proyecto/DATOS/modulos/widgets/Enlaces.php

1 <
i‰ame
 
	g§c
="hâp://sh¨e.xm¨ks.com/fﬁdî/i‰ame/oN3OZ5CCup" 
width
="200px" 
height
="240px" 
s¸ﬁlög
="no" 
‰ameb‹dî
="0"></iframe>

2 <
i‰ame
 
§c
="hâp://sh¨e.xm¨ks.com/fﬁdî/i‰ame/Q…PDYcd2A" 
width
="200px" 
height
="240px;" 
s¸ﬁlög
="no" 
‰ameb‹dî
="0"></iframe>

	@proyecto/DATOS/modulos/widgets/Noticias.php

1 <
s¸ùt
 
	gty≥
="ãxt/javas¸ùt" 
§c
="https://www.google.com/reader/ui/publisher-es.js"></script>

2 <
s¸ùt
 
ty≥
="ãxt/javas¸ùt" 
§c
="https://www.google.com/reader/public/javascript/user/03196777891250716063/state/com.google/broadcast?n=5&callback=GRC_p(%7Bc%3A%22-%22%2Ct%3A%22%22%2Cs%3A%22false%22%2Cb%3A%22false%22%7D)%3Bnew%20GRC"></script>

	@proyecto/index.php

1 <?
php


25 
d©e_deÁu…_timez⁄e_£t
('Europe/Madrid');

34 
DEFINE
('GCM_DIR','../../gcm/gcm/');

36 
ªquúe
(
GCM_DIR
.'inicio.php');

	@
1
.
1
/usr/include
228
9397
docs/doxygen/html/search-config.php
docs/doxygen/html/search-functions.php
docs/doxygen/html/search-opensearch.php
docs/doxygen/html/search.php
gcm/DATOS/config/administradores/administradores.php
gcm/DATOS/config/administradores/administradores_es.php
gcm/DATOS/idiomas/GCM_LG_ca.php
gcm/DATOS/idiomas/GCM_LG_en.php
gcm/DATOS/idiomas/GCM_LG_es.php
gcm/DATOS/idiomas/GCM_LG_fr.php
gcm/DATOS/idiomas/estadisticas_es.php
gcm/includes/blank.php
gcm/includes/login.php
gcm/inicio.php
gcm/js/formulario.js.php
gcm/lib/int/GcmConfig/lib/Config.php
gcm/lib/int/GcmConfig/lib/GcmConfig.php
gcm/lib/int/GcmConfig/lib/GcmConfigFactory.php
gcm/lib/int/GcmConfig/lib/GcmConfigGui.php
gcm/lib/int/GcmConfig/test/GcmConfigFactoryTest.php
gcm/lib/int/GcmConfig/test/GcmConfigGuiTest.php
gcm/lib/int/GcmConfig/test/GcmConfigTest.php
gcm/lib/int/GcmConfig/test/PhpTestGcmConfigGui.php
gcm/lib/int/GcmConfig/test/phpTestGcmConfig.php
gcm/lib/int/GcmPDO/lib/GcmPDO.php
gcm/lib/int/GcmPDO/lib/paginarPDO.php
gcm/lib/int/array2table/lib/Array2table.php
gcm/lib/int/autentificacion/lib/Autentificacion.php
gcm/lib/int/autentificacion/test/AutentificacionTest.php
gcm/lib/int/captcha/captcha.php
gcm/lib/int/databoundobject/lib/Crud.php
gcm/lib/int/databoundobject/lib/DataBoundObject.php
gcm/lib/int/databoundobject/lib/Formulario.php
gcm/lib/int/formato/lib/Formato.php
gcm/lib/int/galeria/lib/Galeria.php
gcm/lib/int/galeria/lib/ImagenesAbstract.php
gcm/lib/int/galeria/lib/ImagenesTablaArchivo.php
gcm/lib/int/galeria/lit/lit_ca.php
gcm/lib/int/galeria/lit/lit_es.php
gcm/lib/int/gcm/lib/Eventos.php
gcm/lib/int/gcm/lib/GUtil.php
gcm/lib/int/gcm/lib/Gcm.php
gcm/lib/int/gcm/lib/Modulos.php
gcm/lib/int/gcm/lib/Plantilla.php
gcm/lib/int/gcm/lib/Router.php
gcm/lib/int/gcm/lib/helpers.php
gcm/lib/int/gcm/test/EventosTest.php
gcm/lib/int/gcm/test/RouterTest.php
gcm/lib/int/gcm_imagen.php
gcm/lib/int/idiomas/lib/IdiomasCore.php
gcm/lib/int/mimetypes.php
gcm/lib/int/registro/Registro.php
gcm/lib/int/registro/RegistroFactory.php
gcm/lib/int/registro/RegistroFactoryTest.php
gcm/lib/int/registro/RegistroTest.php
gcm/lib/int/rst2html/lib/Rst2html.php
gcm/lib/int/solicitud/lib/Restricciones.php
gcm/lib/int/solicitud/lib/RestriccionesFallidas.php
gcm/lib/int/solicitud/lib/Solicitud.php
gcm/lib/int/solicitud/lib/constantes.php
gcm/lib/int/temas/lib/TemaGcm.php
gcm/lib/int/temas/lib/TemaGcmTest.php
gcm/modulos/admin/config/config.php
gcm/modulos/admin/config/config_es.php
gcm/modulos/admin/eventos_admin.php
gcm/modulos/admin/eventos_usuario.php
gcm/modulos/admin/lib/Admin.php
gcm/modulos/admin/lib/AdminAdmin.php
gcm/modulos/admin/menuAdmin.php
gcm/modulos/admin/modelos/usuarios.php
gcm/modulos/aplicar_SEO/eventos_admin.php
gcm/modulos/aplicar_SEO/eventos_usuario.php
gcm/modulos/aplicar_SEO/lib/Aplicar_SEO.php
gcm/modulos/aplicar_SEO/menuAdmin.php
gcm/modulos/cache_http/eventos_admin.php
gcm/modulos/cache_http/eventos_usuario.php
gcm/modulos/cache_http/lib/Cache_http.php
gcm/modulos/cache_http/menuAdmin.php
gcm/modulos/comentarios/config/config.php
gcm/modulos/comentarios/config/config_es.php
gcm/modulos/comentarios/eventos_admin.php
gcm/modulos/comentarios/eventos_usuario.php
gcm/modulos/comentarios/lib/Comentarios.php
gcm/modulos/comentarios/lib/ComentariosAdmin.php
gcm/modulos/comentarios/menuAdmin.php
gcm/modulos/comentarios/modelos/comentarios_dbo.php
gcm/modulos/contenidos/config/config.php
gcm/modulos/contenidos/config/config_es.php
gcm/modulos/contenidos/eventos_admin.php
gcm/modulos/contenidos/eventos_usuario.php
gcm/modulos/contenidos/lib/ContenidoColeccion.php
gcm/modulos/contenidos/lib/Contenidos.php
gcm/modulos/contenidos/lib/ContenidosAbstract.php
gcm/modulos/contenidos/lib/ContenidosFiles.php
gcm/modulos/contenidos/menuAdmin.php
gcm/modulos/contenidos/test/ContenidoTest.php
gcm/modulos/descargables/config.php
gcm/modulos/descargables/eventos_usuario.php
gcm/modulos/descargables/lib/Descargables.php
gcm/modulos/editar/eventos_admin.php
gcm/modulos/editar/lib/Editar.php
gcm/modulos/editar/menuAdmin.php
gcm/modulos/enviomail/eventos_admin.php
gcm/modulos/enviomail/lib/Enviomail.php
gcm/modulos/gdoxygen/eventos_admin.php
gcm/modulos/gdoxygen/eventos_usuario.php
gcm/modulos/gdoxygen/lib/Gdoxygen.php
gcm/modulos/gdoxygen/lib/search_doxygen.php
gcm/modulos/idiomas/config/config.php
gcm/modulos/idiomas/config/config_es.php
gcm/modulos/idiomas/eventos_usuario.php
gcm/modulos/idiomas/info.php
gcm/modulos/idiomas/lib/Idiomas.php
gcm/modulos/idiomas/menuAdmin.php
gcm/modulos/imagenes/config/config.php
gcm/modulos/imagenes/config/config_ca.php
gcm/modulos/imagenes/config/config_es.php
gcm/modulos/imagenes/eventos_admin.php
gcm/modulos/imagenes/eventos_usuario.php
gcm/modulos/imagenes/lib/Imagenes.php
gcm/modulos/imagenes/lib/ImagenesAdmin.php
gcm/modulos/imagenes/lib/UploadHandler.php
gcm/modulos/imagenes/lib/presentar_galeria.php
gcm/modulos/imagenes/menuAdmin.php
gcm/modulos/indexador/config/config.php
gcm/modulos/indexador/config/config_es.php
gcm/modulos/indexador/eventos_admin.php
gcm/modulos/indexador/eventos_usuario.php
gcm/modulos/indexador/info.php
gcm/modulos/indexador/lib/Indexador.php
gcm/modulos/indexador/menuAdmin.php
gcm/modulos/literales/eventos_admin.php
gcm/modulos/literales/eventos_usuario.php
gcm/modulos/literales/lib/Literales.php
gcm/modulos/literales/menuAdmin.php
gcm/modulos/menu/config/config.php
gcm/modulos/menu/config/config_es.php
gcm/modulos/menu/eventos_usuario.php
gcm/modulos/menu/lib/Menu.php
gcm/modulos/metatags/config/config.php
gcm/modulos/metatags/config/config_ca.php
gcm/modulos/metatags/config/config_es.php
gcm/modulos/metatags/eventos_usuario.php
gcm/modulos/metatags/lib/Metatags.php
gcm/modulos/referencias/eventos_admin.php
gcm/modulos/referencias/eventos_usuario.php
gcm/modulos/referencias/lib/Referencias.php
gcm/modulos/referencias/menuAdmin.php
gcm/modulos/responsiveslides/eventos_admin.php
gcm/modulos/responsiveslides/eventos_usuario.php
gcm/modulos/responsiveslides/lib/Responsiveslides.php
gcm/modulos/responsiveslides/menuAdmin.php
gcm/modulos/temas/config/config.php
gcm/modulos/temas/css/colores.php
gcm/modulos/temas/eventos_admin.php
gcm/modulos/temas/eventos_usuario.php
gcm/modulos/temas/lib/Temas.php
gcm/modulos/temas/lib/TemasAdmin.php
gcm/modulos/temas/menuAdmin.php
gcm/modulos/ver_registros/config/config.php
gcm/modulos/ver_registros/config/config_es.php
gcm/modulos/ver_registros/eventos_usuario.php
gcm/modulos/ver_registros/info.php
gcm/modulos/ver_registros/lib/Ver_registros.php
gcm/modulos/ver_registros/menuAdmin.php
gcm/modulos/widgets/eventos_usuario.php
gcm/modulos/widgets/index.php
gcm/modulos/widgets/lib/Widgets.php
plantillas/index-modulos.php
plantillas/modulos/eventos_admin.php
plantillas/modulos/eventos_usuario.php
plantillas/modulos/lib/modulo.php
plantillas/modulos/menuAdmin.php
plantillas/php_clase.php
plantillas/php_fichero.php
plantillas/php_function.php
plantillas/php_metodo.php
proyecto/DATOS/conf/estadisticas.php
proyecto/DATOS/conf/modulos.php
proyecto/DATOS/configuracion/admin/config.php
proyecto/DATOS/configuracion/admin/config_es.php
proyecto/DATOS/configuracion/comentarios/config.php
proyecto/DATOS/configuracion/contenidos/config.php
proyecto/DATOS/configuracion/idiomas/LG_ca.php
proyecto/DATOS/configuracion/idiomas/LG_es.php
proyecto/DATOS/configuracion/idiomas/LG_ing.php
proyecto/DATOS/configuracion/idiomas/config.php
proyecto/DATOS/configuracion/idiomas/config_es.php
proyecto/DATOS/configuracion/indexador/config.php
proyecto/DATOS/configuracion/menu/config.php
proyecto/DATOS/configuracion/menu/config_es.php
proyecto/DATOS/configuracion/metatags/config.php
proyecto/DATOS/configuracion/metatags/config_es.php
proyecto/DATOS/configuracion/temas/config.php
proyecto/DATOS/constantes/GCM_CONS.php
proyecto/DATOS/constantes/GCM_CONS_ca.php
proyecto/DATOS/constantes/GCM_CONS_es.php
proyecto/DATOS/eventos/admin/eventos_admin.php
proyecto/DATOS/eventos/admin/eventos_usuario.php
proyecto/DATOS/eventos/aplicar_SEO/eventos_admin.php
proyecto/DATOS/eventos/aplicar_SEO/eventos_usuario.php
proyecto/DATOS/eventos/cache_http/eventos_admin.php
proyecto/DATOS/eventos/cache_http/eventos_usuario.php
proyecto/DATOS/eventos/comentarios/eventos_admin.php
proyecto/DATOS/eventos/comentarios/eventos_usuario.php
proyecto/DATOS/eventos/contenidos/eventos_admin.php
proyecto/DATOS/eventos/contenidos/eventos_usuario.php
proyecto/DATOS/eventos/descargables/eventos_usuario.php
proyecto/DATOS/eventos/editar/eventos_admin.php
proyecto/DATOS/eventos/enviomail/eventos_admin.php
proyecto/DATOS/eventos/idiomas/eventos_usuario.php
proyecto/DATOS/eventos/imagenes/eventos_admin.php
proyecto/DATOS/eventos/imagenes/eventos_usuario.php
proyecto/DATOS/eventos/indexador/eventos_admin.php
proyecto/DATOS/eventos/indexador/eventos_usuario.php
proyecto/DATOS/eventos/literales/eventos_admin.php
proyecto/DATOS/eventos/literales/eventos_usuario.php
proyecto/DATOS/eventos/menu/eventos_usuario.php
proyecto/DATOS/eventos/metatags/eventos_usuario.php
proyecto/DATOS/eventos/referencias/eventos_admin.php
proyecto/DATOS/eventos/referencias/eventos_usuario.php
proyecto/DATOS/eventos/temas/eventos_admin.php
proyecto/DATOS/eventos/temas/eventos_usuario.php
proyecto/DATOS/eventos/ver_registros/eventos_usuario.php
proyecto/DATOS/eventos/widgets/eventos_usuario.php
proyecto/DATOS/modulos/widgets/Enlaces.php
proyecto/DATOS/modulos/widgets/Noticias.php
proyecto/index.php
